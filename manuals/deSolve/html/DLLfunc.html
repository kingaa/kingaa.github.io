<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Evaluates a Derivative Function Represented in a DLL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for DLLfunc {deSolve}"><tr><td>DLLfunc {deSolve}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Evaluates a Derivative Function Represented in a DLL</h2>

<h3>Description</h3>

<p>Calls a function, defined in a compiled language as a DLL</p>


<h3>Usage</h3>

<pre>DLLfunc(func, times, y, parms, dllname,
  initfunc = dllname, rpar = NULL, ipar = NULL, nout = 0,
  outnames = NULL, forcings = NULL, initforc = NULL,
  fcontrol = NULL)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>func </code></td>
<td>
<p>the name of the function in the dynamically loaded
shared library,
</p>
</td></tr>
<tr valign="top"><td><code>times </code></td>
<td>
<p>first value = the time at which the function needs to be
evaluated,
</p>
</td></tr>
<tr valign="top"><td><code>y </code></td>
<td>
<p>the values of the dependent variables for which the function
needs to be evaluated,
</p>
</td></tr>
<tr valign="top"><td><code>parms </code></td>
<td>
<p>the parameters that are passed to the initialiser function,
</p>
</td></tr>
<tr valign="top"><td><code>dllname </code></td>
<td>
<p>a string giving the name of the shared library (without
extension) that contains the compiled function or subroutine definitions
referred to in <code>func</code>,
</p>
</td></tr>
<tr valign="top"><td><code>initfunc </code></td>
<td>
<p>if not <code>NULL</code>, the name of the initialisation function
(which initialises values of parameters), as provided in &lsquo;<span class="file">dllname</span>&rsquo;.
See details.
</p>
</td></tr>
<tr valign="top"><td><code>rpar </code></td>
<td>
<p>a vector with double precision values passed to the
DLL-function <code>func</code> and <code>jacfunc</code> present in the DLL, via
argument rpar,
</p>
</td></tr>
<tr valign="top"><td><code>ipar </code></td>
<td>
<p>a vector with integer values passed to the dll-function
<code>func</code> and <code>jacfunc</code> present in the DLL, via function argument
ipar,
</p>
</td></tr>
<tr valign="top"><td><code>nout </code></td>
<td>
<p>the number of output variables.
</p>
</td></tr>
<tr valign="top"><td><code>outnames </code></td>
<td>
<p>only used if &lsquo;<span class="file">dllname</span>&rsquo; is specified and
<code>nout</code> &gt; 0: the names of output variables calculated in the
compiled function <code>func</code>, present in the shared library.
</p>
</td></tr>
<tr valign="top"><td><code>forcings </code></td>
<td>
<p>only used if &lsquo;<span class="file">dllname</span>&rsquo; is specified: a list with
the forcing function data sets, each present as a two-columned matrix,
with (time, value); interpolation outside the interval
[min(<code>times</code>), max(<code>times</code>)] is done by taking the value at
the closest data extreme.
</p>
<p>See package vignette <code>"compiledCode"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>initforc </code></td>
<td>
<p>if not <code>NULL</code>, the name of the forcing function
initialisation function, as provided in
&lsquo;<span class="file">dllname</span>&rsquo;. It MUST be present if <code>forcings</code> has been given a
value.
See package vignette <code>"compiledCode"</code>.
</p>
</td></tr>
<tr valign="top"><td><code>fcontrol </code></td>
<td>
<p>A list of control parameters for the forcing functions.
See package vignette <code>"compiledCode"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is meant to help developing FORTRAN or C models that are
to be used to solve ordinary differential equations (ODE) in packages
<code>deSolve</code> and/or <code>rootSolve</code>.
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>dy </code></td>
<td>
<p>the rate of change estimated by the function,
</p>
</td></tr>
<tr valign="top"><td><code>var </code></td>
<td>
<p>the ordinary output variables of the function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><code><a href="../../deSolve/help/ode.html">ode</a></code> for a general interface to most of the ODE solvers
</p>


<h3>Examples</h3>

<pre>
## ==========================================================================
## ex. 1
## ccl4model
## ==========================================================================
## Parameter values and initial conditions
## see example(ccl4model) for a more comprehensive implementation

Parms &lt;- c(0.182, 4.0, 4.0, 0.08, 0.04, 0.74, 0.05, 0.15, 0.32,
        16.17, 281.48, 13.3, 16.17, 5.487, 153.8, 0.04321671,
        0.4027255, 1000, 0.02, 1.0, 3.8)

yini &lt;- c(AI = 21, AAM = 0, AT = 0, AF = 0, AL = 0, CLT = 0,  AM = 0)

## the rate of change
DLLfunc(y = yini, dllname = "deSolve", func = "derivsccl4",
        initfunc = "initccl4", parms = Parms, times = 1,
        nout = 3, outnames = c("DOSE", "MASS", "CP")  )

## ==========================================================================
## ex. 2
## SCOC model
## ==========================================================================

## Forcing function "data"
Flux  &lt;- matrix(ncol = 2, byrow = TRUE, data = c(1, 0.654, 2, 0.167))
parms &lt;- c(k = 0.01)
Yini  &lt;- 60

DLLfunc(y=Yini, times=1, func = "scocder",
    parms = parms, dllname = "deSolve",
    initforc = "scocforc",  forcings = Flux,
    initfunc = "scocpar", nout = 2,
    outnames = c("Mineralisation","Depo"))
## correct value = dy = flux - k * y = 0.654 - 0.01 * 60

DLLfunc(y = Yini, times = 2, func = "scocder",
    parms = parms, dllname = "deSolve",
    initforc = "scocforc",  forcings = Flux,
    initfunc = "scocpar", nout = 2,
    outnames = c("Mineralisation", "Depo"))
</pre>

<hr /><div style="text-align: center;">[Package <em>deSolve</em> version 1.30 <a href="00Index.html">Index</a>]</div>
</div></body></html>
