<!DOCTYPE html><html><head><title>R: A Physiological Model of Unbalanced Algal Growth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>aquaphy {deSolve}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='aquaphy'>A Physiological Model of Unbalanced Algal Growth</h2>

<h3>Description</h3>

<p>A phytoplankton model with uncoupled carbon and nitrogen
assimilation as a function of light and Dissolved Inorganic Nitrogen
(DIN) concentration.
</p>
<p>Algal biomass is described via 3 different state variables:
</p>

<ul>
<li><p> low molecular weight carbohydrates (LMW), the product of
photosynthesis,
</p>
</li>
<li><p> storage molecules (RESERVE) and 
</p>
</li>
<li><p> the biosynthetic and photosynthetic apparatus (PROTEINS).
</p>
</li></ul>

<p>All algal state variables are expressed in
<code class="reqn">\rm mmol\, C\, m^{-3}</code>.
Only proteins contain nitrogen and
chlorophyll, with a fixed stoichiometric ratio.  As the relative
amount of proteins changes in the algae, so does the N:C and the Chl:C
ratio.
</p>
<p>An additional state variable, dissolved inorganic nitrogen (DIN) has
units of <code class="reqn">\rm mmol\, N\, m^{-3}</code>.
</p>
<p>The algae grow in a dilution culture (chemostat): there is constant
inflow of DIN and outflow of culture water, including DIN and algae,
at the same rate.
</p>
<p>Two versions of the model are included.
</p>

<ul>
<li><p> In the default model, there is a day-night illumination regime, i.e.
the light is switched on and off at fixed times (where the sum of
illuminated + dark period = 24 hours).
</p>
</li>
<li><p> In another version, the light is imposed as a forcing function data
set.
</p>
</li></ul>

<p>This model is written in <code>FORTRAN</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aquaphy(times, y, parms, PAR = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aquaphy_:_times">times</code></td>
<td>
<p>time sequence for which output is wanted; the first value
of times must be the initial time,</p>
</td></tr>
<tr><td><code id="aquaphy_:_y">y</code></td>
<td>
<p>the initial (state) values (&quot;DIN&quot;, &quot;PROTEIN&quot;, &quot;RESERVE&quot;,
&quot;LMW&quot;), in that order,</p>
</td></tr>
<tr><td><code id="aquaphy_:_parms">parms</code></td>
<td>
<p>vector or list with the aquaphy model parameters; see
the example for the order in which these have to be defined.</p>
</td></tr>
<tr><td><code id="aquaphy_:_PAR">PAR</code></td>
<td>
<p>a data set of the photosynthetically active radiation
(light intensity), if <code>NULL</code>, on-off PAR is used, </p>
</td></tr>
<tr><td><code id="aquaphy_:_...">...</code></td>
<td>
<p>any other parameters passed to the integrator <code>ode</code>
(which solves the model).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is implemented primarily to demonstrate the linking of
FORTRAN with <span class="rlang"><b>R</b></span>-code.
</p>
<p>The source can be found in the &lsquo;<span class="file">doc/examples/dynload</span>&rsquo; subdirectory of the package.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Lancelot, C., Veth, C. and Mathot, S. (1991). Modelling ice-edge
phytoplankton bloom in the Scotia-Weddel sea sector of the Southern
Ocean during spring 1988. Journal of Marine Systems 2, 333&ndash;346.
</p>
<p>Soetaert, K. and Herman, P. (2008). A practical guide to ecological
modelling.  Using R as a simulation platform. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="../../deSolve/help/ccl4model.html">ccl4model</a></code>, the CCl4 inhalation model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## ======================================================
##
## Example 1. PAR an on-off function
##
## ======================================================


## -----------------------------
## the model parameters:
## -----------------------------

parameters &lt;- c(maxPhotoSynt   = 0.125,      # mol C/mol C/hr
                rMortPHY       = 0.001,      # /hr
                alpha          = -0.125/150, # uEinst/m2/s/hr
                pExudation     = 0.0,        # -
                maxProteinSynt = 0.136,      # mol C/mol C/hr
                ksDIN          = 1.0,        # mmol N/m3
                minpLMW        = 0.05,       # mol C/mol C
                maxpLMW        = 0.15,       # mol C/mol C
                minQuotum      = 0.075,      # mol C/mol C
                maxStorage     = 0.23,       # /h
                respirationRate= 0.0001,     # /h
                pResp          = 0.4,        # -
                catabolismRate = 0.06,       # /h
                dilutionRate   = 0.01,       # /h
                rNCProtein     = 0.2,        # mol N/mol C
                inputDIN       = 10.0,       # mmol N/m3
                rChlN          = 1,          # g Chl/mol N
                parMean        = 250.,       # umol Phot/m2/s
                dayLength      = 15.         # hours
                )

## -----------------------------
## The initial conditions
## -----------------------------

state &lt;- c(DIN    = 6.,     # mmol N/m3
          PROTEIN = 20.0,   # mmol C/m3
          RESERVE = 5.0,    # mmol C/m3
          LMW     = 1.0)    # mmol C/m3

## -----------------------------
## Running the model
## -----------------------------

times &lt;- seq(0, 24*20, 1)

out &lt;- as.data.frame(aquaphy(times, state, parameters))

## -----------------------------
## Plotting model output
## -----------------------------

par(mfrow = c(2, 2), oma = c(0, 0, 3, 0))
col &lt;- grey(0.9)
ii &lt;- 1:length(out$PAR)              

plot(times[ii], out$Chlorophyll[ii], type = "l",
      main = "Chlorophyll", xlab = "time, hours",ylab = "ug/l")
polygon(times[ii], out$PAR[ii]-10, col = col, border = NA); box()
lines(times[ii], out$Chlorophyll[ii], lwd = 2 )


plot (times[ii], out$DIN[ii], type = "l", main = "DIN",
      xlab = "time, hours",ylab = "mmolN/m3")
polygon(times[ii], out$PAR[ii]-10, col = col, border = NA); box()
lines(times[ii], out$DIN[ii], lwd = 2 )


plot (times[ii], out$NCratio[ii], type = "n", main = "NCratio",
      xlab = "time, hours", ylab = "molN/molC")
polygon(times[ii], out$PAR[ii]-10, col = col, border = NA); box()
lines(times[ii], out$NCratio[ii], lwd = 2 )


plot (times[ii], out$PhotoSynthesis[ii],type = "l",
       main = "PhotoSynthesis", xlab = "time, hours",
       ylab = "mmolC/m3/hr")
polygon(times[ii], out$PAR[ii]-10, col = col, border = NA); box()
lines(times[ii], out$PhotoSynthesis[ii], lwd = 2 )

mtext(outer = TRUE, side = 3, "AQUAPHY, PAR= on-off", cex = 1.5)

## -----------------------------
## Summary model output
## -----------------------------
t(summary(out))

## ======================================================
##
## Example 2. PAR a forcing function data set
##
## ======================================================

times &lt;- seq(0, 24*20, 1)

## -----------------------------
## create the forcing functions
## -----------------------------

ftime  &lt;- seq(0,500,by=0.5)
parval &lt;- pmax(0,250 + 350*sin(ftime*2*pi/24)+
   (runif(length(ftime))-0.5)*250)
Par    &lt;- matrix(nc=2,c(ftime,parval))


state &lt;- c(DIN     = 6.,     # mmol N/m3
           PROTEIN = 20.0,   # mmol C/m3
           RESERVE = 5.0,    # mmol C/m3
           LMW     = 1.0)    # mmol C/m3
              
out &lt;- aquaphy(times, state, parameters, Par)

plot(out, which = c("PAR", "Chlorophyll", "DIN", "NCratio"), 
     xlab = "time, hours", 
     ylab = c("uEinst/m2/s", "ug/l", "mmolN/m3", "molN/molC"))

mtext(outer = TRUE, side = 3, "AQUAPHY, PAR=forcing", cex = 1.5)

# Now all variables plotted in one figure...
plot(out, which = 1:9, type = "l")

par(mfrow = c(1, 1))

</code></pre>

<hr /><div style="text-align: center;">[Package <em>deSolve</em> version 1.35 <a href="00Index.html">Index</a>]</div>
</div>
</body></html>
