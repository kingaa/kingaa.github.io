<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Find Nearest Event for Each Time Step and Clean Time Steps to...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for cleanEventTimes {deSolve}"><tr><td>cleanEventTimes {deSolve}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Find Nearest Event for Each Time Step and Clean Time Steps to Avoid Doubles
</h2>

<h3>Description</h3>

<p>These functions can be used for checking time steps and events used by 
ode solver functions. They are normally called internally within the solvers. 
</p>


<h3>Usage</h3>

<pre>
nearestEvent(times, eventtimes)
cleanEventTimes(times, eventtimes, eps = .Machine$double.eps * 10)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>times</code></td>
<td>
<p>the vector of output times,</p>
</td></tr>
<tr valign="top"><td><code>eventtimes</code></td>
<td>
<p>a vector with the event times,</p>
</td></tr>
<tr valign="top"><td><code>eps</code></td>
<td>
<p>relative tolerance value below which two numbers are assumed 
to be numerically equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In floating point arithmetics, problems can occur if values have to be
compared for 'equality' but are only close to each other and not exactly
the same.
</p>
<p>The utility functions can be used to add all <code>eventtimes</code> to
the output <code>times</code> vector, but without including times that are
very close to an event.
</p>
<p>This means that all values of <code>eventtimes</code> are contained
but only the subset of <code>times</code> that have no close neighbors in
<code>eventtimes</code>.
</p>
<p>These checks are normally performed internally by the integration solvers.
</p>


<h3>Value</h3>

<p><code>nearestEvent</code> returns a vector with the closest events for
each time step and
</p>
<p><code>cleanEventTimes</code> returns a vector with the output times
without all those that are 'very close' to an event.
</p>


<h3>Author(s)</h3>

<p>Thomas Petzoldt
</p>


<h3>See Also</h3>

<p><code><a href="../../deSolve/help/events.html">events</a></code>
</p>


<h3>Examples</h3>

<pre>

events &lt;- sort(c(0, 2, 3, 4 + 1e-10, 5, 7 - 1e-10,
                 7 + 6e-15, 7.5, 9, 24.9999, 25, 80, 1001, 1e300))
times  &lt;- sort(c(0, 1:7, 4.5, 6.75, 7.5, 9.2, 9.0001, 25, 879, 1e3, 1e300+5))

nearest &lt;- nearestEvent(times, events)
data.frame(times=times, nearest = nearest)

## typical usage: include all events in times after removing values that
## are numerically close together, events have priority 
times
unique_times &lt;- cleanEventTimes(times, events)
newtimes &lt;- sort(c(unique_times, events))
newtimes
</pre>

<hr /><div style="text-align: center;">[Package <em>deSolve</em> version 1.28 <a href="00Index.html">Index</a>]</div>
</body></html>
