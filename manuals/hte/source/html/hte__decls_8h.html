<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hte: src/hte_decls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hte
   </div>
   <div id="projectbrief">Inference of transmission of hospital-acquired infections</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hte__decls_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hte_decls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="hte__decls_8h__dep__incl.png" border="0" usemap="#asrc_2hte__decls_8hdep" alt=""/></div>
<map name="asrc_2hte__decls_8hdep" id="asrc_2hte__decls_8hdep">
<area shape="rect" title=" " alt="" coords="43,5,161,32"/>
<area shape="rect" href="hte__internal_8h.html" title=" " alt="" coords="35,80,169,107"/>
<area shape="rect" href="filter_8c.html" title=" " alt="" coords="5,155,92,181"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="117,155,194,181"/>
</map>
</div>
</div>
<p><a href="hte__decls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a09095ca3c0c44a3085e330ad5386152b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hte__decls_8h.html#a09095ca3c0c44a3085e330ad5386152b">Bernoulli_Filter_Wrapper</a> (SEXP Alpha, SEXP Beta, SEXP P0, SEXP Isol_Factor, SEXP Eta, SEXP Patno, SEXP Result, SEXP Isol, SEXP Rowid, SEXP Loc, SEXP Dim, SEXP Lambda, SEXP Gamma, SEXP Unit, SEXP Time)</td></tr>
<tr class="separator:a09095ca3c0c44a3085e330ad5386152b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9701768cde10c1179393a608b5344366"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hte__decls_8h.html#a9701768cde10c1179393a608b5344366">Bernoulli_Filter</a> (const double *Alpha, const double *Beta, const double *p0, const double *isol_fact, const double *Eta, const int *patno, const int *result, const int *isol, const int *rowid, const int *loc, const int *dim, const double *Lambda, const double *Gamma, const double *Time, int *Patient, int *Occ, double *Prev_i, double *Prev_u, double *Loglik)</td></tr>
<tr class="separator:a9701768cde10c1179393a608b5344366"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93796b877f1dc3723bcee2b5816c39f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hte__decls_8h.html#a93796b877f1dc3723bcee2b5816c39f9">BFilter</a> (const double *Alpha, const double *Beta, const double *p0, const double *isol_fact, const double *Eta, const int *result, const int *isol, const int *loc, const double *time, const int *dim, const double *lambda, const double *gamma, double *logLik)</td></tr>
<tr class="separator:a93796b877f1dc3723bcee2b5816c39f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d01866ac6a793f31f262995b0455882"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hte__decls_8h.html#a4d01866ac6a793f31f262995b0455882">R_init_hte</a> (DllInfo *info)</td></tr>
<tr class="separator:a4d01866ac6a793f31f262995b0455882"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9701768cde10c1179393a608b5344366"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9701768cde10c1179393a608b5344366">&#9670;&nbsp;</a></span>Bernoulli_Filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Bernoulli_Filter </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>isol_fact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>patno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>isol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>rowid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Patient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Prev_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Prev_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Loglik</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the main Bernoulli filter. The data enter through the 'patno', 'result', 'isol', 'rowid', and 'loc' arguments. Each of these are of the same length (the number of events). It is assumed that the data have been sorted into blocks, one block per patient. The input arguments 'Lambda', 'Gamma', 'Time', however, are pointers to matrices, with one row per location (unit) and one column per event. The output arguments ('Occ', 'Prev_i', 'Prev_u', 'LogLik') are similarly matrices of this form. It is assumed that, prior to the call, these have been zeroed. It is assumed that location 0 corresponds to outside the hospital. </p>

<p class="definition">Definition at line <a class="el" href="filter_8c_source.html#l00106">106</a> of file <a class="el" href="filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">int</span> k = 0;            <span class="comment">// pointer to line in the patient-history data</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">int</span> pat = patno[0];   <span class="comment">// patient number</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordtype">double</span> p = *p0;       <span class="comment">// probability of infection</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">double</span> isf = *isol_fact;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">while</span> (k &lt; dim[0]) {          <span class="comment">// loop over events</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (pat != patno[k]) {      <span class="comment">// beginning of a new patient block</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      pat = patno[k];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      p = *p0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> <span class="keyword">event</span> = rowid[k]-1;     <span class="comment">// zero-based column number</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">int</span> locat = loc[k]-1;       <span class="comment">// zero-based row number</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">int</span> isolat = isol[k];       <span class="comment">// is the patient isolated?</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (event &lt; 0 || event &gt;= dim[2])</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="hte__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;%s&#39;: rowid mistake!&quot;</span>,__func__); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (locat &lt; 0 || locat &gt;= dim[1])</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="hte__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;%s&#39;: location mistake!&quot;</span>,__func__); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// indices into Patient, Occ, Prev, Lambda, Gamma, Loglik, Time:</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> i = locat + <span class="keyword">event</span>*dim[1]; <span class="comment">// current unit &amp; event</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">int</span> i1 = i+dim[1];            <span class="comment">// next event, same unit</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// assimilate new test result:</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    p = <a class="code" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a">filtration</a>(result[k],p,*Alpha,*Beta,*Eta, &amp;Loglik[i]);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (Patient[i] != NA_INTEGER)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="hte__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;%s&#39;: cannot overwrite patient ID!&quot;</span>,__func__); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Patient[i] = pat;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    k++;                    <span class="comment">// advance to next line in patient history</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (k &lt; dim[0] &amp;&amp; pat == patno[k]) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">if</span> (locat &gt; 0) {  <span class="comment">// we are in hospital</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// step through events to next event that involves this patient:</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">while</span> (event &lt; rowid[k]-1) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="keywordflow">if</span> (isolat) {         <span class="comment">// isolated patients</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            Prev_i[i] += p;     <span class="comment">// CHECK ME!</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// predict status at next timepoint:</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            p = <a class="code" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a>(Time[i],Time[i1],p,isf*Lambda[i],Gamma[i]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          } <span class="keywordflow">else</span> {              <span class="comment">// unisolated patients</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            Prev_u[i] += p;     <span class="comment">// CHECK ME!</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="comment">// predict status at next timepoint:</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            p = <a class="code" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a>(Time[i],Time[i1],p,Lambda[i],Gamma[i]);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          Occ[i]++;     <span class="comment">// increment occupancy</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <span class="keyword">event</span>++;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          i = i1;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          i1 += dim[1];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      } <span class="keywordflow">else</span> {          <span class="comment">// we are out of hospital</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// prevalence and occupancy are not tracked for location 0</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// predict status at next timepoint:</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keyword">event</span> = rowid[k]-1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        i1 = <span class="keyword">event</span>*dim[1];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        p = <a class="code" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a>(Time[i],Time[i1],p,Lambda[i],Gamma[i]);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// compute prevalence</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; dim[3]; k++) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (Occ[k] &gt; 0) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      Prev_i[k] /= Occ[k];      <span class="comment">// frequency-dependence!</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      Prev_u[k] /= Occ[k];      <span class="comment">// frequency-dependence!</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      Prev_i[k] = Prev_u[k] = R_NaReal;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="afilter_8c_html_a02d22dd760e39a2b5189125c52df2a2a"><div class="ttname"><a href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a">filtration</a></div><div class="ttdeci">static double filtration(int result, double p, double Alpha, double Beta, double Eta, double *ll)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00076">filter.c:77</a></div></div>
<div class="ttc" id="afilter_8c_html_a5bb0d10c9c7df5ac90a01fbcc66f46db"><div class="ttname"><a href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a></div><div class="ttdeci">static double prediction(double t1, double t2, double p, double lambda, double gamma)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00052">filter.c:53</a></div></div>
<div class="ttc" id="ahte__internal_8h_html_ad25a1c617278c25cbcbb9b9a3a6b8024"><div class="ttname"><a href="hte__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a></div><div class="ttdeci">#define err(...)</div><div class="ttdef"><b>Definition:</b> <a href="hte__internal_8h_source.html#l00013">hte_internal.h:13</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hte__decls_8h_a9701768cde10c1179393a608b5344366_cgraph.png" border="0" usemap="#ahte__decls_8h_a9701768cde10c1179393a608b5344366_cgraph" alt=""/></div>
<map name="ahte__decls_8h_a9701768cde10c1179393a608b5344366_cgraph" id="ahte__decls_8h_a9701768cde10c1179393a608b5344366_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,124,57"/>
<area shape="rect" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a" title=" " alt="" coords="176,5,255,32"/>
<area shape="rect" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db" title=" " alt="" coords="172,56,259,83"/>
<area shape="rect" href="filter_8c.html#a928d0067ff420da9ba1cb8a9b6558957" title=" " alt="" coords="307,5,389,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hte__decls_8h_a9701768cde10c1179393a608b5344366_icgraph.png" border="0" usemap="#ahte__decls_8h_a9701768cde10c1179393a608b5344366_icgraph" alt=""/></div>
<map name="ahte__decls_8h_a9701768cde10c1179393a608b5344366_icgraph" id="ahte__decls_8h_a9701768cde10c1179393a608b5344366_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,353,32"/>
<area shape="rect" href="filter_8c.html#a09095ca3c0c44a3085e330ad5386152b" title=" " alt="" coords="5,5,187,32"/>
</map>
</div>

</div>
</div>
<a id="a09095ca3c0c44a3085e330ad5386152b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09095ca3c0c44a3085e330ad5386152b">&#9670;&nbsp;</a></span>Bernoulli_Filter_Wrapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP Bernoulli_Filter_Wrapper </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>P0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Isol_Factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Patno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Isol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Rowid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="filter_8c_source.html#l00004">4</a> of file <a class="el" href="filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;   {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  SEXP Patient, Occ, Prev_i, Prev_u, LogLik;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SEXP ans, nm;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">int</span> ngrid = INTEGER(Dim)[3];</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  PROTECT(Patient = NEW_INTEGER(ngrid));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  PROTECT(Occ = NEW_INTEGER(ngrid));</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PROTECT(Prev_i = NEW_NUMERIC(ngrid));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(Prev_u = NEW_NUMERIC(ngrid));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  PROTECT(LogLik = NEW_NUMERIC(ngrid));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> *pat = INTEGER(Patient);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">int</span> *occ = INTEGER(Occ);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">double</span> *prev_i = REAL(Prev_i);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">double</span> *prev_u = REAL(Prev_u);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">double</span> *logLik = REAL(LogLik);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ngrid; k++) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    pat[k] = R_NaInt;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    occ[k] = 0;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    prev_i[k] = prev_u[k] = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    logLik[k] = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="filter_8c.html#a9701768cde10c1179393a608b5344366">Bernoulli_Filter</a>(REAL(Alpha),REAL(Beta), REAL(P0),REAL(Isol_Factor),</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                   REAL(Eta),INTEGER(Patno),INTEGER(Result),INTEGER(Isol),</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                   INTEGER(Rowid),INTEGER(Loc),INTEGER(Dim),</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                   REAL(Lambda),REAL(Gamma),REAL(Time),INTEGER(Patient),</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                   INTEGER(Occ),REAL(Prev_i),REAL(Prev_u),REAL(LogLik));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  PROTECT(ans = NEW_LIST(9));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(nm = NEW_CHARACTER(9));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  SET_ELEMENT(ans,0,Unit); SET_STRING_ELT(nm,0,mkChar(<span class="stringliteral">&quot;unit&quot;</span>));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  SET_ELEMENT(ans,1,Time); SET_STRING_ELT(nm,1,mkChar(<span class="stringliteral">&quot;time&quot;</span>));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  SET_ELEMENT(ans,2,Prev_i); SET_STRING_ELT(nm,2,mkChar(<span class="stringliteral">&quot;prev_i&quot;</span>));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  SET_ELEMENT(ans,3,Prev_u); SET_STRING_ELT(nm,3,mkChar(<span class="stringliteral">&quot;prev_u&quot;</span>));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  SET_ELEMENT(ans,4,Patient); SET_STRING_ELT(nm,4,mkChar(<span class="stringliteral">&quot;patient&quot;</span>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  SET_ELEMENT(ans,5,Occ); SET_STRING_ELT(nm,5,mkChar(<span class="stringliteral">&quot;occ&quot;</span>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  SET_ELEMENT(ans,6,Lambda); SET_STRING_ELT(nm,6,mkChar(<span class="stringliteral">&quot;lambda&quot;</span>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  SET_ELEMENT(ans,7,Gamma); SET_STRING_ELT(nm,7,mkChar(<span class="stringliteral">&quot;gamma&quot;</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  SET_ELEMENT(ans,8,LogLik); SET_STRING_ELT(nm,8,mkChar(<span class="stringliteral">&quot;logLik&quot;</span>));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  SET_NAMES(ans,nm);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  UNPROTECT(7);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="afilter_8c_html_a9701768cde10c1179393a608b5344366"><div class="ttname"><a href="filter_8c.html#a9701768cde10c1179393a608b5344366">Bernoulli_Filter</a></div><div class="ttdeci">void Bernoulli_Filter(const double *Alpha, const double *Beta, const double *p0, const double *isol_fact, const double *Eta, const int *patno, const int *result, const int *isol, const int *rowid, const int *loc, const int *dim, const double *Lambda, const double *Gamma, const double *Time, int *Patient, int *Occ, double *Prev_i, double *Prev_u, double *Loglik)</div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00106">filter.c:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hte__decls_8h_a09095ca3c0c44a3085e330ad5386152b_cgraph.png" border="0" usemap="#ahte__decls_8h_a09095ca3c0c44a3085e330ad5386152b_cgraph" alt=""/></div>
<map name="ahte__decls_8h_a09095ca3c0c44a3085e330ad5386152b_cgraph" id="ahte__decls_8h_a09095ca3c0c44a3085e330ad5386152b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,187,57"/>
<area shape="rect" href="filter_8c.html#a9701768cde10c1179393a608b5344366" title=" " alt="" coords="235,31,353,57"/>
<area shape="rect" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a" title=" " alt="" coords="405,5,484,32"/>
<area shape="rect" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db" title=" " alt="" coords="401,56,488,83"/>
<area shape="rect" href="filter_8c.html#a928d0067ff420da9ba1cb8a9b6558957" title=" " alt="" coords="536,5,619,32"/>
</map>
</div>

</div>
</div>
<a id="a93796b877f1dc3723bcee2b5816c39f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93796b877f1dc3723bcee2b5816c39f9">&#9670;&nbsp;</a></span>BFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BFilter </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>isol_fact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>isol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>logLik</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="filter_8c_source.html#l00194">194</a> of file <a class="el" href="filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">int</span> k = 0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">double</span> p = *p0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">double</span> isf = *isol_fact;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  *logLik = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  p = <a class="code" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a">filtration</a>(result[0],p,*Alpha,*Beta,*Eta,logLik);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  k++;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">while</span> (k &lt; *dim) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> locat = loc[k-1]-1;     <span class="comment">// zero-based location number</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">int</span> isolat = isol[k-1];     <span class="comment">// isolated?</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (isolat &amp;&amp; locat &gt; 0) { <span class="comment">// isolated patient</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      p = <a class="code" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a>(time[k-1],time[k],p,isf*lambda[locat],gamma[locat]);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    } <span class="keywordflow">else</span> {                    <span class="comment">// unisolated patient</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      p = <a class="code" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db">prediction</a>(time[k-1],time[k],p,lambda[locat],gamma[locat]);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    p = <a class="code" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a">filtration</a>(result[k],p,*Alpha,*Beta,*Eta,logLik);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    k++;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="hte__decls_8h_a93796b877f1dc3723bcee2b5816c39f9_cgraph.png" border="0" usemap="#ahte__decls_8h_a93796b877f1dc3723bcee2b5816c39f9_cgraph" alt=""/></div>
<map name="ahte__decls_8h_a93796b877f1dc3723bcee2b5816c39f9_cgraph" id="ahte__decls_8h_a93796b877f1dc3723bcee2b5816c39f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,68,57"/>
<area shape="rect" href="filter_8c.html#a02d22dd760e39a2b5189125c52df2a2a" title=" " alt="" coords="120,5,199,32"/>
<area shape="rect" href="filter_8c.html#a5bb0d10c9c7df5ac90a01fbcc66f46db" title=" " alt="" coords="116,56,203,83"/>
<area shape="rect" href="filter_8c.html#a928d0067ff420da9ba1cb8a9b6558957" title=" " alt="" coords="251,5,333,32"/>
</map>
</div>

</div>
</div>
<a id="a4d01866ac6a793f31f262995b0455882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d01866ac6a793f31f262995b0455882">&#9670;&nbsp;</a></span>R_init_hte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void R_init_hte </td>
          <td>(</td>
          <td class="paramtype">DllInfo *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00019">19</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                                {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="comment">// Register routines</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  R_registerRoutines(info,<a class="code" href="init_8c.html#a797f993f1e8df1178a348d1e203c775e">cMethods</a>,<a class="code" href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a>,NULL,NULL);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  R_useDynamicSymbols(info,FALSE);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  R_forceSymbols(info,TRUE);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="ttc" id="ainit_8c_html_a797f993f1e8df1178a348d1e203c775e"><div class="ttname"><a href="init_8c.html#a797f993f1e8df1178a348d1e203c775e">cMethods</a></div><div class="ttdeci">static const R_CMethodDef cMethods[]</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00009">init.c:9</a></div></div>
<div class="ttc" id="ainit_8c_html_aa5ecd2cda6339e38a7040278a02baaa5"><div class="ttname"><a href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a></div><div class="ttdeci">static const R_CallMethodDef callMethods[]</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00014">init.c:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="hte__decls_8h.html">hte_decls.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
