<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pomp: src/decls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pomp
   </div>
   <div id="projectbrief">Inference for partially observed Markov processes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('decls_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">decls.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h__dep__incl.png" border="0" usemap="#asrc_2decls_8hdep" alt=""/></div>
<map name="asrc_2decls_8hdep" id="asrc_2decls_8hdep">
<area shape="rect" title=" " alt="" coords="2227,5,2318,31"/>
<area shape="rect" href="internal_8h.html" title=" " alt="" coords="2219,79,2326,104"/>
<area shape="poly" title=" " alt="" coords="2275,44,2275,79,2270,79,2270,44"/>
<area shape="rect" href="bspline_8c.html" title=" " alt="" coords="5,152,108,177"/>
<area shape="poly" title=" " alt="" coords="2206,96,1805,100,1202,110,579,128,318,140,121,155,109,156,108,151,120,149,317,135,579,123,1202,105,1805,95,2206,91"/>
<area shape="rect" href="dinit_8c.html" title=" " alt="" coords="133,152,218,177"/>
<area shape="poly" title=" " alt="" coords="2206,96,1823,99,1251,109,663,126,416,139,230,155,219,156,218,151,230,149,416,134,662,121,1251,103,1823,94,2206,90"/>
<area shape="rect" href="distributions_8c.html" title=" " alt="" coords="243,152,380,177"/>
<area shape="poly" title=" " alt="" coords="2206,95,1919,95,1472,101,939,119,663,134,392,155,380,156,380,150,391,149,662,129,939,114,1472,96,1919,90,2206,89"/>
<area shape="rect" href="dmeasure_8c.html" title=" " alt="" coords="404,152,525,177"/>
<area shape="poly" title=" " alt="" coords="2206,95,1939,95,1528,101,1039,119,786,135,538,155,526,156,525,151,538,149,786,129,1039,114,1528,96,1939,90,2206,89"/>
<area shape="rect" href="dprior_8c.html" title=" " alt="" coords="550,152,643,177"/>
<area shape="poly" title=" " alt="" coords="2206,96,1446,114,990,131,800,142,656,155,644,156,644,151,655,149,799,137,990,126,1446,109,2205,91"/>
<area shape="rect" href="dprocess_8c.html" title=" " alt="" coords="667,152,782,177"/>
<area shape="poly" title=" " alt="" coords="2205,95,1972,97,1624,104,1214,122,1002,136,794,155,782,156,782,151,794,149,1001,131,1214,117,1624,99,1972,91,2205,90"/>
<area shape="rect" href="emeasure_8c.html" title=" " alt="" coords="807,152,928,177"/>
<area shape="poly" title=" " alt="" coords="2206,96,1994,99,1682,108,1315,125,941,155,928,156,928,151,940,149,1315,120,1681,103,1994,94,2206,90"/>
<area shape="rect" href="euler_8c.html" title=" " alt="" coords="953,152,1041,177"/>
<area shape="poly" title=" " alt="" coords="2205,95,2008,97,1723,104,1391,122,1220,136,1053,155,1042,156,1041,151,1052,149,1220,131,1391,117,1723,99,2008,91,2205,90"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="1065,152,1142,177"/>
<area shape="poly" title=" " alt="" coords="2205,95,2023,97,1763,104,1461,122,1306,136,1154,155,1143,157,1142,151,1154,149,1305,131,1461,117,1763,99,2023,91,2205,90"/>
<area shape="rect" href="logmeanexp_8c.html" title=" " alt="" coords="1167,152,1304,177"/>
<area shape="poly" title=" " alt="" coords="2206,98,1828,116,1574,132,1317,155,1304,156,1304,151,1316,149,1574,127,1827,111,2206,92"/>
<area shape="rect" href="lookup__table_8c.html" title=" " alt="" coords="1329,152,1467,177"/>
<area shape="poly" title=" " alt="" coords="2206,99,1892,119,1687,135,1480,155,1468,156,1467,151,1479,149,1687,130,1892,114,2206,94"/>
<area shape="rect" href="mif2_8c.html" title=" " alt="" coords="1492,152,1579,177"/>
<area shape="poly" title=" " alt="" coords="2206,99,1937,117,1765,133,1592,155,1580,157,1579,151,1591,149,1764,128,1936,112,2205,93"/>
<area shape="rect" href="ou2_8c.html" title=" " alt="" coords="1603,152,1683,177"/>
<area shape="poly" title=" " alt="" coords="2205,100,1979,119,1837,135,1696,155,1684,157,1683,151,1695,149,1837,130,1978,114,2205,94"/>
<area shape="rect" href="partrans_8c.html" title=" " alt="" coords="1708,152,1819,177"/>
<area shape="poly" title=" " alt="" coords="2206,104,1832,155,1819,157,1819,151,1831,149,2206,98"/>
<area shape="rect" href="pfilter_8c.html" title=" " alt="" coords="1843,152,1937,177"/>
<area shape="poly" title=" " alt="" coords="2206,107,1949,155,1937,157,1936,152,1948,149,2205,102"/>
<area shape="rect" href="pomp__fun_8c.html" title=" " alt="" coords="1961,152,2083,177"/>
<area shape="poly" title=" " alt="" coords="2220,110,2063,154,2062,149,2218,105"/>
<area shape="rect" href="pomp__mat_8h.html" title=" " alt="" coords="2159,152,2285,177"/>
<area shape="poly" title=" " alt="" coords="2258,117,2232,153,2228,150,2254,114"/>
<area shape="rect" href="probe__marginal_8c.html" title=" " alt="" coords="2013,225,2172,251"/>
<area shape="poly" title=" " alt="" coords="2223,111,2184,129,2148,154,2132,171,2118,191,2100,226,2095,224,2114,188,2127,168,2144,150,2182,124,2221,106"/>
<area shape="rect" href="probe__nlar_8c.html" title=" " alt="" coords="2196,225,2320,251"/>
<area shape="poly" title=" " alt="" coords="2290,115,2301,145,2303,162,2301,178,2287,205,2271,227,2267,223,2283,203,2295,177,2298,161,2296,146,2285,117"/>
<area shape="rect" href="synth__lik_8c.html" title=" " alt="" coords="2345,225,2459,251"/>
<area shape="poly" title=" " alt="" coords="2294,113,2394,223,2390,227,2290,116"/>
<area shape="rect" href="probe_8c.html" title=" " alt="" coords="2411,152,2505,177"/>
<area shape="poly" title=" " alt="" coords="2316,106,2429,149,2427,154,2314,111"/>
<area shape="rect" href="probe__acf_8c.html" title=" " alt="" coords="2529,152,2648,177"/>
<area shape="poly" title=" " alt="" coords="2337,104,2538,149,2537,154,2336,110"/>
<area shape="rect" href="resample_8c.html" title=" " alt="" coords="2671,152,2789,177"/>
<area shape="poly" title=" " alt="" coords="2340,100,2661,149,2671,151,2671,156,2660,155,2339,105"/>
<area shape="rect" href="rinit_8c.html" title=" " alt="" coords="2813,152,2895,177"/>
<area shape="poly" title=" " alt="" coords="2340,95,2546,116,2801,149,2813,151,2812,157,2800,155,2546,121,2339,101"/>
<area shape="rect" href="rmeasure_8c.html" title=" " alt="" coords="2920,152,3039,177"/>
<area shape="poly" title=" " alt="" coords="2340,95,2590,116,2908,149,2920,151,2919,156,2907,155,2589,121,2340,100"/>
<area shape="rect" href="rprior_8c.html" title=" " alt="" coords="3063,152,3154,177"/>
<area shape="poly" title=" " alt="" coords="2340,92,2648,110,2849,126,3052,149,3063,151,3063,156,3051,155,2849,131,2648,115,2340,98"/>
<area shape="rect" href="rprocess_8c.html" title=" " alt="" coords="3179,152,3289,177"/>
<area shape="poly" title=" " alt="" coords="2340,92,2694,109,2928,126,3166,149,3179,151,3178,156,3166,155,2928,131,2693,115,2340,98"/>
<area shape="rect" href="simulate_8c.html" title=" " alt="" coords="3313,152,3427,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,2748,107,3023,124,3302,149,3314,151,3313,156,3302,155,3022,129,2747,112,2340,97"/>
<area shape="rect" href="skeleton_8c.html" title=" " alt="" coords="3451,152,3561,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,2529,94,2801,104,3117,121,3440,149,3451,151,3450,156,3439,155,3117,127,2801,109,2529,100,2340,96"/>
<area shape="rect" href="sobolseq_8c.html" title=" " alt="" coords="3586,152,3701,177"/>
<area shape="poly" title=" " alt="" coords="2340,90,2548,93,2853,102,3210,120,3574,149,3586,151,3586,156,3574,155,3210,125,2853,107,2548,99,2340,96"/>
<area shape="rect" href="ssa_8c.html" title=" " alt="" coords="3725,152,3804,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,3017,109,3419,126,3586,137,3713,149,3725,151,3725,157,3712,155,3586,142,3418,132,3017,114,2340,97"/>
<area shape="rect" href="trajectory_8c.html" title=" " alt="" coords="3829,152,3946,177"/>
<area shape="poly" title=" " alt="" coords="2340,90,2581,91,2945,98,3376,116,3599,131,3817,149,3829,151,3828,156,3816,155,3598,136,3376,122,2945,104,2581,96,2340,95"/>
<area shape="rect" href="transformations_8c.html" title=" " alt="" coords="3970,152,4130,177"/>
<area shape="poly" title=" " alt="" coords="2340,90,2600,93,2999,102,3472,119,3718,133,3958,149,3970,150,3970,156,3958,155,3717,138,3472,125,2999,107,2600,98,2340,96"/>
<area shape="rect" href="userdata_8c.html" title=" " alt="" coords="4155,152,4268,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,3215,109,3749,126,3973,137,4142,149,4155,151,4154,156,4142,155,3973,142,3749,131,3215,114,2340,96"/>
<area shape="rect" href="vmeasure_8c.html" title=" " alt="" coords="4292,152,4413,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,3278,108,3856,125,4098,137,4281,149,4292,151,4292,156,4280,155,4098,142,3856,131,3278,113,2340,96"/>
<area shape="rect" href="wpfilter_8c.html" title=" " alt="" coords="4438,152,4542,177"/>
<area shape="poly" title=" " alt="" coords="2340,91,2740,95,3344,105,3968,123,4229,135,4426,149,4438,151,4437,156,4426,155,4229,140,3968,128,3344,110,2740,100,2340,96"/>
<area shape="poly" title=" " alt="" coords="2190,186,2115,227,2113,223,2188,182"/>
<area shape="poly" title=" " alt="" coords="2236,188,2255,224,2250,226,2232,191"/>
<area shape="poly" title=" " alt="" coords="2264,180,2374,223,2372,228,2262,185"/>
</map>
</div>
</div>
<p><a href="decls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41860ab8f0d4fb23e3ce010e6ad2ff2f" id="r_a41860ab8f0d4fb23e3ce010e6ad2ff2f"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41860ab8f0d4fb23e3ce010e6ad2ff2f">bspline_basis</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a41860ab8f0d4fb23e3ce010e6ad2ff2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91f1740c904de28f294b3e9dc2bc812" id="r_ac91f1740c904de28f294b3e9dc2bc812"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac91f1740c904de28f294b3e9dc2bc812">periodic_bspline_basis</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac91f1740c904de28f294b3e9dc2bc812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24fa1bb0f03a3d3443051e82d0246b8" id="r_ab24fa1bb0f03a3d3443051e82d0246b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab24fa1bb0f03a3d3443051e82d0246b8">bspline_basis_eval_deriv</a> (double, double *, int, int, int, double *)</td></tr>
<tr class="separator:ab24fa1bb0f03a3d3443051e82d0246b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e746ce7f69a999ad8ff316f10fd1d2" id="r_af3e746ce7f69a999ad8ff316f10fd1d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3e746ce7f69a999ad8ff316f10fd1d2">periodic_bspline_basis_eval_deriv</a> (double, double, int, int, int, double *)</td></tr>
<tr class="separator:af3e746ce7f69a999ad8ff316f10fd1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b4fa54c658fe6c6677c51e8346d728c" id="r_a6b4fa54c658fe6c6677c51e8346d728c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b4fa54c658fe6c6677c51e8346d728c">do_dinit</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6b4fa54c658fe6c6677c51e8346d728c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6133e3ef45a5d9fe3deab72750062df9" id="r_a6133e3ef45a5d9fe3deab72750062df9"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6133e3ef45a5d9fe3deab72750062df9">R_Euler_Multinom</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6133e3ef45a5d9fe3deab72750062df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7cf2dcaaa5333231ed19998fd9dfde6" id="r_aa7cf2dcaaa5333231ed19998fd9dfde6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7cf2dcaaa5333231ed19998fd9dfde6">D_Euler_Multinom</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa7cf2dcaaa5333231ed19998fd9dfde6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666ff456fb565a43aac025137ae5b0f0" id="r_a666ff456fb565a43aac025137ae5b0f0"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a666ff456fb565a43aac025137ae5b0f0">E_Euler_Multinom</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a666ff456fb565a43aac025137ae5b0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f8691fcce63ae69c6eb740a5e39f41" id="r_a05f8691fcce63ae69c6eb740a5e39f41"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05f8691fcce63ae69c6eb740a5e39f41">R_GammaWN</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a05f8691fcce63ae69c6eb740a5e39f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d15947a5f8c829a5672f83b2246d7b8" id="r_a3d15947a5f8c829a5672f83b2246d7b8"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d15947a5f8c829a5672f83b2246d7b8">R_BetaBinom</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a3d15947a5f8c829a5672f83b2246d7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb19c7180d18dc9f384cea477ee1a83" id="r_a7eb19c7180d18dc9f384cea477ee1a83"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7eb19c7180d18dc9f384cea477ee1a83">D_BetaBinom</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a7eb19c7180d18dc9f384cea477ee1a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983ad52a265f059c6e25be89cdf97fd7" id="r_a983ad52a265f059c6e25be89cdf97fd7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a983ad52a265f059c6e25be89cdf97fd7">do_dmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a983ad52a265f059c6e25be89cdf97fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d3d47b7ef5f3a691582c1000108cdb7" id="r_a2d3d47b7ef5f3a691582c1000108cdb7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d3d47b7ef5f3a691582c1000108cdb7">do_dprior</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a2d3d47b7ef5f3a691582c1000108cdb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef1a476d6745db7455441c65c74fd61" id="r_a6ef1a476d6745db7455441c65c74fd61"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ef1a476d6745db7455441c65c74fd61">do_dprocess</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6ef1a476d6745db7455441c65c74fd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1ec1439680776719b9b8b9ebdbf9a33" id="r_ac1ec1439680776719b9b8b9ebdbf9a33"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1ec1439680776719b9b8b9ebdbf9a33">do_emeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac1ec1439680776719b9b8b9ebdbf9a33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19293a3a394b4e0885714f833bc2a96b" id="r_a19293a3a394b4e0885714f833bc2a96b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a> (SEXP, SEXP, SEXP, SEXP, SEXP, double, <a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a>, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a19293a3a394b4e0885714f833bc2a96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80981cb1dec869d1c736129470da780f" id="r_a80981cb1dec869d1c736129470da780f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80981cb1dec869d1c736129470da780f">num_euler_steps</a> (double, double, double *)</td></tr>
<tr class="separator:a80981cb1dec869d1c736129470da780f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e40667f6198be18fb99f8f07417da1d" id="r_a4e40667f6198be18fb99f8f07417da1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a> (double, double, double)</td></tr>
<tr class="separator:a4e40667f6198be18fb99f8f07417da1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc4318ebe71bfe439dc5c6816aec9e9" id="r_a3dc4318ebe71bfe439dc5c6816aec9e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3dc4318ebe71bfe439dc5c6816aec9e9">_gompertz_normal_dmeasure</a> (double *, double *, double *, double *, int, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a3dc4318ebe71bfe439dc5c6816aec9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7b791e4e3d33b6ac0b5dd04425c9be" id="r_a1a7b791e4e3d33b6ac0b5dd04425c9be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a7b791e4e3d33b6ac0b5dd04425c9be">_gompertz_normal_rmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a1a7b791e4e3d33b6ac0b5dd04425c9be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad181675b4773a3f401bedc49de88b54c" id="r_ad181675b4773a3f401bedc49de88b54c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad181675b4773a3f401bedc49de88b54c">_gompertz_normal_emeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ad181675b4773a3f401bedc49de88b54c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6fd08b625a00245a898d5375b90a725" id="r_ac6fd08b625a00245a898d5375b90a725"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6fd08b625a00245a898d5375b90a725">_gompertz_normal_vmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ac6fd08b625a00245a898d5375b90a725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf2fd72947e8ff6f76c2a8d70e649d3" id="r_a2cf2fd72947e8ff6f76c2a8d70e649d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cf2fd72947e8ff6f76c2a8d70e649d3">_gompertz_step</a> (double *, const double *, const int *, const int *, const int *, const double *, double, double)</td></tr>
<tr class="separator:a2cf2fd72947e8ff6f76c2a8d70e649d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0665a1991b34b2d1c9c85db01ed034b" id="r_ad0665a1991b34b2d1c9c85db01ed034b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad0665a1991b34b2d1c9c85db01ed034b">_gompertz_skeleton</a> (double *, double *, const double *, const int *, const int *, const int *, const double *, double)</td></tr>
<tr class="separator:ad0665a1991b34b2d1c9c85db01ed034b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825a990c0794920e7661efabe955a9e1" id="r_a825a990c0794920e7661efabe955a9e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a825a990c0794920e7661efabe955a9e1">_gompertz_to_trans</a> (double *, const double *, const int *)</td></tr>
<tr class="separator:a825a990c0794920e7661efabe955a9e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab01a70b6ea0338ce91c04f773b54a2" id="r_adab01a70b6ea0338ce91c04f773b54a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adab01a70b6ea0338ce91c04f773b54a2">_gompertz_from_trans</a> (double *, const double *, const int *)</td></tr>
<tr class="separator:adab01a70b6ea0338ce91c04f773b54a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a632ad1476e98dfe96ef9ee0e7f939b45" id="r_a632ad1476e98dfe96ef9ee0e7f939b45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a632ad1476e98dfe96ef9ee0e7f939b45">R_init_pomp</a> (DllInfo *)</td></tr>
<tr class="separator:a632ad1476e98dfe96ef9ee0e7f939b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0537073d1cb88f92ea923a0c28d2ac9d" id="r_a0537073d1cb88f92ea923a0c28d2ac9d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0537073d1cb88f92ea923a0c28d2ac9d">logmeanexp</a> (const SEXP, const SEXP)</td></tr>
<tr class="separator:a0537073d1cb88f92ea923a0c28d2ac9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6345040eb63a38c0ff7ae42f3ea35ff" id="r_ae6345040eb63a38c0ff7ae42f3ea35ff"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a> (SEXP)</td></tr>
<tr class="separator:ae6345040eb63a38c0ff7ae42f3ea35ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fc25ac8149dbd6da367aa01dd9ad9ed" id="r_a8fc25ac8149dbd6da367aa01dd9ad9ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlookup__table__t.html">lookup_table_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a> (SEXP, int *)</td></tr>
<tr class="separator:a8fc25ac8149dbd6da367aa01dd9ad9ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbec5a723223278096829f0532d5dc3a" id="r_afbec5a723223278096829f0532d5dc3a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a> (SEXP, SEXP)</td></tr>
<tr class="separator:afbec5a723223278096829f0532d5dc3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6439566617e54cb9f4507f7ad2824f" id="r_ade6439566617e54cb9f4507f7ad2824f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a> (<a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, double, double *)</td></tr>
<tr class="separator:ade6439566617e54cb9f4507f7ad2824f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09bcd3caa641c11a9e456e7a4fdafffa" id="r_a09bcd3caa641c11a9e456e7a4fdafffa"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a09bcd3caa641c11a9e456e7a4fdafffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb8fb617fb1a4584e553f08810105f9" id="r_a8eb8fb617fb1a4584e553f08810105f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8eb8fb617fb1a4584e553f08810105f9">_ou2_step</a> (double *, const double *, const int *, const int *, const int *, const double *, double, double)</td></tr>
<tr class="separator:a8eb8fb617fb1a4584e553f08810105f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499e2ed0106272324438f9c988015671" id="r_a499e2ed0106272324438f9c988015671"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a499e2ed0106272324438f9c988015671">_ou2_pdf</a> (double *, double *, double *, double, double, const double *, const int *, const int *, const int *, const double *)</td></tr>
<tr class="separator:a499e2ed0106272324438f9c988015671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaef81a8193fa69cf2c0589f8ac56187" id="r_acaef81a8193fa69cf2c0589f8ac56187"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acaef81a8193fa69cf2c0589f8ac56187">_ou2_skel</a> (double *, double *, double *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:acaef81a8193fa69cf2c0589f8ac56187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af750b0a42d4a28fc0fd251947a27d385" id="r_af750b0a42d4a28fc0fd251947a27d385"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af750b0a42d4a28fc0fd251947a27d385">_ou2_dmeasure</a> (double *, double *, double *, double *, int, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:af750b0a42d4a28fc0fd251947a27d385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b56b325d719e42ac66e1367b4f72f8e" id="r_a9b56b325d719e42ac66e1367b4f72f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b56b325d719e42ac66e1367b4f72f8e">_ou2_rmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a9b56b325d719e42ac66e1367b4f72f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e80084cfe8b5c5c76de464571a95c4" id="r_ad5e80084cfe8b5c5c76de464571a95c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5e80084cfe8b5c5c76de464571a95c4">_ou2_emeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ad5e80084cfe8b5c5c76de464571a95c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8e43ec5af20eb48754c1014606057a" id="r_adc8e43ec5af20eb48754c1014606057a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc8e43ec5af20eb48754c1014606057a">_ou2_vmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:adc8e43ec5af20eb48754c1014606057a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ee70ea223bd1cd7359810d1e0c8a49" id="r_ab6ee70ea223bd1cd7359810d1e0c8a49"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6ee70ea223bd1cd7359810d1e0c8a49">do_partrans</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab6ee70ea223bd1cd7359810d1e0c8a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9eda32aa6838894c1096d31d5672ad" id="r_abb9eda32aa6838894c1096d31d5672ad"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb9eda32aa6838894c1096d31d5672ad">pfilter</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:abb9eda32aa6838894c1096d31d5672ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada19523cc1edc44a799fce734f25c934" id="r_ada19523cc1edc44a799fce734f25c934"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a> (SEXP, SEXP, <a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ada19523cc1edc44a799fce734f25c934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90946f2aeaeb4f5826c8de7facb25999" id="r_a90946f2aeaeb4f5826c8de7facb25999"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a> (SEXP)</td></tr>
<tr class="separator:a90946f2aeaeb4f5826c8de7facb25999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17019a937f12763c2df28735e19b88c3" id="r_a17019a937f12763c2df28735e19b88c3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a> (SEXP)</td></tr>
<tr class="separator:a17019a937f12763c2df28735e19b88c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f31f12db7a1e75775f01eb11ead99d" id="r_a91f31f12db7a1e75775f01eb11ead99d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a91f31f12db7a1e75775f01eb11ead99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c714747e1b49d142af4d58fee24446" id="r_a34c714747e1b49d142af4d58fee24446"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a34c714747e1b49d142af4d58fee24446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87d831ce816f581c1145704489ae791" id="r_ab87d831ce816f581c1145704489ae791"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab87d831ce816f581c1145704489ae791">probe_acf</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab87d831ce816f581c1145704489ae791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00b01cfe308e46e0f8a0e830f363a9a" id="r_aa00b01cfe308e46e0f8a0e830f363a9a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa00b01cfe308e46e0f8a0e830f363a9a">probe_ccf</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa00b01cfe308e46e0f8a0e830f363a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d070d973eba13345ec32d0dd772520f" id="r_a9d070d973eba13345ec32d0dd772520f"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d070d973eba13345ec32d0dd772520f">probe_marginal_setup</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a9d070d973eba13345ec32d0dd772520f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac769062b9d41abb5d572eeaf6cf05b" id="r_afac769062b9d41abb5d572eeaf6cf05b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afac769062b9d41abb5d572eeaf6cf05b">probe_marginal_solve</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:afac769062b9d41abb5d572eeaf6cf05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7d9cf2e04e141bce1bdfa71f9c576b" id="r_aac7d9cf2e04e141bce1bdfa71f9c576b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac7d9cf2e04e141bce1bdfa71f9c576b">probe_nlar</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aac7d9cf2e04e141bce1bdfa71f9c576b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4822de0304baafeca236b97ecb216b" id="r_a9f4822de0304baafeca236b97ecb216b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a9f4822de0304baafeca236b97ecb216b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8f78d126b50ffa8da9b867053278df" id="r_a2f8f78d126b50ffa8da9b867053278df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a> (int, double *, int, int *, int)</td></tr>
<tr class="separator:a2f8f78d126b50ffa8da9b867053278df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3de8f433818929ff221b26769ed9e6c" id="r_ab3de8f433818929ff221b26769ed9e6c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab3de8f433818929ff221b26769ed9e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fdad74a815d2783d4f6f7053a6cb3ca" id="r_a0fdad74a815d2783d4f6f7053a6cb3ca"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a0fdad74a815d2783d4f6f7053a6cb3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82bdfc4b0763ddd79d74e02f60e790a" id="r_ab82bdfc4b0763ddd79d74e02f60e790a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab82bdfc4b0763ddd79d74e02f60e790a">do_rprior</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab82bdfc4b0763ddd79d74e02f60e790a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af129ae090fa637ebcec13e50e6c0d7be" id="r_af129ae090fa637ebcec13e50e6c0d7be"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:af129ae090fa637ebcec13e50e6c0d7be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9d3b94c1a9a99e0db90e251f670e853" id="r_aa9d3b94c1a9a99e0db90e251f670e853"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa9d3b94c1a9a99e0db90e251f670e853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9390ea094fe7c28762eb6ac23f1c144" id="r_ad9390ea094fe7c28762eb6ac23f1c144"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ad9390ea094fe7c28762eb6ac23f1c144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d94e3819f568bb29c6d5e77f02a3d8" id="r_a02d94e3819f568bb29c6d5e77f02a3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a> (double *, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, double *)</td></tr>
<tr class="separator:a02d94e3819f568bb29c6d5e77f02a3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdcf759e7db4fcc8f07d2692c18183b" id="r_adcdcf759e7db4fcc8f07d2692c18183b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a> (double *, double, double, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, int *, double *)</td></tr>
<tr class="separator:adcdcf759e7db4fcc8f07d2692c18183b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87734543f5fc40ed123f9f1664e3b7a7" id="r_a87734543f5fc40ed123f9f1664e3b7a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a> (double *, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *, SEXP, double *)</td></tr>
<tr class="separator:a87734543f5fc40ed123f9f1664e3b7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06448ff2e2ef1613edd4618634dbed6" id="r_ae06448ff2e2ef1613edd4618634dbed6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a> (double *, double, double, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, int *, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *, SEXP, double *)</td></tr>
<tr class="separator:ae06448ff2e2ef1613edd4618634dbed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1187e52d896c25c1cdb5dd593dbc291" id="r_af1187e52d896c25c1cdb5dd593dbc291"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1187e52d896c25c1cdb5dd593dbc291">do_skeleton</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:af1187e52d896c25c1cdb5dd593dbc291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91cd56241914126e7f0a89c67bfac2f3" id="r_a91cd56241914126e7f0a89c67bfac2f3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91cd56241914126e7f0a89c67bfac2f3">sobol_sequence</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a91cd56241914126e7f0a89c67bfac2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac796abcef7f5d6add4d98023a0bde62b" id="r_ac796abcef7f5d6add4d98023a0bde62b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac796abcef7f5d6add4d98023a0bde62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab735e5526875ee755d72af6c8750bc05" id="r_ab735e5526875ee755d72af6c8750bc05"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab735e5526875ee755d72af6c8750bc05">synth_loglik</a> (SEXP, SEXP)</td></tr>
<tr class="separator:ab735e5526875ee755d72af6c8750bc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bcec7f4a5a240606fb8235312d5cc45" id="r_a1bcec7f4a5a240606fb8235312d5cc45"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bcec7f4a5a240606fb8235312d5cc45">iterate_map</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a1bcec7f4a5a240606fb8235312d5cc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9632871950917c7b954b1784b74ec78" id="r_aa9632871950917c7b954b1784b74ec78"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9632871950917c7b954b1784b74ec78">pomp_desolve_setup</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa9632871950917c7b954b1784b74ec78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9d4b991e534272c7dc4a6602be32ec" id="r_a5c9d4b991e534272c7dc4a6602be32ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c9d4b991e534272c7dc4a6602be32ec">pomp_vf_eval</a> (int *, double *, double *, double *, double *, int *)</td></tr>
<tr class="separator:a5c9d4b991e534272c7dc4a6602be32ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1f879a376bbbef32d6d8fde12078ed" id="r_abc1f879a376bbbef32d6d8fde12078ed"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc1f879a376bbbef32d6d8fde12078ed">pomp_desolve_takedown</a> (void)</td></tr>
<tr class="separator:abc1f879a376bbbef32d6d8fde12078ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a3814da0f600c71a99fd3fe5ba215ca" id="r_a5a3814da0f600c71a99fd3fe5ba215ca"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a3814da0f600c71a99fd3fe5ba215ca">LogitTransform</a> (SEXP)</td></tr>
<tr class="separator:a5a3814da0f600c71a99fd3fe5ba215ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc031bd56388c0dbb1b6e4aacb3971c" id="r_a6cc031bd56388c0dbb1b6e4aacb3971c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cc031bd56388c0dbb1b6e4aacb3971c">ExpitTransform</a> (SEXP)</td></tr>
<tr class="separator:a6cc031bd56388c0dbb1b6e4aacb3971c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adc7fa1db20bdddfae3611911961f6c" id="r_a9adc7fa1db20bdddfae3611911961f6c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9adc7fa1db20bdddfae3611911961f6c">LogBarycentricTransform</a> (SEXP)</td></tr>
<tr class="separator:a9adc7fa1db20bdddfae3611911961f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a534d4c8bcea55d9f5a6e7d8b34e55408" id="r_a534d4c8bcea55d9f5a6e7d8b34e55408"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a534d4c8bcea55d9f5a6e7d8b34e55408">InverseLogBarycentricTransform</a> (SEXP)</td></tr>
<tr class="separator:a534d4c8bcea55d9f5a6e7d8b34e55408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e269d1663ac1f67722366434b79ef6" id="r_ac8e269d1663ac1f67722366434b79ef6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8e269d1663ac1f67722366434b79ef6">set_pomp_userdata</a> (SEXP)</td></tr>
<tr class="separator:ac8e269d1663ac1f67722366434b79ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f11ca97854cd188080da40020f738eb" id="r_a0f11ca97854cd188080da40020f738eb"><td class="memItemLeft" align="right" valign="top">const SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f11ca97854cd188080da40020f738eb">get_userdata</a> (const char *)</td></tr>
<tr class="separator:a0f11ca97854cd188080da40020f738eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2923b639b10bf3be378a454be2ba23" id="r_a3f2923b639b10bf3be378a454be2ba23"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f2923b639b10bf3be378a454be2ba23">get_userdata_int</a> (const char *)</td></tr>
<tr class="separator:a3f2923b639b10bf3be378a454be2ba23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34196cff245ce7384eb8b2c3fa4a6552" id="r_a34196cff245ce7384eb8b2c3fa4a6552"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34196cff245ce7384eb8b2c3fa4a6552">get_userdata_double</a> (const char *)</td></tr>
<tr class="separator:a34196cff245ce7384eb8b2c3fa4a6552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55c56601a4d47af6f8d162ff1aa9503" id="r_aa55c56601a4d47af6f8d162ff1aa9503"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa55c56601a4d47af6f8d162ff1aa9503">do_vmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa55c56601a4d47af6f8d162ff1aa9503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c47fabab25be7910ba58cc20426bf35" id="r_a1c47fabab25be7910ba58cc20426bf35"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c47fabab25be7910ba58cc20426bf35">wpfilter</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a1c47fabab25be7910ba58cc20426bf35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="adab01a70b6ea0338ce91c04f773b54a2" name="adab01a70b6ea0338ce91c04f773b54a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab01a70b6ea0338ce91c04f773b54a2">&#9670;&#160;</a></span>_gompertz_from_trans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_from_trans </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>__p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>__pt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>__parindex</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00113">113</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>   {</div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_define" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a> = exp(<a class="code hl_define" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a>);</div>
<div class="line"><span class="lineno">  118</span>  <a class="code hl_define" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a> = exp(<a class="code hl_define" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a>);</div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = exp(<a class="code hl_define" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a>);</div>
<div class="line"><span class="lineno">  120</span>  <a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = exp(<a class="code hl_define" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a>);</div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_define" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a> = exp(<a class="code hl_define" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a>);</div>
<div class="line"><span class="lineno">  122</span>}</div>
<div class="ttc" id="agompertz_8c_html_a216f42bf177ca87e5f7724df32173717"><div class="ttname"><a href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a></div><div class="ttdeci">#define X_0</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00095">gompertz.c:95</a></div></div>
<div class="ttc" id="agompertz_8c_html_a62969232668331297e2dca1ae2ddd10d"><div class="ttname"><a href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a></div><div class="ttdeci">#define r</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00091">gompertz.c:91</a></div></div>
<div class="ttc" id="agompertz_8c_html_a678ef311e74501d7b800f0b47500374a"><div class="ttname"><a href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a></div><div class="ttdeci">#define sigma</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00093">gompertz.c:93</a></div></div>
<div class="ttc" id="agompertz_8c_html_a757a8fce372da1cf6bf283ad0d551b5d"><div class="ttname"><a href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a></div><div class="ttdeci">#define T_sigma</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00098">gompertz.c:98</a></div></div>
<div class="ttc" id="agompertz_8c_html_a7d82cf2074afa4cfb2f3ccef3147b5f1"><div class="ttname"><a href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a></div><div class="ttdeci">#define T_tau</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00099">gompertz.c:99</a></div></div>
<div class="ttc" id="agompertz_8c_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00009">gompertz.c:9</a></div></div>
<div class="ttc" id="agompertz_8c_html_aa7082577997805000f8e8b56846642cd"><div class="ttname"><a href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a></div><div class="ttdeci">#define tau</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00094">gompertz.c:94</a></div></div>
<div class="ttc" id="agompertz_8c_html_ab4d3d6d4c67ada71eec73c01852981f0"><div class="ttname"><a href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a></div><div class="ttdeci">#define T_K</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00097">gompertz.c:97</a></div></div>
<div class="ttc" id="agompertz_8c_html_ad5a2597d3f99cc31bb9bf4e0471f3a37"><div class="ttname"><a href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a></div><div class="ttdeci">#define T_r</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00096">gompertz.c:96</a></div></div>
<div class="ttc" id="agompertz_8c_html_ae51e7437f94eebfb3a19f094cdc7fe0d"><div class="ttname"><a href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a></div><div class="ttdeci">#define T_X_0</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00100">gompertz.c:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dc4318ebe71bfe439dc5c6816aec9e9" name="a3dc4318ebe71bfe439dc5c6816aec9e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc4318ebe71bfe439dc5c6816aec9e9">&#9670;&#160;</a></span>_gompertz_normal_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>lik</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>give_log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00020">20</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>   {</div>
<div class="line"><span class="lineno">   26</span>  *lik = dlnorm(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,log(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>,give_log);</div>
<div class="line"><span class="lineno">   27</span>}</div>
<div class="ttc" id="agompertz_8c_html_a207fd5507206d307cd63f95374fcd00d"><div class="ttname"><a href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a></div><div class="ttdeci">#define X</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00014">gompertz.c:14</a></div></div>
<div class="ttc" id="agompertz_8c_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00011">gompertz.c:11</a></div></div>
<div class="ttc" id="agompertz_8c_html_a798e4073d613ca5ba9618e1b3253df14"><div class="ttname"><a href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a></div><div class="ttdeci">#define Y</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00013">gompertz.c:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad181675b4773a3f401bedc49de88b54c" name="ad181675b4773a3f401bedc49de88b54c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad181675b4773a3f401bedc49de88b54c">&#9670;&#160;</a></span>_gompertz_normal_emeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00040">40</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>   {</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_define" href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> = <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*exp(<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>/2);</div>
<div class="line"><span class="lineno">   47</span>}</div>
<div class="ttc" id="agompertz_8c_html_a423a96c51fa2ea8a6406113803acbbc1"><div class="ttname"><a href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a></div><div class="ttdeci">#define EY</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00016">gompertz.c:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a7b791e4e3d33b6ac0b5dd04425c9be" name="a1a7b791e4e3d33b6ac0b5dd04425c9be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a7b791e4e3d33b6ac0b5dd04425c9be">&#9670;&#160;</a></span>_gompertz_normal_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00030">30</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>   {</div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = rlnorm(log(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><span class="lineno">   37</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6fd08b625a00245a898d5375b90a725" name="ac6fd08b625a00245a898d5375b90a725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6fd08b625a00245a898d5375b90a725">&#9670;&#160;</a></span>_gompertz_normal_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>vmatindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00050">50</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                          {</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordtype">double</span> et = exp(<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_define" href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a> = <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*et*(et-1);</div>
<div class="line"><span class="lineno">   55</span>}</div>
<div class="ttc" id="agompertz_8c_html_a99670a9dfb3b867756c0a48bfad3c4da"><div class="ttname"><a href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a></div><div class="ttdeci">#define VY</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00017">gompertz.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0665a1991b34b2d1c9c85db01ed034b" name="ad0665a1991b34b2d1c9c85db01ed034b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0665a1991b34b2d1c9c85db01ed034b">&#9670;&#160;</a></span>_gompertz_skeleton()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_skeleton </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00070">70</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>   {</div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordtype">double</span> S = exp(-<a class="code hl_define" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_define" href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a> = R_pow(<a class="code hl_define" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S); <span class="comment">// X is not over-written in the skeleton function</span></div>
<div class="line"><span class="lineno">   79</span>}</div>
<div class="ttc" id="agompertz_8c_html_a3e727802b38f4a8209fdde8333e080bb"><div class="ttname"><a href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a></div><div class="ttdeci">#define XPRIME</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00015">gompertz.c:15</a></div></div>
<div class="ttc" id="agompertz_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00008">gompertz.c:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cf2fd72947e8ff6f76c2a8d70e649d3" name="a2cf2fd72947e8ff6f76c2a8d70e649d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf2fd72947e8ff6f76c2a8d70e649d3">&#9670;&#160;</a></span>_gompertz_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_step </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00058">58</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>   {</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordtype">double</span> S = exp(-<a class="code hl_define" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordtype">double</span> eps = (<a class="code hl_define" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a> &gt; 0.0) ? exp(rnorm(0,<a class="code hl_define" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a>)) : 1.0;</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = R_pow(<a class="code hl_define" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S)*eps; <span class="comment">// note X is over-written by this line</span></div>
<div class="line"><span class="lineno">   67</span>}</div>
<div class="ttc" id="agompertz_8c_html_ab899f53048f1f06a224b5eb1fa369750"><div class="ttname"><a href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a></div><div class="ttdeci">#define SIGMA</div><div class="ttdef"><b>Definition</b> <a href="gompertz_8c_source.html#l00010">gompertz.c:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a825a990c0794920e7661efabe955a9e1" name="a825a990c0794920e7661efabe955a9e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a825a990c0794920e7661efabe955a9e1">&#9670;&#160;</a></span>_gompertz_to_trans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_to_trans </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>__pt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>__p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>__parindex</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00102">102</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>   {</div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_define" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a> = log(<a class="code hl_define" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a>);</div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_define" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a> = log(<a class="code hl_define" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>);</div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_define" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a> = log(<a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_define" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a> = log(<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_define" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a> = log(<a class="code hl_define" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a>);</div>
<div class="line"><span class="lineno">  111</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af750b0a42d4a28fc0fd251947a27d385" name="af750b0a42d4a28fc0fd251947a27d385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af750b0a42d4a28fc0fd251947a27d385">&#9670;&#160;</a></span>_ou2_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>lik</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>give_log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00106">106</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  111</span>   {</div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordtype">double</span> sd = fabs(<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordtype">double</span> f = 0.0;</div>
<div class="line"><span class="lineno">  114</span>  f += (ISNA(<a class="code hl_define" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>)) ? 0.0 : dnorm(<a class="code hl_define" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>,x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd,1);</div>
<div class="line"><span class="lineno">  115</span>  f += (ISNA(<a class="code hl_define" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>)) ? 0.0 : dnorm(<a class="code hl_define" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>,x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd,1);</div>
<div class="line"><span class="lineno">  116</span>  *lik = (give_log) ? f : exp(f);</div>
<div class="line"><span class="lineno">  117</span>}</div>
<div class="ttc" id="aou2_8c_html_a1964818ccd90a6173ea48cecb652feeb"><div class="ttname"><a href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a></div><div class="ttdeci">#define X1</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00059">ou2.c:59</a></div></div>
<div class="ttc" id="aou2_8c_html_a294189cdea31dda8faf609b9b3e2000a"><div class="ttname"><a href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a></div><div class="ttdeci">#define Y1</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00062">ou2.c:62</a></div></div>
<div class="ttc" id="aou2_8c_html_a3128cc29e366777d66d8b049451ca8a0"><div class="ttname"><a href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a></div><div class="ttdeci">#define Y2</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00063">ou2.c:63</a></div></div>
<div class="ttc" id="aou2_8c_html_a79ae03a0214cb30e57b9e8835f2a0019"><div class="ttname"><a href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a></div><div class="ttdeci">#define X2</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00060">ou2.c:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5e80084cfe8b5c5c76de464571a95c4" name="ad5e80084cfe8b5c5c76de464571a95c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e80084cfe8b5c5c76de464571a95c4">&#9670;&#160;</a></span>_ou2_emeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00132">132</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>   {</div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_define" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>];</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_define" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><span class="lineno">  140</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a499e2ed0106272324438f9c988015671" name="a499e2ed0106272324438f9c988015671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499e2ed0106272324438f9c988015671">&#9670;&#160;</a></span>_ou2_pdf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_pdf </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00082">82</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span>   {</div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">if</span> (t2-t1 != 1)</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ou2_pdf error: transitions must be consecutive&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span>  f[0] = <a class="code hl_function" href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a">dens_ou2</a>(x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],z[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],z[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code hl_define" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code hl_define" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code hl_define" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code hl_define" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,</div>
<div class="line"><span class="lineno">   92</span>                  <a class="code hl_define" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code hl_define" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code hl_define" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>,1);</div>
<div class="line"><span class="lineno">   93</span>}</div>
<div class="ttc" id="aou2_8c_html_a3f470cf546586fe861be7be3c24557bc"><div class="ttname"><a href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a></div><div class="ttdeci">#define SIGMA3</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00056">ou2.c:56</a></div></div>
<div class="ttc" id="aou2_8c_html_a6e6cd685f94be3c0552ee4cb3e0881ff"><div class="ttname"><a href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a></div><div class="ttdeci">#define ALPHA2</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00051">ou2.c:51</a></div></div>
<div class="ttc" id="aou2_8c_html_a8c409ae997e2b81c3b15dd2f40f78a8a"><div class="ttname"><a href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a">dens_ou2</a></div><div class="ttdeci">static double dens_ou2(double x1, double x2, double z1, double z2, double alpha1, double alpha2, double alpha3, double alpha4, double sigma1, double sigma2, double sigma3, int give_log)</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00029">ou2.c:30</a></div></div>
<div class="ttc" id="aou2_8c_html_ab2ee134520af69f566c53e1653198f29"><div class="ttname"><a href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a></div><div class="ttdeci">#define SIGMA1</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00054">ou2.c:54</a></div></div>
<div class="ttc" id="aou2_8c_html_ae5afe6a4069844a8988fffedaa523856"><div class="ttname"><a href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a></div><div class="ttdeci">#define SIGMA2</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00055">ou2.c:55</a></div></div>
<div class="ttc" id="aou2_8c_html_aef2261269821a4680fe2d8389edb6af1"><div class="ttname"><a href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a></div><div class="ttdeci">#define ALPHA3</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00052">ou2.c:52</a></div></div>
<div class="ttc" id="aou2_8c_html_af8e4e3fc5b56a3cf8340fd6534c71e00"><div class="ttname"><a href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a></div><div class="ttdeci">#define ALPHA4</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00053">ou2.c:53</a></div></div>
<div class="ttc" id="aou2_8c_html_afec7121cee3ac42de7f64aefd50c66cf"><div class="ttname"><a href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a></div><div class="ttdeci">#define ALPHA1</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00050">ou2.c:50</a></div></div>
<div class="ttc" id="apomp_8h_html_ad25a1c617278c25cbcbb9b9a3a6b8024"><div class="ttname"><a href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a></div><div class="ttdeci">#define err(...)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00021">pomp.h:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a499e2ed0106272324438f9c988015671_cgraph.png" border="0" usemap="#adecls_8h_a499e2ed0106272324438f9c988015671_cgraph" alt=""/></div>
<map name="adecls_8h_a499e2ed0106272324438f9c988015671_cgraph" id="adecls_8h_a499e2ed0106272324438f9c988015671_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,87,31"/>
<area shape="rect" href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a" title=" " alt="" coords="135,5,219,31"/>
<area shape="poly" title=" " alt="" coords="87,15,121,15,121,21,87,21"/>
</map>
</div>

</div>
</div>
<a id="a9b56b325d719e42ac66e1367b4f72f8e" name="a9b56b325d719e42ac66e1367b4f72f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b56b325d719e42ac66e1367b4f72f8e">&#9670;&#160;</a></span>_ou2_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>obsindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00120">120</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  125</span>   {</div>
<div class="line"><span class="lineno">  126</span>  <span class="keywordtype">double</span> sd = fabs(<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_define" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = rnorm(x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd);</div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_define" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = rnorm(x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd);</div>
<div class="line"><span class="lineno">  129</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acaef81a8193fa69cf2c0589f8ac56187" name="acaef81a8193fa69cf2c0589f8ac56187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaef81a8193fa69cf2c0589f8ac56187">&#9670;&#160;</a></span>_ou2_skel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_skel </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00095">95</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>   {</div>
<div class="line"><span class="lineno">  101</span>  f[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>] = <a class="code hl_define" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>*x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code hl_define" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>*x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><span class="lineno">  102</span>  f[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>] = <a class="code hl_define" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>*x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code hl_define" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>*x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><span class="lineno">  103</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8eb8fb617fb1a4584e553f08810105f9" name="a8eb8fb617fb1a4584e553f08810105f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb8fb617fb1a4584e553f08810105f9">&#9670;&#160;</a></span>_ou2_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_step </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *</td>          <td class="paramname"><span class="paramname"><em>covars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00071">71</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   76</span>   {</div>
<div class="line"><span class="lineno">   77</span>  <a class="code hl_function" href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd">sim_ou2</a>(&amp;x[<a class="code hl_define" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],&amp;x[<a class="code hl_define" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code hl_define" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code hl_define" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code hl_define" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code hl_define" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,<a class="code hl_define" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code hl_define" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code hl_define" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>);</div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="aou2_8c_html_a202fca38e8cd5e9f0a9e0c33921b01cd"><div class="ttname"><a href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd">sim_ou2</a></div><div class="ttdeci">static void sim_ou2(double *x1, double *x2, double alpha1, double alpha2, double alpha3, double alpha4, double sigma1, double sigma2, double sigma3)</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00009">ou2.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph.png" border="0" usemap="#adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph" alt=""/></div>
<map name="adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph" id="adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,31"/>
<area shape="rect" href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd" title=" " alt="" coords="141,5,219,31"/>
<area shape="poly" title=" " alt="" coords="94,15,128,15,128,21,94,21"/>
</map>
</div>

</div>
</div>
<a id="adc8e43ec5af20eb48754c1014606057a" name="adc8e43ec5af20eb48754c1014606057a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8e43ec5af20eb48754c1014606057a">&#9670;&#160;</a></span>_ou2_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>vmatindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>stateindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>parindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>covindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00143">143</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>   {</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordtype">double</span> sd = fabs(<a class="code hl_define" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_define" href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a> = <a class="code hl_define" href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a> = sd*sd;</div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_define" href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a> = <a class="code hl_define" href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a> = 0;</div>
<div class="line"><span class="lineno">  152</span>}</div>
<div class="ttc" id="aou2_8c_html_a30a3d62562a3da42fdc0697719aad10f"><div class="ttname"><a href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a></div><div class="ttdeci">#define V12</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00067">ou2.c:67</a></div></div>
<div class="ttc" id="aou2_8c_html_a5bab15beab8e28bbd9f89c19407c7397"><div class="ttname"><a href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a></div><div class="ttdeci">#define V21</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00066">ou2.c:66</a></div></div>
<div class="ttc" id="aou2_8c_html_a767d301ad391daed2e4bab0288565f7d"><div class="ttname"><a href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a></div><div class="ttdeci">#define V22</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00068">ou2.c:68</a></div></div>
<div class="ttc" id="aou2_8c_html_a87942002cab74af29b13ec07a3b27edf"><div class="ttname"><a href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a></div><div class="ttdeci">#define V11</div><div class="ttdef"><b>Definition</b> <a href="ou2_8c_source.html#l00065">ou2.c:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9390ea094fe7c28762eb6ac23f1c144" name="ad9390ea094fe7c28762eb6ac23f1c144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9390ea094fe7c28762eb6ac23f1c144">&#9670;&#160;</a></span>add_skel_args()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP add_skel_args </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Snames</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Pnames</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Cnames</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00010">10</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span>{</div>
<div class="line"><span class="lineno">   12</span> </div>
<div class="line"><span class="lineno">   13</span>  SEXP var;</div>
<div class="line"><span class="lineno">   14</span>  <span class="keywordtype">int</span> v;</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span>  <span class="comment">// Covariates</span></div>
<div class="line"><span class="lineno">   19</span>  <span class="keywordflow">for</span> (v = LENGTH(Cnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><span class="lineno">   20</span>    var = NEW_NUMERIC(1);</div>
<div class="line"><span class="lineno">   21</span>    <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   22</span>    UNPROTECT(1);</div>
<div class="line"><span class="lineno">   23</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   24</span>    SET_TAG(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Cnames,v)));</div>
<div class="line"><span class="lineno">   25</span>  }</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>  <span class="comment">// Parameters</span></div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordflow">for</span> (v = LENGTH(Pnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><span class="lineno">   29</span>    var = NEW_NUMERIC(1);</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   31</span>    UNPROTECT(1);</div>
<div class="line"><span class="lineno">   32</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   33</span>    SET_TAG(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Pnames,v)));</div>
<div class="line"><span class="lineno">   34</span>  }</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  <span class="comment">// Latent state variables</span></div>
<div class="line"><span class="lineno">   37</span>  <span class="keywordflow">for</span> (v = LENGTH(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)-1; v &gt;= 0; v--) {</div>
<div class="line"><span class="lineno">   38</span>    var = NEW_NUMERIC(1);</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   40</span>    UNPROTECT(1);</div>
<div class="line"><span class="lineno">   41</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   42</span>    SET_TAG(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,v)));</div>
<div class="line"><span class="lineno">   43</span>  }</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>  <span class="comment">// Time</span></div>
<div class="line"><span class="lineno">   46</span>  var = NEW_NUMERIC(1);</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   48</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">   49</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><span class="lineno">   50</span>  SET_TAG(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,install(<span class="stringliteral">&quot;t&quot;</span>));</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>}</div>
<div class="ttc" id="atrajectory_8c_html_a2e65cd991bb60dd57098ab40b91ac722"><div class="ttname"><a href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a></div><div class="ttdeci">SEXP Snames</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00140">trajectory.c:140</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a94fe754831aa7e8eeb4053fa11b537cd"><div class="ttname"><a href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a></div><div class="ttdeci">SEXP args</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00139">trajectory.c:139</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph.png" border="0" usemap="#adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph" alt=""/></div>
<map name="adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph" id="adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph">
<area shape="rect" title=" " alt="" coords="213,55,328,80"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="35,5,135,31"/>
<area shape="poly" title=" " alt="" coords="208,54,133,33,135,28,210,49"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="35,55,136,80"/>
<area shape="poly" title=" " alt="" coords="199,70,136,70,136,65,199,65"/>
<area shape="rect" href="trajectory_8c.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="5,104,165,129"/>
<area shape="poly" title=" " alt="" coords="210,86,135,106,133,101,208,81"/>
</map>
</div>

</div>
</div>
<a id="a91f31f12db7a1e75775f01eb11ead99d" name="a91f31f12db7a1e75775f01eb11ead99d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f31f12db7a1e75775f01eb11ead99d">&#9670;&#160;</a></span>apply_probe_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_data </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>probes</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00004">4</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    4</span>                                                 {</div>
<div class="line"><span class="lineno">    5</span>  SEXP retval, data, vals;</div>
<div class="line"><span class="lineno">    6</span>  <span class="keywordtype">int</span> nprobe;</div>
<div class="line"><span class="lineno">    7</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">    8</span> </div>
<div class="line"><span class="lineno">    9</span>  nprobe = LENGTH(probes);</div>
<div class="line"><span class="lineno">   10</span>  PROTECT(data = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><span class="lineno">   11</span>  PROTECT(vals = NEW_LIST(nprobe));</div>
<div class="line"><span class="lineno">   12</span>  SET_NAMES(vals,GET_NAMES(probes));</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>  <span class="keywordflow">for</span> (i = 0; i &lt; nprobe; i++) {</div>
<div class="line"><span class="lineno">   15</span>    SET_ELEMENT(vals,i,eval(PROTECT(lang2(VECTOR_ELT(probes,i),data)),</div>
<div class="line"><span class="lineno">   16</span>                            R_ClosureEnv(VECTOR_ELT(probes,i))));</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">if</span> (!IS_NUMERIC(VECTOR_ELT(vals,i))) {</div>
<div class="line"><span class="lineno">   18</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %d returns a non-numeric result&quot;</span>,i+1);</div>
<div class="line"><span class="lineno">   19</span>    }</div>
<div class="line"><span class="lineno">   20</span>    UNPROTECT(1);</div>
<div class="line"><span class="lineno">   21</span>  }</div>
<div class="line"><span class="lineno">   22</span>  PROTECT(vals = VectorToPairList(vals));</div>
<div class="line"><span class="lineno">   23</span>  PROTECT(retval = eval(PROTECT(LCONS(install(<span class="stringliteral">&quot;c&quot;</span>),vals)),R_BaseEnv));</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  UNPROTECT(5);</div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordflow">return</span> retval;</div>
<div class="line"><span class="lineno">   27</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph.png" border="0" usemap="#adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph" alt=""/></div>
<map name="adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph" id="adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,295,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a34c714747e1b49d142af4d58fee24446" name="a34c714747e1b49d142af4d58fee24446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34c714747e1b49d142af4d58fee24446">&#9670;&#160;</a></span>apply_probe_sim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_sim </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>nsim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>probes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>datval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00029">29</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>                                                           {</div>
<div class="line"><span class="lineno">   31</span>  SEXP x, y, names, sims;</div>
<div class="line"><span class="lineno">   32</span>  SEXP returntype, retval, val, valnames;</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordtype">int</span> nprobe, nsims, nobs, ntimes, nvals;</div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordtype">double</span> *xp, *yp;</div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordtype">int</span> p, s, i, j, k, len0 = 0, len = 0;</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  PROTECT(nsim = AS_INTEGER(nsim));</div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">if</span> ((LENGTH(nsim)!=1) || (INTEGER(nsim)[0]&lt;=0))</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a positive integer.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">// &#39;names&#39; holds the names of the probe values</span></div>
<div class="line"><span class="lineno">   45</span>  <span class="comment">// we get these from a previous call to &#39;apply_probe_data&#39;</span></div>
<div class="line"><span class="lineno">   46</span>  nprobe = LENGTH(probes);</div>
<div class="line"><span class="lineno">   47</span>  nvals = LENGTH(datval);</div>
<div class="line"><span class="lineno">   48</span>  PROTECT(names = GET_NAMES(datval));</div>
<div class="line"><span class="lineno">   49</span>  PROTECT(returntype = NEW_INTEGER(1));</div>
<div class="line"><span class="lineno">   50</span>  *(INTEGER(returntype)) = 0;</div>
<div class="line"><span class="lineno">   51</span>  PROTECT(sims = <a class="code hl_function" href="#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a>(<span class="keywordtype">object</span>,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,nsim,returntype,gnsi));</div>
<div class="line"><span class="lineno">   52</span>  PROTECT(y = VECTOR_ELT(sims,1));</div>
<div class="line"><span class="lineno">   53</span>  *(INTEGER(gnsi)) = 0;</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  nobs = INTEGER(GET_DIM(y))[0];</div>
<div class="line"><span class="lineno">   56</span>  nsims = INTEGER(GET_DIM(y))[1];</div>
<div class="line"><span class="lineno">   57</span>  ntimes = INTEGER(GET_DIM(y))[2];</div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// set up temporary storage</span></div>
<div class="line"><span class="lineno">   59</span>  xdim[0] = nobs; xdim[1] = ntimes;</div>
<div class="line"><span class="lineno">   60</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// set up matrix to hold results</span></div>
<div class="line"><span class="lineno">   64</span>  xdim[0] = nsims; xdim[1] = nvals;</div>
<div class="line"><span class="lineno">   65</span>  PROTECT(retval = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><span class="lineno">   66</span>  PROTECT(valnames = NEW_LIST(2));</div>
<div class="line"><span class="lineno">   67</span>  SET_ELEMENT(valnames,1,names);        <span class="comment">// set column names</span></div>
<div class="line"><span class="lineno">   68</span>  SET_DIMNAMES(retval,valnames);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">for</span> (p = 0, k = 0; p &lt; nprobe; p++, k += len) { <span class="comment">// loop over probes</span></div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">for</span> (s = 0; s &lt; nsims; s++) { <span class="comment">// loop over simulations</span></div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>      <span class="comment">// copy the data from y[,s,] to x[,]</span></div>
<div class="line"><span class="lineno">   77</span>      xp = REAL(x);</div>
<div class="line"><span class="lineno">   78</span>      yp = REAL(y)+nobs*s;</div>
<div class="line"><span class="lineno">   79</span>      <span class="keywordflow">for</span> (j = 0; j &lt; ntimes; j++, yp += nobs*nsims) {</div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, xp++) *xp = yp[i];</div>
<div class="line"><span class="lineno">   81</span>      }</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>      <span class="comment">// evaluate the probe on the simulated data</span></div>
<div class="line"><span class="lineno">   84</span>      PROTECT(val = eval(PROTECT(lang2(VECTOR_ELT(probes,p),x)),</div>
<div class="line"><span class="lineno">   85</span>                         R_ClosureEnv(VECTOR_ELT(probes,p))));</div>
<div class="line"><span class="lineno">   86</span>      <span class="keywordflow">if</span> (!IS_NUMERIC(val)) {</div>
<div class="line"><span class="lineno">   87</span>        <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %d returns a non-numeric result.&quot;</span>,p+1);</div>
<div class="line"><span class="lineno">   88</span>      }</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>      len = LENGTH(val);</div>
<div class="line"><span class="lineno">   91</span>      <span class="keywordflow">if</span> (s == 0)</div>
<div class="line"><span class="lineno">   92</span>        len0 = len;</div>
<div class="line"><span class="lineno">   93</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len != len0) {</div>
<div class="line"><span class="lineno">   94</span>        <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;variable-sized results returned by probe %d.&quot;</span>,p+1);</div>
<div class="line"><span class="lineno">   95</span>      }</div>
<div class="line"><span class="lineno">   96</span>      <span class="keywordflow">if</span> (k+len &gt; nvals)</div>
<div class="line"><span class="lineno">   97</span>        <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>      xp = REAL(retval); yp = REAL(val);</div>
<div class="line"><span class="lineno">  100</span>      <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) xp[s+nsims*(i+k)] = yp[i];</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>      UNPROTECT(2);</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  }</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">if</span> (k != nvals)</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  UNPROTECT(9);</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">return</span> retval;</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="adecls_8h_html_aa9d3b94c1a9a99e0db90e251f670e853"><div class="ttname"><a href="#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a></div><div class="ttdeci">SEXP do_simulate(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="simulate_8c_source.html#l00006">simulate.c:6</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a26453e4cfff7ec27ff31d617583dcae4"><div class="ttname"><a href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a></div><div class="ttdeci">static R_INLINE void setrownames(SEXP x, SEXP names, int rank)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00110">pomp_defines.h:110</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a8ab2bdfb97326c698544007bd60c1a49"><div class="ttname"><a href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a></div><div class="ttdeci">static R_INLINE SEXP makearray(int rank, const int *dim)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00040">pomp_defines.h:40</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a58d967e1449ba00d87d2f6d70b50d525"><div class="ttname"><a href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a></div><div class="ttdeci">SEXP params</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00128">trajectory.c:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34c714747e1b49d142af4d58fee24446_cgraph.png" border="0" usemap="#adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph" alt=""/></div>
<map name="adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph" id="adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph">
<area shape="rect" title=" " alt="" coords="5,499,139,524"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="187,499,289,524"/>
<area shape="poly" title=" " alt="" coords="139,509,173,509,173,514,139,514"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="922,274,1033,299"/>
<area shape="poly" title=" " alt="" coords="72,498,92,388,113,308,144,222,185,141,210,104,238,71,270,44,306,23,345,10,389,5,565,5,655,3,728,6,762,12,796,24,832,43,871,71,893,91,912,114,941,166,961,217,973,259,968,260,956,219,937,168,907,117,889,95,868,75,829,48,794,29,761,18,728,11,655,9,565,10,389,10,346,15,308,28,273,48,242,75,214,107,189,143,148,225,118,309,97,389,78,499"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="931,802,1023,827"/>
<area shape="poly" title=" " alt="" coords="76,524,86,643,99,735,122,841,154,954,200,1066,229,1120,261,1171,298,1219,339,1263,374,1289,408,1299,491,1306,563,1313,636,1306,659,1299,683,1290,739,1280,785,1278,805,1275,826,1269,846,1258,867,1239,887,1209,906,1165,936,1050,958,930,970,840,976,841,963,931,941,1051,911,1166,892,1212,871,1243,849,1262,828,1274,807,1280,785,1283,739,1285,685,1295,661,1305,636,1312,563,1319,490,1312,406,1304,372,1293,336,1267,294,1223,257,1175,224,1123,196,1069,149,956,116,843,94,736,81,643,71,525"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="733,147,820,172"/>
<area shape="poly" title=" " alt="" coords="252,497,316,442,418,361,545,271,614,228,683,189,719,174,721,179,685,194,616,233,548,276,421,366,319,447,255,501"/>
<area shape="poly" title=" " alt="" coords="239,498,249,458,267,402,295,340,314,310,335,283,377,240,416,206,453,180,490,159,530,142,574,128,683,100,736,85,780,77,822,79,871,100,892,115,911,134,940,177,960,222,972,259,967,261,955,224,935,180,906,137,889,119,868,105,821,85,780,82,737,91,685,105,576,133,532,147,493,164,456,184,419,210,381,244,339,287,318,313,300,342,272,403,254,459,244,499"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="355,1227,425,1252"/>
<area shape="poly" title=" " alt="" coords="244,524,279,725,340,1032,384,1213,379,1214,335,1033,274,726,239,525"/>
<area shape="poly" title=" " alt="" coords="245,524,266,603,286,663,312,729,345,799,386,868,435,932,492,987,541,1023,587,1052,632,1073,676,1086,721,1090,768,1083,816,1067,868,1039,892,1019,912,996,942,941,961,886,970,840,975,841,966,887,947,943,916,999,896,1023,871,1043,818,1072,769,1089,722,1095,675,1091,630,1078,584,1057,538,1028,489,991,431,935,382,871,341,801,307,731,281,664,261,605,239,525"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="510,499,617,524"/>
<area shape="poly" title=" " alt="" coords="289,509,496,509,496,514,289,514"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="340,624,440,650"/>
<area shape="poly" title=" " alt="" coords="256,522,365,613,361,617,253,527"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="337,296,443,322"/>
<area shape="poly" title=" " alt="" coords="242,497,275,426,302,381,335,339,350,327,353,331,339,343,306,384,280,428,247,500"/>
<area shape="poly" title=" " alt="" coords="800,170,946,264,943,268,797,175"/>
<area shape="poly" title=" " alt="" coords="390,1226,401,1079,423,843,453,614,470,532,479,504,489,486,506,471,525,463,563,462,600,461,617,454,634,440,654,410,662,379,662,349,658,318,654,287,653,255,661,222,682,190,699,176,719,166,721,171,702,180,686,193,666,225,659,255,659,286,663,317,668,348,668,380,659,412,638,444,620,459,601,466,563,467,526,468,509,475,493,489,484,506,475,533,458,615,428,844,406,1079,395,1227"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="523,1154,604,1179"/>
<area shape="poly" title=" " alt="" coords="415,1224,490,1189,510,1181,512,1186,492,1194,417,1229"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="523,1203,603,1228"/>
<area shape="poly" title=" " alt="" coords="425,1232,509,1220,510,1226,426,1237"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="695,1104,858,1130"/>
<area shape="poly" title=" " alt="" coords="395,1225,408,1200,428,1169,455,1138,489,1114,545,1096,604,1090,661,1092,711,1099,710,1104,660,1098,604,1095,546,1102,492,1119,459,1142,432,1172,412,1203,399,1228"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1240,1678,1357,1703"/>
<area shape="poly" title=" " alt="" coords="394,1252,398,1314,412,1410,424,1464,441,1519,464,1572,493,1621,553,1704,581,1737,610,1764,642,1786,679,1802,723,1811,775,1814,979,1814,1021,1811,1064,1803,1145,1775,1215,1740,1267,1708,1270,1713,1217,1745,1147,1780,1065,1808,1022,1816,979,1820,775,1820,722,1816,678,1807,640,1791,607,1769,577,1741,549,1707,488,1624,459,1574,436,1520,419,1465,406,1411,393,1315,389,1253"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="693,1154,860,1179"/>
<area shape="poly" title=" " alt="" coords="397,1225,433,1181,459,1157,490,1140,529,1129,562,1128,636,1140,702,1148,701,1154,636,1145,561,1134,530,1134,492,1145,462,1162,437,1184,402,1228"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="530,1454,597,1479"/>
<area shape="poly" title=" " alt="" coords="397,1252,406,1289,425,1340,453,1394,471,1418,492,1440,518,1455,516,1459,489,1444,467,1422,449,1396,420,1342,401,1291,391,1253"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="491,1252,636,1278"/>
<area shape="poly" title=" " alt="" coords="426,1242,478,1250,477,1255,425,1247"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="736,1203,817,1228"/>
<area shape="poly" title=" " alt="" coords="411,1250,447,1271,491,1288,532,1297,564,1302,596,1299,635,1288,650,1279,659,1269,668,1257,683,1245,722,1228,724,1232,685,1250,672,1261,663,1272,653,1283,637,1293,597,1305,564,1307,531,1302,490,1293,445,1276,408,1255"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="705,1354,848,1379"/>
<area shape="poly" title=" " alt="" coords="394,1252,399,1300,413,1366,426,1401,443,1435,464,1465,492,1489,529,1509,563,1515,597,1509,635,1489,646,1479,653,1468,659,1443,664,1416,671,1402,682,1390,691,1383,694,1388,686,1394,675,1405,669,1418,664,1444,658,1470,651,1483,637,1494,599,1514,563,1521,527,1514,489,1494,461,1469,438,1438,421,1403,408,1368,394,1300,389,1253"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="925,1330,1030,1355"/>
<area shape="poly" title=" " alt="" coords="395,1252,403,1300,419,1370,448,1449,468,1486,493,1521,536,1566,577,1593,623,1612,685,1629,738,1645,783,1657,804,1658,824,1654,845,1645,868,1630,892,1601,902,1571,903,1539,897,1506,891,1472,889,1437,895,1402,915,1366,919,1361,923,1365,919,1369,900,1403,894,1438,896,1472,902,1505,908,1539,908,1572,897,1603,871,1634,848,1650,826,1659,804,1663,782,1662,737,1650,683,1634,622,1617,574,1598,532,1570,489,1524,464,1489,443,1451,414,1372,397,1301,390,1253"/>
<area shape="poly" title=" " alt="" coords="618,1250,722,1225,724,1230,620,1255"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="924,1203,1031,1228"/>
<area shape="poly" title=" " alt="" coords="818,1213,910,1213,910,1218,818,1218"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="924,650,1031,675"/>
<area shape="poly" title=" " alt="" coords="817,1212,844,1205,867,1190,885,1157,896,1112,901,1057,904,998,905,880,908,829,915,790,936,733,959,686,964,688,941,735,920,791,913,830,911,880,909,998,907,1058,901,1113,890,1159,871,1193,847,1210,818,1218"/>
<area shape="poly" title=" " alt="" coords="817,1211,844,1204,868,1190,900,1150,926,1104,945,1055,958,1004,972,910,974,841,980,841,977,911,963,1005,950,1056,931,1106,905,1153,871,1194,846,1209,818,1216"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="917,1379,1037,1404"/>
<area shape="poly" title=" " alt="" coords="849,1373,904,1380,903,1385,848,1378"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="926,1503,1029,1528"/>
<area shape="poly" title=" " alt="" coords="844,1376,871,1389,900,1412,926,1439,964,1490,959,1493,922,1442,897,1416,868,1394,841,1381"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="1085,1652,1192,1678"/>
<area shape="poly" title=" " alt="" coords="994,1526,1116,1641,1112,1645,990,1530"/>
<area shape="poly" title=" " alt="" coords="1193,1671,1227,1676,1226,1681,1192,1676"/>
<area shape="poly" title=" " alt="" coords="609,497,623,488,634,478,655,441,663,405,661,370,656,335,650,299,650,264,659,227,682,190,699,175,719,166,721,171,702,180,686,193,664,229,655,264,656,299,661,334,667,369,668,405,660,443,638,481,626,493,612,501"/>
<area shape="poly" title=" " alt="" coords="608,497,634,478,649,453,655,428,653,379,651,354,653,330,662,307,682,285,710,268,741,257,774,251,807,249,871,255,926,267,925,272,871,260,807,254,775,256,743,262,713,273,686,290,667,310,658,332,656,354,658,378,660,429,654,455,638,481,611,501"/>
<area shape="poly" title=" " alt="" coords="569,524,584,622,610,775,646,931,666,994,686,1039,712,1070,743,1094,739,1098,709,1074,682,1042,661,996,641,932,605,776,578,623,564,525"/>
<area shape="poly" title=" " alt="" coords="615,503,634,491,654,461,661,431,659,400,654,368,649,337,649,306,658,276,682,248,713,232,756,221,807,216,862,215,916,220,967,229,1009,242,1039,260,1078,307,1114,370,1145,448,1172,538,1196,638,1217,744,1250,969,1273,1193,1288,1396,1299,1663,1294,1664,1282,1397,1268,1193,1245,970,1212,745,1191,639,1167,540,1140,450,1109,373,1074,310,1036,264,1007,247,965,234,915,225,861,221,807,221,757,226,715,237,686,252,663,279,654,307,654,336,659,367,665,399,666,431,659,463,638,495,618,508"/>
<area shape="poly" title=" " alt="" coords="569,524,625,857,661,1048,676,1112,686,1141,689,1144,685,1147,682,1144,671,1113,656,1049,620,858,564,525"/>
<area shape="poly" title=" " alt="" coords="617,502,672,499,737,501,805,512,839,522,871,536,901,557,928,583,965,636,961,639,924,587,898,561,868,541,837,527,804,517,736,506,672,504,617,507"/>
<area shape="poly" title=" " alt="" coords="570,524,582,565,604,623,638,684,660,712,685,736,718,749,779,766,918,799,917,804,777,771,716,754,683,740,656,716,634,687,599,625,577,567,565,525"/>
<area shape="poly" title=" " alt="" coords="570,524,599,689,639,939,643,1030,645,1149,649,1208,656,1263,668,1308,686,1341,695,1348,691,1352,682,1344,663,1310,651,1264,644,1209,640,1149,638,1031,633,940,594,690,564,525"/>
<area shape="poly" title=" " alt="" coords="570,524,583,571,606,640,641,719,662,757,686,793,710,819,734,838,782,863,829,890,851,911,872,941,893,994,900,1044,896,1091,888,1136,881,1179,881,1223,892,1269,903,1292,919,1317,922,1319,918,1323,915,1320,898,1295,887,1271,876,1224,876,1179,883,1135,891,1090,895,1044,888,996,867,943,847,915,826,894,780,868,731,842,706,823,682,796,657,760,636,721,601,642,578,573,565,525"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,398,817,423"/>
<area shape="poly" title=" " alt="" coords="596,496,635,477,658,458,683,440,722,423,724,428,685,445,661,463,637,482,599,501"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="717,299,836,324"/>
<area shape="poly" title=" " alt="" coords="607,497,634,478,647,460,653,442,656,407,660,371,668,353,682,335,703,321,706,326,686,339,672,356,665,372,661,407,658,443,651,462,638,481,610,501"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="737,348,817,374"/>
<area shape="poly" title=" " alt="" coords="604,496,634,478,650,454,657,431,664,407,682,384,702,372,723,365,724,370,704,377,686,388,668,410,662,433,655,457,638,481,607,501"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="736,550,817,575"/>
<area shape="poly" title=" " alt="" coords="617,521,723,547,722,552,616,527"/>
<area shape="poly" title=" " alt="" coords="836,301,908,292,909,298,837,307"/>
<area shape="poly" title=" " alt="" coords="817,553,844,544,868,528,890,504,909,476,939,416,958,358,969,312,974,313,963,359,944,418,914,479,894,507,871,532,846,549,819,558"/>
<area shape="poly" title=" " alt="" coords="819,568,870,585,915,611,952,639,949,643,912,615,868,590,817,573"/>
<area shape="poly" title=" " alt="" coords="818,563,846,571,871,586,967,788,962,790,867,589,844,576,817,568"/>
<area shape="poly" title=" " alt="" coords="392,623,403,588,422,540,451,487,489,440,508,425,528,417,565,410,600,402,617,392,634,377,649,353,656,330,656,284,657,238,665,214,682,190,699,176,719,167,722,172,702,181,686,193,670,216,662,239,662,284,661,331,654,355,638,380,620,397,602,407,566,415,529,422,511,430,493,444,455,490,427,542,408,590,397,625"/>
<area shape="poly" title=" " alt="" coords="391,623,413,532,434,465,464,391,503,315,551,243,580,210,611,180,645,154,683,132,733,111,777,104,821,110,871,132,906,158,934,192,955,228,969,259,964,262,950,231,930,195,902,162,868,137,819,116,777,109,735,116,685,137,648,158,615,184,584,214,556,246,507,318,469,393,440,467,418,534,396,624"/>
<area shape="poly" title=" " alt="" coords="440,636,911,657,910,662,440,642"/>
<area shape="poly" title=" " alt="" coords="410,647,456,679,522,719,600,760,685,792,746,805,808,812,917,815,917,820,807,818,745,810,683,797,598,765,519,724,453,683,407,652"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="501,1404,625,1430"/>
<area shape="poly" title=" " alt="" coords="394,650,398,744,412,903,425,996,442,1095,465,1194,493,1289,519,1345,547,1392,543,1394,514,1348,488,1291,459,1195,437,1096,420,997,407,903,393,744,389,650"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="689,599,864,624"/>
<area shape="poly" title=" " alt="" coords="440,631,676,615,676,621,441,636"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="505,951,622,976"/>
<area shape="poly" title=" " alt="" coords="400,649,493,832,551,938,546,940,488,834,395,651"/>
<area shape="poly" title=" " alt="" coords="571,1403,600,1354,634,1289,646,1247,649,1210,657,1176,667,1158,682,1140,689,1135,692,1139,686,1144,671,1161,662,1178,654,1211,651,1248,638,1291,605,1356,575,1405"/>
<area shape="poly" title=" " alt="" coords="621,1428,638,1440,657,1471,664,1503,663,1533,658,1564,654,1593,655,1621,664,1648,686,1674,718,1697,752,1716,788,1731,826,1742,905,1753,985,1754,1063,1747,1135,1734,1248,1705,1249,1710,1136,1740,1063,1752,985,1760,904,1759,825,1747,786,1736,750,1721,715,1701,682,1678,659,1650,650,1622,649,1593,653,1563,658,1533,659,1503,652,1473,634,1444,618,1432"/>
<area shape="poly" title=" " alt="" coords="570,1403,634,1289,645,1260,652,1236,662,1213,682,1190,691,1183,694,1188,686,1194,666,1215,657,1237,650,1262,638,1291,575,1405"/>
<area shape="poly" title=" " alt="" coords="617,1402,709,1379,710,1385,618,1407"/>
<area shape="poly" title=" " alt="" coords="621,1428,638,1440,655,1465,661,1491,660,1540,658,1564,659,1587,668,1609,686,1629,714,1645,754,1656,803,1663,858,1668,972,1670,1072,1666,1072,1672,972,1675,858,1673,802,1669,753,1661,711,1650,682,1634,663,1611,654,1588,652,1564,654,1540,656,1491,650,1468,634,1444,618,1432"/>
<area shape="poly" title=" " alt="" coords="620,1427,638,1440,652,1460,659,1480,660,1519,662,1555,670,1571,686,1587,733,1614,756,1621,778,1624,800,1622,822,1615,868,1587,889,1563,898,1538,899,1512,896,1484,892,1455,891,1426,898,1396,915,1366,920,1361,924,1365,919,1369,903,1398,897,1426,897,1455,901,1483,905,1511,904,1539,894,1566,871,1591,824,1620,801,1627,778,1629,754,1626,731,1619,682,1591,666,1575,657,1557,654,1519,653,1481,647,1462,634,1444,617,1432"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,1452,817,1478"/>
<area shape="poly" title=" " alt="" coords="621,1427,723,1450,722,1455,620,1432"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="737,1502,817,1527"/>
<area shape="poly" title=" " alt="" coords="611,1427,637,1440,653,1453,662,1465,671,1477,685,1488,724,1503,722,1508,683,1493,667,1481,658,1468,649,1456,635,1444,609,1432"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="710,1551,843,1576"/>
<area shape="poly" title=" " alt="" coords="618,1427,638,1440,649,1453,656,1466,662,1491,668,1515,675,1526,686,1537,699,1546,696,1551,682,1542,671,1530,663,1517,657,1492,651,1468,645,1456,634,1444,615,1432"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="712,1403,841,1428"/>
<area shape="poly" title=" " alt="" coords="626,1414,698,1413,699,1419,626,1419"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="736,700,817,726"/>
<area shape="poly" title=" " alt="" coords="572,1403,603,1354,620,1323,633,1289,648,1238,656,1194,661,1117,664,1039,670,994,681,942,700,883,721,826,760,737,765,739,726,828,705,885,687,943,675,995,669,1040,666,1117,662,1195,653,1240,639,1291,625,1325,608,1357,576,1405"/>
<area shape="poly" title=" " alt="" coords="798,698,834,672,867,635,891,594,912,549,942,458,961,374,971,313,976,314,966,375,947,459,917,551,896,596,871,638,837,676,801,702"/>
<area shape="poly" title=" " alt="" coords="817,700,913,676,914,681,818,705"/>
<area shape="poly" title=" " alt="" coords="818,722,870,742,913,766,949,791,946,795,910,771,868,747,817,727"/>
<area shape="poly" title=" " alt="" coords="851,597,868,586,895,555,917,520,935,482,948,443,965,369,972,312,977,313,970,370,953,445,940,484,922,522,899,558,871,590,854,601"/>
<area shape="poly" title=" " alt="" coords="797,622,871,687,921,741,960,789,956,793,917,744,867,691,793,626"/>
<area shape="poly" title=" " alt="" coords="562,951,566,882,582,774,597,712,618,651,646,591,682,537,704,513,726,497,771,480,818,465,842,453,868,434,897,403,923,370,961,310,965,312,927,373,901,407,871,438,845,457,820,470,773,485,729,502,708,517,686,540,651,593,623,652,603,714,588,775,572,882,567,951"/>
<area shape="poly" title=" " alt="" coords="584,974,748,1094,745,1098,581,979"/>
<area shape="poly" title=" " alt="" coords="572,975,586,1009,610,1053,644,1100,686,1140,694,1145,691,1150,682,1144,639,1104,606,1056,582,1011,567,977"/>
<area shape="poly" title=" " alt="" coords="599,948,927,829,929,834,601,953"/>
<area shape="poly" title=" " alt="" coords="573,975,603,1045,639,1141,646,1173,649,1201,649,1250,651,1273,656,1295,667,1317,686,1340,695,1348,691,1352,682,1344,662,1320,651,1297,645,1274,644,1250,644,1201,641,1174,633,1143,598,1047,568,977"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="684,1003,869,1028"/>
<area shape="poly" title=" " alt="" coords="617,974,712,997,710,1002,616,979"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,954,817,979"/>
<area shape="poly" title=" " alt="" coords="622,962,722,963,722,968,622,967"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="753,1304,801,1330"/>
<area shape="poly" title=" " alt="" coords="572,975,631,1118,664,1196,686,1239,714,1270,745,1294,742,1298,711,1274,682,1242,659,1198,626,1120,567,977"/>
<area shape="poly" title=" " alt="" coords="801,1317,911,1331,910,1337,800,1322"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="939,1280,1016,1306"/>
<area shape="poly" title=" " alt="" coords="800,1311,925,1296,925,1302,801,1317"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34c714747e1b49d142af4d58fee24446_icgraph.png" border="0" usemap="#adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph" alt=""/></div>
<map name="adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph" id="adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,289,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a41860ab8f0d4fb23e3ce010e6ad2ff2f" name="a41860ab8f0d4fb23e3ce010e6ad2ff2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41860ab8f0d4fb23e3ce010e6ad2ff2f">&#9670;&#160;</a></span>bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>range</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>nbasis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>degree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deriv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00051">51</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>                                                                              {</div>
<div class="line"><span class="lineno">   52</span>  SEXP y, xr;</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordtype">int</span> nk = nb+deg+1;</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordtype">double</span> dx, minx, maxx;</div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordtype">double</span> *knots = NULL;</div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordtype">double</span> *xdata, *ydata;</div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">if</span> (deg &lt; 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt; 0&quot;</span>);</div>
<div class="line"><span class="lineno">   63</span>  <span class="keywordflow">if</span> (nb &lt;= deg) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; degree&quot;</span>);</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">if</span> (d &lt; 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><span class="lineno">   65</span>  knots = (<span class="keywordtype">double</span> *) R_Calloc(nk,<span class="keywordtype">double</span>);</div>
<div class="line"><span class="lineno">   66</span>  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><span class="lineno">   67</span>  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><span class="lineno">   68</span>  xdata = REAL(xr);</div>
<div class="line"><span class="lineno">   69</span>  ydata = REAL(y);</div>
<div class="line"><span class="lineno">   70</span>  minx = REAL(range)[0];</div>
<div class="line"><span class="lineno">   71</span>  maxx = REAL(range)[1];</div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordflow">if</span> (minx &gt;= maxx) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;improper range &#39;rg&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">   73</span>  dx = (maxx-minx)/((<span class="keywordtype">double</span>) (nb-deg));</div>
<div class="line"><span class="lineno">   74</span>  knots[0] = minx-deg*dx;</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">for</span> (i = 1; i &lt; nk; i++) knots[i] = knots[i-1]+dx;</div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">for</span> (i = 0; i &lt; nb; i++) {</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_function" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(ydata,xdata,nx,i,deg,d,&amp;knots[0]);</div>
<div class="line"><span class="lineno">   78</span>    ydata += nx;</div>
<div class="line"><span class="lineno">   79</span>  }</div>
<div class="line"><span class="lineno">   80</span>  R_Free(knots);</div>
<div class="line"><span class="lineno">   81</span>  UNPROTECT(2);</div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordflow">return</span>(y);</div>
<div class="line"><span class="lineno">   83</span>}</div>
<div class="ttc" id="abspline_8c_html_a2237300eb36fec7026017251da56382e"><div class="ttname"><a href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a></div><div class="ttdeci">static void bspline_eval(double *y, const double *x, int nx, int i, int degree, int deriv, const double *knots)</div><div class="ttdef"><b>Definition</b> <a href="bspline_8c_source.html#l00009">bspline.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph.png" border="0" usemap="#adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph" alt=""/></div>
<map name="adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph" id="adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,116,55"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="164,29,268,55"/>
<area shape="poly" title=" " alt="" coords="116,39,150,39,150,45,116,45"/>
<area shape="poly" title=" " alt="" coords="190,31,184,21,187,11,198,5,216,3,237,6,246,15,243,19,235,11,216,8,200,10,192,15,190,20,194,28"/>
</map>
</div>

</div>
</div>
<a id="ab24fa1bb0f03a3d3443051e82d0246b8" name="ab24fa1bb0f03a3d3443051e82d0246b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab24fa1bb0f03a3d3443051e82d0246b8">&#9670;&#160;</a></span>bspline_basis_eval_deriv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void bspline_basis_eval_deriv </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>knots</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>degree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nbasis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>deriv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00115">115</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>                                                                 {</div>
<div class="line"><span class="lineno">  117</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbasis; i++) {</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_function" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(&amp;y[i],&amp;x,1,i,degree,deriv,knots);</div>
<div class="line"><span class="lineno">  119</span>  }</div>
<div class="line"><span class="lineno">  120</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph.png" border="0" usemap="#adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph" alt=""/></div>
<map name="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph" id="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,151,62"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="199,29,303,55"/>
<area shape="poly" title=" " alt="" coords="151,39,185,39,185,45,151,45"/>
<area shape="poly" title=" " alt="" coords="222,31,216,21,219,11,231,5,251,3,274,6,284,15,281,19,272,11,251,8,233,10,223,15,221,20,227,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph.png" border="0" usemap="#adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph" alt=""/></div>
<map name="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph" id="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,301,45"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,13,108,38"/>
<area shape="poly" title=" " alt="" coords="142,28,108,28,108,23,142,23"/>
</map>
</div>

</div>
</div>
<a id="a7eb19c7180d18dc9f384cea477ee1a83" name="a7eb19c7180d18dc9f384cea477ee1a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb19c7180d18dc9f384cea477ee1a83">&#9670;&#160;</a></span>D_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>prob</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>theta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00137">137</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>                                                                      {</div>
<div class="line"><span class="lineno">  138</span>  <span class="keywordtype">int</span> k, n, nx, ns, np, nt;</div>
<div class="line"><span class="lineno">  139</span>  <span class="keywordtype">double</span> *F, *<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><span class="lineno">  140</span>  SEXP f;</div>
<div class="line"><span class="lineno">  141</span>  PROTECT(x = AS_NUMERIC(x)); nx = LENGTH(x); <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(x);</div>
<div class="line"><span class="lineno">  142</span>  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><span class="lineno">  143</span>  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><span class="lineno">  144</span>  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><span class="lineno">  145</span>  PROTECT(log = AS_INTEGER(log));</div>
<div class="line"><span class="lineno">  146</span>  n = (nx &gt; ns) ? nx : ns;</div>
<div class="line"><span class="lineno">  147</span>  n = (n &gt; np) ? n : np;</div>
<div class="line"><span class="lineno">  148</span>  n = (n &gt; nt) ? n : nt;</div>
<div class="line"><span class="lineno">  149</span>  PROTECT(f = NEW_NUMERIC(n)); F = REAL(f);</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++) {</div>
<div class="line"><span class="lineno">  151</span>    F[k] = <a class="code hl_function" href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d">dbetabinom</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k%nx],S[k%ns],P[k%np],T[k%nt],INTEGER(log)[0]);</div>
<div class="line"><span class="lineno">  152</span>  }</div>
<div class="line"><span class="lineno">  153</span>  UNPROTECT(6);</div>
<div class="line"><span class="lineno">  154</span>  <span class="keywordflow">return</span> f;</div>
<div class="line"><span class="lineno">  155</span>}</div>
<div class="ttc" id="apomp_8h_html_a6c490604aea6eace860456a7a4dc5a8d"><div class="ttname"><a href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d">dbetabinom</a></div><div class="ttdeci">static R_INLINE double dbetabinom(double x, double size, double prob, double theta, int give_log)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00320">pomp.h:321</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph.png" border="0" usemap="#adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph" alt=""/></div>
<map name="adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph" id="adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,31"/>
<area shape="rect" href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d" title=" " alt="" coords="164,5,264,31"/>
<area shape="poly" title=" " alt="" coords="116,15,150,15,150,21,116,21"/>
</map>
</div>

</div>
</div>
<a id="aa7cf2dcaaa5333231ed19998fd9dfde6" name="aa7cf2dcaaa5333231ed19998fd9dfde6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7cf2dcaaa5333231ed19998fd9dfde6">&#9670;&#160;</a></span>D_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>rate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00049">49</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                                            {</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><span class="lineno">   51</span>  <span class="keywordtype">int</span> *dim, n;</div>
<div class="line"><span class="lineno">   52</span>  SEXP f;</div>
<div class="line"><span class="lineno">   53</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordflow">if</span> (dim[0] != ntrans)</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;NROW(&#39;x&#39;) should match length of &#39;rate&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">   56</span>  n = dim[1];</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   61</span>  PROTECT(f = NEW_NUMERIC(n));</div>
<div class="line"><span class="lineno">   62</span>  PROTECT(size = AS_NUMERIC(size));</div>
<div class="line"><span class="lineno">   63</span>  PROTECT(rate = AS_NUMERIC(rate));</div>
<div class="line"><span class="lineno">   64</span>  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><span class="lineno">   65</span>  PROTECT(log = AS_LOGICAL(log));</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_function" href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5">deulermultinom_multi</a>(ntrans,n,REAL(size),REAL(rate),REAL(deltat),REAL(x),INTEGER(log),REAL(f));</div>
<div class="line"><span class="lineno">   67</span>  UNPROTECT(5);</div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordflow">return</span> f;</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="adistributions_8c_html_a7f6bc8c3509b09313972b4ccd73c00c5"><div class="ttname"><a href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5">deulermultinom_multi</a></div><div class="ttdeci">static void deulermultinom_multi(int m, int n, double *size, double *rate, double *deltat, double *trans, int *give_log, double *f)</div><div class="ttdef"><b>Definition</b> <a href="distributions_8c_source.html#l00015">distributions.c:15</a></div></div>
<div class="ttc" id="apomp_8h_html_a8224a361dddd2ad59b411982e5ea746f"><div class="ttname"><a href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a></div><div class="ttdeci">#define warn(...)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00022">pomp.h:22</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph.png" border="0" usemap="#adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph" alt=""/></div>
<map name="adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph" id="adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,147,31"/>
<area shape="rect" href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5" title=" " alt="" coords="195,5,361,31"/>
<area shape="poly" title=" " alt="" coords="147,15,181,15,181,21,147,21"/>
<area shape="rect" href="pomp_8h.html#a0ed4cc2bf09ba401406d3175da73226c" title=" " alt="" coords="409,5,536,31"/>
<area shape="poly" title=" " alt="" coords="362,15,396,15,396,21,362,21"/>
</map>
</div>

</div>
</div>
<a id="a6b4fa54c658fe6c6677c51e8346d728c" name="a6b4fa54c658fe6c6677c51e8346d728c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b4fa54c658fe6c6677c51e8346d728c">&#9670;&#160;</a></span>do_dinit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dinit </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>t0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dinit_8c_source.html#l00220">220</a> of file <a class="el" href="dinit_8c_source.html">dinit.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  223</span>   {</div>
<div class="line"><span class="lineno">  224</span>  SEXP F, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, covar;</div>
<div class="line"><span class="lineno">  225</span>  PROTECT(t0=AS_NUMERIC(t0));</div>
<div class="line"><span class="lineno">  226</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(x));</div>
<div class="line"><span class="lineno">  227</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  228</span>  <span class="comment">// extract the process function</span></div>
<div class="line"><span class="lineno">  229</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dinit&quot;</span>)));</div>
<div class="line"><span class="lineno">  230</span>  <span class="comment">// extract other arguments</span></div>
<div class="line"><span class="lineno">  231</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  232</span>  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><span class="lineno">  233</span>  <span class="comment">// evaluate the density</span></div>
<div class="line"><span class="lineno">  234</span>  PROTECT(F = <a class="code hl_function" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9">init_density</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,x,t0,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,covar,log,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><span class="lineno">  235</span>  UNPROTECT(7);</div>
<div class="line"><span class="lineno">  236</span>  <span class="keywordflow">return</span> F;</div>
<div class="line"><span class="lineno">  237</span>}</div>
<div class="ttc" id="adinit_8c_html_aaf4b691dc5d079394332aedad44ea9c9"><div class="ttname"><a href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9">init_density</a></div><div class="ttdeci">static SEXP init_density(SEXP func, SEXP X, SEXP t0, SEXP params, SEXP covar, SEXP log, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition</b> <a href="dinit_8c_source.html#l00097">dinit.c:98</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_ad396407a99088c710b270a9c1dc3aa9d"><div class="ttname"><a href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a></div><div class="ttdeci">static R_INLINE SEXP as_matrix(SEXP x)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00145">pomp_defines.h:145</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae1150d665d648766c28508b57a8cb644"><div class="ttname"><a href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a></div><div class="ttdeci">SEXP fn</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00138">trajectory.c:138</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph.png" border="0" usemap="#adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph" alt=""/></div>
<map name="adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph" id="adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph">
<area shape="rect" title=" " alt="" coords="5,155,80,180"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="134,68,221,93"/>
<area shape="poly" title=" " alt="" coords="62,152,144,99,147,103,65,157"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="128,179,227,204"/>
<area shape="poly" title=" " alt="" coords="81,171,115,178,114,183,80,177"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="303,5,413,31"/>
<area shape="poly" title=" " alt="" coords="207,65,274,39,297,32,298,37,276,45,209,70"/>
<area shape="rect" href="dinit_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="317,55,399,80"/>
<area shape="poly" title=" " alt="" coords="185,177,220,134,245,110,273,89,303,76,305,81,276,94,249,114,224,138,190,180"/>
<area shape="rect" href="dinit_8c.html#ac5823a47b6e0715358465cf3df99ca1e" title=" " alt="" coords="318,104,398,129"/>
<area shape="poly" title=" " alt="" coords="199,176,274,138,304,128,306,133,276,143,201,181"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="277,153,439,179"/>
<area shape="poly" title=" " alt="" coords="226,182,263,177,263,182,227,187"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="275,203,441,228"/>
<area shape="poly" title=" " alt="" coords="227,195,261,200,261,205,226,200"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="287,252,429,277"/>
<area shape="poly" title=" " alt="" coords="203,202,276,237,299,245,297,250,274,242,200,206"/>
<area shape="rect" href="dinit_8c.html#ab9898e68b5f39ca1a0289d0cb11ed576" title=" " alt="" coords="317,301,399,327"/>
<area shape="poly" title=" " alt="" coords="190,203,225,245,249,268,276,288,305,300,303,305,273,292,245,272,221,248,186,206"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="305,351,411,376"/>
<area shape="poly" title=" " alt="" coords="186,203,217,268,243,305,276,337,293,347,291,352,273,341,239,309,213,270,181,205"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="489,203,609,228"/>
<area shape="poly" title=" " alt="" coords="407,249,485,229,486,234,409,255"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="498,252,601,277"/>
<area shape="poly" title=" " alt="" coords="430,262,484,262,484,267,430,267"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="657,252,764,277"/>
<area shape="poly" title=" " alt="" coords="601,262,644,262,644,267,601,267"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="812,252,929,277"/>
<area shape="poly" title=" " alt="" coords="764,262,798,262,798,267,764,267"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="496,301,603,327"/>
<area shape="poly" title=" " alt="" coords="399,311,483,311,483,317,399,317"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="503,351,595,376"/>
<area shape="poly" title=" " alt="" coords="400,322,491,346,489,351,398,327"/>
</map>
</div>

</div>
</div>
<a id="a983ad52a265f059c6e25be89cdf97fd7" name="a983ad52a265f059c6e25be89cdf97fd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983ad52a265f059c6e25be89cdf97fd7">&#9670;&#160;</a></span>do_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dmeasure_8c_source.html#l00111">111</a> of file <a class="el" href="dmeasure_8c_source.html">dmeasure.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  112</span>{</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordtype">int</span> ntimes, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp, nobs;</div>
<div class="line"><span class="lineno">  116</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames;</div>
<div class="line"><span class="lineno">  117</span>  SEXP cvec, pompfun;</div>
<div class="line"><span class="lineno">  118</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ans;</div>
<div class="line"><span class="lineno">  119</span>  SEXP F;</div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  122</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  125</span>  ntimes = length(times);</div>
<div class="line"><span class="lineno">  126</span>  <span class="keywordflow">if</span> (ntimes &lt; 1) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  PROTECT(y = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(y));</div>
<div class="line"><span class="lineno">  129</span>  dim = INTEGER(GET_DIM(y));</div>
<div class="line"><span class="lineno">  130</span>  nobs = dim[0];</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">if</span> (ntimes != dim[1])</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 2nd dimension of &#39;y&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  136</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  143</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(y)));</div>
<div class="line"><span class="lineno">  152</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">  153</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  154</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  157</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  158</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">  162</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dmeasure&quot;</span>)));</div>
<div class="line"><span class="lineno">  163</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  166</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">// create array to store results</span></div>
<div class="line"><span class="lineno">  169</span>  PROTECT(F = <a class="code hl_function" href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763">ret_array</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordtype">int</span> nprotect = 13;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordtype">double</span> *ys = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="comment">// build argument list</span></div>
<div class="line"><span class="lineno">  182</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Onames,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames,log)); nprotect++;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, ys += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>        <span class="comment">// evaluate the call</span></div>
<div class="line"><span class="lineno">  193</span>        PROTECT(</div>
<div class="line"><span class="lineno">  194</span>                ans = <a class="code hl_function" href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c">eval_call</a>(</div>
<div class="line"><span class="lineno">  195</span>                                <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  196</span>                                time,</div>
<div class="line"><span class="lineno">  197</span>                                ys,nobs,</div>
<div class="line"><span class="lineno">  198</span>                                xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  199</span>                                ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  200</span>                                <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  201</span>                                )</div>
<div class="line"><span class="lineno">  202</span>                );</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">if</span> (k == 0 &amp;&amp; j == 0 &amp;&amp; LENGTH(ans) != 1)</div>
<div class="line"><span class="lineno">  205</span>          <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;dmeasure&#39; returns a vector of length %d when it should return a scalar.&quot;</span>,LENGTH(ans));</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>        *ft = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>        UNPROTECT(1);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>      }</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>  }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordtype">int</span> give_log;</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_typedef" href="pomp_8h.html#a512b62346ff39e290130b66f0498805a">pomp_dmeasure</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordtype">double</span> *yp = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">// extract state, parameter, covariate, observable indices</span></div>
<div class="line"><span class="lineno">  227</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  228</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  229</span>    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  230</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  235</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, yp += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  242</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>        xp = &amp;xs[<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><span class="lineno">  247</span>        pp = &amp;ps[<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>        (*ff)(ft,yp,xp,pp,give_log,oidx,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>      }</div>
<div class="line"><span class="lineno">  252</span>    }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  }</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  263</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  264</span>        *ft = R_NaReal;</div>
<div class="line"><span class="lineno">  265</span>      }</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;dmeasure&#39; unspecified: likelihood undefined.&quot;</span>);</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  }</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">return</span> F;</div>
<div class="line"><span class="lineno">  276</span>}</div>
<div class="ttc" id="adecls_8h_html_a8fc25ac8149dbd6da367aa01dd9ad9ed"><div class="ttname"><a href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a></div><div class="ttdeci">lookup_table_t make_covariate_table(SEXP, int *)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00011">lookup_table.c:11</a></div></div>
<div class="ttc" id="adecls_8h_html_ada19523cc1edc44a799fce734f25c934"><div class="ttname"><a href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a></div><div class="ttdeci">SEXP pomp_fun_handler(SEXP, SEXP, pompfunmode *, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="pomp__fun_8c_source.html#l00030">pomp_fun.c:30</a></div></div>
<div class="ttc" id="adecls_8h_html_ade6439566617e54cb9f4507f7ad2824f"><div class="ttname"><a href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a></div><div class="ttdeci">void table_lookup(lookup_table_t *, double, double *)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00053">lookup_table.c:53</a></div></div>
<div class="ttc" id="adecls_8h_html_ae6345040eb63a38c0ff7ae42f3ea35ff"><div class="ttname"><a href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a></div><div class="ttdeci">SEXP get_covariate_names(SEXP)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00007">lookup_table.c:7</a></div></div>
<div class="ttc" id="admeasure_8c_html_a7ef96aa5550bad09e38528b3b9b91b3b"><div class="ttname"><a href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Onames, SEXP Snames, SEXP Pnames, SEXP Cnames, SEXP log)</div><div class="ttdef"><b>Definition</b> <a href="dmeasure_8c_source.html#l00010">dmeasure.c:11</a></div></div>
<div class="ttc" id="admeasure_8c_html_a9a858c8c108cd54973666dd765f8718c"><div class="ttname"><a href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *y, int nobs, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="dmeasure_8c_source.html#l00075">dmeasure.c:75</a></div></div>
<div class="ttc" id="admeasure_8c_html_af4fb5592481eef6dc2aaf6f158871763"><div class="ttname"><a href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nreps, int ntimes)</div><div class="ttdef"><b>Definition</b> <a href="dmeasure_8c_source.html#l00101">dmeasure.c:101</a></div></div>
<div class="ttc" id="apomp_8h_html_a512b62346ff39e290130b66f0498805a"><div class="ttname"><a href="pomp_8h.html#a512b62346ff39e290130b66f0498805a">pomp_dmeasure</a></div><div class="ttdeci">void pomp_dmeasure(double *lik, const double *y, const double *x, const double *p, int give_log, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00085">pomp.h:86</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a8b775a55898690bdc11c348d0b5dc8c1"><div class="ttname"><a href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a></div><div class="ttdeci">static R_INLINE SEXP as_state_array(SEXP x)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00183">pomp_defines.h:183</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a></div><div class="ttdeci">pompfunmode</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a></div><div class="ttdeci">@ Rfun</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a></div><div class="ttdeci">@ native</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a></div><div class="ttdeci">@ undef</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a></div><div class="ttdeci">@ regNative</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="astructlookup__table__t_html"><div class="ttname"><a href="structlookup__table__t.html">lookup_table_t</a></div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00020">pomp_defines.h:20</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a14099a72d03b2c4a17df78083aaefedb"><div class="ttname"><a href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a></div><div class="ttdeci">int npars</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00132">trajectory.c:132</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a4edeebb04b42d65deaf721d0abbc091e"><div class="ttname"><a href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div><div class="ttdeci">int ncovars</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00133">trajectory.c:133</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a6c1c1c275092d79f830aa36620cfd33d"><div class="ttname"><a href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a></div><div class="ttdeci">pompfunmode mode</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00126">trajectory.c:126</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a72f66d373d52ab42fd8af134bd7f9cda"><div class="ttname"><a href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div><div class="ttdeci">int nreps</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00134">trajectory.c:134</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac0e9686ed371713a6e6717115c66f602"><div class="ttname"><a href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a></div><div class="ttdeci">SEXP cov</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00129">trajectory.c:129</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00131">trajectory.c:131</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph.png" border="0" usemap="#adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph" alt=""/></div>
<map name="adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph" id="adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,116,228"/>
<area shape="rect" href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b" title=" " alt="" coords="207,5,288,31"/>
<area shape="poly" title=" " alt="" coords="63,201,75,169,95,125,124,79,162,40,192,25,195,29,166,44,129,83,100,128,80,171,68,203"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,55,291,80"/>
<area shape="poly" title=" " alt="" coords="67,201,103,147,130,116,163,89,190,76,192,81,165,94,134,120,107,150,71,204"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,104,307,129"/>
<area shape="poly" title=" " alt="" coords="74,200,113,170,163,138,179,131,181,136,165,143,116,174,78,205"/>
<area shape="rect" href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c" title=" " alt="" coords="207,153,287,179"/>
<area shape="poly" title=" " alt="" coords="109,200,193,177,195,183,110,205"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="166,203,329,228"/>
<area shape="poly" title=" " alt="" coords="116,213,152,213,152,218,116,218"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="164,252,331,277"/>
<area shape="poly" title=" " alt="" coords="110,225,186,246,185,251,109,231"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="176,301,319,327"/>
<area shape="poly" title=" " alt="" coords="79,226,117,256,165,286,184,294,181,299,163,291,113,261,75,231"/>
<area shape="rect" href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763" title=" " alt="" coords="207,351,288,376"/>
<area shape="poly" title=" " alt="" coords="71,227,107,281,134,311,165,337,195,351,192,355,163,342,130,315,103,284,67,230"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="195,400,300,425"/>
<area shape="poly" title=" " alt="" coords="68,228,80,260,100,303,129,348,166,387,183,397,181,402,162,391,124,351,95,306,75,262,63,229"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,80,494,105"/>
<area shape="poly" title=" " alt="" coords="291,70,370,81,370,86,291,76"/>
<area shape="poly" title=" " alt="" coords="306,107,369,99,369,104,307,112"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,252,499,277"/>
<area shape="poly" title=" " alt="" coords="297,299,374,278,376,284,298,304"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,301,490,327"/>
<area shape="poly" title=" " alt="" coords="319,311,373,311,373,317,319,317"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,301,653,327"/>
<area shape="poly" title=" " alt="" coords="490,311,533,311,533,317,490,317"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,301,819,327"/>
<area shape="poly" title=" " alt="" coords="654,311,687,311,687,317,654,317"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,351,492,376"/>
<area shape="poly" title=" " alt="" coords="288,361,372,361,372,366,288,366"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,400,485,425"/>
<area shape="poly" title=" " alt="" coords="289,371,380,395,379,400,288,376"/>
</map>
</div>

</div>
</div>
<a id="a2d3d47b7ef5f3a691582c1000108cdb7" name="a2d3d47b7ef5f3a691582c1000108cdb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d3d47b7ef5f3a691582c1000108cdb7">&#9670;&#160;</a></span>do_dprior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprior </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprior_8c_source.html#l00051">51</a> of file <a class="el" href="dprior_8c_source.html">dprior.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>{</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   56</span>  SEXP Pnames, pompfun, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   60</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">   66</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprior&quot;</span>)));</div>
<div class="line"><span class="lineno">   67</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">   70</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>  <span class="comment">// to store results</span></div>
<div class="line"><span class="lineno">   73</span>  PROTECT(F = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>));</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordtype">int</span> nprotect = 6;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">   78</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">   79</span>    SEXP ans;</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169">add_args</a>(Pnames,log,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>)); nprotect++;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(F); j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++) {</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>      PROTECT(ans = <a class="code hl_function" href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><span class="lineno">   88</span>      *pt = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><span class="lineno">   89</span>      UNPROTECT(1);</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="line"><span class="lineno">   92</span>  }</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordtype">int</span> give_log, *pidx = 0;</div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_typedef" href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a> *ff = NULL;</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="comment">// construct state, parameter, covariate, observable indices</span></div>
<div class="line"><span class="lineno">  103</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  106</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    R_CheckUserInterrupt();     <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">for</span> (j = 0, pt = REAL(F), ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++)</div>
<div class="line"><span class="lineno">  114</span>      (*ff)(pt,ps,give_log,pidx);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordtype">int</span> give_log, j;</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordtype">double</span> *pt;</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">for</span> (j = 0, pt = REAL(F); j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pt++)</div>
<div class="line"><span class="lineno">  128</span>      *pt = (give_log) ? 0.0 : 1.0;</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  135</span>  <span class="keywordflow">return</span> F;</div>
<div class="line"><span class="lineno">  136</span>}</div>
<div class="ttc" id="adprior_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition</b> <a href="dprior_8c_source.html#l00034">dprior.c:34</a></div></div>
<div class="ttc" id="adprior_8c_html_a2136fa17c5e1e54de6d6a4e5fe62f169"><div class="ttname"><a href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP names, SEXP log, SEXP args)</div><div class="ttdef"><b>Definition</b> <a href="dprior_8c_source.html#l00010">dprior.c:10</a></div></div>
<div class="ttc" id="apomp_8h_html_a3faa3c7fe8f69a8f03b0cf34bb6d66b6"><div class="ttname"><a href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a></div><div class="ttdeci">void pomp_dprior(double *lik, const double *p, int give_log, const int *parindex)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00110">pomp.h:111</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph.png" border="0" usemap="#adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph" alt=""/></div>
<map name="adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph" id="adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,88,105"/>
<area shape="rect" href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169" title=" " alt="" coords="167,5,248,31"/>
<area shape="poly" title=" " alt="" coords="66,78,135,40,153,32,155,37,137,44,69,82"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="164,55,251,80"/>
<area shape="poly" title=" " alt="" coords="88,84,150,74,150,79,89,89"/>
<area shape="rect" href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="167,104,247,129"/>
<area shape="poly" title=" " alt="" coords="89,96,154,106,153,111,88,101"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="136,153,279,179"/>
<area shape="poly" title=" " alt="" coords="70,103,137,138,156,146,154,151,135,143,68,108"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="331,55,442,80"/>
<area shape="poly" title=" " alt="" coords="251,65,318,65,318,70,251,70"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="327,128,447,153"/>
<area shape="poly" title=" " alt="" coords="279,153,313,148,313,154,279,159"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="335,177,438,203"/>
<area shape="poly" title=" " alt="" coords="279,173,322,179,321,184,279,178"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="495,177,601,203"/>
<area shape="poly" title=" " alt="" coords="438,187,481,187,481,193,438,193"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="649,177,767,203"/>
<area shape="poly" title=" " alt="" coords="602,187,635,187,635,193,602,193"/>
</map>
</div>

</div>
</div>
<a id="a6ef1a476d6745db7455441c65c74fd61" name="a6ef1a476d6745db7455441c65c74fd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef1a476d6745db7455441c65c74fd61">&#9670;&#160;</a></span>do_dprocess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprocess_8c_source.html#l00273">273</a> of file <a class="el" href="dprocess_8c_source.html">dprocess.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  274</span>{</div>
<div class="line"><span class="lineno">  275</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, covar;</div>
<div class="line"><span class="lineno">  276</span>  PROTECT(times=AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  277</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  278</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  279</span>  <span class="comment">// extract the process function</span></div>
<div class="line"><span class="lineno">  280</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprocess&quot;</span>)));</div>
<div class="line"><span class="lineno">  281</span>  <span class="comment">// extract other arguments</span></div>
<div class="line"><span class="lineno">  282</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  283</span>  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">// evaluate the density</span></div>
<div class="line"><span class="lineno">  285</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611">onestep_density</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,x,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,covar,log,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><span class="lineno">  286</span>  UNPROTECT(7);</div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  288</span>}</div>
<div class="ttc" id="adprocess_8c_html_af743054a6e56b1e76d6ee59866b22611"><div class="ttname"><a href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611">onestep_density</a></div><div class="ttdeci">static SEXP onestep_density(SEXP func, SEXP x, SEXP times, SEXP params, SEXP covar, SEXP log, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition</b> <a href="dprocess_8c_source.html#l00127">dprocess.c:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph.png" border="0" usemap="#adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph" alt=""/></div>
<map name="adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph" id="adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,108,80"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="177,5,264,31"/>
<area shape="poly" title=" " alt="" coords="99,52,164,32,165,37,100,57"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="161,55,280,80"/>
<area shape="poly" title=" " alt="" coords="108,65,148,65,148,70,108,70"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="156,177,285,203"/>
<area shape="poly" title=" " alt="" coords="77,78,193,167,190,171,74,83"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="361,5,472,31"/>
<area shape="poly" title=" " alt="" coords="264,15,348,15,348,21,264,21"/>
<area shape="poly" title=" " alt="" coords="271,52,351,32,353,37,272,57"/>
<area shape="rect" href="dprocess_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="376,55,457,80"/>
<area shape="poly" title=" " alt="" coords="231,175,273,133,301,109,332,89,362,76,364,81,335,94,304,114,276,137,235,179"/>
<area shape="rect" href="dprocess_8c.html#a7853b2436f140d9aa7ca0bac61dc21c6" title=" " alt="" coords="377,104,457,129"/>
<area shape="poly" title=" " alt="" coords="247,175,332,138,363,128,364,133,334,143,249,180"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="335,153,498,179"/>
<area shape="poly" title=" " alt="" coords="286,179,321,175,322,180,286,185"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="333,203,500,228"/>
<area shape="poly" title=" " alt="" coords="286,196,320,200,319,205,285,201"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="345,252,488,277"/>
<area shape="poly" title=" " alt="" coords="250,200,334,237,359,245,357,250,332,242,248,205"/>
<area shape="rect" href="dprocess_8c.html#af4fb5592481eef6dc2aaf6f158871763" title=" " alt="" coords="376,301,457,327"/>
<area shape="poly" title=" " alt="" coords="235,201,276,243,304,267,335,288,364,300,362,305,332,292,301,271,272,247,231,205"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="364,351,469,376"/>
<area shape="poly" title=" " alt="" coords="230,202,268,267,298,305,335,337,352,347,349,351,332,342,295,308,264,270,226,204"/>
<area shape="rect" href="dprocess_8c.html#a7113f106ccbbafb6a71989d6f6e9811d" title=" " alt="" coords="575,55,641,80"/>
<area shape="poly" title=" " alt="" coords="458,65,560,65,560,70,458,70"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="548,203,668,228"/>
<area shape="poly" title=" " alt="" coords="466,249,544,229,545,234,467,255"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="557,252,659,277"/>
<area shape="poly" title=" " alt="" coords="488,262,543,262,543,267,488,267"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="716,252,823,277"/>
<area shape="poly" title=" " alt="" coords="660,262,702,262,702,267,660,267"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="871,252,988,277"/>
<area shape="poly" title=" " alt="" coords="823,262,857,262,857,267,823,267"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="555,301,661,327"/>
<area shape="poly" title=" " alt="" coords="458,311,541,311,541,317,458,317"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="562,351,654,376"/>
<area shape="poly" title=" " alt="" coords="458,322,549,346,548,351,457,327"/>
</map>
</div>

</div>
</div>
<a id="ac1ec1439680776719b9b8b9ebdbf9a33" name="ac1ec1439680776719b9b8b9ebdbf9a33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1ec1439680776719b9b8b9ebdbf9a33">&#9670;&#160;</a></span>do_emeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_emeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emeasure_8c_source.html#l00098">98</a> of file <a class="el" href="emeasure_8c_source.html">emeasure.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>{</div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordtype">int</span> ntimes, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><span class="lineno">  103</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><span class="lineno">  104</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">  105</span>  SEXP pompfun;</div>
<div class="line"><span class="lineno">  106</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  109</span>  SEXP cvec;</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  113</span>  ntimes = length(times);</div>
<div class="line"><span class="lineno">  114</span>  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  118</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  125</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;emeasure&quot;</span>)));</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">  136</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  137</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  138</span>  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  141</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  142</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">  146</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  149</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">// first do setup</span></div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  160</span>    SEXP ans;</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>          PROTECT(</div>
<div class="line"><span class="lineno">  176</span>                  ans = <a class="code hl_function" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  177</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  178</span>                                  time,</div>
<div class="line"><span class="lineno">  179</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  180</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  181</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  182</span>                                  )</div>
<div class="line"><span class="lineno">  183</span>                  );</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>          nobs = LENGTH(ans);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  188</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>          PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>          nprotect += 3;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>          yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  196</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  199</span>          yt += nobs;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>          first = 0;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>          PROTECT(</div>
<div class="line"><span class="lineno">  206</span>                  ans = <a class="code hl_function" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  207</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  208</span>                                  time,</div>
<div class="line"><span class="lineno">  209</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  210</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  211</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  212</span>                                  )</div>
<div class="line"><span class="lineno">  213</span>                  );</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><span class="lineno">  216</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  221</span>          yt += nobs;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>          UNPROTECT(1);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>      }</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  }</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_typedef" href="pomp_8h.html#a3f0c4a869b9b0e27422e503eaf380bd5">pomp_emeasure</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><span class="lineno">  243</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  244</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  245</span>    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  246</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  249</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><span class="lineno">  252</span>    yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  259</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>        xp = &amp;xs[<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><span class="lineno">  264</span>        pp = &amp;ps[<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>      }</div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>  }</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  276</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><span class="lineno">  278</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordtype">int</span> i, n = nobs*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,dim)); nprotect++;</div>
<div class="line"><span class="lineno">  283</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><span class="lineno">  284</span>    <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><span class="lineno">  289</span>  }</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>  }</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  294</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">  295</span>}</div>
<div class="ttc" id="aemeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="emeasure_8c_source.html#l00060">emeasure.c:60</a></div></div>
<div class="ttc" id="aemeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="emeasure_8c_source.html#l00010">emeasure.c:10</a></div></div>
<div class="ttc" id="aemeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="emeasure_8c_source.html#l00084">emeasure.c:84</a></div></div>
<div class="ttc" id="apomp_8h_html_a3f0c4a869b9b0e27422e503eaf380bd5"><div class="ttname"><a href="pomp_8h.html#a3f0c4a869b9b0e27422e503eaf380bd5">pomp_emeasure</a></div><div class="ttdeci">void pomp_emeasure(double *f, const double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00092">pomp.h:93</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a263b864ea80d9008e4c96ffe013f1dff"><div class="ttname"><a href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a></div><div class="ttdeci">static R_INLINE void fixdimnames(SEXP x, const char **names, int n)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00129">pomp_defines.h:129</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_ac56010c8d35a155162376d066856f663"><div class="ttname"><a href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a></div><div class="ttdeci">static R_INLINE int invalid_names(SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00055">pomp_defines.h:55</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph.png" border="0" usemap="#adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph" alt=""/></div>
<map name="adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph" id="adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph">
<area shape="rect" title=" " alt="" coords="5,308,116,333"/>
<area shape="rect" href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="207,5,288,31"/>
<area shape="poly" title=" " alt="" coords="61,308,68,260,84,191,97,153,115,115,136,80,162,48,192,29,195,33,166,52,140,83,119,118,102,155,89,193,73,261,66,308"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,107,291,132"/>
<area shape="poly" title=" " alt="" coords="63,307,75,274,95,229,124,182,162,141,190,127,192,132,166,145,128,185,100,231,80,276,68,309"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,132,494,157"/>
<area shape="poly" title=" " alt="" coords="60,307,67,264,84,204,97,172,114,141,136,114,163,92,193,77,226,71,260,72,293,77,356,98,407,123,404,128,354,103,292,82,259,77,226,77,195,83,165,96,140,118,118,144,102,174,89,205,72,265,66,308"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,156,307,181"/>
<area shape="poly" title=" " alt="" coords="68,306,105,255,132,225,162,198,188,184,190,189,166,203,135,229,109,258,72,309"/>
<area shape="rect" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="207,359,287,384"/>
<area shape="poly" title=" " alt="" coords="109,331,195,354,193,360,108,336"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,232,492,257"/>
<area shape="poly" title=" " alt="" coords="72,306,110,272,135,255,163,242,217,230,272,225,325,226,372,231,371,236,325,232,272,231,218,235,165,247,138,260,113,276,75,310"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="166,408,329,433"/>
<area shape="poly" title=" " alt="" coords="78,331,116,362,165,393,184,401,181,406,163,398,113,366,75,336"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,484,819,509"/>
<area shape="poly" title=" " alt="" coords="70,332,105,388,132,418,165,442,194,451,245,459,388,473,688,491,687,496,387,478,244,464,193,456,163,447,129,422,101,391,66,335"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="164,559,331,584"/>
<area shape="poly" title=" " alt="" coords="67,333,76,374,94,431,123,492,143,520,166,544,174,550,171,554,162,548,138,523,118,494,89,433,70,375,61,334"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,295,485,320"/>
<area shape="poly" title=" " alt="" coords="116,316,379,307,379,312,116,321"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="176,509,319,535"/>
<area shape="poly" title=" " alt="" coords="69,333,81,364,102,405,130,449,166,488,187,502,184,506,162,492,126,453,97,408,77,366,64,335"/>
<area shape="rect" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="207,257,288,283"/>
<area shape="poly" title=" " alt="" coords="108,305,193,282,194,287,109,310"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="195,608,300,633"/>
<area shape="poly" title=" " alt="" coords="65,334,71,383,87,453,100,491,117,529,139,564,166,595,183,606,180,611,162,599,135,567,112,531,95,493,82,454,66,383,60,334"/>
<area shape="poly" title=" " alt="" coords="291,122,370,133,370,138,291,128"/>
<area shape="poly" title=" " alt="" coords="306,159,369,151,369,156,307,164"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,559,499,584"/>
<area shape="poly" title=" " alt="" coords="298,532,376,552,374,558,297,537"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,509,490,535"/>
<area shape="poly" title=" " alt="" coords="319,519,373,519,373,525,319,525"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,509,653,535"/>
<area shape="poly" title=" " alt="" coords="490,519,533,519,533,525,490,525"/>
<area shape="poly" title=" " alt="" coords="653,511,687,505,688,511,654,516"/>
<area shape="poly" title=" " alt="" coords="266,255,405,163,408,167,269,260"/>
<area shape="poly" title=" " alt="" coords="288,262,372,251,372,256,289,267"/>
<area shape="poly" title=" " alt="" coords="289,275,380,293,379,298,288,280"/>
</map>
</div>

</div>
</div>
<a id="ab6ee70ea223bd1cd7359810d1e0c8a49" name="ab6ee70ea223bd1cd7359810d1e0c8a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ee70ea223bd1cd7359810d1e0c8a49">&#9670;&#160;</a></span>do_partrans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_partrans </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>dir</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="partrans_8c_source.html#l00049">49</a> of file <a class="el" href="partrans_8c_source.html">partrans.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>{</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  SEXP Pnames, tparams, pompfun, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ob;</div>
<div class="line"><span class="lineno">   53</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_enumeration" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a> direc;</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordtype">int</span> qvec, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  qvec = isNull(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <span class="comment">// is &#39;params&#39; a vector?</span></div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  PROTECT(tparams = duplicate(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <span class="comment">// coerce &#39;params&#39; to matrix</span></div>
<div class="line"><span class="lineno">   63</span>  PROTECT(tparams = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(tparams));</div>
<div class="line"><span class="lineno">   64</span>  dim = INTEGER(GET_DIM(tparams));</div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams)));</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="comment">// determine direction of transformation and extract corresponding pomp_fun</span></div>
<div class="line"><span class="lineno">   70</span>  direc = (<a class="code hl_enumeration" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a>) *(INTEGER(dir));</div>
<div class="line"><span class="lineno">   71</span>  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;partrans&quot;</span>)));</div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordflow">switch</span> (direc) {</div>
<div class="line"><span class="lineno">   73</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a>: <span class="keywordflow">default</span>:   <span class="comment">// from estimation scale</span></div>
<div class="line"><span class="lineno">   74</span>    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;from&quot;</span>)));</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a>:                      <span class="comment">// to estimation scale</span></div>
<div class="line"><span class="lineno">   77</span>    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;to&quot;</span>)));</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   79</span>  }</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">   84</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    SEXP ans, nm;</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordtype">double</span> *pa, *ps = REAL(tparams);</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordtype">int</span> *posn;</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames));</div>
<div class="line"><span class="lineno">   98</span>    PROTECT(ans = <a class="code hl_function" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><span class="lineno">  102</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user transformation functions must return named numeric vectors.&quot;</span>);</div>
<div class="line"><span class="lineno">  103</span>    posn = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    nprotect += 4;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> (j = 1, ps += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>      PROTECT(ans = <a class="code hl_function" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><span class="lineno">  114</span>      pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  115</span>      <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><span class="lineno">  116</span>      UNPROTECT(1);</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    }</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  }</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_typedef" href="pomp_8h.html#ad6fffa3f10a13bfb8faf085bc4f4c953">pomp_transform</a> *ff;</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordtype">int</span> *idx;</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    idx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(tparams); j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><span class="lineno">  138</span>      (*ff)(pt,ps,idx);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">break</span>;  <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  }</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">if</span> (qvec) {</div>
<div class="line"><span class="lineno">  151</span>    PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams))); nprotect++;</div>
<div class="line"><span class="lineno">  152</span>    SET_DIM(tparams,R_NilValue);</div>
<div class="line"><span class="lineno">  153</span>    SET_NAMES(tparams,Pnames);</div>
<div class="line"><span class="lineno">  154</span>  }</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">return</span> tparams;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>}</div>
<div class="ttc" id="apartrans_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition</b> <a href="partrans_8c_source.html#l00033">partrans.c:33</a></div></div>
<div class="ttc" id="apartrans_8c_html_ad0f00e555a10801616b1d7f177d88ec3"><div class="ttname"><a href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="partrans_8c_source.html#l00012">partrans.c:12</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6b"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a></div><div class="ttdeci">direction_t</div><div class="ttdef"><b>Definition</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a></div><div class="ttdeci">@ from</div><div class="ttdef"><b>Definition</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a></div><div class="ttdeci">@ to</div><div class="ttdef"><b>Definition</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apomp_8h_html_ad6fffa3f10a13bfb8faf085bc4f4c953"><div class="ttname"><a href="pomp_8h.html#ad6fffa3f10a13bfb8faf085bc4f4c953">pomp_transform</a></div><div class="ttdeci">void pomp_transform(double *pt, const double *p, const int *parindex)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00114">pomp.h:115</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a76a484fb785e5a4b35f15e41a1b8fc1b"><div class="ttname"><a href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a></div><div class="ttdeci">static R_INLINE SEXP matchnames(SEXP provided, SEXP needed, const char *where)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00059">pomp_defines.h:60</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph.png" border="0" usemap="#adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph" alt=""/></div>
<map name="adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph" id="adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,104,155"/>
<area shape="rect" href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3" title=" " alt="" coords="183,5,264,31"/>
<area shape="poly" title=" " alt="" coords="63,127,98,85,123,61,151,40,168,30,171,35,153,44,126,65,102,88,67,131"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="180,55,267,80"/>
<area shape="poly" title=" " alt="" coords="77,127,151,89,167,82,169,87,153,94,79,131"/>
<area shape="rect" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="183,104,263,129"/>
<area shape="poly" title=" " alt="" coords="104,132,169,122,170,127,104,137"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="665,180,783,205"/>
<area shape="poly" title=" " alt="" coords="105,143,652,185,651,190,104,148"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="511,205,617,231"/>
<area shape="poly" title=" " alt="" coords="79,152,113,169,153,183,245,202,338,212,425,217,497,217,497,223,425,222,338,217,244,207,151,189,111,174,77,157"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="152,256,295,281"/>
<area shape="poly" title=" " alt="" coords="69,153,104,192,154,234,177,248,174,252,150,239,101,196,65,157"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="347,55,458,80"/>
<area shape="poly" title=" " alt="" coords="267,65,334,65,334,70,267,70"/>
<area shape="poly" title=" " alt="" coords="617,207,651,201,652,207,618,212"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="343,256,463,281"/>
<area shape="poly" title=" " alt="" coords="295,266,329,266,329,271,295,271"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="351,305,454,331"/>
<area shape="poly" title=" " alt="" coords="271,279,343,299,341,304,269,284"/>
<area shape="poly" title=" " alt="" coords="438,303,461,292,501,265,536,238,539,242,505,269,464,296,441,308"/>
</map>
</div>

</div>
</div>
<a id="ab3de8f433818929ff221b26769ed9e6c" name="ab3de8f433818929ff221b26769ed9e6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3de8f433818929ff221b26769ed9e6c">&#9670;&#160;</a></span>do_rinit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rinit </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>t0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>nsim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rinit_8c_source.html#l00091">91</a> of file <a class="el" href="rinit_8c_source.html">rinit.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>{</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  SEXP Pnames, Cnames, <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, pcnames;</div>
<div class="line"><span class="lineno">   95</span>  SEXP x = R_NilValue;</div>
<div class="line"><span class="lineno">   96</span>  SEXP pompfun, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">   97</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">   98</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">   99</span>  SEXP cvec;</div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordtype">int</span> npar, nrep, nvar, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nsims, ns;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  nsims = *(INTEGER(AS_INTEGER(nsim)));</div>
<div class="line"><span class="lineno">  105</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  106</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  107</span>  PROTECT(pcnames = GET_COLNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  110</span>  npar = dim[0]; nrep = dim[1];</div>
<div class="line"><span class="lineno">  111</span>  ns = nsims*nrep;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  114</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  115</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  116</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*(REAL(t0)),<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="comment">// extract userdata</span></div>
<div class="line"><span class="lineno">  122</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rinit&quot;</span>)));</div>
<div class="line"><span class="lineno">  125</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    SEXP ans;</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordtype">double</span> *time = REAL(AS_NUMERIC(t0));</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordtype">double</span> *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordtype">double</span> *xs, *xt = NULL;</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordtype">int</span> *midx;</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames,Cnames));</div>
<div class="line"><span class="lineno">  142</span>    PROTECT(ans = <a class="code hl_function" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps,npar,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  143</span>    PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  144</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))</div>
<div class="line"><span class="lineno">  147</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    nvar = LENGTH(ans);</div>
<div class="line"><span class="lineno">  150</span>    xs = REAL(ans);</div>
<div class="line"><span class="lineno">  151</span>    midx = INTEGER(PROTECT(match(Pnames,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,0)));</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">for</span> (j = 0; j &lt; nvar; j++) {</div>
<div class="line"><span class="lineno">  154</span>      <span class="keywordflow">if</span> (midx[j] != 0)</div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;a state variable and a parameter share the name: &#39;%s&#39;.&quot;</span>,CHAR(STRING_ELT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,j)));</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    PROTECT(x = <a class="code hl_function" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a>(nvar,ns,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  159</span>    xt = REAL(x);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    nprotect += 6;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> (j = 1, xt += nvar; j &lt; ns; j++, xt += nvar) {</div>
<div class="line"><span class="lineno">  166</span>      PROTECT(ans = <a class="code hl_function" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps+npar*(j%nrep),npar,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  167</span>      xs = REAL(ans);</div>
<div class="line"><span class="lineno">  168</span>      <span class="keywordflow">if</span> (LENGTH(ans) != nvar)</div>
<div class="line"><span class="lineno">  169</span>        <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; returns vectors of variable length.&quot;</span>);</div>
<div class="line"><span class="lineno">  170</span>      memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  171</span>      UNPROTECT(1);</div>
<div class="line"><span class="lineno">  172</span>    }</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  }</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordtype">double</span> *xt, *ps, time;</div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_typedef" href="pomp_8h.html#a849cb5008ab19114475e2730a51ff9d7">pomp_rinit</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    nvar = *INTEGER(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;nstatevars&quot;</span>)));</div>
<div class="line"><span class="lineno">  186</span>    PROTECT(x = <a class="code hl_function" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a>(nvar,ns,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)); nprotect++;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  189</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  190</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  193</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    GetRNGstate();</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    time = *(REAL(t0));</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">for</span> (j = 0, xt = REAL(x), ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; ns; j++, xt += nvar)</div>
<div class="line"><span class="lineno">  201</span>      (*ff)(xt,ps+npar*(j%nrep),time,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>    PutRNGstate();</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>  }</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    PROTECT(x = <a class="code hl_function" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede">pomp_default_rinit</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,Pnames,npar,nrep,ns)); nprotect++;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>  }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  }</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">// now add column names</span></div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordflow">if</span> (nrep &gt; 1) {</div>
<div class="line"><span class="lineno">  221</span>    SEXP dn, xn;</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordtype">int</span> k, *p;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">if</span> (isNull(pcnames)) {</div>
<div class="line"><span class="lineno">  225</span>      PROTECT(pcnames = NEW_INTEGER(nrep)); nprotect++;</div>
<div class="line"><span class="lineno">  226</span>      <span class="keywordflow">for</span> (k = 0, p = INTEGER(pcnames); k &lt; nrep; k++, p++) *p = k+1;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><span class="lineno">  230</span>      <span class="keywordtype">int</span> k, *sp;</div>
<div class="line"><span class="lineno">  231</span>      SEXP us;</div>
<div class="line"><span class="lineno">  232</span>      PROTECT(us = mkString(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><span class="lineno">  233</span>      PROTECT(xn = NEW_INTEGER(ns));</div>
<div class="line"><span class="lineno">  234</span>      <span class="keywordflow">for</span> (k = 0, sp = INTEGER(xn); k &lt; ns; k++, sp++) *sp = (k/nrep)+1;</div>
<div class="line"><span class="lineno">  235</span>      PROTECT(xn = <a class="code hl_function" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416">paste0</a>(pcnames,us,xn));</div>
<div class="line"><span class="lineno">  236</span>      PROTECT(dn = GET_DIMNAMES(x));</div>
<div class="line"><span class="lineno">  237</span>      nprotect += 4;</div>
<div class="line"><span class="lineno">  238</span>      SET_ELEMENT(dn,1,xn);</div>
<div class="line"><span class="lineno">  239</span>      SET_DIMNAMES(x,dn);</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>      PROTECT(dn = GET_DIMNAMES(x)); nprotect++;</div>
<div class="line"><span class="lineno">  244</span>      SET_ELEMENT(dn,1,pcnames);</div>
<div class="line"><span class="lineno">  245</span>      SET_DIMNAMES(x,dn);</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    }</div>
<div class="line"><span class="lineno">  248</span>  }</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  251</span>  <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  252</span>}</div>
<div class="ttc" id="apomp_8h_html_a849cb5008ab19114475e2730a51ff9d7"><div class="ttname"><a href="pomp_8h.html#a849cb5008ab19114475e2730a51ff9d7">pomp_rinit</a></div><div class="ttdeci">void pomp_rinit(double *x, const double *p, double t0, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00039">pomp.h:40</a></div></div>
<div class="ttc" id="arinit_8c_html_a1d34a269c2da0e05ebce19a2d07bf123"><div class="ttname"><a href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int m, int n, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00079">rinit.c:79</a></div></div>
<div class="ttc" id="arinit_8c_html_a4d765252bd25e8eb50da6837a15b5416"><div class="ttname"><a href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416">paste0</a></div><div class="ttdeci">static R_INLINE SEXP paste0(SEXP a, SEXP b, SEXP c)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00010">rinit.c:10</a></div></div>
<div class="ttc" id="arinit_8c_html_a966f509fab1f9d9e38fc64d7e5773ede"><div class="ttname"><a href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede">pomp_default_rinit</a></div><div class="ttdeci">static SEXP pomp_default_rinit(SEXP params, SEXP Pnames, int npar, int nrep, int nsim)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00254">rinit.c:254</a></div></div>
<div class="ttc" id="arinit_8c_html_ac243dd8b5b0b777968905b257e24dc9c"><div class="ttname"><a href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t0, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00058">rinit.c:59</a></div></div>
<div class="ttc" id="arinit_8c_html_afdfe8d3f0939427e72c44c0e4f3bb102"><div class="ttname"><a href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00021">rinit.c:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph.png" border="0" usemap="#adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph" alt=""/></div>
<map name="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph" id="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph">
<area shape="rect" title=" " alt="" coords="5,255,76,280"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="167,5,248,31"/>
<area shape="poly" title=" " alt="" coords="40,254,45,213,58,156,82,94,100,65,122,40,136,30,152,23,154,28,139,35,126,44,104,68,87,96,63,157,50,214,45,255"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="164,55,251,80"/>
<area shape="poly" title=" " alt="" coords="42,254,49,221,64,177,88,130,104,108,122,89,149,74,152,79,126,93,108,112,93,133,69,179,55,222,47,255"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="167,104,247,129"/>
<area shape="poly" title=" " alt="" coords="44,253,72,198,94,166,122,138,153,123,155,128,126,143,98,169,76,201,49,256"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="126,153,289,179"/>
<area shape="poly" title=" " alt="" coords="53,253,83,225,123,196,152,181,154,186,125,200,86,229,56,257"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="661,329,779,355"/>
<area shape="poly" title=" " alt="" coords="75,252,124,239,262,224,319,224,372,228,480,251,614,290,651,304,685,320,683,325,649,309,612,295,478,256,371,234,319,229,262,230,124,245,76,257"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="124,255,291,280"/>
<area shape="poly" title=" " alt="" coords="76,265,110,265,110,270,76,270"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="174,304,241,329"/>
<area shape="poly" title=" " alt="" coords="77,275,162,301,160,306,76,280"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="135,353,280,379"/>
<area shape="poly" title=" " alt="" coords="55,278,85,308,125,338,142,346,139,351,123,343,81,312,51,282"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="358,355,439,380"/>
<area shape="poly" title=" " alt="" coords="48,279,58,304,74,335,96,365,125,388,153,399,183,406,245,407,304,397,353,382,355,387,305,402,246,412,183,411,152,404,123,392,92,368,69,337,53,306,43,281"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="136,455,279,480"/>
<area shape="poly" title=" " alt="" coords="47,279,56,310,72,352,94,395,126,433,145,447,142,451,122,437,90,398,67,354,51,312,42,281"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="155,504,260,529"/>
<area shape="poly" title=" " alt="" coords="45,280,50,321,63,377,87,438,104,466,126,491,143,502,140,507,122,495,100,469,82,441,58,379,45,322,40,281"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="343,55,454,80"/>
<area shape="poly" title=" " alt="" coords="251,65,330,65,330,70,251,70"/>
<area shape="poly" title=" " alt="" coords="281,364,344,364,344,370,281,369"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="507,305,613,331"/>
<area shape="poly" title=" " alt="" coords="439,352,504,332,506,337,440,358"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="507,355,613,380"/>
<area shape="poly" title=" " alt="" coords="440,365,493,365,493,370,440,370"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="514,404,606,429"/>
<area shape="poly" title=" " alt="" coords="440,377,506,397,504,403,439,382"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="339,405,459,431"/>
<area shape="poly" title=" " alt="" coords="257,452,334,432,336,437,258,457"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="347,455,450,480"/>
<area shape="poly" title=" " alt="" coords="279,465,333,465,333,470,279,470"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="507,453,613,479"/>
<area shape="poly" title=" " alt="" coords="450,464,493,464,493,469,450,470"/>
<area shape="poly" title=" " alt="" coords="590,451,612,438,658,401,696,363,700,367,662,404,615,443,593,456"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph.png" border="0" usemap="#adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph" alt=""/></div>
<map name="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph" id="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,559,31"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a0fdad74a815d2783d4f6f7053a6cb3ca" name="a0fdad74a815d2783d4f6f7053a6cb3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fdad74a815d2783d4f6f7053a6cb3ca">&#9670;&#160;</a></span>do_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rmeasure_8c_source.html#l00098">98</a> of file <a class="el" href="rmeasure_8c_source.html">rmeasure.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>{</div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordtype">int</span> ntimes, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><span class="lineno">  103</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><span class="lineno">  104</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">  105</span>  SEXP pompfun;</div>
<div class="line"><span class="lineno">  106</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  109</span>  SEXP cvec;</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  113</span>  ntimes = length(times);</div>
<div class="line"><span class="lineno">  114</span>  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  118</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  125</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rmeasure&quot;</span>)));</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">  136</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  137</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  138</span>  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  141</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  142</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">  146</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  149</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">// first do setup</span></div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  160</span>    SEXP ans;</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>          PROTECT(</div>
<div class="line"><span class="lineno">  176</span>                  ans = <a class="code hl_function" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  177</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  178</span>                                  time,</div>
<div class="line"><span class="lineno">  179</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  180</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  181</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  182</span>                                  )</div>
<div class="line"><span class="lineno">  183</span>                  );</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>          nobs = LENGTH(ans);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  188</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>          PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>          nprotect += 3;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>          yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  196</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  199</span>          yt += nobs;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>          first = 0;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>          PROTECT(</div>
<div class="line"><span class="lineno">  206</span>                  ans = <a class="code hl_function" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  207</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  208</span>                                  time,</div>
<div class="line"><span class="lineno">  209</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  210</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  211</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  212</span>                                  )</div>
<div class="line"><span class="lineno">  213</span>                  );</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><span class="lineno">  216</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  221</span>          yt += nobs;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>          UNPROTECT(1);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>      }</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  }</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_typedef" href="pomp_8h.html#ab50f528dfb03feaa03e7846023767637">pomp_rmeasure</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><span class="lineno">  243</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  244</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  245</span>    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  246</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  249</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><span class="lineno">  252</span>    yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    GetRNGstate();</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  261</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        xp = &amp;xs[<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><span class="lineno">  266</span>        pp = &amp;ps[<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>      }</div>
<div class="line"><span class="lineno">  271</span>    }</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    PutRNGstate();</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  280</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><span class="lineno">  282</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordtype">int</span> i, n = nobs*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,dim)); nprotect++;</div>
<div class="line"><span class="lineno">  287</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><span class="lineno">  293</span>  }</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  298</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">  299</span>}</div>
<div class="ttc" id="apomp_8h_html_ab50f528dfb03feaa03e7846023767637"><div class="ttname"><a href="pomp_8h.html#ab50f528dfb03feaa03e7846023767637">pomp_rmeasure</a></div><div class="ttdeci">void pomp_rmeasure(double *y, const double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00078">pomp.h:79</a></div></div>
<div class="ttc" id="armeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="rmeasure_8c_source.html#l00060">rmeasure.c:60</a></div></div>
<div class="ttc" id="armeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="rmeasure_8c_source.html#l00010">rmeasure.c:10</a></div></div>
<div class="ttc" id="armeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="rmeasure_8c_source.html#l00084">rmeasure.c:84</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph.png" border="0" usemap="#adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph" alt=""/></div>
<map name="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph" id="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,308,112,333"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="203,5,284,31"/>
<area shape="poly" title=" " alt="" coords="58,308,65,260,81,191,94,153,111,116,132,80,158,48,188,29,191,33,162,52,136,83,116,118,99,155,86,193,70,261,64,308"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="200,107,287,132"/>
<area shape="poly" title=" " alt="" coords="61,307,72,274,92,229,120,182,158,141,186,127,188,131,162,145,124,185,97,231,77,276,66,309"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="379,132,490,157"/>
<area shape="poly" title=" " alt="" coords="58,307,65,264,81,204,94,172,110,141,132,114,159,92,189,77,222,71,256,71,289,77,352,98,403,123,400,127,350,103,288,82,255,77,222,76,191,82,161,96,136,118,115,144,98,174,86,205,70,265,64,308"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="184,156,303,181"/>
<area shape="poly" title=" " alt="" coords="65,306,101,255,128,225,158,198,183,184,186,189,162,203,132,229,105,258,70,310"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="203,359,283,384"/>
<area shape="poly" title=" " alt="" coords="107,331,191,354,189,359,105,336"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="381,232,488,257"/>
<area shape="poly" title=" " alt="" coords="70,306,106,272,132,255,159,242,213,230,268,225,321,226,368,230,367,236,321,231,268,230,214,235,161,247,134,260,110,276,73,310"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="162,408,325,433"/>
<area shape="poly" title=" " alt="" coords="76,331,113,362,161,393,179,401,177,406,159,398,110,366,72,336"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="697,484,815,509"/>
<area shape="poly" title=" " alt="" coords="68,332,102,388,129,418,161,442,190,451,240,459,384,473,684,491,683,496,383,478,240,464,189,456,159,447,125,422,98,391,64,335"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="160,559,327,584"/>
<area shape="poly" title=" " alt="" coords="65,333,73,374,91,431,119,492,139,520,162,544,169,550,166,554,158,548,135,523,115,494,86,433,68,375,59,334"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="389,295,481,320"/>
<area shape="poly" title=" " alt="" coords="112,316,375,307,375,312,112,321"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="172,509,315,535"/>
<area shape="poly" title=" " alt="" coords="67,333,79,364,99,405,126,449,162,488,182,501,179,506,158,492,122,453,94,408,74,366,62,335"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="203,257,284,283"/>
<area shape="poly" title=" " alt="" coords="105,305,189,282,190,287,107,310"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="191,608,296,633"/>
<area shape="poly" title=" " alt="" coords="63,334,69,383,84,453,97,491,114,529,135,564,162,595,179,606,176,611,158,599,131,567,109,531,92,493,79,454,64,383,58,334"/>
<area shape="poly" title=" " alt="" coords="287,122,366,133,366,138,287,128"/>
<area shape="poly" title=" " alt="" coords="302,159,365,151,365,156,303,164"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="375,559,495,584"/>
<area shape="poly" title=" " alt="" coords="294,532,372,552,370,558,293,537"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="383,509,486,535"/>
<area shape="poly" title=" " alt="" coords="315,519,369,519,369,525,315,525"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="543,509,649,535"/>
<area shape="poly" title=" " alt="" coords="486,519,529,519,529,525,486,525"/>
<area shape="poly" title=" " alt="" coords="649,511,683,505,684,511,650,516"/>
<area shape="poly" title=" " alt="" coords="262,255,401,163,404,167,265,260"/>
<area shape="poly" title=" " alt="" coords="284,262,368,251,368,256,285,267"/>
<area shape="poly" title=" " alt="" coords="285,275,376,293,375,298,284,280"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph.png" border="0" usemap="#adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph" alt=""/></div>
<map name="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph" id="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,595,31"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="ab82bdfc4b0763ddd79d74e02f60e790a" name="ab82bdfc4b0763ddd79d74e02f60e790a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82bdfc4b0763ddd79d74e02f60e790a">&#9670;&#160;</a></span>do_rprior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprior </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprior_8c_source.html#l00058">58</a> of file <a class="el" href="rprior_8c_source.html">rprior.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>{</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   63</span>  SEXP Pnames, pompfun, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369">ret_array</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   67</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">   73</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprior&quot;</span>)));</div>
<div class="line"><span class="lineno">   74</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">   77</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordtype">int</span> nprotect = 5;</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    SEXP ans, nm;</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordtype">double</span> *pa, *p = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordtype">int</span> *posn = NULL;</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <span class="comment">// set up the function call</span></div>
<div class="line"><span class="lineno">   92</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames)); nprotect++;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, p += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>        PROTECT(ans = <a class="code hl_function" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,p,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><span class="lineno">   99</span>        PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>        PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><span class="lineno">  103</span>          <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprior&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  104</span>        posn = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>        nprotect += 4;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>        pa = REAL(ans);</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) p[posn[i]] = pa[i];</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>        first = 0;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>        PROTECT(ans = <a class="code hl_function" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,p,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><span class="lineno">  116</span>        PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>        pa = REAL(ans);</div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) p[posn[i]] = pa[i];</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>        UNPROTECT(2);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>      }</div>
<div class="line"><span class="lineno">  124</span>    }</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordtype">double</span> *p;</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordtype">int</span> *pidx = 0;</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_typedef" href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">// extract parameter index</span></div>
<div class="line"><span class="lineno">  137</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  140</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    R_CheckUserInterrupt();     <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    GetRNGstate();</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">for</span> (j = 0, p = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, p += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><span class="lineno">  148</span>      (*ff)(p,pidx);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    PutRNGstate();</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordflow">default</span>: <span class="comment">// just duplicate</span></div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rprior&#39; unspecified: duplicating parameters.&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>;</div>
<div class="line"><span class="lineno">  164</span>}</div>
<div class="ttc" id="apomp_8h_html_a910c57a1b150c29312792eba4a5fb2d3"><div class="ttname"><a href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a></div><div class="ttdeci">void pomp_rprior(double *p, const int *parindex)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00106">pomp.h:107</a></div></div>
<div class="ttc" id="arprior_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition</b> <a href="rprior_8c_source.html#l00031">rprior.c:31</a></div></div>
<div class="ttc" id="arprior_8c_html_a47e0916f81aa8c67b2cd749534467369"><div class="ttname"><a href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(SEXP params)</div><div class="ttdef"><b>Definition</b> <a href="rprior_8c_source.html#l00047">rprior.c:47</a></div></div>
<div class="ttc" id="arprior_8c_html_ad0f00e555a10801616b1d7f177d88ec3"><div class="ttname"><a href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="rprior_8c_source.html#l00010">rprior.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph.png" border="0" usemap="#adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph" alt=""/></div>
<map name="adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph" id="adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph">
<area shape="rect" title=" " alt="" coords="5,131,85,156"/>
<area shape="rect" href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3" title=" " alt="" coords="164,5,245,31"/>
<area shape="poly" title=" " alt="" coords="52,129,83,86,106,61,132,40,150,30,152,35,135,44,110,65,88,89,57,132"/>
<area shape="rect" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="165,55,245,80"/>
<area shape="poly" title=" " alt="" coords="70,128,132,97,161,83,163,88,134,102,72,133"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="651,131,768,156"/>
<area shape="poly" title=" " alt="" coords="85,137,133,134,273,131,413,132,637,138,637,143,413,137,273,136,133,139,86,142"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="494,156,601,181"/>
<area shape="poly" title=" " alt="" coords="86,143,480,163,480,168,85,148"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="133,207,276,232"/>
<area shape="poly" title=" " alt="" coords="72,154,134,185,163,198,161,203,132,190,70,159"/>
<area shape="rect" href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369" title=" " alt="" coords="164,305,245,331"/>
<area shape="poly" title=" " alt="" coords="60,155,135,242,183,293,180,297,131,245,56,158"/>
<area shape="poly" title=" " alt="" coords="600,158,636,152,637,157,601,163"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="324,207,444,232"/>
<area shape="poly" title=" " alt="" coords="276,217,310,217,310,222,276,222"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="333,256,435,281"/>
<area shape="poly" title=" " alt="" coords="252,229,324,250,323,255,251,235"/>
<area shape="poly" title=" " alt="" coords="417,254,443,241,483,215,519,188,522,192,486,219,445,246,419,258"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="341,305,427,331"/>
<area shape="poly" title=" " alt="" coords="246,315,326,315,326,321,246,321"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="331,355,437,380"/>
<area shape="poly" title=" " alt="" coords="246,327,325,348,323,353,245,332"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="492,305,603,331"/>
<area shape="poly" title=" " alt="" coords="428,315,478,315,478,321,428,321"/>
</map>
</div>

</div>
</div>
<a id="af129ae090fa637ebcec13e50e6c0d7be" name="af129ae090fa637ebcec13e50e6c0d7be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af129ae090fa637ebcec13e50e6c0d7be">&#9670;&#160;</a></span>do_rprocess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>xstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>tstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprocess_8c_source.html#l00025">25</a> of file <a class="el" href="rprocess_8c_source.html">rprocess.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordtype">int</span> *xdim, type, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, ntimes;</div>
<div class="line"><span class="lineno">   29</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, copy, rproc, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, accumvars, covar;</div>
<div class="line"><span class="lineno">   30</span>  SEXP dimXstart, dimP;</div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">   38</span>  ntimes = length(times);</div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">if</span> (ntimes &lt; 1) {</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(times) &lt; 1: no work to do.&quot;</span>);</div>
<div class="line"><span class="lineno">   41</span>  }</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  PROTECT(xstart = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(xstart));</div>
<div class="line"><span class="lineno">   44</span>  PROTECT(dimXstart = GET_DIM(xstart));</div>
<div class="line"><span class="lineno">   45</span>  xdim = INTEGER(dimXstart);</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = xdim[0]; nrepsx = xdim[1];</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   49</span>  PROTECT(dimP = GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   50</span>  xdim = INTEGER(dimP);</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = xdim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = xdim[1];</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordflow">if</span> (nrepsx &gt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {         <span class="comment">// more ICs than parameters</span></div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">if</span> (nrepsx % <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != 0) {</div>
<div class="line"><span class="lineno">   57</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">   58</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   59</span>      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><span class="lineno">   60</span>      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><span class="lineno">   61</span>      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">   62</span>      dims[0] = <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; dims[1] = nrepsx;</div>
<div class="line"><span class="lineno">   63</span>      PROTECT(copy = duplicate(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   64</span>      PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dims));</div>
<div class="line"><span class="lineno">   65</span>      nprotect += 2;</div>
<div class="line"><span class="lineno">   66</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><span class="lineno">   67</span>      src = REAL(copy);</div>
<div class="line"><span class="lineno">   68</span>      tgt = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">   69</span>      <span class="keywordflow">for</span> (j = 0; j &lt; nrepsx; j++) {</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; k++, tgt++) {</div>
<div class="line"><span class="lineno">   71</span>          *tgt = src[k+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)];</div>
<div class="line"><span class="lineno">   72</span>        }</div>
<div class="line"><span class="lineno">   73</span>      }</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = nrepsx;</div>
<div class="line"><span class="lineno">   76</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nrepsx &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {  <span class="comment">// more parameters than ICs</span></div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0) {</div>
<div class="line"><span class="lineno">   78</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   80</span>      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><span class="lineno">   81</span>      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><span class="lineno">   82</span>      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">   83</span>      dims[0] = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dims[1] = <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   84</span>      PROTECT(copy = duplicate(xstart));</div>
<div class="line"><span class="lineno">   85</span>      PROTECT(xstart = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dims));</div>
<div class="line"><span class="lineno">   86</span>      nprotect += 2;</div>
<div class="line"><span class="lineno">   87</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(xstart,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><span class="lineno">   88</span>      src = REAL(copy);</div>
<div class="line"><span class="lineno">   89</span>      tgt = REAL(xstart);</div>
<div class="line"><span class="lineno">   90</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) {</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; k++, tgt++) {</div>
<div class="line"><span class="lineno">   92</span>          *tgt = src[k+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*(j%nrepsx)];</div>
<div class="line"><span class="lineno">   93</span>        }</div>
<div class="line"><span class="lineno">   94</span>      }</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span>  }</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>  PROTECT(rproc = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprocess&quot;</span>)));</div>
<div class="line"><span class="lineno">   99</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  100</span>  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><span class="lineno">  101</span>  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  nprotect += 4;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">// extract the process function</span></div>
<div class="line"><span class="lineno">  106</span>  type = *(INTEGER(GET_SLOT(rproc,install(<span class="stringliteral">&quot;type&quot;</span>))));</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="comment">// one-step simulator</span></div>
<div class="line"><span class="lineno">  109</span>    {</div>
<div class="line"><span class="lineno">  110</span>      SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><span class="lineno">  111</span>      <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><span class="lineno">  112</span>      PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">  113</span>      PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><span class="lineno">  114</span>                                  accumvars,covar,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><span class="lineno">  115</span>      nprotect += 2;</div>
<div class="line"><span class="lineno">  116</span>    }</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>: <span class="comment">// discrete-time and Euler</span></div>
<div class="line"><span class="lineno">  119</span>    {</div>
<div class="line"><span class="lineno">  120</span>      SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><span class="lineno">  121</span>      <span class="keywordtype">double</span> deltat;</div>
<div class="line"><span class="lineno">  122</span>      PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">  123</span>      deltat = *(REAL(AS_NUMERIC(GET_SLOT(rproc,install(<span class="stringliteral">&quot;delta.t&quot;</span>)))));</div>
<div class="line"><span class="lineno">  124</span>      PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><span class="lineno">  125</span>                                  accumvars,covar,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><span class="lineno">  126</span>      nprotect += 2;</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a>: <span class="comment">// Gillespie&#39;s method</span></div>
<div class="line"><span class="lineno">  130</span>    {</div>
<div class="line"><span class="lineno">  131</span>      SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, vmatrix, hmax;</div>
<div class="line"><span class="lineno">  132</span>      PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;rate.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">  133</span>      PROTECT(vmatrix = GET_SLOT(rproc,install(<span class="stringliteral">&quot;v&quot;</span>)));</div>
<div class="line"><span class="lineno">  134</span>      PROTECT(hmax = GET_SLOT(rproc,install(<span class="stringliteral">&quot;hmax&quot;</span>)));</div>
<div class="line"><span class="lineno">  135</span>      PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,vmatrix,covar,</div>
<div class="line"><span class="lineno">  136</span>                                accumvars,hmax,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><span class="lineno">  137</span>      nprotect += 4;</div>
<div class="line"><span class="lineno">  138</span>    }</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  141</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f">pomp_default_rprocess</a>(xstart,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><span class="lineno">  142</span>    nprotect++;</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  144</span>  }</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,3);</div>
<div class="line"><span class="lineno">  147</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>}</div>
<div class="ttc" id="adecls_8h_html_a19293a3a394b4e0885714f833bc2a96b"><div class="ttname"><a href="#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a></div><div class="ttdeci">SEXP euler_simulator(SEXP, SEXP, SEXP, SEXP, SEXP, double, rprocmode, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00107">euler.c:108</a></div></div>
<div class="ttc" id="adecls_8h_html_ac796abcef7f5d6add4d98023a0bde62b"><div class="ttname"><a href="#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a></div><div class="ttdeci">SEXP SSA_simulator(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00226">ssa.c:226</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a></div><div class="ttdeci">@ gill</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a></div><div class="ttdeci">@ discrete</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a></div><div class="ttdeci">@ dflt</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a></div><div class="ttdeci">@ onestep</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a></div><div class="ttdeci">@ euler</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="arprocess_8c_html_a37e868d572ef0240fa585840f2aed80f"><div class="ttname"><a href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f">pomp_default_rprocess</a></div><div class="ttdeci">static SEXP pomp_default_rprocess(SEXP xstart, int nvars, int nreps, int ntimes)</div><div class="ttdef"><b>Definition</b> <a href="rprocess_8c_source.html#l00010">rprocess.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph.png" border="0" usemap="#adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph" alt=""/></div>
<map name="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph" id="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,105,154"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="172,27,259,53"/>
<area shape="poly" title=" " alt="" coords="71,126,152,70,174,57,177,62,155,74,74,131"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="563,78,674,103"/>
<area shape="poly" title=" " alt="" coords="59,127,72,101,91,69,118,37,152,12,181,5,225,3,335,9,443,22,511,35,551,50,587,68,584,73,549,55,510,40,443,27,334,14,225,8,182,10,154,17,122,41,96,72,76,104,64,130"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="153,457,277,482"/>
<area shape="poly" title=" " alt="" coords="65,153,204,443,200,445,60,155"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="565,217,672,242"/>
<area shape="poly" title=" " alt="" coords="93,151,197,184,261,200,326,213,445,225,552,228,552,233,445,230,325,219,260,206,195,189,92,157"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="573,154,665,179"/>
<area shape="poly" title=" " alt="" coords="106,141,559,161,559,167,105,146"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="331,78,505,103"/>
<area shape="poly" title=" " alt="" coords="105,128,153,120,317,98,317,104,154,125,106,134"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="157,783,274,809"/>
<area shape="poly" title=" " alt="" coords="62,154,210,769,205,770,57,155"/>
<area shape="poly" title=" " alt="" coords="259,39,373,46,511,63,558,72,557,77,510,68,373,52,259,44"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="377,281,459,306"/>
<area shape="poly" title=" " alt="" coords="220,455,256,388,286,349,324,315,343,305,363,298,365,303,345,310,327,319,290,352,261,391,224,458"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="378,431,458,457"/>
<area shape="poly" title=" " alt="" coords="277,459,364,448,365,453,278,464"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="337,633,499,658"/>
<area shape="poly" title=" " alt="" coords="225,481,263,543,292,579,327,611,352,625,349,630,324,615,288,583,258,546,221,483"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="881,457,999,482"/>
<area shape="poly" title=" " alt="" coords="236,454,276,433,325,416,402,403,481,399,560,400,637,406,776,427,881,450,880,456,775,432,637,411,560,405,481,404,403,409,326,421,278,438,238,459"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="335,682,501,707"/>
<area shape="poly" title=" " alt="" coords="222,482,234,518,254,569,285,622,305,646,327,667,337,674,334,678,324,671,301,650,281,625,250,571,229,520,217,483"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="727,531,833,557"/>
<area shape="poly" title=" " alt="" coords="240,480,280,499,326,515,431,533,536,543,634,546,713,545,713,550,634,551,536,548,430,539,325,520,278,504,238,484"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="351,481,485,506"/>
<area shape="poly" title=" " alt="" coords="278,474,338,481,337,486,277,479"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="353,330,483,355"/>
<area shape="poly" title=" " alt="" coords="226,455,267,415,324,372,356,357,358,362,327,377,271,419,230,458"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="347,834,489,859"/>
<area shape="poly" title=" " alt="" coords="224,481,262,581,293,649,328,717,365,774,400,822,396,825,360,778,323,720,288,652,258,583,219,483"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="377,179,459,205"/>
<area shape="poly" title=" " alt="" coords="219,455,257,372,287,318,323,266,353,236,385,211,388,215,357,239,327,270,291,321,261,375,224,458"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="566,907,671,933"/>
<area shape="poly" title=" " alt="" coords="230,480,270,519,297,541,327,560,353,572,378,577,425,580,447,582,469,587,491,599,513,618,534,650,545,680,547,711,544,740,540,802,546,834,561,869,586,897,582,901,556,872,541,836,535,802,539,740,541,711,539,681,530,652,509,622,488,603,467,592,446,587,425,585,378,583,352,577,324,565,294,546,267,523,226,484"/>
<area shape="poly" title=" " alt="" coords="807,529,899,485,901,490,810,533"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="559,834,679,859"/>
<area shape="poly" title=" " alt="" coords="490,844,545,844,545,849,490,849"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="567,683,670,709"/>
<area shape="poly" title=" " alt="" coords="469,831,509,812,537,791,561,766,599,719,603,722,565,770,540,795,512,817,471,836"/>
<area shape="poly" title=" " alt="" coords="632,681,753,564,757,568,635,685"/>
<area shape="poly" title=" " alt="" coords="443,177,579,107,582,112,446,181"/>
<area shape="poly" title=" " alt="" coords="459,197,552,214,551,219,458,202"/>
<area shape="poly" title=" " alt="" coords="459,184,559,171,560,177,459,189"/>
<area shape="poly" title=" " alt="" coords="506,88,550,88,550,93,506,93"/>
<area shape="poly" title=" " alt="" coords="458,101,512,120,576,146,574,151,510,125,456,106"/>
<area shape="poly" title=" " alt="" coords="271,781,419,745,481,727,509,717,522,696,532,669,542,603,544,523,541,436,536,266,541,195,547,165,556,140,568,124,582,110,586,114,572,127,561,142,552,166,546,195,541,266,546,436,549,523,548,603,537,671,527,698,512,721,483,732,420,750,272,786"/>
<area shape="poly" title=" " alt="" coords="222,781,260,726,290,694,324,667,335,661,338,666,327,671,293,698,265,729,226,784"/>
<area shape="poly" title=" " alt="" coords="233,781,273,753,324,724,360,709,362,714,327,729,276,758,236,785"/>
<area shape="poly" title=" " alt="" coords="268,806,354,828,353,833,266,811"/>
<area shape="poly" title=" " alt="" coords="274,806,330,813,394,811,426,806,456,796,484,782,509,762,523,743,533,718,543,654,544,576,540,491,535,405,533,324,539,255,546,226,556,202,573,185,576,189,561,205,551,228,544,255,539,324,541,404,546,490,550,576,549,654,538,719,527,745,513,766,487,786,458,801,427,811,394,817,330,818,273,811"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="325,933,511,958"/>
<area shape="poly" title=" " alt="" coords="226,807,265,861,294,892,327,918,341,925,338,930,324,922,290,895,261,864,222,810"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="377,883,459,909"/>
<area shape="poly" title=" " alt="" coords="233,807,274,837,326,868,365,882,363,887,324,873,271,842,230,811"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="394,982,442,1007"/>
<area shape="poly" title=" " alt="" coords="223,808,236,841,258,884,288,930,327,968,353,982,381,989,379,994,351,987,324,973,284,933,253,887,231,843,218,810"/>
<area shape="poly" title=" " alt="" coords="441,987,510,968,581,936,583,941,512,973,443,992"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="580,982,657,1007"/>
<area shape="poly" title=" " alt="" coords="442,992,566,992,566,997,442,997"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph.png" border="0" usemap="#adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph" alt=""/></div>
<map name="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph" id="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,588,31"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="aa9d3b94c1a9a99e0db90e251f670e853" name="aa9d3b94c1a9a99e0db90e251f670e853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d3b94c1a9a99e0db90e251f670e853">&#9670;&#160;</a></span>do_simulate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_simulate </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>nsim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>rettype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="simulate_8c_source.html#l00006">6</a> of file <a class="el" href="simulate_8c_source.html">simulate.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    7</span>{</div>
<div class="line"><span class="lineno">    8</span> </div>
<div class="line"><span class="lineno">    9</span>  SEXP t0, times, x0, x, y;</div>
<div class="line"><span class="lineno">   10</span>  SEXP ans = R_NilValue, ans_names = R_NilValue;</div>
<div class="line"><span class="lineno">   11</span>  SEXP simnames;</div>
<div class="line"><span class="lineno">   12</span>  <span class="keywordtype">int</span> return_type = *(INTEGER(rettype)); <span class="comment">// 0 = array, 1 = pomps</span></div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>  <span class="keywordflow">if</span> (LENGTH(nsim) != 1) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a single integer&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span>  PROTECT(t0 = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;t0&quot;</span>)));</div>
<div class="line"><span class="lineno">   19</span>  PROTECT(times = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>  <span class="comment">// initialize the simulations</span></div>
<div class="line"><span class="lineno">   22</span>  PROTECT(x0 = <a class="code hl_function" href="#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a>(<span class="keywordtype">object</span>,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,t0,nsim,gnsi));</div>
<div class="line"><span class="lineno">   23</span>  PROTECT(simnames = GET_COLNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  <span class="comment">// call &#39;rprocess&#39; to simulate state process</span></div>
<div class="line"><span class="lineno">   26</span>  PROTECT(x = <a class="code hl_function" href="#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a>(<span class="keywordtype">object</span>,x0,t0,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <span class="comment">// call &#39;rmeasure&#39; to simulate the measurement process</span></div>
<div class="line"><span class="lineno">   29</span>  PROTECT(y = <a class="code hl_function" href="#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a>(<span class="keywordtype">object</span>,x,times,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <a class="code hl_function" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(x,simnames);</div>
<div class="line"><span class="lineno">   32</span>  <a class="code hl_function" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(y,simnames);</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordflow">switch</span> (return_type) {</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordflow">case</span> 0:  <span class="comment">// return a list of arrays</span></div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    PROTECT(ans = NEW_LIST(2));</div>
<div class="line"><span class="lineno">   41</span>    PROTECT(ans_names = NEW_CHARACTER(2));</div>
<div class="line"><span class="lineno">   42</span>    nprotect += 2;</div>
<div class="line"><span class="lineno">   43</span>    SET_STRING_ELT(ans_names,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><span class="lineno">   44</span>    SET_STRING_ELT(ans_names,1,mkChar(<span class="stringliteral">&quot;obs&quot;</span>));</div>
<div class="line"><span class="lineno">   45</span>    SET_NAMES(ans,ans_names);</div>
<div class="line"><span class="lineno">   46</span>    SET_ELEMENT(ans,0,x);</div>
<div class="line"><span class="lineno">   47</span>    SET_ELEMENT(ans,1,y);</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">// a list to hold the pomp objects</span></div>
<div class="line"><span class="lineno">   54</span>    {</div>
<div class="line"><span class="lineno">   55</span>      SEXP pp, xx, yy, po;</div>
<div class="line"><span class="lineno">   56</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> *xdim;</div>
<div class="line"><span class="lineno">   57</span>      <span class="keywordtype">int</span> nvar, npar, nobs, nsim, ntim, nparsets;</div>
<div class="line"><span class="lineno">   58</span>      <span class="keywordtype">int</span> dim[2], i, j, k;</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>      PROTECT(po = duplicate(<span class="keywordtype">object</span>));</div>
<div class="line"><span class="lineno">   61</span>      SET_SLOT(po,install(<span class="stringliteral">&quot;t0&quot;</span>),t0);</div>
<div class="line"><span class="lineno">   62</span>      SET_SLOT(po,install(<span class="stringliteral">&quot;times&quot;</span>),times);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>      xdim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">   65</span>      nvar = xdim[0]; nsim = xdim[1]; ntim = xdim[2];</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>      xdim = INTEGER(GET_DIM(y));</div>
<div class="line"><span class="lineno">   68</span>      nobs = xdim[0]; <span class="comment">// second dimensions of &#39;x&#39; and &#39;y&#39; must agree</span></div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>      xdim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   71</span>      npar = xdim[0]; nparsets = xdim[1];</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>      dim[0] = nvar; dim[1] = ntim;</div>
<div class="line"><span class="lineno">   74</span>      PROTECT(xx = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><span class="lineno">   75</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(xx,GET_ROWNAMES(GET_DIMNAMES(x)),2);</div>
<div class="line"><span class="lineno">   76</span>      SET_SLOT(po,install(<span class="stringliteral">&quot;states&quot;</span>),xx);</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>      dim[0] = nobs; dim[1] = ntim;</div>
<div class="line"><span class="lineno">   79</span>      PROTECT(yy = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><span class="lineno">   80</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(yy,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><span class="lineno">   81</span>      SET_SLOT(po,install(<span class="stringliteral">&quot;data&quot;</span>),yy);</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>      PROTECT(pp = NEW_NUMERIC(npar));</div>
<div class="line"><span class="lineno">   84</span>      SET_NAMES(pp,GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   85</span>      SET_SLOT(po,install(<span class="stringliteral">&quot;params&quot;</span>),pp);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>      PROTECT(ans = NEW_LIST(nsim));</div>
<div class="line"><span class="lineno">   88</span>      SET_NAMES(ans,simnames);</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>      nprotect += 5;</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>      <span class="keywordflow">for</span> (k = 0; k &lt; nsim; k++) {</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        SEXP po2;</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordtype">double</span> *xs = REAL(x), *ys = REAL(y), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordtype">double</span> *xt, *yt, *pt;</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>        PROTECT(po2 = duplicate(po));</div>
<div class="line"><span class="lineno">   99</span>        xt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;states&quot;</span>)));</div>
<div class="line"><span class="lineno">  100</span>        yt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><span class="lineno">  101</span>        pt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;params&quot;</span>)));</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        memcpy(pt,ps+npar*(k%nparsets),npar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>        <span class="comment">// copy x[,k,] and y[,k,] into po2</span></div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">for</span> (j = 0; j &lt; ntim; j++) {</div>
<div class="line"><span class="lineno">  107</span>          <span class="keywordflow">for</span> (i = 0; i &lt; nvar; i++, xt++) *xt = xs[i+nvar*(k+nsim*j)];</div>
<div class="line"><span class="lineno">  108</span>          <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, yt++) *yt = ys[i+nobs*(k+nsim*j)];</div>
<div class="line"><span class="lineno">  109</span>        }</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>        SET_ELEMENT(ans,k,po2);</div>
<div class="line"><span class="lineno">  112</span>        UNPROTECT(1);</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>      }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    }</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  }</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">return</span> ans;</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>}</div>
<div class="ttc" id="adecls_8h_html_a0fdad74a815d2783d4f6f7053a6cb3ca"><div class="ttname"><a href="#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a></div><div class="ttdeci">SEXP do_rmeasure(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="rmeasure_8c_source.html#l00098">rmeasure.c:98</a></div></div>
<div class="ttc" id="adecls_8h_html_ab3de8f433818929ff221b26769ed9e6c"><div class="ttname"><a href="#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a></div><div class="ttdeci">SEXP do_rinit(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="rinit_8c_source.html#l00091">rinit.c:91</a></div></div>
<div class="ttc" id="adecls_8h_html_af129ae090fa637ebcec13e50e6c0d7be"><div class="ttname"><a href="#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a></div><div class="ttdeci">SEXP do_rprocess(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="rprocess_8c_source.html#l00025">rprocess.c:25</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a796a0cd2011dadc57c790c46532ef00b"><div class="ttname"><a href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a></div><div class="ttdeci">static R_INLINE void setcolnames(SEXP x, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00121">pomp_defines.h:121</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph.png" border="0" usemap="#adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph" alt=""/></div>
<map name="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph" id="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph">
<area shape="rect" title=" " alt="" coords="5,632,108,658"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="552,78,639,103"/>
<area shape="poly" title=" " alt="" coords="60,631,87,561,139,453,173,391,212,330,257,271,308,218,363,176,424,143,485,118,538,101,539,107,487,123,426,148,366,180,311,222,261,274,217,333,177,394,143,455,92,563,65,633"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="741,328,851,354"/>
<area shape="poly" title=" " alt="" coords="57,632,67,580,85,503,113,414,132,369,154,326,223,214,257,171,292,134,333,103,380,76,435,52,502,30,555,14,599,4,621,3,643,7,665,16,690,31,721,60,746,95,765,134,778,175,793,253,798,314,792,315,788,254,773,176,760,136,741,98,717,63,686,35,663,21,641,12,620,8,600,9,556,19,503,36,437,57,382,81,336,107,296,138,261,174,227,217,158,329,137,371,118,416,90,504,72,581,63,633"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="173,1434,244,1459"/>
<area shape="poly" title=" " alt="" coords="63,658,205,1419,200,1420,58,659"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="750,959,842,984"/>
<area shape="poly" title=" " alt="" coords="60,658,61,773,71,975,82,1095,100,1221,125,1348,159,1471,184,1561,206,1633,221,1664,242,1693,271,1720,311,1747,366,1773,420,1786,470,1785,518,1773,564,1750,607,1716,648,1674,686,1622,697,1601,705,1575,716,1510,720,1435,721,1353,720,1193,723,1125,733,1071,752,1029,774,994,779,997,757,1032,739,1072,729,1125,725,1193,726,1353,726,1435,721,1511,711,1576,702,1603,690,1625,652,1677,611,1720,567,1754,520,1778,471,1791,419,1791,365,1778,308,1751,268,1724,238,1696,217,1667,201,1635,179,1562,153,1472,120,1349,95,1222,77,1096,65,975,55,774,55,658"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="329,455,435,480"/>
<area shape="poly" title=" " alt="" coords="80,630,344,485,347,489,82,635"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="159,632,259,658"/>
<area shape="poly" title=" " alt="" coords="108,642,145,642,145,648,108,648"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="156,1812,261,1838"/>
<area shape="poly" title=" " alt="" coords="61,658,69,871,88,1232,101,1420,118,1589,137,1719,147,1764,158,1792,168,1803,164,1806,154,1794,142,1766,131,1720,112,1590,96,1421,83,1232,64,871,56,658"/>
<area shape="poly" title=" " alt="" coords="617,101,653,128,690,165,720,204,747,245,785,315,781,317,742,247,716,207,686,168,649,132,614,105"/>
<area shape="poly" title=" " alt="" coords="208,1433,219,1245,241,931,272,621,289,508,298,468,307,442,323,418,341,401,379,380,417,359,435,343,452,321,466,293,471,268,471,219,471,195,474,171,483,146,501,120,518,107,538,97,540,102,521,111,505,124,487,148,479,172,476,195,476,219,477,268,471,295,457,324,439,347,420,363,381,384,344,406,327,422,312,445,303,469,294,509,277,622,247,932,224,1245,213,1434"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="341,1459,423,1484"/>
<area shape="poly" title=" " alt="" coords="245,1449,328,1461,328,1466,244,1454"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="342,1508,422,1534"/>
<area shape="poly" title=" " alt="" coords="234,1457,310,1495,330,1502,328,1507,308,1499,232,1462"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="514,935,677,960"/>
<area shape="poly" title=" " alt="" coords="207,1433,207,1367,217,1266,229,1209,247,1152,273,1097,307,1049,349,1012,398,985,450,967,500,955,501,960,451,972,400,990,352,1017,311,1052,278,1100,252,1154,234,1210,222,1267,212,1368,212,1433"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1059,1459,1176,1484"/>
<area shape="poly" title=" " alt="" coords="214,1459,222,1498,239,1550,268,1604,287,1627,311,1645,342,1659,387,1669,445,1675,513,1677,590,1673,674,1663,763,1646,855,1621,924,1594,989,1558,1046,1522,1088,1491,1091,1495,1049,1526,992,1563,927,1599,857,1626,764,1651,674,1668,590,1678,513,1682,445,1681,386,1674,340,1664,308,1650,284,1631,263,1607,234,1552,217,1499,209,1460"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="512,984,679,1010"/>
<area shape="poly" title=" " alt="" coords="208,1433,211,1376,225,1291,238,1244,255,1196,278,1151,307,1110,349,1073,397,1044,449,1024,498,1010,499,1015,450,1029,400,1049,352,1077,311,1113,283,1154,260,1198,243,1245,230,1292,217,1376,213,1433"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="349,1711,415,1736"/>
<area shape="poly" title=" " alt="" coords="214,1459,223,1502,240,1563,269,1630,288,1662,311,1690,337,1707,334,1712,308,1694,284,1665,264,1633,235,1565,218,1503,209,1460"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="309,1610,455,1635"/>
<area shape="poly" title=" " alt="" coords="218,1458,252,1519,279,1556,311,1588,331,1601,328,1606,308,1592,275,1559,248,1522,214,1461"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="555,1586,636,1611"/>
<area shape="poly" title=" " alt="" coords="221,1458,256,1501,282,1525,311,1544,369,1568,431,1583,490,1592,541,1595,541,1601,490,1597,430,1588,367,1573,308,1549,279,1529,253,1505,217,1461"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="524,1083,667,1108"/>
<area shape="poly" title=" " alt="" coords="208,1433,212,1382,226,1308,239,1267,256,1228,279,1191,308,1159,354,1128,406,1108,460,1096,510,1092,511,1097,461,1102,408,1113,356,1133,311,1163,283,1194,261,1230,244,1269,231,1309,217,1382,213,1433"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="743,783,849,808"/>
<area shape="poly" title=" " alt="" coords="244,1443,346,1440,480,1429,546,1419,606,1406,654,1389,686,1368,697,1354,705,1335,717,1288,723,1231,725,1168,726,1043,727,989,733,947,756,877,780,820,785,822,761,879,739,948,733,990,731,1043,731,1168,729,1231,723,1289,710,1337,701,1357,690,1372,657,1394,607,1411,547,1425,481,1434,347,1445,244,1449"/>
<area shape="poly" title=" " alt="" coords="455,1611,541,1602,541,1607,456,1617"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="743,1586,849,1611"/>
<area shape="poly" title=" " alt="" coords="636,1596,729,1596,729,1601,636,1601"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="743,632,849,658"/>
<area shape="poly" title=" " alt="" coords="601,1584,643,1496,667,1434,685,1370,694,1302,695,1215,689,1012,688,909,693,813,707,732,719,698,734,670,739,664,743,668,738,673,724,700,712,733,699,814,694,909,694,1012,700,1215,699,1302,691,1371,672,1436,648,1498,606,1587"/>
<area shape="poly" title=" " alt="" coords="617,1583,654,1555,671,1536,686,1514,711,1453,722,1398,724,1347,720,1298,715,1249,712,1196,717,1137,733,1071,752,1029,774,994,779,997,757,1032,739,1073,722,1138,718,1196,720,1248,725,1298,729,1347,727,1398,716,1454,690,1517,676,1539,657,1559,620,1588"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="736,1083,856,1108"/>
<area shape="poly" title=" " alt="" coords="667,1093,722,1093,722,1098,667,1098"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="745,1232,847,1258"/>
<area shape="poly" title=" " alt="" coords="615,1106,769,1222,765,1226,612,1111"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="904,1383,1011,1408"/>
<area shape="poly" title=" " alt="" coords="813,1256,934,1372,931,1375,809,1260"/>
<area shape="poly" title=" " alt="" coords="986,1406,1079,1451,1076,1455,984,1411"/>
<area shape="poly" title=" " alt="" coords="392,453,422,412,452,359,463,324,467,292,465,234,465,207,469,179,480,150,501,121,518,106,538,97,540,102,521,111,505,124,484,153,474,180,470,207,470,234,472,292,468,325,457,361,427,415,397,456"/>
<area shape="poly" title=" " alt="" coords="393,453,437,411,468,388,502,371,559,352,619,342,676,336,727,335,727,341,676,342,619,347,560,357,504,375,471,393,441,415,397,457"/>
<area shape="poly" title=" " alt="" coords="387,480,395,545,415,645,430,702,450,760,475,817,505,870,532,901,562,925,559,929,528,905,500,873,470,819,445,762,425,703,410,646,390,546,382,481"/>
<area shape="poly" title=" " alt="" coords="434,459,453,447,466,430,475,412,482,377,479,340,472,304,465,267,464,232,474,197,485,180,501,164,526,146,551,133,576,124,601,120,650,124,697,143,742,173,785,214,824,262,858,316,900,393,937,474,970,558,998,643,1044,815,1076,982,1097,1136,1110,1270,1118,1445,1113,1445,1105,1270,1092,1137,1071,983,1039,816,993,645,965,560,932,476,895,396,854,318,819,265,781,218,739,178,695,147,648,129,601,125,577,129,553,138,529,150,504,168,489,184,479,199,469,232,470,267,477,303,485,340,487,377,480,414,471,433,456,451,437,464"/>
<area shape="poly" title=" " alt="" coords="389,480,446,748,482,898,496,949,505,971,508,975,505,979,500,974,491,951,476,900,441,749,383,481"/>
<area shape="poly" title=" " alt="" coords="436,465,491,468,556,477,625,495,689,523,719,544,745,569,782,619,778,622,741,573,715,548,687,527,623,500,555,483,491,474,436,470"/>
<area shape="poly" title=" " alt="" coords="388,480,398,525,420,590,454,660,477,691,504,719,528,734,550,742,595,745,641,747,665,755,690,771,728,812,757,859,777,906,790,945,785,946,773,908,752,862,724,815,686,775,662,760,640,753,595,750,549,748,525,739,501,723,473,695,450,662,415,592,393,527,383,481"/>
<area shape="poly" title=" " alt="" coords="389,480,457,822,462,861,463,896,461,958,462,985,468,1013,482,1040,505,1070,514,1078,510,1082,501,1073,477,1043,463,1014,457,986,455,958,458,896,457,862,452,823,383,481"/>
<area shape="poly" title=" " alt="" coords="407,478,451,500,504,522,532,530,557,533,602,534,645,540,667,551,690,568,706,587,715,604,722,640,724,678,729,698,738,720,756,747,775,771,771,774,752,750,734,722,724,699,719,678,716,641,710,606,701,590,686,572,664,555,643,545,602,539,556,539,530,535,502,527,449,505,405,483"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,179,636,204"/>
<area shape="poly" title=" " alt="" coords="392,453,421,412,452,359,465,318,469,283,476,249,486,232,501,215,519,202,540,195,542,200,522,207,504,219,490,235,481,251,474,283,470,319,457,361,425,415,396,456"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="536,278,655,303"/>
<area shape="poly" title=" " alt="" coords="388,453,431,390,463,353,501,320,528,306,530,310,504,325,467,357,435,394,393,456"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="555,228,635,254"/>
<area shape="poly" title=" " alt="" coords="390,453,452,358,465,331,471,308,481,286,501,264,520,253,541,245,543,250,523,257,504,268,485,289,476,310,470,333,457,361,395,456"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="555,430,636,455"/>
<area shape="poly" title=" " alt="" coords="435,459,541,446,541,451,436,464"/>
<area shape="poly" title=" " alt="" coords="647,301,733,322,731,328,646,306"/>
<area shape="poly" title=" " alt="" coords="635,428,687,408,729,384,765,360,768,364,731,389,689,413,637,433"/>
<area shape="poly" title=" " alt="" coords="637,448,664,457,690,472,724,507,752,547,788,619,783,621,747,549,720,510,686,476,662,462,636,453"/>
<area shape="poly" title=" " alt="" coords="611,454,651,502,672,534,690,569,713,638,720,694,724,750,739,820,762,889,786,945,781,947,757,890,733,822,719,751,714,694,707,639,686,571,668,537,646,505,607,457"/>
<area shape="poly" title=" " alt="" coords="209,631,218,579,236,500,265,409,285,364,307,321,349,254,389,206,436,165,501,120,538,103,540,107,504,125,439,169,392,209,354,257,312,324,289,366,270,411,242,501,223,580,214,632"/>
<area shape="poly" title=" " alt="" coords="207,632,211,564,224,458,236,398,254,336,277,275,307,218,348,160,387,119,436,89,502,62,554,44,599,35,620,35,642,39,665,48,690,63,719,88,742,119,760,153,774,189,790,259,796,314,791,315,785,260,768,191,755,155,737,122,715,92,686,67,663,53,641,44,620,40,599,40,556,49,504,67,438,94,391,123,352,163,312,221,282,277,259,337,241,399,229,459,216,565,213,632"/>
<area shape="poly" title=" " alt="" coords="259,642,729,642,729,648,259,648"/>
<area shape="poly" title=" " alt="" coords="214,657,224,761,244,924,273,1092,291,1160,312,1209,351,1269,389,1310,437,1341,504,1368,556,1387,601,1398,622,1398,643,1394,664,1384,686,1368,701,1346,711,1314,720,1228,723,1139,727,1100,733,1071,753,1029,775,994,779,997,758,1032,739,1073,732,1101,729,1139,725,1229,717,1315,706,1349,690,1372,667,1389,644,1399,622,1404,601,1403,555,1392,502,1373,435,1345,386,1314,346,1272,307,1212,286,1162,268,1093,238,925,218,762,208,658"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="320,1172,444,1198"/>
<area shape="poly" title=" " alt="" coords="217,657,375,1158,370,1160,212,659"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="508,582,683,607"/>
<area shape="poly" title=" " alt="" coords="258,632,309,624,494,601,495,606,310,629,259,638"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="323,834,441,859"/>
<area shape="poly" title=" " alt="" coords="223,656,363,821,359,825,219,660"/>
<area shape="poly" title=" " alt="" coords="384,1171,397,1132,420,1078,454,1020,476,994,501,971,511,964,514,969,504,975,480,998,459,1024,425,1080,402,1134,389,1173"/>
<area shape="poly" title=" " alt="" coords="388,1197,397,1242,418,1306,433,1339,452,1371,476,1400,504,1424,570,1460,642,1484,717,1499,792,1505,866,1505,934,1500,1047,1484,1048,1490,935,1506,866,1510,792,1510,716,1504,641,1489,568,1465,501,1429,472,1404,448,1374,428,1342,413,1308,392,1244,383,1198"/>
<area shape="poly" title=" " alt="" coords="389,1171,442,1090,474,1048,501,1020,514,1013,516,1017,504,1024,478,1051,446,1094,393,1174"/>
<area shape="poly" title=" " alt="" coords="407,1170,502,1125,541,1110,542,1115,504,1130,409,1175"/>
<area shape="poly" title=" " alt="" coords="390,1197,403,1233,426,1281,459,1330,480,1351,504,1368,551,1391,602,1406,655,1415,708,1420,808,1417,890,1407,891,1412,808,1423,707,1425,654,1421,601,1411,550,1396,501,1373,477,1355,455,1333,421,1284,398,1235,385,1199"/>
<area shape="poly" title=" " alt="" coords="444,1177,510,1169,582,1157,645,1140,670,1130,686,1119,704,1099,714,1081,722,1042,723,999,733,947,782,820,786,822,739,948,729,999,727,1043,719,1082,708,1102,690,1123,672,1135,647,1145,583,1162,511,1174,444,1182"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,1283,636,1308"/>
<area shape="poly" title=" " alt="" coords="399,1196,444,1232,504,1269,542,1283,541,1288,502,1274,441,1237,396,1200"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="555,1332,635,1358"/>
<area shape="poly" title=" " alt="" coords="393,1196,435,1256,467,1290,504,1319,543,1334,541,1339,501,1323,463,1294,431,1259,389,1199"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="529,1184,662,1210"/>
<area shape="poly" title=" " alt="" coords="444,1186,515,1190,515,1195,444,1191"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="531,1234,660,1259"/>
<area shape="poly" title=" " alt="" coords="423,1195,503,1220,531,1227,530,1233,502,1225,422,1200"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="555,1034,636,1059"/>
<area shape="poly" title=" " alt="" coords="391,1170,435,1121,467,1093,501,1069,541,1054,543,1059,504,1074,470,1097,439,1125,395,1174"/>
<area shape="poly" title=" " alt="" coords="635,1043,663,1036,686,1021,704,988,716,943,723,889,726,829,728,711,733,621,761,477,786,366,791,368,766,478,739,621,733,712,731,830,728,889,721,944,709,990,690,1024,665,1041,637,1048"/>
<area shape="poly" title=" " alt="" coords="635,1043,663,1036,686,1020,702,999,714,978,724,935,722,893,713,851,704,807,701,763,709,717,719,694,734,670,739,664,743,667,738,673,723,696,714,719,706,763,710,807,718,850,727,893,729,936,719,980,707,1002,690,1024,665,1041,637,1048"/>
<area shape="poly" title=" " alt="" coords="636,1035,687,1020,758,988,760,993,689,1025,637,1040"/>
<area shape="poly" title=" " alt="" coords="605,580,774,363,778,366,609,583"/>
<area shape="poly" title=" " alt="" coords="619,605,656,632,690,670,711,709,720,743,727,777,739,820,787,945,782,947,733,822,722,779,715,744,706,711,686,673,652,636,616,609"/>
<area shape="poly" title=" " alt="" coords="383,833,396,749,421,624,438,559,457,499,478,450,501,416,523,398,545,387,566,381,587,379,633,379,687,370,740,355,741,360,689,376,633,384,588,385,567,387,547,392,526,403,505,420,482,452,462,501,443,560,426,625,401,750,388,834"/>
<area shape="poly" title=" " alt="" coords="404,857,449,884,504,913,541,928,539,933,502,918,446,889,401,861"/>
<area shape="poly" title=" " alt="" coords="394,858,437,913,468,944,504,971,516,977,513,982,501,975,465,948,433,916,390,861"/>
<area shape="poly" title=" " alt="" coords="439,856,575,889,689,921,758,950,756,955,687,926,573,894,438,862"/>
<area shape="poly" title=" " alt="" coords="389,859,401,900,423,957,457,1018,479,1046,504,1070,513,1075,510,1080,501,1074,475,1049,453,1021,418,959,396,902,384,860"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="503,784,688,810"/>
<area shape="poly" title=" " alt="" coords="437,831,526,810,527,815,438,836"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,834,636,859"/>
<area shape="poly" title=" " alt="" coords="441,844,541,844,541,849,441,849"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="571,683,619,708"/>
<area shape="poly" title=" " alt="" coords="400,831,563,714,566,719,403,836"/>
<area shape="poly" title=" " alt="" coords="620,700,689,725,731,749,768,773,765,777,728,753,687,730,618,705"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="757,683,835,708"/>
<area shape="poly" title=" " alt="" coords="619,693,743,693,743,698,619,698"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph.png" border="0" usemap="#adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph" alt=""/></div>
<map name="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph" id="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph">
<area shape="rect" title=" " alt="" coords="337,5,440,31"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="af1187e52d896c25c1cdb5dd593dbc291" name="af1187e52d896c25c1cdb5dd593dbc291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1187e52d896c25c1cdb5dd593dbc291">&#9670;&#160;</a></span>do_skeleton()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_skeleton </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00326">326</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  327</span>{</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, nrepp, nrepx, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  332</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Cnames, Pnames;</div>
<div class="line"><span class="lineno">  333</span>  SEXP pompfun, <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, ob;</div>
<div class="line"><span class="lineno">  334</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><span class="lineno">  335</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><span class="lineno">  338</span>  ntimes = LENGTH(t);</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  341</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">  342</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepx = dim[1];</div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><span class="lineno">  344</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  347</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  348</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  <span class="comment">// 2nd dimension of &#39;x&#39; and &#39;params&#39; need not agree</span></div>
<div class="line"><span class="lineno">  351</span>  <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepp &gt; nrepx) ? nrepp : nrepx;</div>
<div class="line"><span class="lineno">  352</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepp != 0) || (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepx != 0))</div>
<div class="line"><span class="lineno">  353</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;2nd dimensions of &#39;x&#39; and &#39;params&#39; are incompatible&quot;</span>);</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">  356</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  357</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  360</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  361</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">  364</span>  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><span class="lineno">  365</span>  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">  366</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  369</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  PROTECT(F = <a class="code hl_function" href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e">ret_array</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>  <span class="keywordtype">int</span> nprotect = 12;</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <a class="code hl_function" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a>(REAL(F),REAL(t),REAL(x),REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><span class="lineno">  382</span>                    <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,</div>
<div class="line"><span class="lineno">  383</span>                    <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><span class="lineno">  384</span>                    &amp;covariate_table,REAL(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>  }</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">  392</span>    <a class="code hl_typedef" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  395</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  396</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_function" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a>(</div>
<div class="line"><span class="lineno">  401</span>                         REAL(F),REAL(t),REAL(x),REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><span class="lineno">  402</span>                         <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><span class="lineno">  403</span>                         sidx,pidx,cidx,&amp;covariate_table,ff,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  }</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordtype">int</span> i, n = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++, ft++) *ft = R_NaReal;</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  }</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>  }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  421</span>  <span class="keywordflow">return</span> F;</div>
<div class="line"><span class="lineno">  422</span>}</div>
<div class="ttc" id="apomp_8h_html_a1c79f52f1a622f5a59fea40ad9dfe1f4"><div class="ttname"><a href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a></div><div class="ttdeci">void pomp_skeleton(double *f, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00072">pomp.h:73</a></div></div>
<div class="ttc" id="askeleton_8c_html_a4c519c3f1f7ceca7aae16c0aa702cfeb"><div class="ttname"><a href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *f, double *time, double *x, double *p, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, int *sidx, int *pidx, int *cidx, lookup_table_t *covar_table, pomp_skeleton *fun, SEXP args, double *cov)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00245">skeleton.c:245</a></div></div>
<div class="ttc" id="askeleton_8c_html_a53b6db198caa0f42fbbccb00bc27a12e"><div class="ttname"><a href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nvars, int nreps, int ntimes, SEXP Snames)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00081">skeleton.c:81</a></div></div>
<div class="ttc" id="askeleton_8c_html_a82ea4779fc1cc65f27c3546cbb6669c8"><div class="ttname"><a href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00010">skeleton.c:10</a></div></div>
<div class="ttc" id="askeleton_8c_html_ab5870e93076f917246e64740c1416a05"><div class="ttname"><a href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *f, double *time, double *x, double *p, SEXP fn, SEXP args, SEXP Snames, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, lookup_table_t *covar_table, double *cov)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00093">skeleton.c:94</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph.png" border="0" usemap="#adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph" alt=""/></div>
<map name="adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph" id="adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph">
<area shape="rect" title=" " alt="" coords="5,203,105,228"/>
<area shape="rect" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8" title=" " alt="" coords="179,5,294,31"/>
<area shape="poly" title=" " alt="" coords="58,201,69,169,87,125,115,79,152,40,165,31,168,36,155,44,119,83,92,128,73,171,63,203"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="193,55,280,80"/>
<area shape="poly" title=" " alt="" coords="61,201,94,147,121,116,152,89,179,76,181,81,155,94,124,120,99,150,65,204"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="177,104,296,129"/>
<area shape="poly" title=" " alt="" coords="68,200,104,169,152,138,167,132,169,136,155,143,108,174,72,204"/>
<area shape="rect" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="157,203,317,228"/>
<area shape="poly" title=" " alt="" coords="105,213,143,213,143,218,105,218"/>
<area shape="rect" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="173,252,301,277"/>
<area shape="poly" title=" " alt="" coords="103,225,177,246,175,251,102,231"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="155,351,318,376"/>
<area shape="poly" title=" " alt="" coords="66,227,99,280,125,310,155,336,167,343,164,347,152,340,121,314,95,283,61,230"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="153,400,320,425"/>
<area shape="poly" title=" " alt="" coords="63,227,74,260,92,302,119,347,155,385,164,392,161,396,152,389,115,350,88,305,69,261,58,229"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="165,301,308,327"/>
<area shape="poly" title=" " alt="" coords="72,226,108,256,155,286,173,294,170,299,152,291,105,261,69,231"/>
<area shape="rect" href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e" title=" " alt="" coords="196,153,277,179"/>
<area shape="poly" title=" " alt="" coords="102,200,182,178,183,183,103,205"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="373,55,483,80"/>
<area shape="poly" title=" " alt="" coords="280,65,359,65,359,70,280,70"/>
<area shape="poly" title=" " alt="" coords="286,101,364,81,365,86,287,107"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="375,203,481,228"/>
<area shape="poly" title=" " alt="" coords="317,213,361,213,361,218,317,218"/>
<area shape="poly" title=" " alt="" coords="286,249,364,229,365,234,287,255"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="388,252,468,277"/>
<area shape="poly" title=" " alt="" coords="301,262,374,262,374,267,301,267"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="691,328,808,353"/>
<area shape="poly" title=" " alt="" coords="301,274,368,286,677,329,677,335,368,291,300,279"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="536,353,643,379"/>
<area shape="poly" title=" " alt="" coords="296,275,321,286,336,298,346,310,355,322,369,332,407,346,447,356,522,364,522,369,446,361,405,351,367,336,351,326,342,314,333,302,319,291,294,280"/>
<area shape="poly" title=" " alt="" coords="643,355,677,349,678,355,643,360"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="368,453,488,479"/>
<area shape="poly" title=" " alt="" coords="304,325,322,336,334,349,341,362,347,388,353,414,359,426,370,439,377,444,373,448,366,443,355,429,348,415,342,389,336,364,329,352,318,340,301,329"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="377,404,479,429"/>
<area shape="poly" title=" " alt="" coords="296,324,321,336,337,347,347,359,370,383,389,395,386,400,366,387,343,362,333,351,319,340,294,329"/>
<area shape="poly" title=" " alt="" coords="469,401,534,380,536,385,470,406"/>
<area shape="poly" title=" " alt="" coords="277,156,319,138,333,127,342,115,352,102,366,89,375,84,378,88,370,93,355,106,346,118,337,130,321,143,279,160"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="375,104,481,129"/>
<area shape="poly" title=" " alt="" coords="277,153,364,130,366,135,278,158"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="382,153,474,179"/>
<area shape="poly" title=" " alt="" coords="278,163,368,163,368,169,278,169"/>
</map>
</div>

</div>
</div>
<a id="aa55c56601a4d47af6f8d162ff1aa9503" name="aa55c56601a4d47af6f8d162ff1aa9503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55c56601a4d47af6f8d162ff1aa9503">&#9670;&#160;</a></span>do_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_vmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmeasure_8c_source.html#l00099">99</a> of file <a class="el" href="vmeasure_8c_source.html">vmeasure.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordtype">int</span> ntimes, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordtype">int</span> nobs = 0, nans = 0;</div>
<div class="line"><span class="lineno">  104</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><span class="lineno">  105</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">  106</span>  SEXP pompfun;</div>
<div class="line"><span class="lineno">  107</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  110</span>  SEXP cvec;</div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  114</span>  ntimes = length(times);</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><span class="lineno">  119</span>  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><span class="lineno">  120</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  126</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> ((<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><span class="lineno">  132</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;vmeasure&quot;</span>)));</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">  137</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  138</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  139</span>  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  142</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  143</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><span class="lineno">  147</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  150</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>  <span class="comment">// first do setup</span></div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  161</span>    SEXP ans;</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>          PROTECT(</div>
<div class="line"><span class="lineno">  177</span>                  ans = <a class="code hl_function" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  178</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  179</span>                                  time,</div>
<div class="line"><span class="lineno">  180</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  181</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  182</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  183</span>                                  )</div>
<div class="line"><span class="lineno">  184</span>                  );</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>          nans = LENGTH(ans);</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>          nobs = (int) sqrt(nans);</div>
<div class="line"><span class="lineno">  189</span>          <span class="keywordflow">if</span> (nans != nobs*nobs)</div>
<div class="line"><span class="lineno">  190</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a symmetric square matrix.&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>          PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(ans)));</div>
<div class="line"><span class="lineno">  193</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><span class="lineno">  194</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a matrix with row-names.&quot;</span>);</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>          PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>          nprotect += 3;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>          yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  201</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  204</span>          yt += nans;</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>          first = 0;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>          PROTECT(</div>
<div class="line"><span class="lineno">  211</span>                  ans = <a class="code hl_function" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><span class="lineno">  212</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><span class="lineno">  213</span>                                  time,</div>
<div class="line"><span class="lineno">  214</span>                                  xs+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  215</span>                                  ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  216</span>                                  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><span class="lineno">  217</span>                                  )</div>
<div class="line"><span class="lineno">  218</span>                  );</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>          <span class="keywordflow">if</span> (LENGTH(ans) != nans)</div>
<div class="line"><span class="lineno">  221</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  226</span>          yt += nans;</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>          UNPROTECT(1);</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        }</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>      }</div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  242</span>    SEXP vmatindex;</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx, *vmidx;</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_typedef" href="pomp_8h.html#ad514ab0a8cca7242600f76a41ac1b45e">pomp_vmeasure</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  248</span>    nans = nobs*nobs;</div>
<div class="line"><span class="lineno">  249</span>    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><span class="lineno">  250</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  251</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  252</span>    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  253</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    PROTECT(vmatindex = NEW_INTEGER(nans)); nprotect++;</div>
<div class="line"><span class="lineno">  256</span>    vmidx = INTEGER(vmatindex);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">for</span> (k = 0; k &lt; nobs; k++) {</div>
<div class="line"><span class="lineno">  258</span>      <span class="keywordflow">for</span> (j = 0; j &lt; nobs; j++) {</div>
<div class="line"><span class="lineno">  259</span>        vmidx[j+nobs*k] = oidx[j]+nobs*oidx[k];</div>
<div class="line"><span class="lineno">  260</span>      }</div>
<div class="line"><span class="lineno">  261</span>    }</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <span class="comment">// address of native routine</span></div>
<div class="line"><span class="lineno">  264</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><span class="lineno">  267</span>    yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  274</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nans) { <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        xp = &amp;xs[<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><span class="lineno">  279</span>        pp = &amp;ps[<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        (*ff)(yt,xp,pp,vmidx,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>      }</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>  }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno">  291</span>    nobs = LENGTH(Onames);</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordtype">int</span> dim[4] = {nobs, nobs, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><span class="lineno">  293</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[4] = {<span class="stringliteral">&quot;var1&quot;</span>,<span class="stringliteral">&quot;var2&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordtype">int</span> i, n = nobs*nobs*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(4,dim)); nprotect++;</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,4);</div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_function" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames);</div>
<div class="line"><span class="lineno">  300</span>    <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,4);</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><span class="lineno">  305</span>  }</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>  }</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  310</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">  311</span>}</div>
<div class="ttc" id="apomp_8h_html_ad514ab0a8cca7242600f76a41ac1b45e"><div class="ttname"><a href="pomp_8h.html#ad514ab0a8cca7242600f76a41ac1b45e">pomp_vmeasure</a></div><div class="ttdeci">void pomp_vmeasure(double *f, const double *x, const double *p, const int *vmatindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00099">pomp.h:100</a></div></div>
<div class="ttc" id="avmeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="vmeasure_8c_source.html#l00060">vmeasure.c:60</a></div></div>
<div class="ttc" id="avmeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="vmeasure_8c_source.html#l00010">vmeasure.c:10</a></div></div>
<div class="ttc" id="avmeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="vmeasure_8c_source.html#l00084">vmeasure.c:84</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph.png" border="0" usemap="#adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph" alt=""/></div>
<map name="adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph" id="adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph">
<area shape="rect" title=" " alt="" coords="5,333,116,359"/>
<area shape="rect" href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="207,5,288,31"/>
<area shape="poly" title=" " alt="" coords="60,332,66,281,81,205,95,164,112,122,134,83,162,48,192,28,195,33,166,52,139,86,117,125,100,166,87,207,71,282,65,333"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,107,291,132"/>
<area shape="poly" title=" " alt="" coords="62,332,72,295,91,243,121,189,140,163,162,141,189,126,192,131,166,145,144,167,125,191,96,245,77,296,67,334"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,132,494,157"/>
<area shape="poly" title=" " alt="" coords="60,333,65,285,80,218,93,182,111,148,134,117,163,92,193,77,226,70,259,71,293,76,356,98,407,123,404,127,354,103,292,82,259,76,226,76,195,82,165,96,138,121,115,151,98,184,85,219,70,286,65,333"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,156,307,181"/>
<area shape="poly" title=" " alt="" coords="65,332,100,269,128,232,162,199,185,185,188,189,166,203,132,235,105,272,70,335"/>
<area shape="rect" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="207,409,287,435"/>
<area shape="poly" title=" " alt="" coords="92,356,165,388,201,402,199,407,163,392,90,361"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,232,492,257"/>
<area shape="poly" title=" " alt="" coords="68,332,104,285,131,261,163,242,216,227,272,222,325,223,372,228,372,234,325,228,272,227,217,232,165,247,134,265,108,289,72,335"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="166,459,329,484"/>
<area shape="poly" title=" " alt="" coords="74,357,111,400,137,423,165,444,181,451,178,456,163,448,133,427,107,403,70,360"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,559,819,584"/>
<area shape="poly" title=" " alt="" coords="69,358,81,387,101,424,129,462,165,493,234,507,377,526,688,561,687,566,377,531,233,512,163,498,126,466,97,427,76,389,64,360"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="164,609,331,635"/>
<area shape="poly" title=" " alt="" coords="66,359,73,404,90,468,120,537,141,568,166,596,171,600,168,604,162,600,136,572,115,539,85,470,68,405,61,360"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,295,485,320"/>
<area shape="poly" title=" " alt="" coords="116,338,379,311,379,316,116,343"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="176,560,319,585"/>
<area shape="poly" title=" " alt="" coords="68,358,79,393,99,442,127,493,145,517,166,539,186,552,183,557,162,543,141,521,123,496,94,444,74,395,63,360"/>
<area shape="rect" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="207,257,288,283"/>
<area shape="poly" title=" " alt="" coords="90,331,163,300,199,285,201,290,165,304,92,336"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="386,352,491,377"/>
<area shape="poly" title=" " alt="" coords="116,346,372,359,372,364,116,351"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="195,659,300,684"/>
<area shape="poly" title=" " alt="" coords="65,359,70,412,84,489,97,531,114,573,137,611,166,645,183,657,180,661,162,649,133,615,110,575,92,533,79,490,64,412,60,359"/>
<area shape="poly" title=" " alt="" coords="291,122,370,133,370,138,291,128"/>
<area shape="poly" title=" " alt="" coords="306,159,369,151,369,156,307,164"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,560,499,585"/>
<area shape="poly" title=" " alt="" coords="319,570,365,570,365,575,319,575"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,609,490,635"/>
<area shape="poly" title=" " alt="" coords="298,583,376,603,374,608,297,588"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,584,653,609"/>
<area shape="poly" title=" " alt="" coords="490,611,533,604,534,610,491,617"/>
<area shape="poly" title=" " alt="" coords="653,586,687,580,688,585,654,591"/>
<area shape="poly" title=" " alt="" coords="266,255,405,163,408,167,269,260"/>
<area shape="poly" title=" " alt="" coords="288,262,372,251,372,256,289,267"/>
<area shape="poly" title=" " alt="" coords="289,275,380,293,379,298,288,280"/>
<area shape="poly" title=" " alt="" coords="275,280,401,343,398,348,273,285"/>
</map>
</div>

</div>
</div>
<a id="a666ff456fb565a43aac025137ae5b0f0" name="a666ff456fb565a43aac025137ae5b0f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666ff456fb565a43aac025137ae5b0f0">&#9670;&#160;</a></span>E_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP E_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>rate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00071">71</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>                                                          {</div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><span class="lineno">   73</span>  SEXP x;</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;eeulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;eeulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   78</span>  PROTECT(size = AS_NUMERIC(size));</div>
<div class="line"><span class="lineno">   79</span>  PROTECT(rate = AS_NUMERIC(rate));</div>
<div class="line"><span class="lineno">   80</span>  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><span class="lineno">   81</span>  PROTECT(x = duplicate(rate));</div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_function" href="pomp_8h.html#a210a3bacc8d9a585b5237408fbe04ae0">eeulermultinom</a>(ntrans,*REAL(size),REAL(rate),*REAL(deltat),REAL(x));</div>
<div class="line"><span class="lineno">   83</span>  UNPROTECT(4);</div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">   85</span>}</div>
<div class="ttc" id="apomp_8h_html_a210a3bacc8d9a585b5237408fbe04ae0"><div class="ttname"><a href="pomp_8h.html#a210a3bacc8d9a585b5237408fbe04ae0">eeulermultinom</a></div><div class="ttdeci">static R_INLINE void eeulermultinom(int m, double size, const double *rate, double dt, double *trans)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00137">pomp.h:138</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a666ff456fb565a43aac025137ae5b0f0_cgraph.png" border="0" usemap="#adecls_8h_a666ff456fb565a43aac025137ae5b0f0_cgraph" alt=""/></div>
<map name="adecls_8h_a666ff456fb565a43aac025137ae5b0f0_cgraph" id="adecls_8h_a666ff456fb565a43aac025137ae5b0f0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,31"/>
<area shape="rect" href="pomp_8h.html#a210a3bacc8d9a585b5237408fbe04ae0" title=" " alt="" coords="192,5,319,31"/>
<area shape="poly" title=" " alt="" coords="144,15,178,15,178,21,144,21"/>
</map>
</div>

</div>
</div>
<a id="a19293a3a394b4e0885714f833bc2a96b" name="a19293a3a394b4e0885714f833bc2a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19293a3a394b4e0885714f833bc2a96b">&#9670;&#160;</a></span>euler_simulator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP euler_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>func</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>xstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>tstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a></td>          <td class="paramname"><span class="paramname"><em>method</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>accumvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00107">107</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  112</span>   {</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, nzeros, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><span class="lineno">  116</span>  <span class="keywordtype">double</span> *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, t0;</div>
<div class="line"><span class="lineno">  117</span>  SEXP cvec, <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <span class="keywordflow">if</span> (deltat &lt;= 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;delta.t&#39; should be a positive number.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  122</span>  dim = INTEGER(GET_DIM(xstart)); <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">  123</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><span class="lineno">  124</span>  ntimes = LENGTH(times);</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><span class="lineno">  127</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  128</span>  t0 = *(REAL(tstart));</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><span class="lineno">  132</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><span class="lineno">  133</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  134</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(covar));</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(covar,&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  138</span>  PROTECT(cvec = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// indices of accumulator variables</span></div>
<div class="line"><span class="lineno">  142</span>  nzeros = LENGTH(accumvars);</div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordtype">int</span> *zidx = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="comment">// extract user function</span></div>
<div class="line"><span class="lineno">  146</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="comment">// array to hold results</span></div>
<div class="line"><span class="lineno">  149</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <span class="comment">// copy the start values into the result array</span></div>
<div class="line"><span class="lineno">  152</span>  memcpy(REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(xstart),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">// set up</span></div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordtype">int</span> *pidx = 0, *sidx = 0, *cidx = 0;</div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_typedef" href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a> *ff = NULL;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// construct list of all arguments</span></div>
<div class="line"><span class="lineno">  164</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><span class="lineno">  168</span>    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><span class="lineno">  169</span>    sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  170</span>    pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  171</span>    cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    GetRNGstate();</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">break</span>;                              <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  181</span>  }</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  <span class="comment">// main computation loop</span></div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordtype">int</span> step;</div>
<div class="line"><span class="lineno">  185</span>  <span class="keywordtype">double</span> *xt, *time, t;</div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno">  189</span>       step = 0, xt = REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>), time = REAL(times), t = t0;</div>
<div class="line"><span class="lineno">  190</span>       step &lt; ntimes;</div>
<div class="line"><span class="lineno">  191</span>       step++, xt += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div>
<div class="line"><span class="lineno">  192</span>       ) {</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordtype">double</span> dt;</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordtype">int</span> nstep = 0;</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">if</span> (t &gt; time[step]) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;times&#39; must be an increasing sequence.&quot;</span>);  <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++)</div>
<div class="line"><span class="lineno">  204</span>      <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><span class="lineno">  205</span>        xt[zidx[i]+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*j] = 0.0;</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// determine size and number of time-steps</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">switch</span> (method) {</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="keywordflow">default</span>:      <span class="comment">// one step</span></div>
<div class="line"><span class="lineno">  210</span>      dt = time[step]-t;</div>
<div class="line"><span class="lineno">  211</span>      nstep = 1;</div>
<div class="line"><span class="lineno">  212</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>:              <span class="comment">// fixed step</span></div>
<div class="line"><span class="lineno">  214</span>      dt = deltat;</div>
<div class="line"><span class="lineno">  215</span>      nstep = <a class="code hl_function" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a>(t,time[step],dt);</div>
<div class="line"><span class="lineno">  216</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>:                 <span class="comment">// Euler method</span></div>
<div class="line"><span class="lineno">  218</span>      dt = deltat;</div>
<div class="line"><span class="lineno">  219</span>      nstep = <a class="code hl_function" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a>(t,time[step],&amp;dt);</div>
<div class="line"><span class="lineno">  220</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="comment">// loop over individual steps</span></div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">for</span> (k = 0; k &lt; nstep; k++) {</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  227</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,t,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>      <span class="comment">// loop over replicates</span></div>
<div class="line"><span class="lineno">  230</span>      <span class="keywordtype">double</span> *ap, *pm, *xm, *ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>      <span class="keywordflow">for</span> (j = 0, pm = ps, xm = xt; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pm += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, xm += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><span class="lineno">  237</span>          {</div>
<div class="line"><span class="lineno">  238</span>            SEXP ans, nm;</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>              PROTECT(ans = <a class="code hl_function" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>              PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  245</span>              <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><span class="lineno">  246</span>                <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprocess&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  247</span>              pidx = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(nm,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>              nprotect += 3;</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>              ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  252</span>              <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>              first = 0;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>              PROTECT(ans = <a class="code hl_function" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>              ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  261</span>              <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>              UNPROTECT(1);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>            }</div>
<div class="line"><span class="lineno">  266</span>          }</div>
<div class="line"><span class="lineno">  267</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><span class="lineno">  270</span>          (*ff)(xm,pm,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t,dt);</div>
<div class="line"><span class="lineno">  271</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">default</span>:                              <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  274</span>          <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  275</span>          <span class="keywordflow">break</span>;                              <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>      }</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>      t += dt;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>      <span class="keywordflow">if</span> ((method == <a class="code hl_enumvalue" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>) &amp;&amp; (k == nstep-2)) { <span class="comment">// penultimate step</span></div>
<div class="line"><span class="lineno">  284</span>        dt = time[step]-t;</div>
<div class="line"><span class="lineno">  285</span>        t = time[step]-dt;</div>
<div class="line"><span class="lineno">  286</span>      }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    }</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">if</span> (step &lt; ntimes-1)</div>
<div class="line"><span class="lineno">  291</span>      memcpy(xt+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,xt,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>  }</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>  <span class="comment">// clean up</span></div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    PutRNGstate();</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>  }</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  }</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  313</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>}</div>
<div class="ttc" id="aeuler_8c_html_a0681d20c093a288da04bffa9adbfe48a"><div class="ttname"><a href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a></div><div class="ttdeci">int num_map_steps(double t1, double t2, double deltat)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00342">euler.c:342</a></div></div>
<div class="ttc" id="aeuler_8c_html_a3da8d135fe6d232031cf7c314f432265"><div class="ttname"><a href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a></div><div class="ttdeci">int num_euler_steps(double t1, double t2, double *deltat)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00317">euler.c:317</a></div></div>
<div class="ttc" id="aeuler_8c_html_ad78b5357467ce6dfb3b594a64a0e3d08"><div class="ttname"><a href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *dt, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00067">euler.c:67</a></div></div>
<div class="ttc" id="aeuler_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="euler_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00010">euler.c:10</a></div></div>
<div class="ttc" id="aeuler_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00092">euler.c:92</a></div></div>
<div class="ttc" id="apomp_8h_html_abd7cfb2f9064495241ac3474f912d36d"><div class="ttname"><a href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a></div><div class="ttdeci">void pomp_onestep_sim(double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t, double dt)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00058">pomp.h:59</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph.png" border="0" usemap="#adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph" alt=""/></div>
<map name="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph" id="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph">
<area shape="rect" title=" " alt="" coords="5,256,129,281"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="220,5,301,31"/>
<area shape="poly" title=" " alt="" coords="68,255,79,214,98,156,130,94,151,65,176,40,206,24,208,29,179,44,155,68,134,96,103,158,84,215,74,256"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="221,55,301,80"/>
<area shape="poly" title=" " alt="" coords="70,255,83,221,105,177,136,130,176,89,206,74,209,79,179,93,140,133,110,179,88,224,75,257"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="179,104,342,129"/>
<area shape="poly" title=" " alt="" coords="75,254,115,203,143,173,176,146,202,132,204,137,179,151,147,177,119,206,79,257"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="715,205,832,231"/>
<area shape="poly" title=" " alt="" coords="80,254,120,220,147,203,176,190,249,172,324,163,400,160,474,163,609,179,712,200,711,205,608,184,474,168,400,166,325,168,250,178,178,195,150,208,123,224,83,258"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="177,205,344,231"/>
<area shape="poly" title=" " alt="" coords="116,253,198,232,199,237,117,258"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="560,256,667,281"/>
<area shape="poly" title=" " alt="" coords="129,266,546,266,546,271,129,271"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="194,307,327,332"/>
<area shape="poly" title=" " alt="" coords="117,279,199,301,198,306,116,284"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="196,356,325,381"/>
<area shape="poly" title=" " alt="" coords="86,279,126,310,179,341,198,349,196,354,176,346,123,314,82,284"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="189,405,332,431"/>
<area shape="poly" title=" " alt="" coords="79,280,117,334,146,364,179,390,192,398,189,402,176,395,142,368,113,337,74,283"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="220,455,301,480"/>
<area shape="poly" title=" " alt="" coords="76,281,89,313,110,356,141,401,179,440,208,455,206,460,176,444,136,405,106,359,84,315,71,283"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="208,504,313,529"/>
<area shape="poly" title=" " alt="" coords="74,281,84,321,104,377,135,438,155,465,179,489,197,500,194,505,176,493,151,469,131,440,99,380,79,323,69,282"/>
<area shape="poly" title=" " alt="" coords="654,253,719,232,720,237,655,258"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="392,331,512,356"/>
<area shape="poly" title=" " alt="" coords="308,403,343,390,391,365,404,359,406,364,393,370,345,395,309,408"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="401,380,503,405"/>
<area shape="poly" title=" " alt="" coords="332,406,386,399,387,404,333,411"/>
<area shape="poly" title=" " alt="" coords="487,378,511,365,555,328,591,290,595,294,559,332,513,370,490,382"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="399,429,505,455"/>
<area shape="poly" title=" " alt="" coords="301,459,385,448,386,453,302,465"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="406,479,498,504"/>
<area shape="poly" title=" " alt="" coords="302,470,393,481,392,487,301,475"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="397,528,507,553"/>
<area shape="poly" title=" " alt="" coords="303,475,345,489,393,513,409,520,407,525,391,518,343,494,301,480"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph.png" border="0" usemap="#adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph" alt=""/></div>
<map name="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph" id="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph">
<area shape="rect" title=" " alt="" coords="636,5,760,31"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="488,5,588,31"/>
<area shape="poly" title=" " alt="" coords="622,21,588,21,588,15,622,15"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a87734543f5fc40ed123f9f1664e3b7a7" name="a87734543f5fc40ed123f9f1664e3b7a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87734543f5fc40ed123f9f1664e3b7a7">&#9670;&#160;</a></span>eval_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>npars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ncovars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ntimes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nreps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>sidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>pidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>cidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *</td>          <td class="paramname"><span class="paramname"><em>covar_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *</td>          <td class="paramname"><span class="paramname"><em>fun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>cov</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00245">245</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{</div>
<div class="line"><span class="lineno">  253</span>  <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><span class="lineno">  254</span>  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>      xp = &amp;x[<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k)];</div>
<div class="line"><span class="lineno">  265</span>      pp = &amp;p[<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp)];</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>      (*fun)(f,xp,pp,sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span>  }</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>}</div>
<div class="ttc" id="atrajectory_8c_html_a6d8415c759496fb5460bce9a56445919"><div class="ttname"><a href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a></div><div class="ttdeci">lookup_table_t covar_table</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00130">trajectory.c:130</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph.png" border="0" usemap="#adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph" alt=""/></div>
<map name="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph" id="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,165,31"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="213,5,319,31"/>
<area shape="poly" title=" " alt="" coords="166,15,199,15,199,21,166,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph.png" border="0" usemap="#adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph" alt=""/></div>
<map name="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph" id="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph">
<area shape="rect" title=" " alt="" coords="168,31,328,56"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="13,5,113,31"/>
<area shape="poly" title=" " alt="" coords="154,33,113,27,113,22,154,28"/>
<area shape="rect" href="trajectory_8c.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,55,120,80"/>
<area shape="poly" title=" " alt="" coords="154,58,120,63,120,57,154,53"/>
</map>
</div>

</div>
</div>
<a id="a02d94e3819f568bb29c6d5e77f02a3d8" name="a02d94e3819f568bb29c6d5e77f02a3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d94e3819f568bb29c6d5e77f02a3d8">&#9670;&#160;</a></span>eval_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>fn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Snames</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>npars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ncovars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ntimes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nreps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *</td>          <td class="paramname"><span class="paramname"><em>covar_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>cov</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00093">93</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>   {</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  SEXP ans, nm;</div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordtype">double</span> *fs;</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>        PROTECT(ans = <a class="code hl_function" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><span class="lineno">  121</span>                                x+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  122</span>                                p+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  123</span>                                <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordflow">if</span> (LENGTH(ans)!=<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><span class="lineno">  126</span>          <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><span class="lineno">  129</span>        PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><span class="lineno">  131</span>          <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>        posn = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>        fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        nprotect += 3;</div>
<div class="line"><span class="lineno">  138</span>        first = 0;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        PROTECT(ans = <a class="code hl_function" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><span class="lineno">  143</span>                                x+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><span class="lineno">  144</span>                                p+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><span class="lineno">  145</span>                                <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>        fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>        UNPROTECT(1);</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>      }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    }</div>
<div class="line"><span class="lineno">  155</span>  }</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>}</div>
<div class="ttc" id="askeleton_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00057">skeleton.c:57</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph.png" border="0" usemap="#adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph" alt=""/></div>
<map name="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph" id="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,133,107"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="195,5,275,31"/>
<area shape="poly" title=" " alt="" coords="97,79,192,34,195,39,99,84"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="336,81,453,107"/>
<area shape="poly" title=" " alt="" coords="134,91,322,91,322,97,134,97"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="181,107,288,132"/>
<area shape="poly" title=" " alt="" coords="134,101,168,106,167,112,133,106"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="182,156,287,181"/>
<area shape="poly" title=" " alt="" coords="100,104,195,148,192,153,98,109"/>
<area shape="poly" title=" " alt="" coords="288,108,322,103,323,108,289,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph.png" border="0" usemap="#adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph" alt=""/></div>
<map name="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph" id="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph">
<area shape="rect" title=" " alt="" coords="168,31,296,56"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="13,5,113,31"/>
<area shape="poly" title=" " alt="" coords="154,34,113,28,113,23,155,29"/>
<area shape="rect" href="trajectory_8c.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,55,120,80"/>
<area shape="poly" title=" " alt="" coords="155,57,121,62,120,57,154,52"/>
</map>
</div>

</div>
</div>
<a id="a6cc031bd56388c0dbb1b6e4aacb3971c" name="a6cc031bd56388c0dbb1b6e4aacb3971c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc031bd56388c0dbb1b6e4aacb3971c">&#9670;&#160;</a></span>ExpitTransform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP ExpitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00026">26</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                             {</div>
<div class="line"><span class="lineno">   27</span>  <span class="keywordtype">double</span> *x;</div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><span class="lineno">   29</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><span class="lineno">   30</span>  x = REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">   31</span>  n = LENGTH(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, x++)</div>
<div class="line"><span class="lineno">   33</span>    *x = 1.0/(1.0+exp(-(*x)));</div>
<div class="line"><span class="lineno">   34</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">   36</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6345040eb63a38c0ff7ae42f3ea35ff" name="ae6345040eb63a38c0ff7ae42f3ea35ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6345040eb63a38c0ff7ae42f3ea35ff">&#9670;&#160;</a></span>get_covariate_names()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP get_covariate_names </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00007">7</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    7</span>                                       {</div>
<div class="line"><span class="lineno">    8</span>  <span class="keywordflow">return</span> GET_ROWNAMES(GET_DIMNAMES(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><span class="lineno">    9</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph.png" border="0" usemap="#adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph" alt=""/></div>
<map name="adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph" id="adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph">
<area shape="rect" title=" " alt="" coords="872,331,1035,356"/>
<area shape="rect" href="dmeasure_8c.html#a326516e59ec4f791bcc752ef5f763c71" title=" " alt="" coords="689,5,799,31"/>
<area shape="poly" title=" " alt="" coords="946,317,934,261,912,187,896,148,875,110,851,75,822,44,798,30,801,25,826,40,855,72,880,107,900,146,917,185,939,259,951,316"/>
<area shape="rect" href="emeasure_8c.html#ab362c459382493c6f7f4721dc5bf6457" title=" " alt="" coords="689,55,799,80"/>
<area shape="poly" title=" " alt="" coords="942,318,927,272,902,214,867,154,846,126,822,101,791,82,794,78,826,97,850,123,872,151,907,212,932,270,947,316"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="527,193,598,219"/>
<area shape="poly" title=" " alt="" coords="937,320,919,289,894,254,861,221,823,196,794,186,764,180,703,179,645,186,599,197,598,192,644,181,702,173,765,175,796,181,825,192,865,217,898,251,924,286,942,317"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,280,108,305"/>
<area shape="poly" title=" " alt="" coords="939,319,921,284,896,243,863,202,823,168,757,134,700,121,640,119,564,121,398,121,346,126,294,140,245,161,200,186,123,239,73,282,70,278,119,235,197,181,243,156,293,135,345,121,398,115,564,115,640,114,701,116,759,129,825,164,867,198,900,240,926,282,944,317"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="509,479,616,504"/>
<area shape="poly" title=" " alt="" coords="941,370,923,400,897,434,864,467,825,492,772,509,716,514,662,512,616,506,616,501,662,507,715,509,771,504,823,488,861,463,893,431,919,397,937,367"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="694,256,794,281"/>
<area shape="poly" title=" " alt="" coords="908,328,823,295,788,284,790,279,825,290,910,323"/>
<area shape="rect" href="vmeasure_8c.html#a97fc58eebfdaa733377f210c1dd48082" title=" " alt="" coords="689,305,799,331"/>
<area shape="poly" title=" " alt="" coords="858,334,799,327,800,322,858,329"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="682,207,806,232"/>
<area shape="poly" title=" " alt="" coords="927,323,881,284,823,246,796,235,798,230,825,241,884,279,931,319"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="695,404,793,429"/>
<area shape="poly" title=" " alt="" coords="907,363,825,394,787,406,785,401,823,389,906,358"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="693,453,795,479"/>
<area shape="poly" title=" " alt="" coords="930,367,883,405,825,443,795,456,793,451,823,438,880,401,927,363"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="337,499,461,524"/>
<area shape="poly" title=" " alt="" coords="945,370,928,406,902,448,868,489,848,506,825,520,775,540,722,552,668,556,615,556,517,544,441,527,443,521,518,539,615,551,668,551,722,546,774,535,823,516,845,502,864,485,898,445,923,403,940,368"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="679,655,809,680"/>
<area shape="poly" title=" " alt="" coords="951,370,939,427,917,501,900,540,880,578,855,614,826,645,808,657,805,652,822,641,851,611,875,575,895,538,912,499,934,426,946,369"/>
<area shape="rect" href="trajectory_8c.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="664,605,824,631"/>
<area shape="poly" title=" " alt="" coords="947,371,932,416,907,474,872,535,850,563,826,588,793,608,790,603,822,584,846,559,867,532,902,472,927,415,942,369"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="685,355,803,380"/>
<area shape="poly" title=" " alt="" coords="858,357,803,363,803,358,858,352"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="348,280,451,305"/>
<area shape="poly" title=" " alt="" coords="527,228,426,282,423,277,524,223"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,280,289,305"/>
<area shape="poly" title=" " alt="" coords="334,295,290,295,290,290,334,290"/>
<area shape="poly" title=" " alt="" coords="142,295,108,295,108,290,142,290"/>
<area shape="poly" title=" " alt="" coords="535,471,507,442,448,367,407,307,411,304,452,364,511,439,539,467"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="513,280,613,305"/>
<area shape="poly" title=" " alt="" coords="685,239,665,246,588,282,586,277,663,241,683,234"/>
<area shape="poly" title=" " alt="" coords="499,295,451,295,451,290,499,290"/>
<area shape="rect" href="dinit_8c.html#aa791ce91b1a00dfb19ecaf829dfc287a" title=" " alt="" coords="525,404,600,429"/>
<area shape="poly" title=" " alt="" coords="681,419,600,419,600,414,681,414"/>
<area shape="poly" title=" " alt="" coords="365,494,76,308,79,303,368,489"/>
<area shape="rect" href="dprocess_8c.html#a2a6438a8b3220ecd24e531d5b3dd4534" title=" " alt="" coords="511,655,614,680"/>
<area shape="poly" title=" " alt="" coords="665,670,614,670,614,665,665,665"/>
<area shape="poly" title=" " alt="" coords="686,353,663,344,586,308,589,303,665,340,688,348"/>
</map>
</div>

</div>
</div>
<a id="a0f11ca97854cd188080da40020f738eb" name="a0f11ca97854cd188080da40020f738eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f11ca97854cd188080da40020f738eb">&#9670;&#160;</a></span>get_userdata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const SEXP get_userdata </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00013">13</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                                           {</div>
<div class="line"><span class="lineno">   14</span>  SEXP elt = <a class="code hl_function" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code hl_define" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><span class="lineno">   15</span>  <span class="keywordflow">if</span> (isNull(elt)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><span class="lineno">   16</span>  <span class="keywordflow">return</span> elt;</div>
<div class="line"><span class="lineno">   17</span>}</div>
<div class="ttc" id="apomp__defines_8h_html_ab39b1553739e35037c2a8846ba65594f"><div class="ttname"><a href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a></div><div class="ttdeci">static R_INLINE SEXP getListElement(SEXP list, const char *str)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00232">pomp_defines.h:232</a></div></div>
<div class="ttc" id="auserdata_8c_html_a1157d519a72b891b41cef2d20a90bebb"><div class="ttname"><a href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a></div><div class="ttdeci">#define USERDATA</div><div class="ttdef"><b>Definition</b> <a href="userdata_8c_source.html#l00006">userdata.c:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0f11ca97854cd188080da40020f738eb_cgraph.png" border="0" usemap="#adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph" alt=""/></div>
<map name="adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph" id="adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,112,31"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="160,5,280,31"/>
<area shape="poly" title=" " alt="" coords="112,15,146,15,146,21,112,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0f11ca97854cd188080da40020f738eb_icgraph.png" border="0" usemap="#adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph" alt=""/></div>
<map name="adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph" id="adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,263,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a34196cff245ce7384eb8b2c3fa4a6552" name="a34196cff245ce7384eb8b2c3fa4a6552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34196cff245ce7384eb8b2c3fa4a6552">&#9670;&#160;</a></span>get_userdata_double()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double * get_userdata_double </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00026">26</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                                                     {</div>
<div class="line"><span class="lineno">   27</span>  SEXP elt = <a class="code hl_function" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code hl_define" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordflow">if</span> (isNull(elt)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordflow">if</span> (!isReal(elt)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not a numeric vector.&quot;</span>,name);</div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordflow">return</span> REAL(elt);</div>
<div class="line"><span class="lineno">   31</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34196cff245ce7384eb8b2c3fa4a6552_cgraph.png" border="0" usemap="#adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_cgraph" alt=""/></div>
<map name="adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_cgraph" id="adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,31"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="212,5,332,31"/>
<area shape="poly" title=" " alt="" coords="164,15,198,15,198,21,164,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34196cff245ce7384eb8b2c3fa4a6552_icgraph.png" border="0" usemap="#adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_icgraph" alt=""/></div>
<map name="adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_icgraph" id="adecls_8h_a34196cff245ce7384eb8b2c3fa4a6552_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,315,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a3f2923b639b10bf3be378a454be2ba23" name="a3f2923b639b10bf3be378a454be2ba23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f2923b639b10bf3be378a454be2ba23">&#9670;&#160;</a></span>get_userdata_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int * get_userdata_int </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00019">19</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   19</span>                                               {</div>
<div class="line"><span class="lineno">   20</span>  SEXP elt = <a class="code hl_function" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code hl_define" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><span class="lineno">   21</span>  <span class="keywordflow">if</span> (isNull(elt)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><span class="lineno">   22</span>  <span class="keywordflow">if</span> (!isInteger(elt)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not an integer.&quot;</span>,name);</div>
<div class="line"><span class="lineno">   23</span>  <span class="keywordflow">return</span> INTEGER(elt);</div>
<div class="line"><span class="lineno">   24</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a3f2923b639b10bf3be378a454be2ba23_cgraph.png" border="0" usemap="#adecls_8h_a3f2923b639b10bf3be378a454be2ba23_cgraph" alt=""/></div>
<map name="adecls_8h_a3f2923b639b10bf3be378a454be2ba23_cgraph" id="adecls_8h_a3f2923b639b10bf3be378a454be2ba23_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,31"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="184,5,304,31"/>
<area shape="poly" title=" " alt="" coords="136,15,170,15,170,21,136,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a3f2923b639b10bf3be378a454be2ba23_icgraph.png" border="0" usemap="#adecls_8h_a3f2923b639b10bf3be378a454be2ba23_icgraph" alt=""/></div>
<map name="adecls_8h_a3f2923b639b10bf3be378a454be2ba23_icgraph" id="adecls_8h_a3f2923b639b10bf3be378a454be2ba23_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,287,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a534d4c8bcea55d9f5a6e7d8b34e55408" name="a534d4c8bcea55d9f5a6e7d8b34e55408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a534d4c8bcea55d9f5a6e7d8b34e55408">&#9670;&#160;</a></span>InverseLogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP InverseLogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Y</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00047">47</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                                             {</div>
<div class="line"><span class="lineno">   48</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">   49</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = AS_NUMERIC(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><span class="lineno">   50</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(LENGTH(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>)));</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_function" href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102">from_log_barycentric</a>(REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),LENGTH(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><span class="lineno">   52</span>  UNPROTECT(2);</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">   54</span>}</div>
<div class="ttc" id="apomp_8h_html_a3e9f93a24377bb00084d9400134fd102"><div class="ttname"><a href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102">from_log_barycentric</a></div><div class="ttdeci">static R_INLINE void from_log_barycentric(double *xt, const double *x, int n)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00287">pomp.h:288</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph.png" border="0" usemap="#adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph" alt=""/></div>
<map name="adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph" id="adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,237,31"/>
<area shape="rect" href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102" title=" " alt="" coords="285,5,445,31"/>
<area shape="poly" title=" " alt="" coords="238,15,272,15,272,21,238,21"/>
</map>
</div>

</div>
</div>
<a id="a1bcec7f4a5a240606fb8235312d5cc45" name="a1bcec7f4a5a240606fb8235312d5cc45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bcec7f4a5a240606fb8235312d5cc45">&#9670;&#160;</a></span>iterate_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP iterate_map </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>t0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00019">19</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   20</span>{</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">   23</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">   24</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">   25</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><span class="lineno">   26</span>  SEXP skel, pompfun;</div>
<div class="line"><span class="lineno">   27</span>  SEXP accumvars;</div>
<div class="line"><span class="lineno">   28</span>  SEXP repnames;</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordtype">int</span> *zidx = 0;</div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepp, ntimes, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nzeros;</div>
<div class="line"><span class="lineno">   31</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">   32</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordtype">double</span> deltat, t;</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  PROTECT(skel = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><span class="lineno">   36</span>  deltat = *(REAL(GET_SLOT(skel,install(<span class="stringliteral">&quot;delta.t&quot;</span>))));</div>
<div class="line"><span class="lineno">   37</span>  t = *(REAL(AS_NUMERIC(t0)));</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  PROTECT(x0 = duplicate(x0));</div>
<div class="line"><span class="lineno">   40</span>  PROTECT(x0 = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(x0));</div>
<div class="line"><span class="lineno">   41</span>  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   45</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><span class="lineno">   47</span>  PROTECT(repnames = GET_COLNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">   50</span>  ntimes = LENGTH(times);</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><span class="lineno">   53</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   54</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">   57</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">   58</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  <span class="comment">// extract user-defined function</span></div>
<div class="line"><span class="lineno">   61</span>  PROTECT(pompfun = GET_SLOT(skel,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">   62</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">   65</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="comment">// create array to store results</span></div>
<div class="line"><span class="lineno">   68</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7">ret_array</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,repnames));</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  <span class="comment">// get names and indices of accumulator variables</span></div>
<div class="line"><span class="lineno">   71</span>  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><span class="lineno">   72</span>  nzeros = LENGTH(accumvars);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordtype">int</span> nprotect = 15;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">if</span> (nzeros &gt; 0) {</div>
<div class="line"><span class="lineno">   77</span>    zidx = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>))); nprotect++;</div>
<div class="line"><span class="lineno">   78</span>  }</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  <span class="comment">// set up the computations</span></div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code hl_function" href="#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_function" href="#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a>(REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><span class="lineno">   88</span>                       <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,</div>
<div class="line"><span class="lineno">   89</span>                       &amp;covariate_table,zidx,REAL(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>  }</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_typedef" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><span class="lineno">  102</span>    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  103</span>    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  104</span>    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_function" href="#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a>(REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><span class="lineno">  107</span>                            <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,sidx,pidx,cidx,</div>
<div class="line"><span class="lineno">  108</span>                            &amp;covariate_table,zidx,ff,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>  }</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">break</span>; <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  }</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  122</span>}</div>
<div class="ttc" id="adecls_8h_html_ad9390ea094fe7c28762eb6ac23f1c144"><div class="ttname"><a href="#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00010">skeleton.c:10</a></div></div>
<div class="ttc" id="adecls_8h_html_adcdcf759e7db4fcc8f07d2692c18183b"><div class="ttname"><a href="#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a></div><div class="ttdeci">void iterate_skeleton_R(double *, double, double, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, lookup_table_t *, int *, double *)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00161">skeleton.c:161</a></div></div>
<div class="ttc" id="adecls_8h_html_ae06448ff2e2ef1613edd4618634dbed6"><div class="ttname"><a href="#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a></div><div class="ttdeci">void iterate_skeleton_native(double *, double, double, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, lookup_table_t *, int *, pomp_skeleton *, SEXP, double *)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00274">skeleton.c:274</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a2109a7d0e874cf7da59ecdde93f802b7"><div class="ttname"><a href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nvars, int nreps, int ntimes, SEXP Snames, SEXP repnames)</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00006">trajectory.c:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph.png" border="0" usemap="#adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph" alt=""/></div>
<map name="adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph" id="adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph">
<area shape="rect" title=" " alt="" coords="5,252,107,277"/>
<area shape="rect" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8" title=" " alt="" coords="185,31,299,56"/>
<area shape="poly" title=" " alt="" coords="57,251,67,214,85,164,113,111,131,87,153,65,170,54,173,59,156,69,135,90,117,114,90,166,72,216,62,252"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="199,80,285,105"/>
<area shape="poly" title=" " alt="" coords="60,251,92,186,119,147,153,114,184,99,187,104,156,119,123,151,96,188,65,253"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="161,203,323,228"/>
<area shape="poly" title=" " alt="" coords="104,249,179,229,180,234,105,255"/>
<area shape="rect" href="skeleton_8c.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="155,252,329,277"/>
<area shape="poly" title=" " alt="" coords="107,262,141,262,141,267,107,267"/>
<area shape="rect" href="skeleton_8c.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2" title=" " alt="" coords="171,301,313,327"/>
<area shape="poly" title=" " alt="" coords="105,275,180,295,179,300,104,280"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="555,428,661,453"/>
<area shape="poly" title=" " alt="" coords="73,275,110,305,156,336,215,368,263,391,312,408,378,425,462,437,541,440,541,445,462,442,377,430,311,413,261,396,213,373,153,340,107,309,70,279"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="159,553,325,579"/>
<area shape="poly" title=" " alt="" coords="61,278,66,327,80,397,92,435,109,473,130,508,157,539,163,544,160,548,153,543,126,511,104,475,87,437,75,398,60,327,55,278"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="171,504,313,529"/>
<area shape="poly" title=" " alt="" coords="62,277,71,317,88,372,116,431,135,458,156,483,176,496,173,500,153,487,130,462,111,434,83,374,66,318,57,278"/>
<area shape="rect" href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7" title=" " alt="" coords="201,129,283,155"/>
<area shape="poly" title=" " alt="" coords="71,250,153,188,203,159,205,163,156,192,74,254"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="387,5,497,31"/>
<area shape="poly" title=" " alt="" coords="285,80,328,65,376,40,391,33,393,38,378,44,330,70,286,85"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="377,203,507,228"/>
<area shape="poly" title=" " alt="" coords="294,249,376,229,377,234,295,255"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="389,252,495,277"/>
<area shape="poly" title=" " alt="" coords="330,262,375,262,375,267,330,267"/>
<area shape="poly" title=" " alt="" coords="300,299,328,286,342,275,351,263,361,250,376,237,386,231,388,236,379,242,365,254,356,266,346,279,331,291,303,304"/>
<area shape="poly" title=" " alt="" coords="294,299,376,278,377,283,295,304"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="402,301,482,327"/>
<area shape="poly" title=" " alt="" coords="313,311,388,311,388,317,313,317"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="709,403,827,428"/>
<area shape="poly" title=" " alt="" coords="310,324,697,399,696,404,309,329"/>
<area shape="poly" title=" " alt="" coords="266,325,316,353,378,381,463,407,542,426,541,431,461,413,376,386,314,357,263,329"/>
<area shape="poly" title=" " alt="" coords="661,430,695,424,696,429,662,435"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="382,553,502,579"/>
<area shape="poly" title=" " alt="" coords="295,527,377,547,376,553,294,532"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="391,504,493,529"/>
<area shape="poly" title=" " alt="" coords="313,514,377,514,377,519,313,519"/>
<area shape="poly" title=" " alt="" coords="470,502,566,457,568,461,472,506"/>
<area shape="poly" title=" " alt="" coords="282,134,306,127,328,115,344,97,351,79,359,59,376,40,382,35,385,39,379,44,364,62,356,81,348,100,331,119,308,131,284,139"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="389,55,495,80"/>
<area shape="poly" title=" " alt="" coords="282,130,328,114,376,89,391,83,393,87,378,94,330,119,284,135"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="396,104,488,129"/>
<area shape="poly" title=" " alt="" coords="282,134,382,121,383,127,283,140"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="389,153,495,179"/>
<area shape="poly" title=" " alt="" coords="283,144,376,155,376,161,282,149"/>
</map>
</div>

</div>
</div>
<a id="ae06448ff2e2ef1613edd4618634dbed6" name="ae06448ff2e2ef1613edd4618634dbed6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06448ff2e2ef1613edd4618634dbed6">&#9670;&#160;</a></span>iterate_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>npars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ncovars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ntimes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nreps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nzeros</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>sidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>pidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>cidx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *</td>          <td class="paramname"><span class="paramname"><em>covar_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>zeroindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *</td>          <td class="paramname"><span class="paramname"><em>fun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>cov</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00274">274</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  282</span>{</div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><span class="lineno">  284</span>  <span class="keywordtype">double</span> *xs, *Xs;</div>
<div class="line"><span class="lineno">  285</span>  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><span class="lineno">  292</span>    nsteps = <a class="code hl_function" href="#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><span class="lineno">  296</span>      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><span class="lineno">  297</span>        *xs = 0.0;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  302</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>      <span class="keywordflow">for</span> (j = 0, Xs = <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, xs = x; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, Xs += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, xs += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        (*fun)(Xs,xs,p+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),sidx,pidx,cidx,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t);</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>      }</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>      memcpy(x,<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><span class="lineno">  313</span>        t += deltat;</div>
<div class="line"><span class="lineno">  314</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  315</span>        t = *time;</div>
<div class="line"><span class="lineno">  316</span>      }</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    }</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">if</span> (nsteps == 0) memcpy(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>  }</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>}</div>
<div class="ttc" id="adecls_8h_html_a4e40667f6198be18fb99f8f07417da1d"><div class="ttname"><a href="#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a></div><div class="ttdeci">int num_map_steps(double, double, double)</div><div class="ttdef"><b>Definition</b> <a href="euler_8c_source.html#l00342">euler.c:342</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph.png" border="0" usemap="#adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph" alt=""/></div>
<map name="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph" id="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,180,56"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="228,5,357,31"/>
<area shape="poly" title=" " alt="" coords="180,30,214,25,215,30,181,35"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="240,55,345,80"/>
<area shape="poly" title=" " alt="" coords="181,51,226,57,226,62,180,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph.png" border="0" usemap="#adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph" alt=""/></div>
<map name="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph" id="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph">
<area shape="rect" title=" " alt="" coords="155,5,329,31"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="5,5,107,31"/>
<area shape="poly" title=" " alt="" coords="141,21,107,21,107,15,141,15"/>
</map>
</div>

</div>
</div>
<a id="adcdcf759e7db4fcc8f07d2692c18183b" name="adcdcf759e7db4fcc8f07d2692c18183b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcdcf759e7db4fcc8f07d2692c18183b">&#9670;&#160;</a></span>iterate_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>time</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>fn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Snames</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>npars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ncovars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ntimes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nrepp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nreps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nzeros</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *</td>          <td class="paramname"><span class="paramname"><em>covar_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>zeroindex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>cov</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00161">161</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  169</span>{</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  SEXP ans, nm;</div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordtype">double</span> *ap, *xs;</div>
<div class="line"><span class="lineno">  173</span>  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    R_CheckUserInterrupt();</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><span class="lineno">  184</span>    nsteps = <a class="code hl_function" href="#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><span class="lineno">  188</span>      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><span class="lineno">  189</span>        *xs = 0.0;</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><span class="lineno">  194</span>      <a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>      <span class="keywordflow">for</span> (j = 0, xs = x; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>          PROTECT(ans = <a class="code hl_function" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>          <span class="keywordflow">if</span> (LENGTH(ans) != <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><span class="lineno">  203</span>            <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>          <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><span class="lineno">  206</span>          PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><span class="lineno">  207</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><span class="lineno">  208</span>          posn = INTEGER(PROTECT(<a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  211</span>          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>          nprotect += 3;</div>
<div class="line"><span class="lineno">  214</span>          first = 0;</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>          PROTECT(ans = <a class="code hl_function" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><span class="lineno">  221</span>          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>          UNPROTECT(1);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>      }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><span class="lineno">  230</span>        t += deltat;</div>
<div class="line"><span class="lineno">  231</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  232</span>        t = *time;</div>
<div class="line"><span class="lineno">  233</span>      }</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    memcpy(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>  }</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph.png" border="0" usemap="#adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph" alt=""/></div>
<map name="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph" id="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,148,132"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="221,5,301,31"/>
<area shape="poly" title=" " alt="" coords="97,104,195,48,220,35,222,39,197,52,100,109"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="373,81,491,107"/>
<area shape="poly" title=" " alt="" coords="125,104,196,91,281,87,360,87,360,93,281,92,196,97,126,109"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="207,107,314,132"/>
<area shape="poly" title=" " alt="" coords="148,117,193,117,193,122,148,122"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="196,156,325,181"/>
<area shape="poly" title=" " alt="" coords="125,129,200,150,198,155,124,135"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="208,205,313,231"/>
<area shape="poly" title=" " alt="" coords="98,130,142,159,197,190,213,198,211,202,195,195,139,163,95,134"/>
<area shape="poly" title=" " alt="" coords="314,109,359,102,360,107,315,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph.png" border="0" usemap="#adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph" alt=""/></div>
<map name="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph" id="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph">
<area shape="rect" title=" " alt="" coords="155,5,297,31"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="5,5,107,31"/>
<area shape="poly" title=" " alt="" coords="141,21,107,21,107,15,141,15"/>
</map>
</div>

</div>
</div>
<a id="a17019a937f12763c2df28735e19b88c3" name="a17019a937f12763c2df28735e19b88c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17019a937f12763c2df28735e19b88c3">&#9670;&#160;</a></span>load_stack_decr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_decr </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>pack</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00130">130</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>                                 {</div>
<div class="line"><span class="lineno">  131</span>  SEXP s;</div>
<div class="line"><span class="lineno">  132</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><span class="lineno">  133</span>  void (*ff)(<span class="keywordtype">int</span> *);</div>
<div class="line"><span class="lineno">  134</span>  PROTECT(s = ScalarInteger(NA_INTEGER));</div>
<div class="line"><span class="lineno">  135</span>  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><span class="lineno">  136</span>  ff = (void (*)(<span class="keywordtype">int</span> *)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_decr&quot;</span>);</div>
<div class="line"><span class="lineno">  137</span>  ff(INTEGER(s));</div>
<div class="line"><span class="lineno">  138</span>  <span class="keywordflow">if</span> (*(INTEGER(s)) &lt; 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;impossible!&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno">  141</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a17019a937f12763c2df28735e19b88c3_icgraph.png" border="0" usemap="#adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph" alt=""/></div>
<map name="adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph" id="adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,283,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a90946f2aeaeb4f5826c8de7facb25999" name="a90946f2aeaeb4f5826c8de7facb25999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90946f2aeaeb4f5826c8de7facb25999">&#9670;&#160;</a></span>load_stack_incr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_incr </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>pack</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00121">121</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  121</span>                                 {</div>
<div class="line"><span class="lineno">  122</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><span class="lineno">  123</span>  void (*ff)(void);</div>
<div class="line"><span class="lineno">  124</span>  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><span class="lineno">  125</span>  ff = (void (*)(void)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_incr&quot;</span>);</div>
<div class="line"><span class="lineno">  126</span>  ff();</div>
<div class="line"><span class="lineno">  127</span>  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><span class="lineno">  128</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph.png" border="0" usemap="#adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph" alt=""/></div>
<map name="adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph" id="adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,279,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a9adc7fa1db20bdddfae3611911961f6c" name="a9adc7fa1db20bdddfae3611911961f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adc7fa1db20bdddfae3611911961f6c">&#9670;&#160;</a></span>LogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00038">38</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                      {</div>
<div class="line"><span class="lineno">   39</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">   40</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = AS_NUMERIC(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><span class="lineno">   41</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = NEW_NUMERIC(LENGTH(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_function" href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92">to_log_barycentric</a>(REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),LENGTH(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><span class="lineno">   43</span>  UNPROTECT(2);</div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">   45</span>}</div>
<div class="ttc" id="apomp_8h_html_a6a5fa3ea6a4ce20374a9d9d761f04c92"><div class="ttname"><a href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92">to_log_barycentric</a></div><div class="ttdeci">static R_INLINE void to_log_barycentric(double *xt, const double *x, int n)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00277">pomp.h:278</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph.png" border="0" usemap="#adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph" alt=""/></div>
<map name="adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph" id="adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,189,31"/>
<area shape="rect" href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92" title=" " alt="" coords="237,5,380,31"/>
<area shape="poly" title=" " alt="" coords="190,15,223,15,223,21,190,21"/>
</map>
</div>

</div>
</div>
<a id="a5a3814da0f600c71a99fd3fe5ba215ca" name="a5a3814da0f600c71a99fd3fe5ba215ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a3814da0f600c71a99fd3fe5ba215ca">&#9670;&#160;</a></span>LogitTransform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>P</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00014">14</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   14</span>                             {</div>
<div class="line"><span class="lineno">   15</span>  <span class="keywordtype">double</span> *p;</div>
<div class="line"><span class="lineno">   16</span>  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><span class="lineno">   17</span>  PROTECT(P = duplicate(AS_NUMERIC(P)));</div>
<div class="line"><span class="lineno">   18</span>  p = REAL(P);</div>
<div class="line"><span class="lineno">   19</span>  n = LENGTH(P);</div>
<div class="line"><span class="lineno">   20</span>  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, p++)</div>
<div class="line"><span class="lineno">   21</span>    *p = <a class="code hl_function" href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618">logit</a>(*p);</div>
<div class="line"><span class="lineno">   22</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">   23</span>  <span class="keywordflow">return</span> P;</div>
<div class="line"><span class="lineno">   24</span>}</div>
<div class="ttc" id="apomp_8h_html_a4b9004ae67cdf750e5354cf295e91618"><div class="ttname"><a href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618">logit</a></div><div class="ttdeci">static R_INLINE double logit(double p)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00118">pomp.h:118</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph.png" border="0" usemap="#adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph" alt=""/></div>
<map name="adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph" id="adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,124,31"/>
<area shape="rect" href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618" title=" " alt="" coords="172,5,223,31"/>
<area shape="poly" title=" " alt="" coords="124,15,158,15,158,21,124,21"/>
</map>
</div>

</div>
</div>
<a id="a0537073d1cb88f92ea923a0c28d2ac9d" name="a0537073d1cb88f92ea923a0c28d2ac9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0537073d1cb88f92ea923a0c28d2ac9d">&#9670;&#160;</a></span>logmeanexp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP logmeanexp </td>
          <td>(</td>
          <td class="paramtype">const SEXP</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SEXP</td>          <td class="paramname"><span class="paramname"><em>Drop</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="logmeanexp_8c_source.html#l00007">7</a> of file <a class="el" href="logmeanexp_8c_source.html">logmeanexp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    7</span>                                                {</div>
<div class="line"><span class="lineno">    8</span>  <span class="keywordtype">int</span> j, n = LENGTH(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">    9</span>  <span class="keywordtype">int</span> k = *INTEGER(Drop)-1;     <span class="comment">// zero-based index</span></div>
<div class="line"><span class="lineno">   10</span>  <span class="keywordtype">double</span> *x = REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">   11</span>  <span class="keywordtype">long</span> <span class="keywordtype">double</span> m = R_NegInf;</div>
<div class="line"><span class="lineno">   12</span>  <span class="keywordtype">long</span> <span class="keywordtype">double</span> s = 0;</div>
<div class="line"><span class="lineno">   13</span>  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><span class="lineno">   15</span>      m = (x[j] &gt; m) ? (<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] : m;</div>
<div class="line"><span class="lineno">   16</span>  }</div>
<div class="line"><span class="lineno">   17</span>  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><span class="lineno">   19</span>      s += expl((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] - m);</div>
<div class="line"><span class="lineno">   20</span>  }</div>
<div class="line"><span class="lineno">   21</span>  <span class="keywordflow">if</span> (k &gt;= 0 &amp;&amp; k &lt; n) n--;</div>
<div class="line"><span class="lineno">   22</span>  <span class="keywordflow">return</span> ScalarReal(m + log(s/n));</div>
<div class="line"><span class="lineno">   23</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afbec5a723223278096829f0532d5dc3a" name="afbec5a723223278096829f0532d5dc3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbec5a723223278096829f0532d5dc3a">&#9670;&#160;</a></span>lookup_in_table()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP lookup_in_table </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>t</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00024">24</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>                                          {</div>
<div class="line"><span class="lineno">   25</span>  <span class="keywordtype">int</span> xdim[2], nvar;</div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordtype">int</span> j, nt;</div>
<div class="line"><span class="lineno">   27</span>  <span class="keywordtype">double</span> *tp, *xp;</div>
<div class="line"><span class="lineno">   28</span>  SEXP Cnames, <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><span class="lineno">   31</span>  nt = LENGTH(t);</div>
<div class="line"><span class="lineno">   32</span>  PROTECT(Cnames = <a class="code hl_function" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(covar));</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> tab = <a class="code hl_function" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(covar,&amp;nvar);</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordflow">if</span> (nt &gt; 1) {</div>
<div class="line"><span class="lineno">   37</span>    xdim[0] = nvar; xdim[1] = nt;</div>
<div class="line"><span class="lineno">   38</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames,2);</div>
<div class="line"><span class="lineno">   40</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   41</span>    PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(nvar));</div>
<div class="line"><span class="lineno">   42</span>    SET_NAMES(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames);</div>
<div class="line"><span class="lineno">   43</span>  }</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">for</span> (j = 0, tp = REAL(t), xp = REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>); j &lt; nt; j++, tp++, xp += nvar)</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_function" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;tab,*tp,xp);</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>  UNPROTECT(3);</div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">   50</span>}</div>
<div class="ttc" id="alookup__table_8c_html_a036b9fb7cfc62e3984889f95024971a0"><div class="ttname"><a href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a></div><div class="ttdeci">void table_lookup(lookup_table_t *tab, double x, double *y)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00053">lookup_table.c:53</a></div></div>
<div class="ttc" id="alookup__table_8c_html_a1e57a24640cb0d9f6f8d55e02c3d553f"><div class="ttname"><a href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a></div><div class="ttdeci">lookup_table_t make_covariate_table(SEXP object, int *ncovar)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00011">lookup_table.c:11</a></div></div>
<div class="ttc" id="alookup__table_8c_html_aa7a80c78f9ef26859eea09b5299e702b"><div class="ttname"><a href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a></div><div class="ttdeci">SEXP get_covariate_names(SEXP object)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00007">lookup_table.c:7</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afbec5a723223278096829f0532d5dc3a_cgraph.png" border="0" usemap="#adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph" alt=""/></div>
<map name="adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph" id="adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,129,129"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="179,5,342,31"/>
<area shape="poly" title=" " alt="" coords="82,102,123,71,176,40,193,33,195,37,179,44,126,75,86,106"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="177,55,344,80"/>
<area shape="poly" title=" " alt="" coords="117,101,196,81,197,86,118,107"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="215,104,307,129"/>
<area shape="poly" title=" " alt="" coords="130,114,201,114,201,119,130,119"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="205,153,316,179"/>
<area shape="poly" title=" " alt="" coords="118,127,197,147,196,152,117,132"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="208,203,313,228"/>
<area shape="poly" title=" " alt="" coords="86,127,127,157,179,188,198,196,196,201,176,192,124,162,83,132"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afbec5a723223278096829f0532d5dc3a_icgraph.png" border="0" usemap="#adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph" alt=""/></div>
<map name="adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph" id="adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,280,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a8fc25ac8149dbd6da367aa01dd9ad9ed" name="a8fc25ac8149dbd6da367aa01dd9ad9ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">&#9670;&#160;</a></span>make_covariate_table()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> make_covariate_table </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ncovar</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00011">11</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span>                                                               {</div>
<div class="line"><span class="lineno">   12</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> tab;</div>
<div class="line"><span class="lineno">   13</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">   14</span>  dim = INTEGER(GET_DIM(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><span class="lineno">   15</span>  *ncovar = tab.<a class="code hl_variable" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> = dim[0];</div>
<div class="line"><span class="lineno">   16</span>  tab.<a class="code hl_variable" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> = dim[1];</div>
<div class="line"><span class="lineno">   17</span>  tab.<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = 0;</div>
<div class="line"><span class="lineno">   18</span>  tab.<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><span class="lineno">   19</span>  tab.<a class="code hl_variable" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>)));</div>
<div class="line"><span class="lineno">   20</span>  tab.<a class="code hl_variable" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a> = *(INTEGER(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;order&quot;</span>))));</div>
<div class="line"><span class="lineno">   21</span>  <span class="keywordflow">return</span> tab;</div>
<div class="line"><span class="lineno">   22</span>}</div>
<div class="ttc" id="astructlookup__table__t_html_a5bc85f841e0c15e15a7b8b7e12172ea1"><div class="ttname"><a href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">lookup_table_t::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00022">pomp_defines.h:22</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a73816c282d64530aafb1dd154ee41f60"><div class="ttname"><a href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">lookup_table_t::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a83e4e0655a5836172df9d671ed4d726c"><div class="ttname"><a href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">lookup_table_t::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00023">pomp_defines.h:23</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a928f893d2851476723521ae3c7d29749"><div class="ttname"><a href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">lookup_table_t::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_aa071aabe5391f11c0d915907ad16dd28"><div class="ttname"><a href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">lookup_table_t::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00024">pomp_defines.h:24</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_afc0a89e59da489c4fd7fd4aca70c298d"><div class="ttname"><a href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">lookup_table_t::y</a></div><div class="ttdeci">double * y</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00025">pomp_defines.h:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph.png" border="0" usemap="#adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph" alt=""/></div>
<map name="adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph" id="adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph">
<area shape="rect" title=" " alt="" coords="872,331,1039,356"/>
<area shape="rect" href="dmeasure_8c.html#a326516e59ec4f791bcc752ef5f763c71" title=" " alt="" coords="689,5,799,31"/>
<area shape="poly" title=" " alt="" coords="948,318,936,261,913,187,896,148,876,110,851,75,822,44,798,30,801,25,826,40,855,72,880,107,901,146,918,185,941,259,953,316"/>
<area shape="rect" href="emeasure_8c.html#ab362c459382493c6f7f4721dc5bf6457" title=" " alt="" coords="689,55,799,80"/>
<area shape="poly" title=" " alt="" coords="944,318,928,272,903,214,868,154,846,126,822,101,790,82,793,78,826,97,850,123,872,151,908,212,933,270,949,316"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="527,193,598,219"/>
<area shape="poly" title=" " alt="" coords="939,320,920,289,894,254,862,221,823,196,794,186,764,180,703,179,645,186,599,198,598,192,644,181,702,174,765,175,796,181,825,192,865,217,898,251,925,286,944,317"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,280,108,305"/>
<area shape="poly" title=" " alt="" coords="941,320,923,285,897,244,863,203,823,170,757,136,700,122,640,120,564,121,398,121,346,126,294,140,245,161,200,186,123,239,73,282,70,278,119,235,197,181,243,156,293,135,345,121,398,115,564,115,640,114,701,117,759,131,825,165,867,199,901,241,927,282,945,317"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="509,479,616,504"/>
<area shape="poly" title=" " alt="" coords="943,370,924,400,898,435,865,467,825,492,772,509,716,514,662,512,616,506,617,500,663,507,716,509,771,504,823,488,861,463,894,431,920,397,939,367"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="694,256,794,281"/>
<area shape="poly" title=" " alt="" coords="910,328,823,295,788,284,790,279,825,290,912,323"/>
<area shape="rect" href="vmeasure_8c.html#a97fc58eebfdaa733377f210c1dd48082" title=" " alt="" coords="689,305,799,331"/>
<area shape="poly" title=" " alt="" coords="857,334,799,327,800,322,858,329"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="682,207,806,232"/>
<area shape="poly" title=" " alt="" coords="929,323,882,284,823,246,796,235,798,230,825,241,885,280,933,319"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="695,404,793,429"/>
<area shape="poly" title=" " alt="" coords="909,363,825,394,787,407,785,401,823,389,907,358"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="693,453,795,479"/>
<area shape="poly" title=" " alt="" coords="932,367,884,405,825,443,794,456,792,451,823,438,881,401,928,363"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="337,499,461,524"/>
<area shape="poly" title=" " alt="" coords="946,370,929,406,903,448,869,489,848,506,825,520,775,540,723,551,669,556,615,556,517,544,442,527,443,521,518,539,616,550,669,551,722,546,774,535,823,516,845,502,865,485,899,445,924,403,942,368"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="679,655,809,680"/>
<area shape="poly" title=" " alt="" coords="953,370,941,427,918,501,901,540,880,578,855,614,826,645,808,657,805,652,822,641,851,611,876,575,896,538,913,499,936,426,948,369"/>
<area shape="rect" href="trajectory_8c.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="664,605,824,631"/>
<area shape="poly" title=" " alt="" coords="949,371,933,416,908,474,872,535,850,563,826,588,793,608,790,603,822,584,846,559,868,532,903,472,928,415,944,369"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="685,355,803,380"/>
<area shape="poly" title=" " alt="" coords="858,357,803,363,802,358,858,352"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="348,280,451,305"/>
<area shape="poly" title=" " alt="" coords="527,228,426,282,423,277,524,223"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,280,289,305"/>
<area shape="poly" title=" " alt="" coords="334,295,290,295,290,290,334,290"/>
<area shape="poly" title=" " alt="" coords="142,295,108,295,108,290,142,290"/>
<area shape="poly" title=" " alt="" coords="535,471,507,442,448,367,407,307,411,304,452,364,511,439,539,467"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="513,280,613,305"/>
<area shape="poly" title=" " alt="" coords="685,239,665,246,588,282,586,277,663,241,683,234"/>
<area shape="poly" title=" " alt="" coords="499,295,451,295,451,290,499,290"/>
<area shape="rect" href="dinit_8c.html#aa791ce91b1a00dfb19ecaf829dfc287a" title=" " alt="" coords="525,404,600,429"/>
<area shape="poly" title=" " alt="" coords="681,419,600,419,600,414,681,414"/>
<area shape="poly" title=" " alt="" coords="365,494,76,308,79,303,368,489"/>
<area shape="rect" href="dprocess_8c.html#a2a6438a8b3220ecd24e531d5b3dd4534" title=" " alt="" coords="511,655,614,680"/>
<area shape="poly" title=" " alt="" coords="665,670,614,670,614,665,665,665"/>
<area shape="poly" title=" " alt="" coords="686,353,663,344,586,308,589,303,665,340,688,348"/>
</map>
</div>

</div>
</div>
<a id="a2f8f78d126b50ffa8da9b867053278df" name="a2f8f78d126b50ffa8da9b867053278df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f8f78d126b50ffa8da9b867053278df">&#9670;&#160;</a></span>nosort_resamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nosort_resamp </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nw</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00025">25</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordtype">double</span> du, u;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordflow">for</span> (j = 1; j &lt; nw; j++) w[j] += w[j-1];</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordflow">if</span> (w[nw-1] &lt;= 0.0)</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;systematic_resampling&#39;: non-positive sum of weights&quot;</span>);</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  du = w[nw-1] / ((double) np);</div>
<div class="line"><span class="lineno">   36</span>  u = -du*unif_rand();</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordflow">for</span> (i = 0, j = 0; j &lt; np; j++) {</div>
<div class="line"><span class="lineno">   39</span>    u += du;</div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// In the following line, the second test is needed to correct</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">// the infamous Bug of St. Patrick, 2017-03-17.</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">while</span> ((u &gt; w[i]) &amp;&amp; (i &lt; nw-1)) i++;</div>
<div class="line"><span class="lineno">   43</span>    p[j] = i;</div>
<div class="line"><span class="lineno">   44</span>  }</div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">if</span> (offset)                   <span class="comment">// add offset if needed</span></div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">for</span> (j = 0; j &lt; np; j++) p[j] += offset;</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph.png" border="0" usemap="#adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph" alt=""/></div>
<map name="adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph" id="adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph">
<area shape="rect" title=" " alt="" coords="379,55,497,80"/>
<area shape="rect" href="pfilter_8c.html#acfcb3a7b41bc3b2b9315163717854242" title=" " alt="" coords="213,5,273,31"/>
<area shape="poly" title=" " alt="" coords="373,54,273,28,274,23,375,49"/>
<area shape="rect" href="resample_8c.html#a982475f3663a786d7883672aa2ed072e" title=" " alt="" coords="156,55,331,80"/>
<area shape="poly" title=" " alt="" coords="365,70,331,70,331,65,365,65"/>
<area shape="rect" href="wpfilter_8c.html#ac643fb3aad609b1078e9abb994ec6cf2" title=" " alt="" coords="208,104,279,129"/>
<area shape="poly" title=" " alt="" coords="375,86,279,110,278,105,373,81"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,55,108,80"/>
<area shape="poly" title=" " alt="" coords="143,70,108,70,108,65,143,65"/>
</map>
</div>

</div>
</div>
<a id="a80981cb1dec869d1c736129470da780f" name="a80981cb1dec869d1c736129470da780f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80981cb1dec869d1c736129470da780f">&#9670;&#160;</a></span>num_euler_steps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int num_euler_steps </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00317">317</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  317</span>                                                           {</div>
<div class="line"><span class="lineno">  318</span>  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><span class="lineno">  319</span>  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><span class="lineno">  320</span>  <span class="comment">// nstep will be the number of Euler steps to take in going from t1 to t2.</span></div>
<div class="line"><span class="lineno">  321</span>  <span class="comment">// note also that the stepsize changes.</span></div>
<div class="line"><span class="lineno">  322</span>  <span class="comment">// this choice is meant to be conservative</span></div>
<div class="line"><span class="lineno">  323</span>  <span class="comment">// (i.e., so that the actual deltat does not exceed the specified deltat</span></div>
<div class="line"><span class="lineno">  324</span>  <span class="comment">// by more than the relative tolerance &#39;tol&#39;)</span></div>
<div class="line"><span class="lineno">  325</span>  <span class="comment">// and to counteract roundoff error.</span></div>
<div class="line"><span class="lineno">  326</span>  <span class="comment">// It seems to work well, but is not guaranteed:</span></div>
<div class="line"><span class="lineno">  327</span>  <span class="comment">// suggestions would be appreciated.</span></div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="keywordflow">if</span> (t1 &gt;= t2) {</div>
<div class="line"><span class="lineno">  330</span>    *deltat = 0.0;</div>
<div class="line"><span class="lineno">  331</span>    nstep = 0;</div>
<div class="line"><span class="lineno">  332</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t1+*deltat &gt;= t2) {</div>
<div class="line"><span class="lineno">  333</span>    *deltat = t2-t1;</div>
<div class="line"><span class="lineno">  334</span>    nstep = 1;</div>
<div class="line"><span class="lineno">  335</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  336</span>    nstep = (int) ceil((t2-t1)/(*deltat)/(1+tol));</div>
<div class="line"><span class="lineno">  337</span>    *deltat = (t2-t1)/((<span class="keywordtype">double</span>) nstep);</div>
<div class="line"><span class="lineno">  338</span>  }</div>
<div class="line"><span class="lineno">  339</span>  <span class="keywordflow">return</span> nstep;</div>
<div class="line"><span class="lineno">  340</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a80981cb1dec869d1c736129470da780f_icgraph.png" border="0" usemap="#adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph" alt=""/></div>
<map name="adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph" id="adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph">
<area shape="rect" title=" " alt="" coords="808,5,941,31"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="636,5,760,31"/>
<area shape="poly" title=" " alt="" coords="794,21,760,21,760,15,794,15"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="488,5,588,31"/>
<area shape="poly" title=" " alt="" coords="622,21,588,21,588,15,622,15"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="a4e40667f6198be18fb99f8f07417da1d" name="a4e40667f6198be18fb99f8f07417da1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e40667f6198be18fb99f8f07417da1d">&#9670;&#160;</a></span>num_map_steps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int num_map_steps </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>t2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00342">342</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  342</span>                                                        {</div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><span class="lineno">  345</span>  <span class="comment">// nstep will be the number of discrete-time steps to take in going from t1 to t2.</span></div>
<div class="line"><span class="lineno">  346</span>  nstep = (int) floor((t2-t1)/deltat/(1-tol));</div>
<div class="line"><span class="lineno">  347</span>  <span class="keywordflow">return</span> (nstep &gt; 0) ? nstep : 0;</div>
<div class="line"><span class="lineno">  348</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph.png" border="0" usemap="#adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph" alt=""/></div>
<map name="adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph" id="adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph">
<area shape="rect" title=" " alt="" coords="860,55,989,80"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="663,5,787,31"/>
<area shape="poly" title=" " alt="" coords="859,54,776,33,778,28,860,49"/>
<area shape="rect" href="skeleton_8c.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="637,55,812,80"/>
<area shape="poly" title=" " alt="" coords="846,70,812,70,812,65,846,65"/>
<area shape="rect" href="skeleton_8c.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2" title=" " alt="" coords="653,104,796,129"/>
<area shape="poly" title=" " alt="" coords="860,86,778,107,776,101,859,81"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="489,5,589,31"/>
<area shape="poly" title=" " alt="" coords="649,21,589,21,589,15,649,15"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="475,21,440,21,440,15,475,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="488,79,589,104"/>
<area shape="poly" title=" " alt="" coords="624,83,590,88,589,82,623,78"/>
<area shape="poly" title=" " alt="" coords="639,108,589,101,590,96,640,102"/>
</map>
</div>

</div>
</div>
<a id="ac91f1740c904de28f294b3e9dc2bc812" name="ac91f1740c904de28f294b3e9dc2bc812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac91f1740c904de28f294b3e9dc2bc812">&#9670;&#160;</a></span>periodic_bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP periodic_bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>nbasis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>degree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>period</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deriv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00085">85</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>                                         {</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  SEXP y, xr;</div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordtype">double</span> pd = NUMERIC_VALUE(period);</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordtype">double</span> *xrd, *ydata, *val;</div>
<div class="line"><span class="lineno">   96</span>  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><span class="lineno">   97</span>  xrd = REAL(xr);</div>
<div class="line"><span class="lineno">   98</span>  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><span class="lineno">   99</span>  ydata = REAL(y);</div>
<div class="line"><span class="lineno">  100</span>  val = (<span class="keywordtype">double</span> *) R_alloc(nb,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) {</div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_function" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>(xrd[j],pd,deg,nb,d,val);</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">for</span> (k = 0; k &lt; nb; k++) ydata[j+nx*k] = val[k];</div>
<div class="line"><span class="lineno">  104</span>  }</div>
<div class="line"><span class="lineno">  105</span>  UNPROTECT(2);</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">return</span> y;</div>
<div class="line"><span class="lineno">  107</span>}</div>
<div class="ttc" id="abspline_8c_html_a2f083190a387483412260be17208ee1e"><div class="ttname"><a href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a></div><div class="ttdeci">void periodic_bspline_basis_eval_deriv(double x, double period, int degree, int nbasis, int deriv, double *y)</div><div class="ttdef"><b>Definition</b> <a href="bspline_8c_source.html#l00122">bspline.c:122</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph.png" border="0" usemap="#adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph" alt=""/></div>
<map name="adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph" id="adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,175,55"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="223,22,392,62"/>
<area shape="poly" title=" " alt="" coords="175,39,209,39,209,45,175,45"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="440,29,544,55"/>
<area shape="poly" title=" " alt="" coords="392,39,426,39,426,45,392,45"/>
<area shape="poly" title=" " alt="" coords="461,31,455,21,458,11,471,5,492,3,517,6,528,15,525,19,515,11,492,8,473,10,462,15,460,20,466,28"/>
</map>
</div>

</div>
</div>
<a id="af3e746ce7f69a999ad8ff316f10fd1d2" name="af3e746ce7f69a999ad8ff316f10fd1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3e746ce7f69a999ad8ff316f10fd1d2">&#9670;&#160;</a></span>periodic_bspline_basis_eval_deriv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void periodic_bspline_basis_eval_deriv </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>period</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>degree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nbasis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>deriv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00122">122</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  124</span>{</div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordtype">int</span> nknots = nbasis+2*degree+1;</div>
<div class="line"><span class="lineno">  126</span>  <span class="keywordtype">int</span> shift = (degree-1)/2;</div>
<div class="line"><span class="lineno">  127</span>  <span class="keywordtype">double</span> *knots = NULL, *yy = NULL;</div>
<div class="line"><span class="lineno">  128</span>  <span class="keywordtype">double</span> dx;</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> (period &lt;= 0.0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have period &gt; 0&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">if</span> (nbasis &lt;= 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; 0&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">if</span> (degree &lt; 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt;= 0&quot;</span>);</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">if</span> (nbasis &lt; degree) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt;= degree&quot;</span>);</div>
<div class="line"><span class="lineno">  135</span>  <span class="keywordflow">if</span> (deriv &lt; 0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  knots = (<span class="keywordtype">double</span> *) R_Calloc(nknots+degree+1,<span class="keywordtype">double</span>);</div>
<div class="line"><span class="lineno">  138</span>  yy = (<span class="keywordtype">double</span> *) R_Calloc(nknots,<span class="keywordtype">double</span>);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  dx = period/((double) nbasis);</div>
<div class="line"><span class="lineno">  141</span>  <span class="keywordflow">for</span> (k = -degree; k &lt;= nbasis+degree; k++) {</div>
<div class="line"><span class="lineno">  142</span>    knots[degree+k] = k*dx;</div>
<div class="line"><span class="lineno">  143</span>  }</div>
<div class="line"><span class="lineno">  144</span>  x = fmod(x,period);</div>
<div class="line"><span class="lineno">  145</span>  <span class="keywordflow">if</span> (x &lt; 0.0) x += period;</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nknots; k++) {</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_function" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(&amp;yy[k],&amp;x,1,k,degree,deriv,knots);</div>
<div class="line"><span class="lineno">  148</span>  }</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordflow">for</span> (k = 0; k &lt; degree; k++) yy[k] += yy[nbasis+k];</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nbasis; k++) {</div>
<div class="line"><span class="lineno">  151</span>    j = (shift+k)%nbasis;</div>
<div class="line"><span class="lineno">  152</span>    y[k] = yy[j];</div>
<div class="line"><span class="lineno">  153</span>  }</div>
<div class="line"><span class="lineno">  154</span>  R_Free(yy); R_Free(knots);</div>
<div class="line"><span class="lineno">  155</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph.png" border="0" usemap="#adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph" alt=""/></div>
<map name="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph" id="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,175,62"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="223,29,327,55"/>
<area shape="poly" title=" " alt="" coords="175,39,209,39,209,45,175,45"/>
<area shape="poly" title=" " alt="" coords="244,31,238,21,241,11,254,5,275,3,300,6,311,15,307,19,298,11,275,8,255,10,245,15,243,20,248,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph.png" border="0" usemap="#adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph" alt=""/></div>
<map name="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph" id="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph">
<area shape="rect" title=" " alt="" coords="223,23,392,63"/>
<area shape="rect" href="bspline_8c.html#a5300e64c53a9cbb6aa52d351bd338883" title=" " alt="" coords="5,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,35,174,30,175,25,209,29"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="39,55,141,80"/>
<area shape="poly" title=" " alt="" coords="209,57,142,64,141,59,209,52"/>
</map>
</div>

</div>
</div>
<a id="abb9eda32aa6838894c1096d31d5672ad" name="abb9eda32aa6838894c1096d31d5672ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9eda32aa6838894c1096d31d5672ad">&#9670;&#160;</a></span>pfilter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>predmean</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>predvar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>filtmean</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>trackancestry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>doparRS</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>wave</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfilter_8c_source.html#l00016">16</a> of file <a class="el" href="pfilter_8c_source.html">pfilter.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   20</span>{</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span>  SEXP pm = R_NilValue, pv = R_NilValue, fm = R_NilValue;</div>
<div class="line"><span class="lineno">   23</span>  SEXP anc = R_NilValue, wmean = R_NilValue;</div>
<div class="line"><span class="lineno">   24</span>  SEXP ess, loglik;</div>
<div class="line"><span class="lineno">   25</span>  SEXP newstates = R_NilValue, newparams = R_NilValue;</div>
<div class="line"><span class="lineno">   26</span>  SEXP retval, retvalnames;</div>
<div class="line"><span class="lineno">   27</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[2] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordtype">double</span> *xw = 0;</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws, maxw, sum;</div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordtype">int</span> *xanc = 0;</div>
<div class="line"><span class="lineno">   31</span>  SEXP dimX, dimP, newdim, Xnames, Pnames;</div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordtype">int</span> *dim, np;</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = 0, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordtype">int</span> do_pm, do_pv, do_fm, do_ta, do_pr, do_wave, all_fail = 0;</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  PROTECT(dimX = GET_DIM(x));</div>
<div class="line"><span class="lineno">   38</span>  dim = INTEGER(dimX);</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   40</span>  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   43</span>  PROTECT(dimP = GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   44</span>  dim = INTEGER(dimP);</div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % dim[1] != 0)</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be a multiple of ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><span class="lineno">   48</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>  PROTECT(weights = duplicate(weights));</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  np = *(INTEGER(AS_INTEGER(Np))); <span class="comment">// number of particles to resample</span></div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  do_pm = *(LOGICAL(AS_LOGICAL(predmean))); <span class="comment">// calculate prediction means?</span></div>
<div class="line"><span class="lineno">   55</span>  do_pv = *(LOGICAL(AS_LOGICAL(predvar)));  <span class="comment">// calculate prediction variances?</span></div>
<div class="line"><span class="lineno">   56</span>  do_fm = *(LOGICAL(AS_LOGICAL(filtmean))); <span class="comment">// calculate filtering means?</span></div>
<div class="line"><span class="lineno">   57</span>  do_ta = *(LOGICAL(AS_LOGICAL(trackancestry))); <span class="comment">// track ancestry?</span></div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// Do we need to do parameter resampling?</span></div>
<div class="line"><span class="lineno">   59</span>  do_pr = *(LOGICAL(AS_LOGICAL(doparRS)));</div>
<div class="line"><span class="lineno">   60</span>  <span class="comment">// Do we need to take a weighted average over the parameters?</span></div>
<div class="line"><span class="lineno">   61</span>  do_wave = *(LOGICAL(AS_LOGICAL(wave)));</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">if</span> (dim[1] != <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)</div>
<div class="line"><span class="lineno">   65</span>      <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be equal to ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><span class="lineno">   66</span>  }</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><span class="lineno">   69</span>  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// log likelihood</span></div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  xw = REAL(weights);</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <span class="comment">// check and normalize the weights</span></div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">for</span> (k = 0, maxw = R_NegInf; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">if</span> (ISNAN(xw[k]) || xw[k] == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><span class="lineno">   79</span>      PROTECT(retval = NEW_INTEGER(1)); nprotect++;</div>
<div class="line"><span class="lineno">   80</span>      *INTEGER(retval) = k+1; <span class="comment">// return the index of the peccant particle</span></div>
<div class="line"><span class="lineno">   81</span>      UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">   82</span>      <span class="keywordflow">return</span> retval;</div>
<div class="line"><span class="lineno">   83</span>    }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (maxw &lt; xw[k]) maxw = xw[k];</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  }</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">if</span> (maxw == R_NegInf) all_fail = 1;</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    *(REAL(loglik)) = R_NegInf;</div>
<div class="line"><span class="lineno">   94</span>    *(REAL(ess)) = 0;             <span class="comment">// zero effective sample size</span></div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">for</span> (k = 0, w = 0, ws = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><span class="lineno">  100</span>      xw[k] = exp(xw[k]-maxw);</div>
<div class="line"><span class="lineno">  101</span>      <span class="keywordflow">if</span> (xw[k] != 0) {</div>
<div class="line"><span class="lineno">  102</span>        w += xw[k];</div>
<div class="line"><span class="lineno">  103</span>        ws += xw[k]*xw[k];</div>
<div class="line"><span class="lineno">  104</span>      }</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    *(REAL(loglik)) = maxw + log(w/((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)); <span class="comment">// mean of weights is likelihood</span></div>
<div class="line"><span class="lineno">  108</span>    *(REAL(ess)) = w*w/ws;      <span class="comment">// effective sample size</span></div>
<div class="line"><span class="lineno">  109</span>  }</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><span class="lineno">  112</span>    PROTECT(pm = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><span class="lineno">  113</span>  }</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><span class="lineno">  116</span>    PROTECT(pv = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><span class="lineno">  117</span>  }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><span class="lineno">  120</span>    PROTECT(fm = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><span class="lineno">  121</span>  }</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><span class="lineno">  124</span>    PROTECT(anc = NEW_INTEGER(np)); nprotect++;</div>
<div class="line"><span class="lineno">  125</span>    xanc = INTEGER(anc);</div>
<div class="line"><span class="lineno">  126</span>  }</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><span class="lineno">  129</span>    PROTECT(wmean = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)); nprotect++;</div>
<div class="line"><span class="lineno">  130</span>    SET_NAMES(wmean,Pnames);</div>
<div class="line"><span class="lineno">  131</span>  }</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordtype">double</span> *tmp = (do_pv) ? REAL(pv) : 0;</div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_function" href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc">pred_mean_var</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,do_pv,REAL(x),REAL(pm),tmp);</div>
<div class="line"><span class="lineno">  136</span>  }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <span class="comment">//  compute filter mean</span></div>
<div class="line"><span class="lineno">  139</span>  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_function" href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6">filt_mean</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,all_fail,w,xw,REAL(x),REAL(fm));</div>
<div class="line"><span class="lineno">  141</span>  }</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="comment">// compute weighted average of parameters</span></div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">if</span> (all_fail)</div>
<div class="line"><span class="lineno">  146</span>      <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;%s %s&quot;</span>,<span class="stringliteral">&quot;filtering failure at last filter iteration:&quot;</span>,</div>
<div class="line"><span class="lineno">  147</span>           <span class="stringliteral">&quot;using unweighted mean for point estimate.&quot;</span>);</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordtype">double</span> *xwm = REAL(wmean);</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, xwm++) {</div>
<div class="line"><span class="lineno">  150</span>      <span class="keywordtype">double</span> *xp = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)+j;</div>
<div class="line"><span class="lineno">  151</span>      <span class="keywordflow">if</span> (all_fail) {           <span class="comment">// unweighted average</span></div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) sum += *xp;</div>
<div class="line"><span class="lineno">  153</span>        *xwm = sum/((<span class="keywordtype">long</span> double) <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>);</div>
<div class="line"><span class="lineno">  154</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><span class="lineno">  156</span>          <span class="keywordflow">if</span> (xw[k]!=0) sum += xw[k]*(*xp);</div>
<div class="line"><span class="lineno">  157</span>        }</div>
<div class="line"><span class="lineno">  158</span>        *xwm = sum/w;</div>
<div class="line"><span class="lineno">  159</span>      }</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span>  }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="keywordflow">if</span> (!all_fail) { <span class="comment">// resample the particles unless we have filtering failure</span></div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordtype">double</span> *ss = 0, *st = 0, *ps = 0, *pt = 0;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    <span class="comment">// create storage for new states</span></div>
<div class="line"><span class="lineno">  171</span>    xdim[0] = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; xdim[1] = np;</div>
<div class="line"><span class="lineno">  172</span>    PROTECT(newstates = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newstates,Xnames,2);</div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newstates,dimnm,2);</div>
<div class="line"><span class="lineno">  175</span>    ss = REAL(x);</div>
<div class="line"><span class="lineno">  176</span>    st = REAL(newstates);</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><span class="lineno">  180</span>      xdim[0] = <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; xdim[1] = np;</div>
<div class="line"><span class="lineno">  181</span>      PROTECT(newparams = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><span class="lineno">  182</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newparams,Pnames,2);</div>
<div class="line"><span class="lineno">  183</span>      <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newparams,dimnm,2);</div>
<div class="line"><span class="lineno">  184</span>      ps = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  185</span>      pt = REAL(newparams);</div>
<div class="line"><span class="lineno">  186</span>    }</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">// resample</span></div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_function" href="#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(weights),np,sample,0);</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><span class="lineno">  191</span>      <span class="keywordtype">int</span> sp = sample[k];</div>
<div class="line"><span class="lineno">  192</span>      <span class="keywordtype">double</span> *xx, *xp;</div>
<div class="line"><span class="lineno">  193</span>      <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><span class="lineno">  194</span>        *st = *xx;</div>
<div class="line"><span class="lineno">  195</span>      <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">for</span> (j = 0, xp = ps+<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*sp; j &lt; <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, pt++, xp++)</div>
<div class="line"><span class="lineno">  197</span>          *pt = *xp;</div>
<div class="line"><span class="lineno">  198</span>      }</div>
<div class="line"><span class="lineno">  199</span>      <span class="keywordflow">if</span> (do_ta) xanc[k] = sp+1;</div>
<div class="line"><span class="lineno">  200</span>    }</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  } <span class="keywordflow">else</span> { <span class="comment">// don&#39;t resample: just drop 3rd dimension in x prior to return</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    PROTECT(newdim = NEW_INTEGER(2)); nprotect++;</div>
<div class="line"><span class="lineno">  205</span>    dim = INTEGER(newdim);</div>
<div class="line"><span class="lineno">  206</span>    dim[0] = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">  207</span>    SET_DIM(x,newdim);</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,Xnames,2);</div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(x,dimnm,2);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> (do_ta)</div>
<div class="line"><span class="lineno">  212</span>      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) xanc[k] = k+1;</div>
<div class="line"><span class="lineno">  213</span>  }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  PROTECT(retval = NEW_LIST(9));</div>
<div class="line"><span class="lineno">  218</span>  PROTECT(retvalnames = NEW_CHARACTER(9));</div>
<div class="line"><span class="lineno">  219</span>  nprotect += 2;</div>
<div class="line"><span class="lineno">  220</span>  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><span class="lineno">  221</span>  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><span class="lineno">  222</span>  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><span class="lineno">  223</span>  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><span class="lineno">  224</span>  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;pm&quot;</span>));</div>
<div class="line"><span class="lineno">  225</span>  SET_STRING_ELT(retvalnames,5,mkChar(<span class="stringliteral">&quot;pv&quot;</span>));</div>
<div class="line"><span class="lineno">  226</span>  SET_STRING_ELT(retvalnames,6,mkChar(<span class="stringliteral">&quot;fm&quot;</span>));</div>
<div class="line"><span class="lineno">  227</span>  SET_STRING_ELT(retvalnames,7,mkChar(<span class="stringliteral">&quot;ancestry&quot;</span>));</div>
<div class="line"><span class="lineno">  228</span>  SET_STRING_ELT(retvalnames,8,mkChar(<span class="stringliteral">&quot;wmean&quot;</span>));</div>
<div class="line"><span class="lineno">  229</span>  SET_NAMES(retval,retvalnames);</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  SET_ELEMENT(retval,0,loglik);</div>
<div class="line"><span class="lineno">  232</span>  SET_ELEMENT(retval,1,ess);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><span class="lineno">  235</span>    SET_ELEMENT(retval,2,x);</div>
<div class="line"><span class="lineno">  236</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  237</span>    SET_ELEMENT(retval,2,newstates);</div>
<div class="line"><span class="lineno">  238</span>  }</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordflow">if</span> (all_fail || !do_pr) {</div>
<div class="line"><span class="lineno">  241</span>    SET_ELEMENT(retval,3,<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">  242</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  243</span>    SET_ELEMENT(retval,3,newparams);</div>
<div class="line"><span class="lineno">  244</span>  }</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordflow">if</span> (do_pm) {</div>
<div class="line"><span class="lineno">  247</span>    SET_ELEMENT(retval,4,pm);</div>
<div class="line"><span class="lineno">  248</span>  }</div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><span class="lineno">  250</span>    SET_ELEMENT(retval,5,pv);</div>
<div class="line"><span class="lineno">  251</span>  }</div>
<div class="line"><span class="lineno">  252</span>  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><span class="lineno">  253</span>    SET_ELEMENT(retval,6,fm);</div>
<div class="line"><span class="lineno">  254</span>  }</div>
<div class="line"><span class="lineno">  255</span>  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><span class="lineno">  256</span>    SET_ELEMENT(retval,7,anc);</div>
<div class="line"><span class="lineno">  257</span>  }</div>
<div class="line"><span class="lineno">  258</span>  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><span class="lineno">  259</span>    SET_ELEMENT(retval,8,wmean);</div>
<div class="line"><span class="lineno">  260</span>  }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  263</span>  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><span class="lineno">  264</span>}</div>
<div class="ttc" id="adecls_8h_html_a2f8f78d126b50ffa8da9b867053278df"><div class="ttname"><a href="#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int, double *, int, int *, int)</div><div class="ttdef"><b>Definition</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
<div class="ttc" id="apfilter_8c_html_a5a2b1c00965b1b0dc8e1c931ceede8d6"><div class="ttname"><a href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6">filt_mean</a></div><div class="ttdeci">static void filt_mean(int, int, int, long double, const double *, const double *, double *)</div><div class="ttdef"><b>Definition</b> <a href="pfilter_8c_source.html#l00294">pfilter.c:294</a></div></div>
<div class="ttc" id="apfilter_8c_html_a753cef4b66fbcd5c1df4a4cb94e04edc"><div class="ttname"><a href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc">pred_mean_var</a></div><div class="ttdeci">static void pred_mean_var(int, int, int, const double *, double *, double *)</div><div class="ttdef"><b>Definition</b> <a href="pfilter_8c_source.html#l00266">pfilter.c:266</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph.png" border="0" usemap="#adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph" alt=""/></div>
<map name="adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph" id="adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,156,65,181"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="131,5,218,31"/>
<area shape="poly" title=" " alt="" coords="40,154,67,105,87,75,112,48,129,35,132,40,115,52,91,78,71,107,45,157"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="284,31,395,56"/>
<area shape="poly" title=" " alt="" coords="44,154,72,123,112,92,151,74,192,61,270,46,271,51,193,66,153,79,115,96,76,126,48,158"/>
<area shape="rect" href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6" title=" " alt="" coords="133,107,216,132"/>
<area shape="poly" title=" " alt="" coords="65,156,125,134,126,139,67,161"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="121,156,228,181"/>
<area shape="poly" title=" " alt="" coords="66,166,108,166,108,171,66,171"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="129,205,221,231"/>
<area shape="poly" title=" " alt="" coords="67,177,126,198,125,203,65,182"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="115,255,234,280"/>
<area shape="poly" title=" " alt="" coords="49,180,77,209,115,240,126,246,124,251,112,244,74,213,46,183"/>
<area shape="rect" href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc" title=" " alt="" coords="113,304,236,329"/>
<area shape="poly" title=" " alt="" coords="44,180,70,233,90,263,115,289,123,295,119,299,112,293,86,266,65,235,39,183"/>
<area shape="poly" title=" " alt="" coords="219,22,271,30,270,35,218,27"/>
</map>
</div>

</div>
</div>
<a id="aa9632871950917c7b954b1784b74ec78" name="aa9632871950917c7b954b1784b74ec78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9632871950917c7b954b1784b74ec78">&#9670;&#160;</a></span>pomp_desolve_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_desolve_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>object</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00156">156</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  156</span>                                                                       {</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  159</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">  160</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><span class="lineno">  161</span>  SEXP pompfun, ob;</div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// extract user-defined skeleton function</span></div>
<div class="line"><span class="lineno">  166</span>  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><span class="lineno">  167</span>  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><span class="lineno">  169</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = <a class="code hl_variable" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>;</div>
<div class="line"><span class="lineno">  172</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = <a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>;</div>
<div class="line"><span class="lineno">  173</span>  <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  175</span>  R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><span class="lineno">  176</span>  R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><span class="lineno">  179</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0];</div>
<div class="line"><span class="lineno">  180</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  183</span>  <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">  184</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>;</div>
<div class="line"><span class="lineno">  185</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <span class="comment">// set up the covariate table</span></div>
<div class="line"><span class="lineno">  188</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>) = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><span class="lineno">  189</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><span class="lineno">  190</span>  PROTECT(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = NEW_NUMERIC(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><span class="lineno">  191</span>  R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><span class="lineno">  194</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  195</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>  <span class="keywordflow">switch</span> (<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  208</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code hl_function" href="#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><span class="lineno">  209</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>);</div>
<div class="line"><span class="lineno">  210</span>    nprotect += 3;</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><span class="lineno">  217</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  218</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  }</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  229</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  230</span>    PROTECT(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  231</span>    nprotect += 3;</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>)))) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">if</span> (!isNull(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>))) R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  241</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><span class="lineno">  242</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><span class="lineno">  243</span>    R_PreserveObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>  }</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_setup&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  }</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><span class="lineno">  258</span>}</div>
<div class="ttc" id="atrajectory_8c_html_a0e74f51a4d7e89b6a52cc7d78cc8f5ca"><div class="ttname"><a href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a></div><div class="ttdeci">#define RFUN(X)</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00153">trajectory.c:153</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a852c03f3cb2e07fb73c219e4f9a7bf9f"><div class="ttname"><a href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a></div><div class="ttdeci">#define COMMON(X)</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00152">trajectory.c:152</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a8ad5c5cfa2eab8626017e1b9ed0a3f7c"><div class="ttname"><a href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a></div><div class="ttdeci">SEXP cindex</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00146">trajectory.c:146</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a980f881d230271d4e5084135e85a521b"><div class="ttname"><a href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a></div><div class="ttdeci">pomp_skeleton * fun</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00147">trajectory.c:147</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab488f90e51bbc91068510577c6d742db"><div class="ttname"><a href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a></div><div class="ttdeci">SEXP sindex</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00144">trajectory.c:144</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab8af0f07388320ad03576d4d4c0c1bc1"><div class="ttname"><a href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a></div><div class="ttdeci">SEXP pindex</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00145">trajectory.c:145</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac39df6bb0605d87c14d69c0767c29b92"><div class="ttname"><a href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a></div><div class="ttdeci">#define NAT(X)</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00154">trajectory.c:154</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac8d8b2659244f8b65022c653e1604b05"><div class="ttname"><a href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a></div><div class="ttdeci">SEXP object</div><div class="ttdef"><b>Definition</b> <a href="trajectory_8c_source.html#l00127">trajectory.c:127</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9632871950917c7b954b1784b74ec78_cgraph.png" border="0" usemap="#adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph" alt=""/></div>
<map name="adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph" id="adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,165,105"/>
<area shape="rect" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8" title=" " alt="" coords="239,5,354,31"/>
<area shape="poly" title=" " alt="" coords="115,77,212,39,235,32,237,37,214,45,117,82"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="215,55,378,80"/>
<area shape="poly" title=" " alt="" coords="165,80,201,76,202,81,166,86"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="213,104,380,129"/>
<area shape="poly" title=" " alt="" coords="166,99,200,103,200,108,165,104"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="225,153,368,179"/>
<area shape="poly" title=" " alt="" coords="120,103,214,138,240,147,238,152,212,143,118,108"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="428,128,548,153"/>
<area shape="poly" title=" " alt="" coords="368,154,414,148,414,153,369,159"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="437,177,539,203"/>
<area shape="poly" title=" " alt="" coords="369,172,423,179,422,185,368,178"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="596,177,703,203"/>
<area shape="poly" title=" " alt="" coords="540,187,582,187,582,193,540,193"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="751,177,868,203"/>
<area shape="poly" title=" " alt="" coords="703,187,737,187,737,193,703,193"/>
</map>
</div>

</div>
</div>
<a id="abc1f879a376bbbef32d6d8fde12078ed" name="abc1f879a376bbbef32d6d8fde12078ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1f879a376bbbef32d6d8fde12078ed">&#9670;&#160;</a></span>pomp_desolve_takedown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_desolve_takedown </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00292">292</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  292</span>                                  {</div>
<div class="line"><span class="lineno">  293</span>  R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><span class="lineno">  294</span>  R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">  295</span>  R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><span class="lineno">  296</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = R_NilValue;</div>
<div class="line"><span class="lineno">  297</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  298</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  299</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = 0;</div>
<div class="line"><span class="lineno">  300</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = 0;</div>
<div class="line"><span class="lineno">  301</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = 0;</div>
<div class="line"><span class="lineno">  302</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = 0;</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  <span class="keywordflow">switch</span> (<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><span class="lineno">  309</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  310</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><span class="lineno">  311</span>    <a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  }</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>) = 0;</div>
<div class="line"><span class="lineno">  322</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><span class="lineno">  323</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><span class="lineno">  324</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><span class="lineno">  325</span>    R_ReleaseObject(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  328</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = R_NilValue;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_takedown&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  }</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><span class="lineno">  346</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada19523cc1edc44a799fce734f25c934" name="ada19523cc1edc44a799fce734f25c934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada19523cc1edc44a799fce734f25c934">&#9670;&#160;</a></span>pomp_fun_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_fun_handler </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>pfun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>S</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>O</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>C</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00030">30</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><span class="lineno">   34</span>  SEXP f = R_NilValue;</div>
<div class="line"><span class="lineno">   35</span>  SEXP sidx, pidx, oidx, cidx;</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  *<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = *(INTEGER(GET_SLOT(pfun,install(<span class="stringliteral">&quot;mode&quot;</span>))));</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">switch</span> (*<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:                    <span class="comment">// R function</span></div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;R.fun&quot;</span>))); nprotect++;</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:  <span class="comment">// native code</span></div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">if</span> (*(LOGICAL(gnsi))) {     <span class="comment">// get native symbol information?</span></div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>      SEXP nf, pack;</div>
<div class="line"><span class="lineno">   52</span>      PROTECT(nf = GET_SLOT(pfun,install(<span class="stringliteral">&quot;native.fun&quot;</span>)));</div>
<div class="line"><span class="lineno">   53</span>      PROTECT(pack = GET_SLOT(pfun,install(<span class="stringliteral">&quot;PACKAGE&quot;</span>)));</div>
<div class="line"><span class="lineno">   54</span>      nprotect += 2;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>      <span class="keywordflow">if</span> (LENGTH(pack) &lt; 1) {</div>
<div class="line"><span class="lineno">   57</span>        PROTECT(pack = mkString(<span class="stringliteral">&quot;&quot;</span>)); nprotect++; <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">   58</span>      }</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>      <span class="keywordflow">if</span> (*<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>) {</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>        SEXP nsi;</div>
<div class="line"><span class="lineno">   63</span>        PROTECT(nsi = eval(PROTECT(lang3(install(<span class="stringliteral">&quot;getNativeSymbolInfo&quot;</span>),nf,pack)),R_BaseEnv));</div>
<div class="line"><span class="lineno">   64</span>        PROTECT(f = <a class="code hl_function" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(nsi,<span class="stringliteral">&quot;address&quot;</span>));</div>
<div class="line"><span class="lineno">   65</span>        nprotect += 3;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>) {</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, *pkg;</div>
<div class="line"><span class="lineno">   70</span>        fname = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(nf,0));</div>
<div class="line"><span class="lineno">   71</span>        pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><span class="lineno">   72</span>        DL_FUNC <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><span class="lineno">   73</span>        <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = R_GetCCallable(pkg,fname);</div>
<div class="line"><span class="lineno">   74</span>        PROTECT(f = R_MakeExternalPtrFn(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,R_NilValue,R_NilValue)); nprotect++;</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>      }</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>      SET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>),f);</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>      <span class="keywordflow">if</span> (S != NA_STRING) {</div>
<div class="line"><span class="lineno">   81</span>        PROTECT(sidx = <a class="code hl_function" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(S,pfun,<span class="stringliteral">&quot;statenames&quot;</span>,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">   82</span>        SET_SLOT(pfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>),sidx);</div>
<div class="line"><span class="lineno">   83</span>      }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>      <span class="keywordflow">if</span> (P != NA_STRING) {</div>
<div class="line"><span class="lineno">   86</span>        PROTECT(pidx = <a class="code hl_function" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(P,pfun,<span class="stringliteral">&quot;paramnames&quot;</span>,<span class="stringliteral">&quot;parameters&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">   87</span>        SET_SLOT(pfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>),pidx);</div>
<div class="line"><span class="lineno">   88</span>      }</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>      <span class="keywordflow">if</span> (O != NA_STRING) {</div>
<div class="line"><span class="lineno">   91</span>        PROTECT(oidx = <a class="code hl_function" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(O,pfun,<span class="stringliteral">&quot;obsnames&quot;</span>,<span class="stringliteral">&quot;observables&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">   92</span>        SET_SLOT(pfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>),oidx);</div>
<div class="line"><span class="lineno">   93</span>      }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>      <span class="keywordflow">if</span> (C != NA_STRING) {</div>
<div class="line"><span class="lineno">   96</span>        PROTECT(cidx = <a class="code hl_function" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(C,pfun,<span class="stringliteral">&quot;covarnames&quot;</span>,<span class="stringliteral">&quot;covariates&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">   97</span>        SET_SLOT(pfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>),cidx);</div>
<div class="line"><span class="lineno">   98</span>      }</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>    } <span class="keywordflow">else</span> {                    <span class="comment">// native symbol info is stored</span></div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>      PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>))); nprotect++;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    }</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    PROTECT(f = R_NilValue); nprotect++;</div>
<div class="line"><span class="lineno">  111</span>    *<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>  }</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordflow">return</span> f;</div>
<div class="line"><span class="lineno">  119</span>}</div>
<div class="ttc" id="apomp__fun_8c_html_ad3048ea27b0cd1af35870f0b0db5228e"><div class="ttname"><a href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a></div><div class="ttdeci">static R_INLINE SEXP name_index(SEXP provided, SEXP object, const char *slot, const char *humanreadable)</div><div class="ttdef"><b>Definition</b> <a href="pomp__fun_8c_source.html#l00010">pomp_fun.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ada19523cc1edc44a799fce734f25c934_cgraph.png" border="0" usemap="#adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph" alt=""/></div>
<map name="adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph" id="adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,56"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="196,5,316,31"/>
<area shape="poly" title=" " alt="" coords="148,31,182,26,183,31,149,36"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="205,55,307,80"/>
<area shape="poly" title=" " alt="" coords="149,50,191,56,190,61,148,56"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="364,55,471,80"/>
<area shape="poly" title=" " alt="" coords="308,65,350,65,350,70,308,70"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="519,55,636,80"/>
<area shape="poly" title=" " alt="" coords="471,65,505,65,505,70,471,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ada19523cc1edc44a799fce734f25c934_icgraph.png" border="0" usemap="#adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph" alt=""/></div>
<map name="adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph" id="adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph">
<area shape="rect" title=" " alt="" coords="851,379,993,404"/>
<area shape="rect" href="dmeasure_8c.html#a326516e59ec4f791bcc752ef5f763c71" title=" " alt="" coords="667,5,778,31"/>
<area shape="poly" title=" " alt="" coords="917,365,910,300,892,214,877,168,857,123,832,81,801,44,777,29,779,25,804,40,837,78,862,120,882,166,897,213,915,300,922,365"/>
<area shape="rect" href="dprior_8c.html#aa41223e2376a1ecca8a599619048da63" title=" " alt="" coords="681,55,764,80"/>
<area shape="poly" title=" " alt="" coords="915,365,906,309,886,235,871,197,852,159,829,124,801,93,783,82,763,75,765,70,786,77,804,89,833,121,856,156,876,195,891,234,911,308,921,364"/>
<area shape="rect" href="emeasure_8c.html#ab362c459382493c6f7f4721dc5bf6457" title=" " alt="" coords="667,104,778,129"/>
<area shape="poly" title=" " alt="" coords="913,366,901,318,879,258,846,196,825,167,801,143,777,129,780,124,804,139,829,164,851,193,884,256,906,316,918,364"/>
<area shape="rect" href="partrans_8c.html#ac51832cdc1f6e9a2f22df3a0f385cb86" title=" " alt="" coords="673,153,772,179"/>
<area shape="poly" title=" " alt="" coords="909,367,893,330,869,286,839,240,801,200,768,181,771,176,804,196,843,237,874,283,898,328,914,365"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="506,628,577,653"/>
<area shape="poly" title=" " alt="" coords="920,418,909,468,889,530,874,562,855,593,832,619,804,642,776,656,746,664,684,670,624,664,576,654,578,649,625,659,684,664,745,659,774,651,801,637,828,616,851,589,869,560,884,528,904,467,915,417"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,316,108,341"/>
<area shape="poly" title=" " alt="" coords="907,368,890,338,866,303,837,270,801,244,766,227,735,217,706,212,678,211,618,215,543,219,387,219,342,222,296,231,208,258,133,290,81,318,78,313,131,286,206,253,294,225,341,217,387,214,543,214,618,210,678,206,707,207,736,212,768,222,804,240,840,266,871,300,894,335,911,365"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="488,428,595,453"/>
<area shape="poly" title=" " alt="" coords="903,417,861,457,834,477,804,491,760,504,723,506,687,501,642,491,598,475,561,456,564,451,600,470,643,486,688,496,724,501,759,498,802,486,831,472,858,453,900,413"/>
<area shape="rect" href="rprior_8c.html#aff3b8f1d525f9c301d07b63276b76b43" title=" " alt="" coords="683,353,763,379"/>
<area shape="poly" title=" " alt="" coords="837,383,763,374,763,368,837,378"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="673,403,773,428"/>
<area shape="poly" title=" " alt="" coords="837,404,773,412,773,407,837,399"/>
<area shape="rect" href="vmeasure_8c.html#a97fc58eebfdaa733377f210c1dd48082" title=" " alt="" coords="667,452,778,477"/>
<area shape="poly" title=" " alt="" coords="879,412,804,442,766,454,765,449,802,437,877,407"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="661,255,785,280"/>
<area shape="poly" title=" " alt="" coords="897,370,855,331,801,294,775,283,777,278,804,289,858,327,901,366"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="673,553,772,579"/>
<area shape="poly" title=" " alt="" coords="908,417,866,476,837,508,804,536,767,556,765,551,801,532,833,504,862,472,904,414"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="672,603,773,628"/>
<area shape="poly" title=" " alt="" coords="915,418,899,457,876,503,844,551,804,592,775,608,772,603,801,588,840,548,871,501,894,455,910,416"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="658,753,787,779"/>
<area shape="poly" title=" " alt="" coords="922,418,916,483,897,571,882,617,862,663,837,706,804,744,788,755,785,751,801,740,832,703,858,661,877,616,892,569,910,483,917,418"/>
<area shape="rect" href="trajectory_8c.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="643,704,803,729"/>
<area shape="poly" title=" " alt="" coords="920,418,909,473,888,545,854,620,831,655,804,687,774,706,771,702,801,683,827,652,849,617,883,543,904,472,914,417"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="664,304,781,329"/>
<area shape="poly" title=" " alt="" coords="880,375,802,343,768,332,770,327,804,338,882,370"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,385,440,411"/>
<area shape="poly" title=" " alt="" coords="512,620,486,592,454,542,427,491,392,412,397,410,432,488,458,539,490,588,516,617"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,341,289,367"/>
<area shape="poly" title=" " alt="" coords="326,384,270,369,272,364,328,379"/>
<area shape="poly" title=" " alt="" coords="142,344,108,339,109,334,143,339"/>
<area shape="poly" title=" " alt="" coords="482,427,434,413,435,408,483,422"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="491,304,591,329"/>
<area shape="poly" title=" " alt="" coords="663,286,590,306,588,301,661,281"/>
<area shape="poly" title=" " alt="" coords="506,338,415,387,412,383,503,334"/>
<area shape="rect" href="dinit_8c.html#aa791ce91b1a00dfb19ecaf829dfc287a" title=" " alt="" coords="504,553,579,579"/>
<area shape="poly" title=" " alt="" coords="659,569,579,569,579,563,659,563"/>
<area shape="rect" href="dprocess_8c.html#a2a6438a8b3220ecd24e531d5b3dd4534" title=" " alt="" coords="490,753,593,779"/>
<area shape="poly" title=" " alt="" coords="644,769,593,769,593,763,644,763"/>
<area shape="poly" title=" " alt="" coords="650,319,592,319,592,314,650,314"/>
</map>
</div>

</div>
</div>
<a id="a5c9d4b991e534272c7dc4a6602be32ec" name="a5c9d4b991e534272c7dc4a6602be32ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9d4b991e534272c7dc4a6602be32ec">&#9670;&#160;</a></span>pomp_vf_eval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void pomp_vf_eval </td>
          <td>(</td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>neq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>ydot</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>yout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>ip</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00260">260</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>{</div>
<div class="line"><span class="lineno">  262</span>  <span class="keywordflow">switch</span> (<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:                    <span class="comment">// R function</span></div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_function" href="#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a>(ydot,t,y,REAL(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><span class="lineno">  267</span>                    <a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>),<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),<a class="code hl_define" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>),</div>
<div class="line"><span class="lineno">  268</span>                    <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><span class="lineno">  269</span>                    <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><span class="lineno">  270</span>                    &amp;<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),REAL(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:          <span class="comment">// native code</span></div>
<div class="line"><span class="lineno">  275</span>    <a class="code hl_function" href="#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a>(ydot,t,y,REAL(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><span class="lineno">  276</span>                         <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><span class="lineno">  277</span>                         <a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><span class="lineno">  278</span>                         INTEGER(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>)),INTEGER(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>)),INTEGER(<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>)),</div>
<div class="line"><span class="lineno">  279</span>                         &amp;<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>),<a class="code hl_define" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),REAL(<a class="code hl_define" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_vf_eval&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>  }</div>
<div class="line"><span class="lineno">  290</span>}</div>
<div class="ttc" id="adecls_8h_html_a02d94e3819f568bb29c6d5e77f02a3d8"><div class="ttname"><a href="#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, lookup_table_t *, double *)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00093">skeleton.c:94</a></div></div>
<div class="ttc" id="adecls_8h_html_a87734543f5fc40ed123f9f1664e3b7a7"><div class="ttname"><a href="#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, lookup_table_t *, pomp_skeleton *, SEXP, double *)</div><div class="ttdef"><b>Definition</b> <a href="skeleton_8c_source.html#l00245">skeleton.c:245</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph.png" border="0" usemap="#adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph" alt=""/></div>
<map name="adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph" id="adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,120,56"/>
<area shape="rect" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="168,5,328,31"/>
<area shape="poly" title=" " alt="" coords="120,33,154,28,155,33,121,38"/>
<area shape="rect" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="184,55,312,80"/>
<area shape="poly" title=" " alt="" coords="121,48,171,55,170,60,120,53"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="377,5,482,31"/>
<area shape="poly" title=" " alt="" coords="328,15,363,15,363,21,328,21"/>
<area shape="poly" title=" " alt="" coords="295,52,368,32,369,37,296,57"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="389,55,469,80"/>
<area shape="poly" title=" " alt="" coords="312,65,375,65,375,70,312,70"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="531,131,648,156"/>
<area shape="poly" title=" " alt="" coords="307,77,518,125,517,130,305,83"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="376,156,483,181"/>
<area shape="poly" title=" " alt="" coords="273,78,395,147,392,152,271,82"/>
<area shape="poly" title=" " alt="" coords="483,158,517,152,518,157,483,163"/>
</map>
</div>

</div>
</div>
<a id="ab87d831ce816f581c1145704489ae791" name="ab87d831ce816f581c1145704489ae791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87d831ce816f581c1145704489ae791">&#9670;&#160;</a></span>probe_acf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_acf </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>lags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>corr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00100">100</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>                                              {</div>
<div class="line"><span class="lineno">  101</span>  SEXP ans, ans_names;</div>
<div class="line"><span class="lineno">  102</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordtype">int</span> nlag, correlation, <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, n;</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordtype">int</span> j, k, l;</div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordtype">double</span> *p, *p1, *<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordtype">int</span> *lag;</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  nlag = LENGTH(lags);                        <span class="comment">// number of lags</span></div>
<div class="line"><span class="lineno">  110</span>  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><span class="lineno">  111</span>  lag = INTEGER(lags);</div>
<div class="line"><span class="lineno">  112</span>  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = INTEGER(GET_DIM(x))[0];       <span class="comment">// number of variables</span></div>
<div class="line"><span class="lineno">  115</span>  n = INTEGER(GET_DIM(x))[1];               <span class="comment">// number of observations</span></div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  PROTECT(ans = NEW_NUMERIC(nlag*<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_function" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(REAL(ans),REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,lag,nlag);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><span class="lineno">  124</span>    l = 0;</div>
<div class="line"><span class="lineno">  125</span>    <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = (<span class="keywordtype">double</span> *) R_alloc(<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_function" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,&amp;l,1); <span class="comment">// compute lag-0 covariance</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">for</span> (j = 0, p = REAL(ans), p1 = <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>; j &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, p1++)</div>
<div class="line"><span class="lineno">  128</span>      <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, p++)</div>
<div class="line"><span class="lineno">  129</span>        *p /= *p1;</div>
<div class="line"><span class="lineno">  130</span>  }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  PROTECT(ans_names = NEW_STRING(nlag*<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">for</span> (j = 0, l = 0; j &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++) {</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, l++) {</div>
<div class="line"><span class="lineno">  135</span>      snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;acf[%d]&quot;</span>,lag[k]);</div>
<div class="line"><span class="lineno">  136</span>      SET_STRING_ELT(ans_names,l,mkChar(tmp));</div>
<div class="line"><span class="lineno">  137</span>    }</div>
<div class="line"><span class="lineno">  138</span>  }</div>
<div class="line"><span class="lineno">  139</span>  SET_NAMES(ans,ans_names);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  UNPROTECT(4);</div>
<div class="line"><span class="lineno">  142</span>  <span class="keywordflow">return</span> ans;</div>
<div class="line"><span class="lineno">  143</span>}</div>
<div class="ttc" id="aprobe__acf_8c_html_a5d99d0781d78dd79d7516d73c89f62ea"><div class="ttname"><a href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a></div><div class="ttdeci">static void pomp_acf_compute(double *acf, double *x, int n, int nvars, int *lags, int nlag)</div><div class="ttdef"><b>Definition</b> <a href="probe__acf_8c_source.html#l00011">probe_acf.c:11</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab87d831ce816f581c1145704489ae791_cgraph.png" border="0" usemap="#adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph" alt=""/></div>
<map name="adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph" id="adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,92,31"/>
<area shape="rect" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea" title=" " alt="" coords="140,5,291,31"/>
<area shape="poly" title=" " alt="" coords="92,15,126,15,126,21,92,21"/>
</map>
</div>

</div>
</div>
<a id="aa00b01cfe308e46e0f8a0e830f363a9a" name="aa00b01cfe308e46e0f8a0e830f363a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa00b01cfe308e46e0f8a0e830f363a9a">&#9670;&#160;</a></span>probe_ccf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_ccf </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>lags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>corr</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00145">145</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>                                                      {</div>
<div class="line"><span class="lineno">  146</span>  SEXP ans, ans_names;</div>
<div class="line"><span class="lineno">  147</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[2], xx, *p;</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordtype">int</span> nlag, n, correlation;</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordtype">int</span> k;</div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  nlag = LENGTH(lags);</div>
<div class="line"><span class="lineno">  154</span>  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><span class="lineno">  155</span>  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  n = LENGTH(x);                <span class="comment">// n = # of observations</span></div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">if</span> (n != LENGTH(y)) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;x&#39; and &#39;y&#39; must have equal lengths&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><span class="lineno">  161</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = duplicate(AS_NUMERIC(y)));</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  PROTECT(ans = NEW_NUMERIC(nlag));</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <a class="code hl_function" href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727">pomp_ccf_compute</a>(REAL(ans),REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,INTEGER(lags),nlag);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><span class="lineno">  168</span>    k = 0;</div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_function" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(&amp;<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0],REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of x</span></div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_function" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(&amp;<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1],REAL(<a class="code hl_define" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of y</span></div>
<div class="line"><span class="lineno">  171</span>    xx = sqrt(<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0]*<a class="code hl_variable" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1]);</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">for</span> (k = 0, p = REAL(ans); k &lt; nlag; k++, p++) *p /= xx; <span class="comment">// convert to correlation</span></div>
<div class="line"><span class="lineno">  173</span>  }</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  PROTECT(ans_names = NEW_STRING(nlag));</div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++) {</div>
<div class="line"><span class="lineno">  177</span>    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;ccf[%d]&quot;</span>,INTEGER(lags)[k]);</div>
<div class="line"><span class="lineno">  178</span>    SET_STRING_ELT(ans_names,k,mkChar(tmp));</div>
<div class="line"><span class="lineno">  179</span>  }</div>
<div class="line"><span class="lineno">  180</span>  SET_NAMES(ans,ans_names);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>  UNPROTECT(5);</div>
<div class="line"><span class="lineno">  183</span>  <span class="keywordflow">return</span> ans;</div>
<div class="line"><span class="lineno">  184</span>}</div>
<div class="ttc" id="aprobe__acf_8c_html_ae6e4e25744357eec0f8ca5705bea9727"><div class="ttname"><a href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727">pomp_ccf_compute</a></div><div class="ttdeci">static void pomp_ccf_compute(double *ccf, double *x, double *y, int n, int *lags, int nlag)</div><div class="ttdef"><b>Definition</b> <a href="probe__acf_8c_source.html#l00047">probe_acf.c:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph.png" border="0" usemap="#adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph" alt=""/></div>
<map name="adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph" id="adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,91,56"/>
<area shape="rect" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea" title=" " alt="" coords="139,5,289,31"/>
<area shape="poly" title=" " alt="" coords="91,34,124,29,125,34,91,40"/>
<area shape="rect" href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727" title=" " alt="" coords="139,55,289,80"/>
<area shape="poly" title=" " alt="" coords="91,47,126,52,125,57,91,52"/>
</map>
</div>

</div>
</div>
<a id="a9d070d973eba13345ec32d0dd772520f" name="a9d070d973eba13345ec32d0dd772520f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d070d973eba13345ec32d0dd772520f">&#9670;&#160;</a></span>probe_marginal_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>ref</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>order</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>diff</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00010">10</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>                                                            {</div>
<div class="line"><span class="lineno">   11</span>  SEXP z, mm, <a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, retval, retvalnames;</div>
<div class="line"><span class="lineno">   12</span>  <span class="keywordtype">int</span> n, nx, np, df, dim[2];</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>  np = *(INTEGER(AS_INTEGER(order))); <span class="comment">// order of polynomial regression</span></div>
<div class="line"><span class="lineno">   15</span>  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><span class="lineno">   16</span>  n = LENGTH(ref);                    <span class="comment">// n = number of observations</span></div>
<div class="line"><span class="lineno">   17</span>  nx = n - df;                        <span class="comment">// nx = rows in model matrix</span></div>
<div class="line"><span class="lineno">   18</span>  dim[0] = nx; dim[1] = np;           <span class="comment">// dimensions of model matrix</span></div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>  <span class="keywordflow">if</span> (nx &lt; 1) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have diff &lt; number of observations&quot;</span>);</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span>  PROTECT(z = duplicate(AS_NUMERIC(ref)));</div>
<div class="line"><span class="lineno">   23</span>  PROTECT(mm = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><span class="lineno">   24</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = NEW_NUMERIC(np));</div>
<div class="line"><span class="lineno">   25</span>  PROTECT(pivot = NEW_INTEGER(np));</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>  PROTECT(retval = NEW_LIST(3));</div>
<div class="line"><span class="lineno">   28</span>  PROTECT(retvalnames = NEW_CHARACTER(3));</div>
<div class="line"><span class="lineno">   29</span>  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;mm&quot;</span>));</div>
<div class="line"><span class="lineno">   30</span>  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;tau&quot;</span>));</div>
<div class="line"><span class="lineno">   31</span>  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;pivot&quot;</span>));</div>
<div class="line"><span class="lineno">   32</span>  SET_ELEMENT(retval,0,mm);</div>
<div class="line"><span class="lineno">   33</span>  SET_ELEMENT(retval,1,<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><span class="lineno">   34</span>  SET_ELEMENT(retval,2,pivot);</div>
<div class="line"><span class="lineno">   35</span>  SET_NAMES(retval,retvalnames);</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_function" href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156">order_reg_model_matrix</a>(REAL(z),REAL(mm),REAL(<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  UNPROTECT(6);</div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><span class="lineno">   41</span>}</div>
<div class="ttc" id="aprobe__marginal_8c_html_a9accae76d6ed9147d0db36478294f156"><div class="ttname"><a href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156">order_reg_model_matrix</a></div><div class="ttdeci">static void order_reg_model_matrix(double *z, double *X, double *tau, int *pivot, int n, int np, int diff)</div><div class="ttdef"><b>Definition</b> <a href="probe__marginal_8c_source.html#l00078">probe_marginal.c:78</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph.png" border="0" usemap="#adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph" alt=""/></div>
<map name="adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph" id="adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,172,56"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="265,5,357,31"/>
<area shape="poly" title=" " alt="" coords="172,31,252,22,252,27,173,36"/>
<area shape="rect" href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156" title=" " alt="" coords="220,55,403,80"/>
<area shape="poly" title=" " alt="" coords="173,50,207,53,206,59,172,55"/>
<area shape="rect" href="pomp__mat_8h.html#a305b5b8bb23bc880b442f68dc1219ed6" title=" " alt="" coords="451,55,529,80"/>
<area shape="poly" title=" " alt="" coords="403,65,437,65,437,70,403,70"/>
</map>
</div>

</div>
</div>
<a id="afac769062b9d41abb5d572eeaf6cf05b" name="afac769062b9d41abb5d572eeaf6cf05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac769062b9d41abb5d572eeaf6cf05b">&#9670;&#160;</a></span>probe_marginal_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_solve </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>setup</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>diff</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00043">43</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                                                          {</div>
<div class="line"><span class="lineno">   44</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, mm, <a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, beta, beta_names;</div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordtype">int</span> n, nx, np, df;</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><span class="lineno">   50</span>  n = LENGTH(x);                      <span class="comment">// n = number of observations</span></div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  <span class="comment">// unpack the setup information</span></div>
<div class="line"><span class="lineno">   53</span>  PROTECT(mm = VECTOR_ELT(setup,0));    <span class="comment">//  QR-decomposed model matrix</span></div>
<div class="line"><span class="lineno">   54</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = VECTOR_ELT(setup,1));   <span class="comment">// diagonals</span></div>
<div class="line"><span class="lineno">   55</span>  PROTECT(pivot = VECTOR_ELT(setup,2)); <span class="comment">// pivots</span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  nx = INTEGER(GET_DIM(mm))[0]; <span class="comment">// nx = number of rows in model matrix</span></div>
<div class="line"><span class="lineno">   58</span>  np = INTEGER(GET_DIM(mm))[1]; <span class="comment">// np = order of polynomial</span></div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordflow">if</span> (n-df != nx) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;ref&#39; must equal length of data&quot;</span>);</div>
<div class="line"><span class="lineno">   61</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  PROTECT(beta = NEW_NUMERIC(np));</div>
<div class="line"><span class="lineno">   64</span>  PROTECT(beta_names = NEW_STRING(np));</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordflow">for</span> (i = 0; i &lt; np; i++) {</div>
<div class="line"><span class="lineno">   66</span>    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;marg.%d&quot;</span>,i+1);</div>
<div class="line"><span class="lineno">   67</span>    SET_STRING_ELT(beta_names,i,mkChar(tmp));</div>
<div class="line"><span class="lineno">   68</span>  }</div>
<div class="line"><span class="lineno">   69</span>  SET_NAMES(beta,beta_names);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_function" href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1">order_reg_solve</a>(REAL(beta),REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(mm),REAL(<a class="code hl_define" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  UNPROTECT(6);</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">return</span>(beta);</div>
<div class="line"><span class="lineno">   75</span>}</div>
<div class="ttc" id="aprobe__marginal_8c_html_ab7ed44d923122eec45887a267060c3e1"><div class="ttname"><a href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1">order_reg_solve</a></div><div class="ttdeci">static void order_reg_solve(double *beta, double *x, double *mm, double *tau, int *pivot, int n, int np, int diff)</div><div class="ttdef"><b>Definition</b> <a href="probe__marginal_8c_source.html#l00117">probe_marginal.c:117</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph.png" border="0" usemap="#adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph" alt=""/></div>
<map name="adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph" id="adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,172,56"/>
<area shape="rect" href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1" title=" " alt="" coords="220,31,347,56"/>
<area shape="poly" title=" " alt="" coords="173,41,206,41,206,46,173,46"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="395,5,527,31"/>
<area shape="poly" title=" " alt="" coords="346,32,381,27,382,32,347,37"/>
<area shape="rect" href="pomp__mat_8h.html#a595e9be65aee622370178eb5a49f85c2" title=" " alt="" coords="413,55,508,80"/>
<area shape="poly" title=" " alt="" coords="347,49,400,56,399,62,346,55"/>
</map>
</div>

</div>
</div>
<a id="aac7d9cf2e04e141bce1bdfa71f9c576b" name="aac7d9cf2e04e141bce1bdfa71f9c576b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac7d9cf2e04e141bce1bdfa71f9c576b">&#9670;&#160;</a></span>probe_nlar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_nlar </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>lags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>powers</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__nlar_8c_source.html#l00009">9</a> of file <a class="el" href="probe__nlar_8c_source.html">probe_nlar.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    9</span>                                                 {</div>
<div class="line"><span class="lineno">   10</span>  SEXP y, beta, beta_names;</div>
<div class="line"><span class="lineno">   11</span>  <span class="keywordtype">int</span> n, nterms;</div>
<div class="line"><span class="lineno">   12</span>  <span class="keywordtype">int</span> k;</div>
<div class="line"><span class="lineno">   13</span>  <span class="keywordtype">double</span> *mm;</div>
<div class="line"><span class="lineno">   14</span>  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  n = LENGTH(x);                <span class="comment">// n = # of observations</span></div>
<div class="line"><span class="lineno">   17</span>  nterms = LENGTH(lags);</div>
<div class="line"><span class="lineno">   18</span> </div>
<div class="line"><span class="lineno">   19</span>  PROTECT(y = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><span class="lineno">   20</span>  PROTECT(beta = NEW_NUMERIC(nterms));</div>
<div class="line"><span class="lineno">   21</span> </div>
<div class="line"><span class="lineno">   22</span>  mm = (<span class="keywordtype">double</span> *) R_alloc(n*nterms,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">// storage for the model matrix</span></div>
<div class="line"><span class="lineno">   23</span>  <a class="code hl_function" href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c">poly_nlar_fit</a>(REAL(beta),REAL(y),n,nterms,INTEGER(lags),INTEGER(powers),mm);</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  PROTECT(beta_names = NEW_STRING(nterms));</div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nterms; k++) {</div>
<div class="line"><span class="lineno">   27</span>    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;nlar.%d^%d&quot;</span>,INTEGER(lags)[k],INTEGER(powers)[k]);</div>
<div class="line"><span class="lineno">   28</span>    SET_STRING_ELT(beta_names,k,mkChar(tmp));</div>
<div class="line"><span class="lineno">   29</span>  }</div>
<div class="line"><span class="lineno">   30</span>  SET_NAMES(beta,beta_names);</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  UNPROTECT(3);</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordflow">return</span> beta;</div>
<div class="line"><span class="lineno">   34</span>}</div>
<div class="ttc" id="aprobe__nlar_8c_html_afd315040fac0de8def98fd667a0e440c"><div class="ttname"><a href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c">poly_nlar_fit</a></div><div class="ttdeci">static void poly_nlar_fit(double *beta, double *y, int n, int nterms, int *lag, int *power, double *X)</div><div class="ttdef"><b>Definition</b> <a href="probe__nlar_8c_source.html#l00039">probe_nlar.c:39</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph.png" border="0" usemap="#adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph" alt=""/></div>
<map name="adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph" id="adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,96,80"/>
<area shape="rect" href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c" title=" " alt="" coords="144,55,247,80"/>
<area shape="poly" title=" " alt="" coords="96,65,131,65,131,70,96,70"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="295,5,427,31"/>
<area shape="poly" title=" " alt="" coords="238,52,303,32,305,37,239,57"/>
<area shape="rect" href="pomp__mat_8h.html#a305b5b8bb23bc880b442f68dc1219ed6" title=" " alt="" coords="321,55,400,80"/>
<area shape="poly" title=" " alt="" coords="247,65,307,65,307,70,247,70"/>
<area shape="rect" href="pomp__mat_8h.html#a595e9be65aee622370178eb5a49f85c2" title=" " alt="" coords="313,104,408,129"/>
<area shape="poly" title=" " alt="" coords="239,77,305,97,303,102,238,83"/>
</map>
</div>

</div>
</div>
<a id="a3d15947a5f8c829a5672f83b2246d7b8" name="a3d15947a5f8c829a5672f83b2246d7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d15947a5f8c829a5672f83b2246d7b8">&#9670;&#160;</a></span>R_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>prob</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>theta</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00119">119</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  119</span>                                                            {</div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordtype">int</span> k, nval, ns, np, nt;</div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordtype">double</span> *<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><span class="lineno">  122</span>  SEXP ans;</div>
<div class="line"><span class="lineno">  123</span>  PROTECT(n = AS_INTEGER(n)); nval = INTEGER(n)[0];</div>
<div class="line"><span class="lineno">  124</span>  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><span class="lineno">  125</span>  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><span class="lineno">  126</span>  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><span class="lineno">  127</span>  PROTECT(ans = NEW_NUMERIC(nval)); <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(ans);</div>
<div class="line"><span class="lineno">  128</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k] = <a class="code hl_function" href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5">rbetabinom</a>(S[k%ns],P[k%np],T[k%nt]);</div>
<div class="line"><span class="lineno">  131</span>  }</div>
<div class="line"><span class="lineno">  132</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">  133</span>  UNPROTECT(5);</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">return</span> ans;</div>
<div class="line"><span class="lineno">  135</span>}</div>
<div class="ttc" id="apomp_8h_html_a27ce90ca6f901016f2745cd1408cbde5"><div class="ttname"><a href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5">rbetabinom</a></div><div class="ttdeci">static R_INLINE double rbetabinom(double size, double prob, double theta)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00313">pomp.h:314</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph.png" border="0" usemap="#adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph" alt=""/></div>
<map name="adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph" id="adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,31"/>
<area shape="rect" href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5" title=" " alt="" coords="164,5,261,31"/>
<area shape="poly" title=" " alt="" coords="116,15,150,15,150,21,116,21"/>
</map>
</div>

</div>
</div>
<a id="a6133e3ef45a5d9fe3deab72750062df9" name="a6133e3ef45a5d9fe3deab72750062df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6133e3ef45a5d9fe3deab72750062df9">&#9670;&#160;</a></span>R_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>rate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00023">23</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                                                  {</div>
<div class="line"><span class="lineno">   24</span>  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><span class="lineno">   25</span>  <span class="keywordtype">int</span> dim[2];</div>
<div class="line"><span class="lineno">   26</span>  SEXP x, nm;</div>
<div class="line"><span class="lineno">   27</span>  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><span class="lineno">   31</span>  PROTECT(n = AS_INTEGER(n));</div>
<div class="line"><span class="lineno">   32</span>  PROTECT(size = AS_NUMERIC(size));</div>
<div class="line"><span class="lineno">   33</span>  PROTECT(rate = AS_NUMERIC(rate));</div>
<div class="line"><span class="lineno">   34</span>  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><span class="lineno">   35</span>  dim[0] = ntrans;</div>
<div class="line"><span class="lineno">   36</span>  dim[1] = *INTEGER(n);</div>
<div class="line"><span class="lineno">   37</span>  <span class="keywordflow">if</span> (dim[1] == NA_INTEGER || dim[1] &lt; 0)</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: &#39;n&#39; must be a non-negative integer.&quot;</span>);</div>
<div class="line"><span class="lineno">   39</span>  PROTECT(x = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><span class="lineno">   40</span>  PROTECT(nm = GET_NAMES(rate));</div>
<div class="line"><span class="lineno">   41</span>  <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,nm,2);</div>
<div class="line"><span class="lineno">   42</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">   43</span>  <a class="code hl_function" href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372">reulermultinom_multi</a>(dim[0],dim[1],REAL(size),REAL(rate),REAL(deltat),REAL(x));</div>
<div class="line"><span class="lineno">   44</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">   45</span>  UNPROTECT(6);</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">   47</span>}</div>
<div class="ttc" id="adistributions_8c_html_a535016daa0c6d33c1868cc3eace73372"><div class="ttname"><a href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372">reulermultinom_multi</a></div><div class="ttdeci">static void reulermultinom_multi(int m, int n, double *size, double *rate, double *deltat, double *trans)</div><div class="ttdef"><b>Definition</b> <a href="distributions_8c_source.html#l00007">distributions.c:7</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph.png" border="0" usemap="#adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph" alt=""/></div>
<map name="adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph" id="adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,145,80"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="229,5,321,31"/>
<area shape="poly" title=" " alt="" coords="127,52,215,30,216,35,128,57"/>
<area shape="rect" href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372" title=" " alt="" coords="193,55,357,80"/>
<area shape="poly" title=" " alt="" coords="146,65,180,65,180,70,146,70"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="220,104,331,129"/>
<area shape="poly" title=" " alt="" coords="128,77,211,98,209,103,127,83"/>
<area shape="rect" href="pomp_8h.html#af728af2cd3b4be45164906d02a3206a9" title=" " alt="" coords="405,55,528,80"/>
<area shape="poly" title=" " alt="" coords="358,65,391,65,391,70,358,70"/>
</map>
</div>

</div>
</div>
<a id="a05f8691fcce63ae69c6eb740a5e39f41" name="a05f8691fcce63ae69c6eb740a5e39f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05f8691fcce63ae69c6eb740a5e39f41">&#9670;&#160;</a></span>R_GammaWN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_GammaWN </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>deltat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00093">93</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>                                                 {</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordtype">int</span> k, nval, nsig, ndt;</div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordtype">double</span> *x, *sig, *dt;</div>
<div class="line"><span class="lineno">   96</span>  SEXP ans;</div>
<div class="line"><span class="lineno">   97</span>  PROTECT(n = AS_INTEGER(n));</div>
<div class="line"><span class="lineno">   98</span>  nval = INTEGER(n)[0];</div>
<div class="line"><span class="lineno">   99</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = AS_NUMERIC(<a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>));</div>
<div class="line"><span class="lineno">  100</span>  nsig = LENGTH(<a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><span class="lineno">  101</span>  sig = REAL(<a class="code hl_define" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><span class="lineno">  102</span>  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><span class="lineno">  103</span>  ndt = LENGTH(deltat);</div>
<div class="line"><span class="lineno">  104</span>  dt = REAL(deltat);</div>
<div class="line"><span class="lineno">  105</span>  PROTECT(ans = NEW_NUMERIC(nval));</div>
<div class="line"><span class="lineno">  106</span>  x = REAL(ans);</div>
<div class="line"><span class="lineno">  107</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><span class="lineno">  109</span>    x[k] = <a class="code hl_function" href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e">rgammawn</a>(sig[k%nsig],dt[k%ndt]);</div>
<div class="line"><span class="lineno">  110</span>  }</div>
<div class="line"><span class="lineno">  111</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">  112</span>  UNPROTECT(4);</div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">return</span> ans;</div>
<div class="line"><span class="lineno">  114</span>}</div>
<div class="ttc" id="apomp_8h_html_a52cad6bd7c9be6be2215659798114e0e"><div class="ttname"><a href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e">rgammawn</a></div><div class="ttdeci">static R_INLINE double rgammawn(double sigma, double dt)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00128">pomp.h:129</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph.png" border="0" usemap="#adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph" alt=""/></div>
<map name="adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph" id="adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,119,31"/>
<area shape="rect" href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e" title=" " alt="" coords="167,5,263,31"/>
<area shape="poly" title=" " alt="" coords="119,15,153,15,153,21,119,21"/>
</map>
</div>

</div>
</div>
<a id="a632ad1476e98dfe96ef9ee0e7f939b45" name="a632ad1476e98dfe96ef9ee0e7f939b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a632ad1476e98dfe96ef9ee0e7f939b45">&#9670;&#160;</a></span>R_init_pomp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void R_init_pomp </td>
          <td>(</td>
          <td class="paramtype">DllInfo *</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00054">54</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>                                 {</div>
<div class="line"><span class="lineno">   55</span>  <span class="comment">// C functions provided for users</span></div>
<div class="line"><span class="lineno">   56</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;bspline_basis_eval_deriv&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c">bspline_basis_eval_deriv</a>);</div>
<div class="line"><span class="lineno">   57</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;periodic_bspline_basis_eval_deriv&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>);</div>
<div class="line"><span class="lineno">   58</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a0f11ca97854cd188080da40020f738eb">get_userdata</a>);</div>
<div class="line"><span class="lineno">   59</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_int&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a3f2923b639b10bf3be378a454be2ba23">get_userdata_int</a>);</div>
<div class="line"><span class="lineno">   60</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_double&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a34196cff245ce7384eb8b2c3fa4a6552">get_userdata_double</a>);</div>
<div class="line"><span class="lineno">   61</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;pomp_fun_handler&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>);</div>
<div class="line"><span class="lineno">   62</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_incr&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a>);</div>
<div class="line"><span class="lineno">   63</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_decr&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a>);</div>
<div class="line"><span class="lineno">   64</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;make_covariate_table&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>);</div>
<div class="line"><span class="lineno">   65</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_covariate_names&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>);</div>
<div class="line"><span class="lineno">   66</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;table_lookup&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>);</div>
<div class="line"><span class="lineno">   67</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;lookup_in_table&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a>);</div>
<div class="line"><span class="lineno">   68</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_data&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a>);</div>
<div class="line"><span class="lineno">   69</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_sim&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a>);</div>
<div class="line"><span class="lineno">   70</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;systematic_resampling&quot;</span>,(DL_FUNC) &amp;<a class="code hl_function" href="#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a>);</div>
<div class="line"><span class="lineno">   71</span>  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;randwalk_perturbation&quot;</span>, (DL_FUNC) &amp;<a class="code hl_function" href="#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a>);</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  <span class="comment">// Register routines</span></div>
<div class="line"><span class="lineno">   74</span>  R_registerRoutines(info,NULL,<a class="code hl_variable" href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a>,NULL,NULL);</div>
<div class="line"><span class="lineno">   75</span>  R_useDynamicSymbols(info,TRUE);</div>
<div class="line"><span class="lineno">   76</span>  R_forceSymbols(info,FALSE);</div>
<div class="line"><span class="lineno">   77</span>}</div>
<div class="ttc" id="abspline_8c_html_ad552306d18f13eac5425052762f64a0c"><div class="ttname"><a href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c">bspline_basis_eval_deriv</a></div><div class="ttdeci">void bspline_basis_eval_deriv(double x, double *knots, int degree, int nbasis, int deriv, double *y)</div><div class="ttdef"><b>Definition</b> <a href="bspline_8c_source.html#l00115">bspline.c:115</a></div></div>
<div class="ttc" id="adecls_8h_html_a09bcd3caa641c11a9e456e7a4fdafffa"><div class="ttname"><a href="#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a></div><div class="ttdeci">SEXP randwalk_perturbation(SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="mif2_8c_source.html#l00006">mif2.c:6</a></div></div>
<div class="ttc" id="adecls_8h_html_a0f11ca97854cd188080da40020f738eb"><div class="ttname"><a href="#a0f11ca97854cd188080da40020f738eb">get_userdata</a></div><div class="ttdeci">const SEXP get_userdata(const char *)</div><div class="ttdef"><b>Definition</b> <a href="userdata_8c_source.html#l00013">userdata.c:13</a></div></div>
<div class="ttc" id="adecls_8h_html_a17019a937f12763c2df28735e19b88c3"><div class="ttname"><a href="#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a></div><div class="ttdeci">SEXP load_stack_decr(SEXP)</div><div class="ttdef"><b>Definition</b> <a href="pomp__fun_8c_source.html#l00130">pomp_fun.c:130</a></div></div>
<div class="ttc" id="adecls_8h_html_a34196cff245ce7384eb8b2c3fa4a6552"><div class="ttname"><a href="#a34196cff245ce7384eb8b2c3fa4a6552">get_userdata_double</a></div><div class="ttdeci">const double * get_userdata_double(const char *)</div><div class="ttdef"><b>Definition</b> <a href="userdata_8c_source.html#l00026">userdata.c:26</a></div></div>
<div class="ttc" id="adecls_8h_html_a34c714747e1b49d142af4d58fee24446"><div class="ttname"><a href="#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a></div><div class="ttdeci">SEXP apply_probe_sim(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="probe_8c_source.html#l00029">probe.c:29</a></div></div>
<div class="ttc" id="adecls_8h_html_a3f2923b639b10bf3be378a454be2ba23"><div class="ttname"><a href="#a3f2923b639b10bf3be378a454be2ba23">get_userdata_int</a></div><div class="ttdeci">const int * get_userdata_int(const char *)</div><div class="ttdef"><b>Definition</b> <a href="userdata_8c_source.html#l00019">userdata.c:19</a></div></div>
<div class="ttc" id="adecls_8h_html_a90946f2aeaeb4f5826c8de7facb25999"><div class="ttname"><a href="#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a></div><div class="ttdeci">SEXP load_stack_incr(SEXP)</div><div class="ttdef"><b>Definition</b> <a href="pomp__fun_8c_source.html#l00121">pomp_fun.c:121</a></div></div>
<div class="ttc" id="adecls_8h_html_a91f31f12db7a1e75775f01eb11ead99d"><div class="ttname"><a href="#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a></div><div class="ttdeci">SEXP apply_probe_data(SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="probe_8c_source.html#l00004">probe.c:4</a></div></div>
<div class="ttc" id="adecls_8h_html_a9f4822de0304baafeca236b97ecb216b"><div class="ttname"><a href="#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a></div><div class="ttdeci">SEXP systematic_resampling(SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="resample_8c_source.html#l00009">resample.c:9</a></div></div>
<div class="ttc" id="adecls_8h_html_afbec5a723223278096829f0532d5dc3a"><div class="ttname"><a href="#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a></div><div class="ttdeci">SEXP lookup_in_table(SEXP, SEXP)</div><div class="ttdef"><b>Definition</b> <a href="lookup__table_8c_source.html#l00024">lookup_table.c:24</a></div></div>
<div class="ttc" id="ainit_8c_html_aa5ecd2cda6339e38a7040278a02baaa5"><div class="ttname"><a href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a></div><div class="ttdeci">static const R_CallMethodDef callMethods[]</div><div class="ttdef"><b>Definition</b> <a href="init_8c_source.html#l00004">init.c:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph.png" border="0" usemap="#adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph" alt=""/></div>
<map name="adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph" id="adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph">
<area shape="rect" title=" " alt="" coords="5,1623,108,1648"/>
<area shape="rect" href="probe_8c.html#add3f83f20679bad53b6c982ed9dde8ea" title=" " alt="" coords="174,103,313,128"/>
<area shape="poly" title=" " alt="" coords="55,1623,58,1351,69,880,81,633,99,411,110,318,122,241,137,183,154,146,167,133,171,137,158,149,142,184,128,242,115,319,104,412,87,633,75,880,63,1351,61,1623"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="177,1270,310,1295"/>
<area shape="poly" title=" " alt="" coords="62,1622,227,1306,231,1309,67,1624"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="974,740,1137,766"/>
<area shape="poly" title=" " alt="" coords="56,1623,63,1562,79,1469,108,1361,128,1307,154,1256,198,1181,239,1119,280,1067,322,1022,368,982,421,942,556,852,605,825,657,803,711,786,765,773,870,756,960,750,960,755,870,762,766,778,712,791,659,808,607,830,559,857,424,946,371,986,326,1026,284,1071,244,1122,203,1184,158,1258,133,1309,113,1363,84,1470,68,1563,62,1623"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="972,691,1139,716"/>
<area shape="poly" title=" " alt="" coords="56,1623,63,1546,79,1421,108,1270,129,1193,153,1119,181,1032,200,946,217,865,237,792,264,729,282,703,304,680,330,662,362,648,399,640,443,637,643,637,739,642,834,654,992,685,991,690,833,659,739,647,643,642,443,642,400,645,363,653,333,667,307,684,286,706,268,732,242,794,223,866,206,947,186,1033,159,1121,134,1195,113,1271,84,1421,68,1547,61,1623"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="984,1447,1127,1472"/>
<area shape="poly" title=" " alt="" coords="96,1621,161,1601,246,1581,343,1564,443,1557,643,1557,698,1548,792,1526,993,1473,995,1479,793,1531,699,1553,644,1562,443,1562,344,1569,247,1586,162,1607,97,1626"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="1003,343,1108,368"/>
<area shape="poly" title=" " alt="" coords="55,1623,60,1438,74,1120,86,946,103,782,125,641,139,584,153,538,201,397,223,334,247,278,278,231,297,212,319,195,344,182,373,172,406,166,443,164,643,164,703,169,763,183,820,204,874,230,966,285,1030,332,1027,337,963,289,871,234,818,209,761,188,703,174,643,169,443,169,406,171,374,177,346,187,322,199,301,216,282,235,252,281,228,336,206,399,159,539,144,585,131,642,109,782,92,946,79,1120,65,1438,61,1623"/>
<area shape="rect" href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c" title=" " alt="" coords="171,1800,316,1840"/>
<area shape="poly" title=" " alt="" coords="66,1648,100,1709,126,1746,158,1779,175,1791,172,1795,154,1783,122,1750,95,1712,61,1650"/>
<area shape="rect" href="userdata_8c.html#a44f810b1f9d483bd150f3e71102b9534" title=" " alt="" coords="391,1648,497,1674"/>
<area shape="poly" title=" " alt="" coords="108,1636,377,1654,377,1659,108,1642"/>
<area shape="rect" href="userdata_8c.html#a3556b84ff4140332927a0e69ed57df93" title=" " alt="" coords="563,1750,721,1775"/>
<area shape="poly" title=" " alt="" coords="109,1646,157,1657,564,1744,563,1750,155,1662,108,1651"/>
<area shape="rect" href="userdata_8c.html#ae8b18a85d3dd95f88f058c959f645766" title=" " alt="" coords="379,1774,509,1799"/>
<area shape="poly" title=" " alt="" coords="69,1647,105,1688,130,1710,157,1728,209,1750,263,1765,316,1775,365,1781,364,1786,316,1780,262,1770,207,1755,155,1733,126,1714,101,1692,65,1650"/>
<area shape="rect" href="pomp__fun_8c.html#a0a653dae61a3500aaadf64fdefa79c4b" title=" " alt="" coords="180,1928,307,1954"/>
<area shape="poly" title=" " alt="" coords="61,1648,66,1698,81,1769,93,1808,109,1847,131,1883,158,1914,169,1922,166,1927,154,1918,127,1886,105,1849,88,1810,75,1771,61,1698,56,1649"/>
<area shape="rect" href="pomp__fun_8c.html#a5ae1bdf9e79d36d8fc709cbc509d4c8c" title=" " alt="" coords="182,1978,305,2003"/>
<area shape="poly" title=" " alt="" coords="60,1649,63,1705,75,1790,87,1837,104,1883,127,1926,158,1963,171,1973,168,1978,154,1967,123,1929,99,1885,82,1838,69,1791,57,1706,55,1649"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="785,391,909,416"/>
<area shape="poly" title=" " alt="" coords="56,1623,63,1431,81,1111,94,944,111,796,130,683,142,644,154,620,185,586,219,555,256,529,295,505,379,467,467,439,553,420,636,408,772,400,772,405,636,414,554,425,468,444,381,472,298,510,259,533,222,559,189,589,158,623,146,646,135,684,116,797,100,945,86,1111,68,1431,61,1623"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="159,1864,328,1904"/>
<area shape="poly" title=" " alt="" coords="63,1648,72,1687,90,1741,118,1799,136,1826,158,1850,163,1854,160,1858,154,1854,132,1829,113,1802,85,1743,67,1688,58,1649"/>
<area shape="rect" href="mif2_8c.html#add4b451ca3aa78a5e56183372c18bdb7" title=" " alt="" coords="557,1648,727,1674"/>
<area shape="poly" title=" " alt="" coords="108,1630,286,1623,397,1625,510,1633,572,1643,571,1648,509,1638,397,1630,286,1629,108,1635"/>
<area shape="rect" href="resample_8c.html#a982475f3663a786d7883672aa2ed072e" title=" " alt="" coords="156,2027,331,2052"/>
<area shape="poly" title=" " alt="" coords="62,1648,73,1723,93,1834,122,1943,139,1986,158,2014,162,2017,158,2021,154,2018,134,1988,117,1945,88,1835,68,1724,57,1649"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="393,1070,495,1095"/>
<area shape="poly" title=" " alt="" coords="256,1267,418,1103,422,1107,260,1271"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="1195,892,1306,918"/>
<area shape="poly" title=" " alt="" coords="261,1293,314,1336,399,1398,507,1469,632,1535,698,1563,765,1586,833,1602,899,1610,965,1608,1027,1595,1086,1570,1141,1531,1152,1518,1161,1501,1174,1457,1180,1403,1183,1343,1183,1223,1184,1172,1188,1131,1214,1019,1239,930,1244,932,1219,1020,1193,1132,1189,1172,1188,1223,1188,1343,1186,1403,1179,1458,1166,1503,1156,1521,1144,1535,1089,1575,1029,1600,965,1613,899,1615,832,1607,764,1591,696,1568,629,1540,504,1473,396,1403,311,1340,258,1297"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="1205,391,1297,416"/>
<area shape="poly" title=" " alt="" coords="243,1269,252,1202,270,1088,303,939,352,769,383,680,420,589,462,500,511,413,566,329,628,251,697,180,773,118,869,53,914,28,958,11,1003,3,1048,7,1095,23,1144,52,1164,75,1182,110,1212,202,1234,301,1248,377,1243,378,1229,302,1207,204,1177,112,1160,78,1141,57,1093,27,1047,12,1003,9,960,16,916,33,872,57,776,122,700,184,632,255,570,332,516,415,467,502,425,592,388,682,357,771,308,941,276,1089,257,1203,249,1270"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="1012,994,1099,1019"/>
<area shape="poly" title=" " alt="" coords="495,1074,998,1011,999,1016,496,1079"/>
<area shape="poly" title=" " alt="" coords="446,1069,459,1029,481,972,513,910,533,880,555,853,578,833,601,821,645,808,687,794,706,780,724,758,739,732,749,708,757,659,754,613,745,567,736,522,734,475,744,427,756,402,773,377,794,353,814,335,836,324,858,316,907,307,967,297,1061,273,1081,271,1102,274,1122,283,1145,298,1154,310,1162,330,1179,390,1210,561,1235,746,1249,878,1244,879,1229,747,1205,562,1174,391,1157,332,1149,313,1141,302,1120,287,1100,279,1081,277,1062,278,969,302,908,312,859,321,838,328,817,340,797,357,777,380,760,405,749,429,739,475,742,521,750,566,759,612,762,660,754,709,744,735,729,761,710,784,689,798,647,813,603,826,581,838,559,856,537,883,517,913,485,974,464,1030,451,1070"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="607,1220,677,1246"/>
<area shape="poly" title=" " alt="" coords="460,1093,503,1134,559,1180,607,1212,604,1216,556,1185,499,1138,456,1097"/>
<area shape="poly" title=" " alt="" coords="444,1069,464,936,486,831,518,708,560,576,616,442,650,377,687,313,728,253,773,197,815,151,858,113,902,82,948,60,995,49,1043,50,1093,64,1144,94,1176,123,1201,158,1220,197,1233,237,1248,316,1252,377,1247,377,1243,317,1228,239,1215,199,1196,160,1172,126,1141,98,1091,69,1042,55,995,54,950,65,905,86,862,117,819,155,777,200,732,256,691,316,654,379,621,444,565,578,523,710,491,832,469,937,449,1070"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="794,1146,901,1171"/>
<area shape="poly" title=" " alt="" coords="496,1088,727,1131,781,1142,780,1147,726,1136,495,1094"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="592,867,692,892"/>
<area shape="poly" title=" " alt="" coords="456,1068,617,900,621,904,459,1072"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="589,1146,695,1171"/>
<area shape="poly" title=" " alt="" coords="479,1093,558,1124,596,1138,594,1143,556,1129,477,1098"/>
<area shape="poly" title=" " alt="" coords="1080,991,1212,922,1214,927,1082,996"/>
<area shape="poly" title=" " alt="" coords="666,1218,725,1180,748,1155,758,1143,773,1131,812,1110,846,1100,879,1091,919,1074,942,1055,967,1036,998,1022,1000,1026,969,1041,946,1059,921,1078,881,1096,847,1105,814,1115,776,1135,762,1147,752,1159,728,1185,669,1223"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="807,1244,888,1270"/>
<area shape="poly" title=" " alt="" coords="678,1235,794,1248,793,1254,677,1240"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="807,1294,887,1319"/>
<area shape="poly" title=" " alt="" coords="679,1243,776,1279,798,1287,797,1292,774,1284,677,1248"/>
<area shape="poly" title=" " alt="" coords="676,1219,703,1203,725,1181,738,1156,747,1132,754,1084,749,1039,740,994,732,950,731,906,742,861,755,838,773,815,803,796,849,781,960,760,961,766,851,786,805,801,776,819,759,841,747,863,736,906,737,949,745,993,755,1038,759,1085,752,1133,743,1158,729,1184,706,1207,679,1223"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1513,1422,1631,1447"/>
<area shape="poly" title=" " alt="" coords="649,1245,661,1290,686,1354,724,1422,748,1453,776,1480,823,1510,865,1522,968,1530,1110,1546,1168,1549,1222,1547,1275,1540,1331,1527,1464,1481,1533,1451,1535,1456,1466,1486,1332,1532,1276,1545,1222,1552,1168,1554,1109,1551,968,1536,864,1527,821,1515,773,1485,744,1457,719,1425,681,1356,656,1292,644,1247"/>
<area shape="poly" title=" " alt="" coords="676,1219,703,1203,725,1181,740,1153,749,1126,756,1074,751,1023,740,974,730,925,728,875,732,850,740,825,753,800,773,774,791,756,812,741,859,719,909,706,958,700,959,705,910,711,861,724,815,746,795,760,777,778,758,803,745,827,737,852,733,876,735,924,745,973,756,1022,761,1074,755,1127,745,1155,729,1184,706,1207,679,1223"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="814,1195,881,1220"/>
<area shape="poly" title=" " alt="" coords="677,1226,800,1211,800,1216,678,1231"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="775,1446,920,1471"/>
<area shape="poly" title=" " alt="" coords="651,1245,669,1280,696,1328,732,1379,776,1424,797,1438,794,1442,773,1429,728,1382,691,1330,664,1282,647,1247"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="1015,1496,1096,1522"/>
<area shape="poly" title=" " alt="" coords="653,1245,699,1313,735,1353,776,1387,814,1404,847,1409,882,1414,921,1431,937,1444,946,1457,955,1470,969,1482,1003,1496,1001,1501,967,1486,951,1473,942,1460,933,1447,919,1435,880,1419,847,1414,812,1409,773,1391,731,1356,695,1316,648,1248"/>
<area shape="poly" title=" " alt="" coords="660,1244,710,1284,776,1328,816,1347,848,1357,881,1367,921,1387,946,1407,969,1426,1000,1440,998,1445,967,1430,942,1411,919,1391,880,1372,847,1362,814,1352,773,1333,706,1288,656,1248"/>
<area shape="poly" title=" " alt="" coords="676,1219,703,1204,724,1181,736,1156,745,1124,754,1048,754,959,751,863,747,766,746,676,754,598,761,566,772,539,787,515,803,498,838,475,876,456,918,426,941,400,951,389,967,377,988,367,991,372,969,382,954,393,945,404,922,430,878,460,840,479,807,502,792,518,777,541,766,567,759,599,752,676,752,766,756,863,759,959,759,1048,750,1125,741,1157,729,1184,706,1208,679,1224"/>
<area shape="poly" title=" " alt="" coords="901,1469,1002,1494,1001,1499,900,1474"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="1197,1496,1304,1522"/>
<area shape="poly" title=" " alt="" coords="1096,1506,1184,1506,1184,1512,1096,1512"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="1197,1144,1304,1170"/>
<area shape="poly" title=" " alt="" coords="1095,1503,1120,1496,1141,1482,1170,1448,1193,1409,1211,1367,1224,1325,1240,1244,1246,1183,1251,1184,1246,1245,1229,1326,1216,1369,1198,1411,1174,1451,1144,1486,1122,1500,1097,1508"/>
<area shape="poly" title=" " alt="" coords="1096,1505,1120,1497,1141,1482,1148,1468,1154,1445,1164,1376,1177,1187,1188,880,1218,617,1243,430,1248,431,1224,618,1193,880,1183,1187,1170,1377,1159,1446,1153,1470,1145,1486,1123,1502,1097,1510"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="1191,1724,1311,1750"/>
<area shape="poly" title=" " alt="" coords="1127,1470,1144,1482,1169,1507,1189,1537,1220,1600,1239,1662,1249,1711,1243,1712,1234,1663,1215,1602,1185,1539,1165,1511,1141,1486,1124,1475"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="1199,1447,1302,1472"/>
<area shape="poly" title=" " alt="" coords="1127,1457,1186,1457,1186,1462,1127,1462"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="1359,1447,1465,1472"/>
<area shape="poly" title=" " alt="" coords="1302,1457,1345,1457,1345,1462,1302,1462"/>
<area shape="poly" title=" " alt="" coords="1465,1449,1499,1443,1500,1449,1466,1454"/>
<area shape="poly" title=" " alt="" coords="888,1143,918,1125,934,1103,941,1081,949,1059,966,1036,998,1018,1001,1022,970,1040,953,1062,946,1083,939,1105,922,1128,891,1148"/>
<area shape="poly" title=" " alt="" coords="901,1168,965,1179,1035,1188,1099,1190,1124,1186,1141,1179,1169,1154,1192,1124,1210,1091,1223,1055,1239,986,1246,931,1251,932,1245,987,1228,1057,1215,1093,1196,1127,1173,1158,1144,1183,1125,1191,1099,1195,1035,1194,964,1185,900,1173"/>
<area shape="poly" title=" " alt="" coords="853,1144,1039,777,1044,779,858,1147"/>
<area shape="poly" title=" " alt="" coords="902,1167,922,1181,939,1205,946,1230,944,1278,942,1302,944,1325,952,1346,970,1367,997,1379,1047,1390,1192,1408,1359,1421,1500,1429,1500,1434,1358,1426,1192,1413,1046,1395,995,1384,966,1371,947,1349,939,1326,937,1302,939,1278,940,1231,934,1207,918,1184,899,1171"/>
<area shape="poly" title=" " alt="" coords="849,1145,908,916,943,789,966,726,970,722,974,726,970,729,948,791,913,917,854,1146"/>
<area shape="poly" title=" " alt="" coords="902,1167,922,1181,936,1200,943,1221,944,1260,946,1297,954,1314,970,1330,1013,1354,1033,1359,1053,1361,1095,1352,1141,1329,1161,1316,1179,1299,1207,1259,1227,1218,1240,1182,1245,1184,1232,1220,1212,1262,1183,1302,1165,1320,1144,1334,1096,1357,1054,1366,1033,1365,1011,1359,966,1334,950,1317,941,1299,939,1260,938,1221,931,1203,918,1184,899,1172"/>
<area shape="poly" title=" " alt="" coords="900,1145,919,1136,933,1123,942,1109,951,1095,966,1080,992,1068,1016,1062,1061,1060,1081,1059,1101,1055,1121,1046,1141,1029,1156,995,1172,933,1203,755,1228,565,1244,430,1249,431,1233,566,1208,756,1177,934,1161,997,1145,1032,1124,1051,1103,1060,1082,1065,1061,1065,1017,1067,994,1073,970,1085,955,1098,946,1112,937,1126,921,1141,902,1150"/>
<area shape="poly" title=" " alt="" coords="903,1167,922,1181,943,1212,951,1244,951,1275,947,1305,943,1335,943,1365,951,1395,970,1426,985,1439,981,1443,966,1430,946,1397,938,1366,938,1335,942,1304,946,1274,946,1244,938,1215,918,1184,899,1171"/>
<area shape="poly" title=" " alt="" coords="850,1145,881,1031,917,866,922,818,923,757,922,614,924,542,931,475,944,419,954,397,966,378,988,362,991,367,970,382,958,399,949,421,936,476,930,542,927,614,928,757,927,818,923,867,886,1033,855,1146"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="1015,1246,1096,1271"/>
<area shape="poly" title=" " alt="" coords="897,1169,921,1180,936,1191,946,1203,955,1213,969,1224,1003,1240,1001,1245,967,1229,952,1217,942,1206,933,1195,919,1185,895,1174"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="996,1095,1115,1120"/>
<area shape="poly" title=" " alt="" coords="900,1143,989,1121,990,1126,901,1148"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="1015,1295,1095,1320"/>
<area shape="poly" title=" " alt="" coords="902,1168,922,1180,933,1193,940,1206,946,1232,952,1257,959,1269,970,1280,985,1291,1003,1298,1001,1302,983,1295,966,1285,955,1272,947,1259,941,1233,935,1208,929,1196,918,1185,899,1173"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="1015,1144,1096,1170"/>
<area shape="poly" title=" " alt="" coords="901,1155,1001,1155,1001,1160,901,1161"/>
<area shape="poly" title=" " alt="" coords="1107,1093,1141,1074,1174,1040,1202,1001,1237,929,1242,931,1206,1003,1178,1043,1144,1078,1109,1097"/>
<area shape="poly" title=" " alt="" coords="1096,1150,1120,1143,1141,1130,1163,1108,1181,1083,1211,1028,1230,974,1242,931,1247,932,1235,976,1216,1030,1186,1086,1167,1111,1144,1134,1122,1147,1097,1155"/>
<area shape="poly" title=" " alt="" coords="1096,1154,1184,1154,1184,1160,1096,1160"/>
<area shape="poly" title=" " alt="" coords="1096,1152,1120,1145,1141,1130,1151,1098,1164,1028,1195,818,1244,429,1249,430,1200,818,1169,1029,1156,1100,1145,1133,1123,1149,1097,1157"/>
<area shape="poly" title=" " alt="" coords="658,891,707,932,740,954,776,972,833,989,893,999,998,1006,998,1011,892,1005,832,994,774,977,737,959,704,936,654,895"/>
<area shape="poly" title=" " alt="" coords="693,879,1182,900,1181,905,692,885"/>
<area shape="poly" title=" " alt="" coords="693,885,948,929,1074,956,1118,968,1144,979,1181,1013,1209,1054,1230,1096,1244,1130,1239,1132,1225,1098,1205,1057,1177,1017,1141,983,1117,973,1073,961,947,934,692,890"/>
<area shape="poly" title=" " alt="" coords="653,865,690,821,709,791,724,759,743,690,748,629,745,573,738,520,732,467,733,412,745,353,772,287,810,225,850,183,900,153,967,125,1016,108,1058,99,1079,99,1100,103,1144,126,1173,151,1196,182,1215,216,1228,252,1245,322,1251,377,1246,378,1239,323,1223,253,1210,218,1192,185,1169,155,1141,130,1098,108,1078,104,1059,104,1018,113,969,130,902,157,853,187,814,228,777,289,750,354,738,412,738,467,743,519,750,572,754,629,748,691,729,761,714,793,694,824,658,869"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="785,552,909,578"/>
<area shape="poly" title=" " alt="" coords="663,865,695,841,724,809,743,773,751,742,758,710,772,671,798,626,825,588,829,591,803,629,777,673,763,711,756,744,748,775,729,812,698,845,666,869"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="968,140,1143,166"/>
<area shape="poly" title=" " alt="" coords="653,865,690,820,709,791,724,759,740,703,746,654,744,609,740,566,736,523,738,478,749,430,772,377,796,340,825,306,891,248,957,202,1013,170,1016,174,960,206,894,252,829,310,801,344,777,380,754,432,743,479,742,523,745,565,749,608,751,654,745,704,729,761,713,793,694,824,658,869"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="789,830,906,855"/>
<area shape="poly" title=" " alt="" coords="692,868,775,853,776,858,693,873"/>
<area shape="poly" title=" " alt="" coords="857,577,872,607,897,648,930,690,970,726,982,733,979,737,966,730,926,693,893,651,868,610,852,579"/>
<area shape="poly" title=" " alt="" coords="855,551,886,498,917,427,923,398,927,360,930,270,939,184,950,149,966,126,988,110,1010,99,1031,93,1052,93,1096,103,1144,125,1167,140,1190,160,1233,212,1273,279,1311,358,1347,447,1381,544,1440,752,1489,961,1527,1153,1570,1408,1564,1409,1522,1154,1484,962,1435,753,1376,546,1342,449,1307,360,1268,281,1228,215,1186,164,1164,145,1141,130,1094,108,1052,98,1032,99,1012,104,991,114,970,130,954,152,944,185,935,270,932,360,929,399,923,429,891,500,860,553"/>
<area shape="poly" title=" " alt="" coords="869,576,922,619,936,636,945,650,954,663,970,676,983,683,980,688,966,681,950,667,940,653,932,639,918,623,865,580"/>
<area shape="poly" title=" " alt="" coords="856,577,887,676,907,745,923,817,934,895,937,962,934,1078,933,1133,937,1192,948,1256,971,1331,984,1360,1000,1389,1035,1435,1031,1438,996,1392,979,1363,965,1333,943,1257,931,1192,927,1133,928,1078,932,962,928,895,917,818,901,746,882,677,851,579"/>
<area shape="poly" title=" " alt="" coords="910,570,1041,593,1102,609,1144,627,1181,654,1211,681,1234,707,1252,735,1281,798,1313,879,1341,957,1363,1039,1380,1121,1392,1201,1407,1340,1413,1433,1407,1434,1402,1340,1387,1201,1374,1122,1357,1040,1336,959,1308,881,1277,800,1247,737,1229,710,1207,684,1178,659,1141,631,1100,614,1040,598,909,576"/>
<area shape="poly" title=" " alt="" coords="864,550,891,526,918,496,932,464,938,434,945,406,953,392,966,378,988,364,991,369,970,382,957,395,950,408,943,436,938,465,922,499,895,530,868,554"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="1015,442,1096,467"/>
<area shape="poly" title=" " alt="" coords="861,550,906,514,967,476,1000,463,1002,468,969,481,909,518,864,554"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="1015,491,1095,516"/>
<area shape="poly" title=" " alt="" coords="888,550,967,525,1001,515,1003,521,969,530,889,555"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="989,540,1122,566"/>
<area shape="poly" title=" " alt="" coords="910,559,974,555,975,560,910,564"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="991,392,1120,418"/>
<area shape="poly" title=" " alt="" coords="862,550,918,495,931,476,939,459,949,443,966,427,977,421,980,425,970,431,953,446,944,462,936,479,922,499,866,554"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="1015,642,1096,667"/>
<area shape="poly" title=" " alt="" coords="875,575,969,620,1006,634,1004,639,967,625,872,580"/>
<area shape="poly" title=" " alt="" coords="1097,656,1122,663,1144,676,1167,699,1186,724,1216,780,1236,834,1247,878,1242,879,1230,836,1211,782,1182,727,1163,702,1141,681,1120,668,1096,661"/>
<area shape="poly" title=" " alt="" coords="1097,654,1122,661,1145,677,1168,707,1182,736,1188,765,1189,794,1186,855,1187,890,1193,929,1245,1131,1240,1132,1188,930,1182,890,1181,855,1184,794,1182,766,1177,738,1163,710,1141,680,1120,666,1095,659"/>
<area shape="poly" title=" " alt="" coords="1072,640,1105,612,1141,575,1196,497,1234,428,1239,430,1200,500,1145,579,1109,616,1075,644"/>
<area shape="poly" title=" " alt="" coords="1118,164,1132,172,1145,184,1156,217,1169,287,1200,494,1249,878,1244,879,1194,495,1164,288,1150,218,1140,187,1129,176,1115,168"/>
<area shape="poly" title=" " alt="" coords="1112,164,1144,183,1184,230,1213,283,1233,335,1246,377,1241,378,1228,337,1208,285,1179,233,1141,187,1109,168"/>
<area shape="poly" title=" " alt="" coords="907,848,1143,884,1182,890,1181,896,1142,889,906,853"/>
<area shape="poly" title=" " alt="" coords="877,827,919,808,967,783,1003,768,1005,773,969,788,921,813,879,832"/>
<area shape="poly" title=" " alt="" coords="856,828,900,778,932,750,967,726,980,719,982,724,969,730,935,754,904,782,860,831"/>
<area shape="poly" title=" " alt="" coords="906,843,962,841,1025,832,1087,811,1115,795,1141,775,1174,736,1200,691,1219,643,1232,593,1245,500,1248,430,1253,430,1251,500,1237,594,1224,644,1205,693,1179,739,1145,779,1118,800,1089,816,1026,837,962,847,906,849"/>
<area shape="poly" title=" " alt="" coords="854,855,923,1133,934,1189,941,1234,951,1277,970,1331,1003,1388,1037,1435,1032,1438,998,1391,966,1333,946,1279,936,1235,929,1190,917,1134,849,856"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="392,1859,496,1884"/>
<area shape="poly" title=" " alt="" coords="317,1836,382,1853,380,1858,315,1841"/>
<area shape="poly" title=" " alt="" coords="411,1861,405,1851,408,1841,422,1835,444,1832,471,1836,482,1845,479,1849,469,1841,444,1838,423,1840,412,1845,410,1850,416,1857"/>
<area shape="poly" title=" " alt="" coords="498,1671,558,1682,828,1705,1177,1730,1177,1735,828,1710,557,1688,497,1676"/>
<area shape="poly" title=" " alt="" coords="722,1757,1177,1737,1177,1743,722,1762"/>
<area shape="poly" title=" " alt="" coords="510,1785,727,1784,935,1773,1142,1752,1177,1747,1177,1752,1143,1757,935,1779,727,1789,510,1791"/>
<area shape="poly" title=" " alt="" coords="864,389,916,354,951,335,989,318,1030,306,1070,302,1109,309,1145,329,1161,359,1178,415,1209,577,1234,752,1249,878,1244,879,1228,753,1204,578,1173,417,1157,361,1141,332,1107,314,1070,308,1031,312,991,323,953,340,918,359,867,393"/>
<area shape="poly" title=" " alt="" coords="859,415,889,468,922,539,931,568,935,594,936,641,937,662,942,683,952,704,970,726,976,731,972,735,966,730,948,707,937,684,932,663,930,641,929,595,926,569,918,541,885,471,855,418"/>
<area shape="poly" title=" " alt="" coords="859,415,888,468,922,539,934,580,939,614,947,645,956,660,970,677,977,682,973,686,966,680,951,664,942,647,933,615,929,581,918,541,883,471,854,418"/>
<area shape="poly" title=" " alt="" coords="857,389,911,330,941,301,967,284,1015,267,1056,261,1096,266,1144,284,1174,303,1201,328,1238,378,1234,381,1197,331,1171,307,1142,289,1095,272,1056,266,1016,272,969,289,945,306,915,334,861,393"/>
<area shape="poly" title=" " alt="" coords="903,388,989,368,990,374,904,394"/>
<area shape="poly" title=" " alt="" coords="328,1876,378,1873,378,1878,328,1881"/>
<area shape="poly" title=" " alt="" coords="727,1664,815,1666,920,1663,1032,1651,1088,1641,1142,1627,1216,1596,1284,1556,1342,1515,1385,1480,1388,1484,1345,1519,1287,1561,1218,1601,1144,1632,1089,1646,1033,1656,920,1668,815,1672,727,1670"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="385,2027,503,2052"/>
<area shape="poly" title=" " alt="" coords="331,2037,371,2037,371,2042,331,2042"/>
</map>
</div>

</div>
</div>
<a id="a09bcd3caa641c11a9e456e7a4fdafffa" name="a09bcd3caa641c11a9e456e7a4fdafffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09bcd3caa641c11a9e456e7a4fdafffa">&#9670;&#160;</a></span>randwalk_perturbation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP randwalk_perturbation </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>rw_sd</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mif2_8c_source.html#l00006">6</a> of file <a class="el" href="mif2_8c_source.html">mif2.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    7</span>{</div>
<div class="line"><span class="lineno">    8</span>  <span class="keywordtype">double</span> *xp = 0, *rw, *xrw, *xs;</div>
<div class="line"><span class="lineno">    9</span>  SEXP Pnames, rwnames, <a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>;</div>
<div class="line"><span class="lineno">   10</span>  <span class="keywordtype">int</span> *dim, *pidx;</div>
<div class="line"><span class="lineno">   11</span>  <span class="keywordtype">int</span> nrw = 0, <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   12</span>  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = duplicate(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  <span class="comment">// unpack parameter matrix</span></div>
<div class="line"><span class="lineno">   17</span>  xp = REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">   18</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   19</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>  <span class="comment">// names of parameters undergoing random walk</span></div>
<div class="line"><span class="lineno">   22</span>  PROTECT(rwnames = GET_NAMES(rw_sd));</div>
<div class="line"><span class="lineno">   23</span>  nrw = LENGTH(rwnames); rw = REAL(rw_sd);</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  <span class="comment">// indices of parameters undergoing random walk</span></div>
<div class="line"><span class="lineno">   26</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a> = <a class="code hl_function" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,rwnames,<span class="stringliteral">&quot;parameters&quot;</span>));</div>
<div class="line"><span class="lineno">   27</span>  pidx = INTEGER(<a class="code hl_variable" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>);</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <span class="keywordflow">for</span> (j = 0, xrw = rw; j &lt; nrw; j++, pidx++, xrw++) {</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">for</span> (k = 0, xs = xp+(*pidx); k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xs += <a class="code hl_variable" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><span class="lineno">   33</span>      *xs += *xrw * norm_rand();</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span>  }</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  UNPROTECT(4);</div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordflow">return</span>(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><span class="lineno">   41</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph.png" border="0" usemap="#adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph" alt=""/></div>
<map name="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph" id="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,31"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="223,5,329,31"/>
<area shape="poly" title=" " alt="" coords="175,15,209,15,209,21,175,21"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="377,5,495,31"/>
<area shape="poly" title=" " alt="" coords="330,15,363,15,363,21,330,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph.png" border="0" usemap="#adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph" alt=""/></div>
<map name="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph" id="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,325,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="ac8e269d1663ac1f67722366434b79ef6" name="ac8e269d1663ac1f67722366434b79ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e269d1663ac1f67722366434b79ef6">&#9670;&#160;</a></span>set_pomp_userdata()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP set_pomp_userdata </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>userdata</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00008">8</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    8</span>                                       {</div>
<div class="line"><span class="lineno">    9</span>  <a class="code hl_define" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a> = userdata;</div>
<div class="line"><span class="lineno">   10</span>  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><span class="lineno">   11</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a91cd56241914126e7f0a89c67bfac2f3" name="a91cd56241914126e7f0a89c67bfac2f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91cd56241914126e7f0a89c67bfac2f3">&#9670;&#160;</a></span>sobol_sequence()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP sobol_sequence </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>dim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>length</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sobolseq_8c_source.html#l00234">234</a> of file <a class="el" href="sobolseq_8c_source.html">sobolseq.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>{</div>
<div class="line"><span class="lineno">  236</span>  SEXP data;</div>
<div class="line"><span class="lineno">  237</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = (<span class="keywordtype">unsigned</span> int) INTEGER(dim)[0];</div>
<div class="line"><span class="lineno">  238</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = (<span class="keywordtype">unsigned</span> int) INTEGER(length)[0];</div>
<div class="line"><span class="lineno">  239</span>  <span class="keywordtype">double</span> *dp;</div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k;</div>
<div class="line"><span class="lineno">  241</span>  <a class="code hl_typedef" href="sobolseq_8c.html#ad2ef622b5e2e8077c41f6793f20aba35">nlopt_sobol</a> s = <a class="code hl_function" href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a">nlopt_sobol_create</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) d);</div>
<div class="line"><span class="lineno">  242</span>  <span class="keywordflow">if</span> (s==0) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;dimension is too high&quot;</span>);</div>
<div class="line"><span class="lineno">  243</span>  PROTECT(data = allocMatrix(REALSXP,d,n)); dp = REAL(data);</div>
<div class="line"><span class="lineno">  244</span>  <a class="code hl_function" href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51">nlopt_sobol_skip</a>(s,n,dp);</div>
<div class="line"><span class="lineno">  245</span>  <span class="keywordflow">for</span> (k = 1; k &lt; n; k++) <a class="code hl_function" href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b">sobol_gen</a>(s,dp+k*d);</div>
<div class="line"><span class="lineno">  246</span>  <a class="code hl_function" href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701">nlopt_sobol_destroy</a>(s);</div>
<div class="line"><span class="lineno">  247</span>  UNPROTECT(1);</div>
<div class="line"><span class="lineno">  248</span>  <span class="keywordflow">return</span>(data);</div>
<div class="line"><span class="lineno">  249</span>}</div>
<div class="ttc" id="asobolseq_8c_html_a0d659e93ebfd9865ee974260fc1f2701"><div class="ttname"><a href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701">nlopt_sobol_destroy</a></div><div class="ttdeci">static void nlopt_sobol_destroy(nlopt_sobol s)</div><div class="ttdef"><b>Definition</b> <a href="sobolseq_8c_source.html#l00196">sobolseq.c:196</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a144bd11f1148a8f19f75b0567ad4d95a"><div class="ttname"><a href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a">nlopt_sobol_create</a></div><div class="ttdeci">static nlopt_sobol nlopt_sobol_create(unsigned sdim)</div><div class="ttdef"><b>Definition</b> <a href="sobolseq_8c_source.html#l00188">sobolseq.c:188</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a66138f1615f8bea909b9ad7107ce3c51"><div class="ttname"><a href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51">nlopt_sobol_skip</a></div><div class="ttdeci">static void nlopt_sobol_skip(nlopt_sobol s, unsigned n, double *x)</div><div class="ttdef"><b>Definition</b> <a href="sobolseq_8c_source.html#l00225">sobolseq.c:225</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a8a0ebcfa3fdd7c7a8296647c972fe54b"><div class="ttname"><a href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b">sobol_gen</a></div><div class="ttdeci">static int sobol_gen(soboldata *sd, double *x)</div><div class="ttdef"><b>Definition</b> <a href="sobolseq_8c_source.html#l00096">sobolseq.c:96</a></div></div>
<div class="ttc" id="asobolseq_8c_html_ad2ef622b5e2e8077c41f6793f20aba35"><div class="ttname"><a href="sobolseq_8c.html#ad2ef622b5e2e8077c41f6793f20aba35">nlopt_sobol</a></div><div class="ttdeci">struct nlopt_soboldata_s * nlopt_sobol</div><div class="ttdef"><b>Definition</b> <a href="sobolseq_8c_source.html#l00060">sobolseq.c:60</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph.png" border="0" usemap="#adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph" alt=""/></div>
<map name="adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph" id="adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,132,105"/>
<area shape="rect" href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a" title=" " alt="" coords="184,5,329,31"/>
<area shape="poly" title=" " alt="" coords="94,77,179,40,199,32,201,37,181,44,96,82"/>
<area shape="rect" href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701" title=" " alt="" coords="180,55,333,80"/>
<area shape="poly" title=" " alt="" coords="132,82,166,77,166,82,133,87"/>
<area shape="rect" href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51" title=" " alt="" coords="191,104,322,129"/>
<area shape="poly" title=" " alt="" coords="133,98,178,104,177,109,132,103"/>
<area shape="rect" href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b" title=" " alt="" coords="394,129,482,155"/>
<area shape="poly" title=" " alt="" coords="93,103,133,123,181,139,233,147,286,150,380,146,381,151,286,155,232,152,179,145,131,128,90,108"/>
<area shape="rect" href="sobolseq_8c.html#a26079fb02c638050adfae1b98eebb878" title=" " alt="" coords="395,5,481,31"/>
<area shape="poly" title=" " alt="" coords="330,15,381,15,381,21,330,21"/>
<area shape="rect" href="sobolseq_8c.html#a7da449b80c90d93929ca447c026f4c6d" title=" " alt="" coords="381,55,495,80"/>
<area shape="poly" title=" " alt="" coords="334,65,367,65,367,70,334,70"/>
<area shape="poly" title=" " alt="" coords="323,123,380,131,380,137,322,128"/>
<area shape="rect" href="sobolseq_8c.html#a5750aa319cae41f5f03c7af0e490922c" title=" " alt="" coords="543,129,639,155"/>
<area shape="poly" title=" " alt="" coords="482,139,529,139,529,145,482,145"/>
</map>
</div>

</div>
</div>
<a id="ac796abcef7f5d6add4d98023a0bde62b" name="ac796abcef7f5d6add4d98023a0bde62b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac796abcef7f5d6add4d98023a0bde62b">&#9670;&#160;</a></span>SSA_simulator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP SSA_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>func</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>xstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>tstart</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>times</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>vmatrix</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>covar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>accumvars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>hmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>gnsi</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssa_8c_source.html#l00226">226</a> of file <a class="el" href="ssa_8c_source.html">ssa.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  228</span>{</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordtype">int</span> *dim, xdim[3];</div>
<div class="line"><span class="lineno">  231</span>  <span class="keywordtype">int</span> nvar, nvarv, nevent, npar, nrep, ntimes;</div>
<div class="line"><span class="lineno">  232</span>  SEXP statenames, paramnames, covarnames;</div>
<div class="line"><span class="lineno">  233</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, covdim;</div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordtype">int</span> nzeros = LENGTH(accumvars);</div>
<div class="line"><span class="lineno">  235</span>  <a class="code hl_enumeration" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><span class="lineno">  236</span>  SEXP <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, zindex, vindex;</div>
<div class="line"><span class="lineno">  237</span>  <span class="keywordtype">int</span> *sidx, *pidx, *cidx, *zidx, *vidx;</div>
<div class="line"><span class="lineno">  238</span>  SEXP <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Vnames;</div>
<div class="line"><span class="lineno">  239</span>  <a class="code hl_struct" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><span class="lineno">  240</span>  Rboolean hasvnames;</div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordtype">double</span> t0;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>  dim = INTEGER(GET_DIM(xstart)); nvar = dim[0]; nrep = dim[1];</div>
<div class="line"><span class="lineno">  244</span>  dim = INTEGER(GET_DIM(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); npar = dim[0];</div>
<div class="line"><span class="lineno">  245</span>  dim = INTEGER(GET_DIM(vmatrix)); nvarv = dim[0]; nevent = dim[1];</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="keywordflow">if</span> (nvarv != nvar)</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;number of state variables must equal the number of rows in &#39;v&#39;.&quot;</span>);</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  ntimes = LENGTH(times);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><span class="lineno">  253</span>  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><span class="lineno">  254</span>  t0 = *(REAL(tstart));</div>
<div class="line"><span class="lineno">  255</span>  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><span class="lineno">  258</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><span class="lineno">  259</span>  PROTECT(Cnames = <a class="code hl_function" href="#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(covar));</div>
<div class="line"><span class="lineno">  260</span>  PROTECT(Vnames = GET_ROWNAMES(GET_DIMNAMES(vmatrix)));</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>  covariate_table = <a class="code hl_function" href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(covar,&amp;covdim);</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  PROTECT(statenames = GET_SLOT(func,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><span class="lineno">  265</span>  PROTECT(paramnames = GET_SLOT(func,install(<span class="stringliteral">&quot;paramnames&quot;</span>)));</div>
<div class="line"><span class="lineno">  266</span>  PROTECT(covarnames = GET_SLOT(func,install(<span class="stringliteral">&quot;covarnames&quot;</span>)));</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>  <a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a> = LENGTH(covarnames);</div>
<div class="line"><span class="lineno">  269</span>  hasvnames = !isNull(Vnames);</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>  PROTECT(hmax = AS_NUMERIC(hmax));</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>  PROTECT(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code hl_function" href="#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code hl_variable" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code hl_define" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>))) = R_ExternalPtrAddr(<a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_define" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a> = (<a class="code hl_typedef" href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a> *) <a class="code hl_function" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9">__pomp_Rfun_ssa_ratefn</a>;</div>
<div class="line"><span class="lineno">  292</span>    <a class="code hl_define" href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a> = nvar;</div>
<div class="line"><span class="lineno">  293</span>    <a class="code hl_define" href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a> = npar;</div>
<div class="line"><span class="lineno">  294</span>    <a class="code hl_define" href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a> = covdim;</div>
<div class="line"><span class="lineno">  295</span>    PROTECT(<a class="code hl_define" href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a> = <a class="code hl_function" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code hl_variable" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><span class="lineno">  296</span>    PROTECT(<a class="code hl_define" href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a> = <a class="code hl_variable" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><span class="lineno">  297</span>    nprotect += 2;</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_define" href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a> = 1;</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>  }</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  xdim[0] = nvar; xdim[1] = nrep; xdim[2] = ntimes;</div>
<div class="line"><span class="lineno">  305</span>  PROTECT(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,xdim)); nprotect++;</div>
<div class="line"><span class="lineno">  306</span>  <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code hl_variable" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,3);</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  309</span>  pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  310</span>  cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>  <span class="keywordflow">if</span> (nzeros&gt;0) {</div>
<div class="line"><span class="lineno">  313</span>    PROTECT(zindex = <a class="code hl_define" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">  314</span>    zidx = INTEGER(zindex);</div>
<div class="line"><span class="lineno">  315</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  316</span>    zidx = 0;</div>
<div class="line"><span class="lineno">  317</span>  }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>  <span class="keywordflow">if</span> (hasvnames) {</div>
<div class="line"><span class="lineno">  320</span>    PROTECT(vindex = <a class="code hl_define" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,Vnames,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><span class="lineno">  321</span>    vidx = INTEGER(vindex);</div>
<div class="line"><span class="lineno">  322</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  323</span>    vidx = 0;</div>
<div class="line"><span class="lineno">  324</span>  }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">  327</span>  {</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">for</span> (i = 0; i &lt; nrep; i++) {</div>
<div class="line"><span class="lineno">  330</span>      <a class="code hl_function" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c">SSA</a>(<a class="code hl_define" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>,i,nvar,nevent,npar,nrep,ntimes,</div>
<div class="line"><span class="lineno">  331</span>          REAL(xstart),t0,REAL(times),REAL(<a class="code hl_variable" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><span class="lineno">  332</span>          REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(vmatrix),</div>
<div class="line"><span class="lineno">  333</span>          nzeros,zidx,sidx,pidx,<a class="code hl_variable" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,cidx,hasvnames,vidx,</div>
<div class="line"><span class="lineno">  334</span>          covdim,&amp;covariate_table,REAL(hmax));</div>
<div class="line"><span class="lineno">  335</span>    }</div>
<div class="line"><span class="lineno">  336</span>  }</div>
<div class="line"><span class="lineno">  337</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  340</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><span class="lineno">  341</span>}</div>
<div class="ttc" id="apomp_8h_html_a7cbbce02475d974d83e25dc46c4b6f1d"><div class="ttname"><a href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a></div><div class="ttdeci">double pomp_ssa_rate_fn(int event, double t, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition</b> <a href="pomp_8h_source.html#l00051">pomp.h:52</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a2285fe40c11882d02308957485772528"><div class="ttname"><a href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a></div><div class="ttdeci">#define MATCHROWNAMES(X, N, W)</div><div class="ttdef"><b>Definition</b> <a href="pomp__defines_8h_source.html#l00013">pomp_defines.h:13</a></div></div>
<div class="ttc" id="assa_8c_html_a08a1d63aa145b71449d68985c31ab32c"><div class="ttname"><a href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c">SSA</a></div><div class="ttdeci">static void SSA(pomp_ssa_rate_fn *ratefun, int irep, int nvar, int nevent, int npar, int nrep, int ntimes, double *xstart, double t, const double *times, const double *params, double *xout, const double *v, int nzero, const int *izero, const int *istate, const int *ipar, int ncovar, const int *icovar, Rboolean hasvname, const int *ivmat, int mcov, lookup_table_t *tab, const double *hmax)</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00118">ssa.c:118</a></div></div>
<div class="ttc" id="assa_8c_html_a492c6ccf2bde2bebcd32e73e0933ee92"><div class="ttname"><a href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a></div><div class="ttdeci">#define FIRST</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00196">ssa.c:196</a></div></div>
<div class="ttc" id="assa_8c_html_a6ee98078df1e27286ab249d0ceb99dc9"><div class="ttname"><a href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a></div><div class="ttdeci">#define NPAR</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00192">ssa.c:192</a></div></div>
<div class="ttc" id="assa_8c_html_a8c08e69dae809f2cec273c05025824f9"><div class="ttname"><a href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9">__pomp_Rfun_ssa_ratefn</a></div><div class="ttdeci">static double __pomp_Rfun_ssa_ratefn(int j, double t, const double *x, const double *p, int *stateindex, int *parindex, int *covindex, double *c)</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00199">ssa.c:199</a></div></div>
<div class="ttc" id="assa_8c_html_aacac4c9fd5f97b563c3e886e6c78af77"><div class="ttname"><a href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a></div><div class="ttdeci">#define RXR</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00197">ssa.c:197</a></div></div>
<div class="ttc" id="assa_8c_html_ad4005a40cf60593ea8924e927d57f9eb"><div class="ttname"><a href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a></div><div class="ttdeci">#define NCOV</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00193">ssa.c:193</a></div></div>
<div class="ttc" id="assa_8c_html_ad5195ac8f863f5a9a7eaa0db094f7639"><div class="ttname"><a href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a></div><div class="ttdeci">#define NVAR</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00191">ssa.c:191</a></div></div>
<div class="ttc" id="assa_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00009">ssa.c:9</a></div></div>
<div class="ttc" id="assa_8c_html_af97b4b249542bc8c012be3f4614bdcf0"><div class="ttname"><a href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a></div><div class="ttdeci">#define RATEFN</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00195">ssa.c:195</a></div></div>
<div class="ttc" id="assa_8c_html_aff1b09d6630c6c0942f78171e74c1b9d"><div class="ttname"><a href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a></div><div class="ttdeci">#define ARGS</div><div class="ttdef"><b>Definition</b> <a href="ssa_8c_source.html#l00194">ssa.c:194</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph.png" border="0" usemap="#adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph" alt=""/></div>
<map name="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph" id="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,123,204"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="171,5,356,31"/>
<area shape="poly" title=" " alt="" coords="68,177,103,112,133,73,169,40,179,34,181,39,172,44,137,76,108,115,73,180"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="223,55,304,80"/>
<area shape="poly" title=" " alt="" coords="73,177,112,134,139,110,169,89,208,74,210,79,172,94,142,114,116,137,77,180"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="182,104,345,129"/>
<area shape="poly" title=" " alt="" coords="87,176,170,138,193,131,194,136,172,143,90,181"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="180,153,347,179"/>
<area shape="poly" title=" " alt="" coords="122,181,166,176,166,181,123,187"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="217,203,309,228"/>
<area shape="poly" title=" " alt="" coords="123,196,204,206,203,211,122,201"/>
<area shape="rect" href="pomp__fun_8c.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="192,252,335,277"/>
<area shape="poly" title=" " alt="" coords="91,202,172,237,198,246,197,251,170,242,89,207"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="208,301,319,327"/>
<area shape="poly" title=" " alt="" coords="77,202,116,245,142,268,172,288,196,298,194,303,169,292,139,272,112,248,73,206"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="239,351,287,376"/>
<area shape="poly" title=" " alt="" coords="73,203,108,268,137,305,172,337,199,350,226,357,225,362,197,355,169,342,133,309,104,271,68,206"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="404,215,524,240"/>
<area shape="poly" title=" " alt="" coords="332,249,390,238,391,244,333,255"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="413,264,515,289"/>
<area shape="poly" title=" " alt="" coords="335,266,399,270,399,275,335,272"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="572,264,679,289"/>
<area shape="poly" title=" " alt="" coords="516,274,558,274,558,279,516,279"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="727,264,844,289"/>
<area shape="poly" title=" " alt="" coords="679,274,713,274,713,279,679,279"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="425,325,503,351"/>
<area shape="poly" title=" " alt="" coords="287,358,411,342,412,347,288,363"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="411,375,517,400"/>
<area shape="poly" title=" " alt="" coords="288,363,398,377,397,382,287,369"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph.png" border="0" usemap="#adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph" alt=""/></div>
<map name="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph" id="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph">
<area shape="rect" title=" " alt="" coords="636,5,753,31"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="488,5,588,31"/>
<area shape="poly" title=" " alt="" coords="622,21,588,21,588,15,622,15"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="337,5,440,31"/>
<area shape="poly" title=" " alt="" coords="474,21,440,21,440,15,474,15"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,31"/>
<area shape="poly" title=" " alt="" coords="324,21,290,21,290,15,324,15"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="142,21,108,21,108,15,142,15"/>
</map>
</div>

</div>
</div>
<a id="ab735e5526875ee755d72af6c8750bc05" name="ab735e5526875ee755d72af6c8750bc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab735e5526875ee755d72af6c8750bc05">&#9670;&#160;</a></span>synth_loglik()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP synth_loglik </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>ysim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>ydat</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="synth__lik_8c_source.html#l00104">104</a> of file <a class="el" href="synth__lik_8c_source.html">synth_lik.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>                                         {</div>
<div class="line"><span class="lineno">  105</span>  SEXP loglik, dim, y;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  PROTECT(y = duplicate(AS_NUMERIC(ydat)));</div>
<div class="line"><span class="lineno">  108</span>  PROTECT(dim = GET_DIM(ysim));</div>
<div class="line"><span class="lineno">  109</span>  PROTECT(ysim = AS_NUMERIC(ysim));</div>
<div class="line"><span class="lineno">  110</span>  PROTECT(loglik = NEW_NUMERIC(1));</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <a class="code hl_function" href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd">robust_synth_loglik</a>(REAL(ysim),INTEGER(dim),REAL(y),REAL(loglik));</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  UNPROTECT(4);</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">return</span> loglik;</div>
<div class="line"><span class="lineno">  116</span>}</div>
<div class="ttc" id="asynth__lik_8c_html_a357cf49307356489922f2cb22efac4fd"><div class="ttname"><a href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd">robust_synth_loglik</a></div><div class="ttdeci">static void robust_synth_loglik(double *y, int *dim, double *ydat, double *loglik)</div><div class="ttdef"><b>Definition</b> <a href="synth__lik_8c_source.html#l00011">synth_lik.c:11</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph.png" border="0" usemap="#adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph" alt=""/></div>
<map name="adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph" id="adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,107,31"/>
<area shape="rect" href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd" title=" " alt="" coords="155,5,304,31"/>
<area shape="poly" title=" " alt="" coords="107,15,141,15,141,21,107,21"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="352,5,484,31"/>
<area shape="poly" title=" " alt="" coords="304,15,338,15,338,21,304,21"/>
</map>
</div>

</div>
</div>
<a id="a9f4822de0304baafeca236b97ecb216b" name="a9f4822de0304baafeca236b97ecb216b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4822de0304baafeca236b97ecb216b">&#9670;&#160;</a></span>systematic_resampling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP systematic_resampling </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>np</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00009">9</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>{</div>
<div class="line"><span class="lineno">   11</span>  <span class="keywordtype">int</span> m, n;</div>
<div class="line"><span class="lineno">   12</span>  SEXP perm;</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>  m = *(INTEGER(AS_INTEGER(np)));</div>
<div class="line"><span class="lineno">   15</span>  n = LENGTH(weights);</div>
<div class="line"><span class="lineno">   16</span>  PROTECT(perm = NEW_INTEGER(m));</div>
<div class="line"><span class="lineno">   17</span>  PROTECT(weights = AS_NUMERIC(weights));</div>
<div class="line"><span class="lineno">   18</span>  GetRNGstate();</div>
<div class="line"><span class="lineno">   19</span>  <a class="code hl_function" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a>(n,REAL(weights),m,INTEGER(perm),1);</div>
<div class="line"><span class="lineno">   20</span>  PutRNGstate();</div>
<div class="line"><span class="lineno">   21</span>  UNPROTECT(2);</div>
<div class="line"><span class="lineno">   22</span>  <span class="keywordflow">return</span>(perm);</div>
<div class="line"><span class="lineno">   23</span>}</div>
<div class="ttc" id="aresample_8c_html_a37f1a2acca063e96f0efa73705ec87b2"><div class="ttname"><a href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int nw, double *w, int np, int *p, int offset)</div><div class="ttdef"><b>Definition</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph.png" border="0" usemap="#adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph" alt=""/></div>
<map name="adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph" id="adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,31"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="228,5,347,31"/>
<area shape="poly" title=" " alt="" coords="180,15,214,15,214,21,180,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph.png" border="0" usemap="#adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph" alt=""/></div>
<map name="adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph" id="adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,331,31"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,31"/>
<area shape="poly" title=" " alt="" coords="143,21,108,21,108,15,143,15"/>
</map>
</div>

</div>
</div>
<a id="ade6439566617e54cb9f4507f7ad2824f" name="ade6439566617e54cb9f4507f7ad2824f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6439566617e54cb9f4507f7ad2824f">&#9670;&#160;</a></span>table_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void table_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *</td>          <td class="paramname"><span class="paramname"><em>tab</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00053">53</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>{</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordtype">int</span> flag = 0;</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordtype">int</span> j, k, n;</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordtype">double</span> e;</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordflow">if</span> ((tab == 0) || (tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> &lt; 1) || (tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> &lt; 1)) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   59</span>  tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = findInterval(tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>,tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>,x,1,1,tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>,&amp;flag);</div>
<div class="line"><span class="lineno">   60</span>  <span class="comment">// warn only if we are *outside* the interval</span></div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordflow">if</span> ((x &lt; tab-&gt;x[0]) || (x &gt; tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>-1]))</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_define" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;table_lookup&#39;: extrapolating at %le.&quot;</span>, x);</div>
<div class="line"><span class="lineno">   63</span>  <span class="keywordflow">switch</span> (tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a>) {</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>: <span class="comment">// linear interpolation</span></div>
<div class="line"><span class="lineno">   65</span>    e = (x - tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]) / (tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>] - tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]);</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">for</span> (j = 0, k = tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>*tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>, n = k-tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j &lt; tab-&gt;width; j++, k++, n++) {</div>
<div class="line"><span class="lineno">   67</span>      y[j] = e*(tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k])+(1-e)*(tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[n]);</div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">case</span> 0: <span class="comment">// piecewise constant</span></div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">if</span> (flag &lt; 0) n = 0;</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flag &gt; 0) n = tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>;</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">else</span> n = tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1;</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">for</span> (j = 0, k = n*tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j &lt; tab-&gt;width; j++, k++) {</div>
<div class="line"><span class="lineno">   75</span>      y[j] = tab-&gt;<a class="code hl_variable" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k];</div>
<div class="line"><span class="lineno">   76</span>    }</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   78</span>  }</div>
<div class="line"><span class="lineno">   79</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph.png" border="0" usemap="#adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph" alt=""/></div>
<map name="adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph" id="adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph">
<area shape="rect" title=" " alt="" coords="1059,359,1164,384"/>
<area shape="rect" href="dmeasure_8c.html#a326516e59ec4f791bcc752ef5f763c71" title=" " alt="" coords="868,5,979,31"/>
<area shape="poly" title=" " alt="" coords="1107,345,1104,283,1090,202,1077,159,1060,117,1037,78,1009,44,995,34,978,27,980,22,997,29,1012,40,1042,75,1065,115,1082,158,1095,201,1109,283,1113,345"/>
<area shape="rect" href="emeasure_8c.html#ab362c459382493c6f7f4721dc5bf6457" title=" " alt="" coords="868,55,979,80"/>
<area shape="poly" title=" " alt="" coords="1105,346,1097,295,1080,229,1052,161,1032,129,1009,101,994,90,978,82,980,77,997,86,1013,97,1037,126,1057,159,1085,228,1102,293,1110,345"/>
<area shape="rect" href="rinit_8c.html#ad963b9a55d662fd9085f90fa1d05b399" title=" " alt="" coords="527,156,598,181"/>
<area shape="poly" title=" " alt="" coords="1100,346,1088,313,1070,273,1043,236,1009,206,957,180,901,162,842,152,784,148,677,153,598,164,598,159,677,147,784,143,843,147,902,157,959,175,1012,201,1047,232,1074,271,1093,311,1105,344"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,207,108,232"/>
<area shape="poly" title=" " alt="" coords="1103,346,1094,304,1076,253,1048,202,1030,179,1009,160,973,137,940,122,909,115,878,112,811,116,727,121,398,121,352,123,305,131,216,155,139,184,84,209,82,204,137,179,214,149,304,125,351,118,398,115,727,115,811,111,878,107,910,109,942,117,976,132,1012,156,1034,176,1053,199,1081,250,1099,302,1109,344"/>
<area shape="rect" href="rmeasure_8c.html#aa4917309d8b878da9adfc8ee6223bc2a" title=" " alt="" coords="509,207,616,232"/>
<area shape="poly" title=" " alt="" coords="1096,347,1063,294,1038,268,1009,247,960,226,906,211,852,203,798,199,697,202,616,212,616,207,696,197,798,194,853,198,908,206,961,221,1012,242,1042,264,1067,291,1101,345"/>
<area shape="rect" href="vmeasure_8c.html#a97fc58eebfdaa733377f210c1dd48082" title=" " alt="" coords="868,409,979,435"/>
<area shape="poly" title=" " alt="" coords="1051,390,972,412,971,407,1050,385"/>
<area shape="rect" href="euler_8c.html#af1e18bd117c75ccef2b6bd7f45439b44" title=" " alt="" coords="664,307,788,332"/>
<area shape="poly" title=" " alt="" coords="1045,361,1010,355,788,328,789,323,1011,350,1046,356"/>
<area shape="rect" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="843,508,1003,533"/>
<area shape="poly" title=" " alt="" coords="1099,398,1064,448,1040,475,1012,498,987,510,984,505,1009,493,1036,471,1060,445,1094,395"/>
<area shape="rect" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="859,459,987,484"/>
<area shape="poly" title=" " alt="" coords="1088,395,1053,423,1012,448,980,461,978,456,1009,444,1050,418,1084,391"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="874,557,973,583"/>
<area shape="poly" title=" " alt="" coords="1105,398,1092,432,1072,472,1046,512,1012,547,994,558,974,565,972,560,991,553,1009,543,1042,509,1068,469,1087,430,1100,396"/>
<area shape="rect" href="skeleton_8c.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="836,656,1011,681"/>
<area shape="poly" title=" " alt="" coords="1111,398,1103,450,1087,517,1058,585,1037,617,1012,645,993,658,990,654,1009,641,1033,614,1053,583,1082,515,1098,449,1105,398"/>
<area shape="rect" href="skeleton_8c.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2" title=" " alt="" coords="852,607,995,632"/>
<area shape="poly" title=" " alt="" coords="1108,398,1098,441,1080,494,1052,549,1034,574,1012,596,992,609,989,604,1009,592,1030,570,1048,546,1075,492,1093,439,1103,397"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="337,333,461,359"/>
<area shape="poly" title=" " alt="" coords="1045,372,461,351,462,346,1045,366"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="859,705,988,731"/>
<area shape="poly" title=" " alt="" coords="1113,398,1108,459,1094,539,1081,581,1064,623,1041,662,1012,696,990,710,987,706,1009,692,1037,659,1059,621,1076,580,1089,538,1103,459,1107,398"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="899,257,947,283"/>
<area shape="poly" title=" " alt="" coords="1081,352,1048,328,1009,304,947,279,949,274,1012,300,1051,323,1085,348"/>
<area shape="rect" href="simulate_8c.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="348,207,451,232"/>
<area shape="poly" title=" " alt="" coords="515,186,442,209,440,204,513,181"/>
<area shape="rect" href="probe_8c.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,207,289,232"/>
<area shape="poly" title=" " alt="" coords="334,222,290,222,290,217,334,217"/>
<area shape="poly" title=" " alt="" coords="142,222,108,222,108,217,142,217"/>
<area shape="poly" title=" " alt="" coords="496,222,451,222,451,217,496,217"/>
<area shape="rect" href="rprocess_8c.html#a91f2867fc46d33e1778108853725d74a" title=" " alt="" coords="513,257,613,283"/>
<area shape="poly" title=" " alt="" coords="669,305,605,285,607,280,671,300"/>
<area shape="poly" title=" " alt="" coords="507,256,440,235,442,230,509,251"/>
<area shape="rect" href="skeleton_8c.html#a93ce73bdd2e70be7b043dcfc1a5d259c" title=" " alt="" coords="676,508,776,533"/>
<area shape="poly" title=" " alt="" coords="829,523,776,523,776,518,829,518"/>
<area shape="rect" href="trajectory_8c.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="669,459,783,484"/>
<area shape="poly" title=" " alt="" coords="858,507,777,487,778,481,860,502"/>
<area shape="poly" title=" " alt="" coords="859,490,777,511,776,506,858,485"/>
<area shape="poly" title=" " alt="" coords="845,474,784,474,784,469,845,469"/>
<area shape="rect" href="dinit_8c.html#aa791ce91b1a00dfb19ecaf829dfc287a" title=" " alt="" coords="689,557,763,583"/>
<area shape="poly" title=" " alt="" coords="860,573,764,573,764,567,860,567"/>
<area shape="rect" href="trajectory_8c.html#a3ee9c5f69ec3b1b090448cb76634602d" title=" " alt="" coords="675,631,777,656"/>
<area shape="poly" title=" " alt="" coords="822,658,776,652,777,647,823,653"/>
<area shape="poly" title=" " alt="" coords="838,632,777,640,776,635,838,627"/>
<area shape="poly" title=" " alt="" coords="350,331,91,235,93,230,352,326"/>
<area shape="rect" href="dprocess_8c.html#a2a6438a8b3220ecd24e531d5b3dd4534" title=" " alt="" coords="675,705,777,731"/>
<area shape="poly" title=" " alt="" coords="844,721,778,721,778,715,844,715"/>
<area shape="rect" href="ssa_8c.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="667,257,785,283"/>
<area shape="poly" title=" " alt="" coords="886,273,785,273,785,267,886,267"/>
<area shape="poly" title=" " alt="" coords="654,273,613,273,613,267,654,267"/>
</map>
</div>

</div>
</div>
<a id="a1c47fabab25be7910ba58cc20426bf35" name="a1c47fabab25be7910ba58cc20426bf35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c47fabab25be7910ba58cc20426bf35">&#9670;&#160;</a></span>wpfilter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SEXP wpfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>W</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Trigger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP</td>          <td class="paramname"><span class="paramname"><em>Np</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wpfilter_8c_source.html#l00010">10</a> of file <a class="el" href="wpfilter_8c_source.html">wpfilter.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span>{</div>
<div class="line"><span class="lineno">   12</span> </div>
<div class="line"><span class="lineno">   13</span>  SEXP dimX, dimP, Xnames, Pnames;</div>
<div class="line"><span class="lineno">   14</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, np;</div>
<div class="line"><span class="lineno">   15</span>  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><span class="lineno">   16</span>  <span class="comment">//  int npars;</span></div>
<div class="line"><span class="lineno">   17</span>  <span class="comment">//  int do_pr = 0;  // do parameter resampling?  at the moment, we do not</span></div>
<div class="line"><span class="lineno">   18</span>  <span class="keywordtype">int</span> *dim, k;</div>
<div class="line"><span class="lineno">   19</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>  PROTECT(dimX = GET_DIM(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><span class="lineno">   22</span>  dim = INTEGER(dimX);</div>
<div class="line"><span class="lineno">   23</span>  <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><span class="lineno">   24</span>  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span>  PROTECT(Params = <a class="code hl_function" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(Params));</div>
<div class="line"><span class="lineno">   27</span>  PROTECT(dimP = GET_DIM(Params));</div>
<div class="line"><span class="lineno">   28</span>  dim = INTEGER(dimP);</div>
<div class="line"><span class="lineno">   29</span>  <span class="comment">//  npars = dim[0];</span></div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordflow">if</span> (dim[1] &gt; 1 &amp;&amp; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != dim[1])                     <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_define" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;params&#39;) does not match ncol(&#39;states&#39;)&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><span class="lineno">   32</span>  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(Params)));</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  np = *INTEGER(AS_INTEGER(Np));</div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><span class="lineno">   36</span>  <span class="comment">//  do_pr = (dim[1] &gt; 1);           // resample parameters as well as states</span></div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  PROTECT(Weights = duplicate(AS_NUMERIC(Weights)));</div>
<div class="line"><span class="lineno">   39</span>  PROTECT(W = duplicate(AS_NUMERIC(W)));</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="keywordtype">double</span> trigger, target;</div>
<div class="line"><span class="lineno">   44</span>  trigger = *REAL(AS_NUMERIC(Trigger));</div>
<div class="line"><span class="lineno">   45</span>  target = *REAL(AS_NUMERIC(Target));</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>  <span class="comment">// add W to Weights. check weights for NAN or +Inf. find max of weights.</span></div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordtype">long</span> <span class="keywordtype">double</span> maxlogw = R_NegInf, oldw = 0;</div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordtype">double</span> *xW = REAL(Weights);</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordtype">double</span> *xw = REAL(W);</div>
<div class="line"><span class="lineno">   51</span>  <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    oldw += exp(*xW);</div>
<div class="line"><span class="lineno">   54</span>    *xW += *xw;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">if</span> (ISNAN(*xW) || *xW == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><span class="lineno">   57</span>      SEXP rv;</div>
<div class="line"><span class="lineno">   58</span>      PROTECT(rv = ScalarInteger(k+1)); nprotect++;</div>
<div class="line"><span class="lineno">   59</span>      UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">   60</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">   61</span>    }</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> (maxlogw &lt; *xW) maxlogw = *xW;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  }</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="comment">// set up return list</span></div>
<div class="line"><span class="lineno">   68</span>  SEXP retval, retvalnames, newdim;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  PROTECT(retval = NEW_LIST(5));</div>
<div class="line"><span class="lineno">   71</span>  PROTECT(retvalnames = NEW_CHARACTER(5));</div>
<div class="line"><span class="lineno">   72</span>  PROTECT(newdim = NEW_INTEGER(2));</div>
<div class="line"><span class="lineno">   73</span>  nprotect += 3;</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  dim = INTEGER(newdim);</div>
<div class="line"><span class="lineno">   76</span>  dim[0] = <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><span class="lineno">   77</span>  SET_DIM(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,newdim);</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Xnames,2);</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,2);</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><span class="lineno">   82</span>  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><span class="lineno">   83</span>  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;weights&quot;</span>));</div>
<div class="line"><span class="lineno">   84</span>  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><span class="lineno">   85</span>  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><span class="lineno">   86</span>  SET_NAMES(retval,retvalnames);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  SEXP ess, loglik;</div>
<div class="line"><span class="lineno">   89</span>  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><span class="lineno">   90</span>  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// conditional log likelihood</span></div>
<div class="line"><span class="lineno">   91</span>  nprotect += 2;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordflow">if</span> (maxlogw == R_NegInf) {    <span class="comment">// all particles have zero likelihood</span></div>
<div class="line"><span class="lineno">   94</span>    *REAL(ess) = 0;</div>
<div class="line"><span class="lineno">   95</span>    *REAL(loglik) = R_NegInf;</div>
<div class="line"><span class="lineno">   96</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   97</span>    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws = 0;</div>
<div class="line"><span class="lineno">   99</span>    xw = REAL(W);</div>
<div class="line"><span class="lineno">  100</span>    xW = REAL(Weights);</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><span class="lineno">  102</span>      *xW -= maxlogw;</div>
<div class="line"><span class="lineno">  103</span>      *xw = exp(*xW);</div>
<div class="line"><span class="lineno">  104</span>      <span class="keywordflow">if</span> (*xw != 0) {</div>
<div class="line"><span class="lineno">  105</span>        w += *xw;</div>
<div class="line"><span class="lineno">  106</span>        ws += (*xw)*(*xw);</div>
<div class="line"><span class="lineno">  107</span>      }</div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span>    *(REAL(ess)) = w*w/ws;</div>
<div class="line"><span class="lineno">  110</span>    *(REAL(loglik)) = maxlogw + log(w) - log(oldw);</div>
<div class="line"><span class="lineno">  111</span>  }</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  SET_ELEMENT(retval,3,ess);</div>
<div class="line"><span class="lineno">  114</span>  SET_ELEMENT(retval,4,loglik);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  <span class="keywordflow">if</span> (maxlogw == R_NegInf || (*REAL(ess) &gt;= <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*trigger &amp;&amp; np == <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)) { <span class="comment">// do not resample</span></div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    SET_ELEMENT(retval,0,<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">  119</span>    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><span class="lineno">  120</span>    SET_ELEMENT(retval,2,Weights);</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  } <span class="keywordflow">else</span> {                      <span class="comment">// no resampling</span></div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">// create storage for new states</span></div>
<div class="line"><span class="lineno">  125</span>    SEXP newstates = R_NilValue;</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordtype">double</span> *ss = 0, *st = 0;</div>
<div class="line"><span class="lineno">  127</span>    {</div>
<div class="line"><span class="lineno">  128</span>      <span class="keywordtype">int</span> xdim[] = {<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, np};</div>
<div class="line"><span class="lineno">  129</span>      PROTECT(newstates = <a class="code hl_function" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><span class="lineno">  130</span>      <a class="code hl_function" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newstates,Xnames,2);</div>
<div class="line"><span class="lineno">  131</span>      <a class="code hl_function" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newstates,dimnm,2);</div>
<div class="line"><span class="lineno">  132</span>      ss = REAL(<a class="code hl_define" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><span class="lineno">  133</span>      st = REAL(newstates);</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>    SET_ELEMENT(retval,0,newstates);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">//    SEXP newparams = R_NilValue;</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="comment">//    double *ps = 0, *pt = 0;</span></div>
<div class="line"><span class="lineno">  141</span>    <span class="comment">// if (do_pr) {</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="comment">//   int xdim[] = {npars, np};</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">//   PROTECT(newparams = makearray(2,xdim)); nprotect++;</span></div>
<div class="line"><span class="lineno">  144</span>    <span class="comment">//   setrownames(newparams,Pnames,2);</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="comment">//   fixdimnames(newparams,dimnm,2);</span></div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">//   ps = REAL(Params);</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">//   pt = REAL(newparams);</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="comment">//   SET_ELEMENT(retval,1,newparams);</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="comment">// } else {</span></div>
<div class="line"><span class="lineno">  150</span>    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><span class="lineno">  151</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="comment">// create storage for new weights</span></div>
<div class="line"><span class="lineno">  154</span>    SEXP newweights = R_NilValue;</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordtype">double</span> *ws = 0, *wt = 0;</div>
<div class="line"><span class="lineno">  156</span>    {</div>
<div class="line"><span class="lineno">  157</span>      PROTECT(newweights = NEW_NUMERIC(np)); nprotect++;</div>
<div class="line"><span class="lineno">  158</span>      ws = REAL(Weights);</div>
<div class="line"><span class="lineno">  159</span>      wt = REAL(newweights);</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span>    SET_ELEMENT(retval,2,newweights);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// compute target resampling weights</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">for</span> (k = 0, xw = REAL(W), xW = REAL(Weights); k &lt; <a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><span class="lineno">  165</span>      *xw = *xW;</div>
<div class="line"><span class="lineno">  166</span>      *xW *= target;</div>
<div class="line"><span class="lineno">  167</span>      *xw = exp(*xw - *xW);</div>
<div class="line"><span class="lineno">  168</span>    }</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    <span class="comment">// do resampling</span></div>
<div class="line"><span class="lineno">  171</span>    {</div>
<div class="line"><span class="lineno">  172</span>      <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><span class="lineno">  173</span>      GetRNGstate();</div>
<div class="line"><span class="lineno">  174</span>      <a class="code hl_function" href="#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a>(<a class="code hl_variable" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(W),np,sample,0);</div>
<div class="line"><span class="lineno">  175</span>      PutRNGstate();</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordtype">int</span> sp = sample[k], j;</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordtype">double</span> *xx;</div>
<div class="line"><span class="lineno">  180</span>        <span class="comment">//      double *xp;</span></div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code hl_variable" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><span class="lineno">  182</span>          *st = *xx;</div>
<div class="line"><span class="lineno">  183</span>        <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><span class="lineno">  184</span>        <span class="comment">// if (do_pr) {</span></div>
<div class="line"><span class="lineno">  185</span>        <span class="comment">//   for (j = 0, xp = ps+npars*sp; j &lt; npars; j++, pt++, xp++)</span></div>
<div class="line"><span class="lineno">  186</span>        <span class="comment">//     *pt = *xp;</span></div>
<div class="line"><span class="lineno">  187</span>        <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  188</span>        wt[k] = ws[sp];</div>
<div class="line"><span class="lineno">  189</span>      }</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span>  }</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  UNPROTECT(nprotect);</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><span class="lineno">  195</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph.png" border="0" usemap="#adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph" alt=""/></div>
<map name="adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph" id="adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,76,132"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="140,5,227,31"/>
<area shape="poly" title=" " alt="" coords="54,104,122,48,143,35,145,40,126,52,58,108"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="291,31,401,56"/>
<area shape="poly" title=" " alt="" coords="75,106,123,91,277,55,278,60,125,97,77,111"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="130,107,237,132"/>
<area shape="poly" title=" " alt="" coords="76,117,116,117,116,122,76,122"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="137,156,229,181"/>
<area shape="poly" title=" " alt="" coords="77,129,133,149,132,154,75,134"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="124,205,243,231"/>
<area shape="poly" title=" " alt="" coords="56,130,86,160,125,190,137,197,134,202,123,195,82,164,52,134"/>
<area shape="poly" title=" " alt="" coords="227,22,277,30,276,35,226,27"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="decls_8h.html">decls.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
