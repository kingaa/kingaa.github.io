<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pomp: src/decls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pomp
   </div>
   <div id="projectbrief">Inference for partially observed Markov processes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('decls_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">decls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h__dep__incl.png" border="0" usemap="#asrc_2decls_8hdep" alt=""/></div>
<map name="asrc_2decls_8hdep" id="asrc_2decls_8hdep">
<area shape="rect" title=" " alt="" coords="2230,5,2321,32"/>
<area shape="rect" href="internal_8h.html" title=" " alt="" coords="2222,80,2329,107"/>
<area shape="rect" href="bspline_8c.html" title=" " alt="" coords="5,155,108,181"/>
<area shape="rect" href="dinit_8c.html" title=" " alt="" coords="133,155,218,181"/>
<area shape="rect" href="distributions_8c.html" title=" " alt="" coords="243,155,380,181"/>
<area shape="rect" href="dmeasure_8c.html" title=" " alt="" coords="404,155,525,181"/>
<area shape="rect" href="dprior_8c.html" title=" " alt="" coords="549,155,644,181"/>
<area shape="rect" href="dprocess_8c.html" title=" " alt="" coords="669,155,783,181"/>
<area shape="rect" href="emeasure_8c.html" title=" " alt="" coords="808,155,929,181"/>
<area shape="rect" href="euler_8c.html" title=" " alt="" coords="953,155,1043,181"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="1067,155,1145,181"/>
<area shape="rect" href="logmeanexp_8c.html" title=" " alt="" coords="1169,155,1307,181"/>
<area shape="rect" href="lookup__table_8c.html" title=" " alt="" coords="1331,155,1471,181"/>
<area shape="rect" href="mif2_8c.html" title=" " alt="" coords="1495,155,1581,181"/>
<area shape="rect" href="ou2_8c.html" title=" " alt="" coords="1606,155,1686,181"/>
<area shape="rect" href="partrans_8c.html" title=" " alt="" coords="1711,155,1821,181"/>
<area shape="rect" href="pfilter_8c.html" title=" " alt="" coords="1845,155,1940,181"/>
<area shape="rect" href="pomp__fun_8c.html" title=" " alt="" coords="1964,155,2085,181"/>
<area shape="rect" href="pomp__mat_8h.html" title=" " alt="" coords="2161,155,2288,181"/>
<area shape="rect" href="probe__marginal_8c.html" title=" " alt="" coords="2015,229,2173,256"/>
<area shape="rect" href="probe__nlar_8c.html" title=" " alt="" coords="2198,229,2323,256"/>
<area shape="rect" href="synth__lik_8c.html" title=" " alt="" coords="2347,229,2462,256"/>
<area shape="rect" href="probe_8c.html" title=" " alt="" coords="2414,155,2507,181"/>
<area shape="rect" href="probe__acf_8c.html" title=" " alt="" coords="2532,155,2651,181"/>
<area shape="rect" href="resample_8c.html" title=" " alt="" coords="2674,155,2791,181"/>
<area shape="rect" href="rinit_8c.html" title=" " alt="" coords="2815,155,2898,181"/>
<area shape="rect" href="rmeasure_8c.html" title=" " alt="" coords="2923,155,3041,181"/>
<area shape="rect" href="rprior_8c.html" title=" " alt="" coords="3066,155,3157,181"/>
<area shape="rect" href="rprocess_8c.html" title=" " alt="" coords="3181,155,3292,181"/>
<area shape="rect" href="simulate_8c.html" title=" " alt="" coords="3316,155,3429,181"/>
<area shape="rect" href="skeleton_8c.html" title=" " alt="" coords="3453,155,3564,181"/>
<area shape="rect" href="sobolseq_8c.html" title=" " alt="" coords="3589,155,3703,181"/>
<area shape="rect" href="ssa_8c.html" title=" " alt="" coords="3728,155,3807,181"/>
<area shape="rect" href="trajectory_8c.html" title=" " alt="" coords="3831,155,3949,181"/>
<area shape="rect" href="transformations_8c.html" title=" " alt="" coords="3973,155,4133,181"/>
<area shape="rect" href="userdata_8c.html" title=" " alt="" coords="4157,155,4271,181"/>
<area shape="rect" href="vmeasure_8c.html" title=" " alt="" coords="4295,155,4416,181"/>
<area shape="rect" href="wpfilter_8c.html" title=" " alt="" coords="4441,155,4547,181"/>
</map>
</div>
</div>
<p><a href="decls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41860ab8f0d4fb23e3ce010e6ad2ff2f"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a41860ab8f0d4fb23e3ce010e6ad2ff2f">bspline_basis</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a41860ab8f0d4fb23e3ce010e6ad2ff2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91f1740c904de28f294b3e9dc2bc812"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ac91f1740c904de28f294b3e9dc2bc812">periodic_bspline_basis</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac91f1740c904de28f294b3e9dc2bc812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24fa1bb0f03a3d3443051e82d0246b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab24fa1bb0f03a3d3443051e82d0246b8">bspline_basis_eval_deriv</a> (double, double *, int, int, int, double *)</td></tr>
<tr class="separator:ab24fa1bb0f03a3d3443051e82d0246b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e746ce7f69a999ad8ff316f10fd1d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#af3e746ce7f69a999ad8ff316f10fd1d2">periodic_bspline_basis_eval_deriv</a> (double, double, int, int, int, double *)</td></tr>
<tr class="separator:af3e746ce7f69a999ad8ff316f10fd1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b4fa54c658fe6c6677c51e8346d728c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a6b4fa54c658fe6c6677c51e8346d728c">do_dinit</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6b4fa54c658fe6c6677c51e8346d728c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6133e3ef45a5d9fe3deab72750062df9"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a6133e3ef45a5d9fe3deab72750062df9">R_Euler_Multinom</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6133e3ef45a5d9fe3deab72750062df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7cf2dcaaa5333231ed19998fd9dfde6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aa7cf2dcaaa5333231ed19998fd9dfde6">D_Euler_Multinom</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa7cf2dcaaa5333231ed19998fd9dfde6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f8691fcce63ae69c6eb740a5e39f41"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a05f8691fcce63ae69c6eb740a5e39f41">R_GammaWN</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a05f8691fcce63ae69c6eb740a5e39f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d15947a5f8c829a5672f83b2246d7b8"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a3d15947a5f8c829a5672f83b2246d7b8">R_BetaBinom</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a3d15947a5f8c829a5672f83b2246d7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb19c7180d18dc9f384cea477ee1a83"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a7eb19c7180d18dc9f384cea477ee1a83">D_BetaBinom</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a7eb19c7180d18dc9f384cea477ee1a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983ad52a265f059c6e25be89cdf97fd7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a983ad52a265f059c6e25be89cdf97fd7">do_dmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a983ad52a265f059c6e25be89cdf97fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d3d47b7ef5f3a691582c1000108cdb7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a2d3d47b7ef5f3a691582c1000108cdb7">do_dprior</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a2d3d47b7ef5f3a691582c1000108cdb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef1a476d6745db7455441c65c74fd61"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a6ef1a476d6745db7455441c65c74fd61">do_dprocess</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a6ef1a476d6745db7455441c65c74fd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1ec1439680776719b9b8b9ebdbf9a33"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ac1ec1439680776719b9b8b9ebdbf9a33">do_emeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac1ec1439680776719b9b8b9ebdbf9a33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19293a3a394b4e0885714f833bc2a96b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a> (SEXP, SEXP, SEXP, SEXP, SEXP, double, <a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a>, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a19293a3a394b4e0885714f833bc2a96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80981cb1dec869d1c736129470da780f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a80981cb1dec869d1c736129470da780f">num_euler_steps</a> (double, double, double *)</td></tr>
<tr class="separator:a80981cb1dec869d1c736129470da780f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e40667f6198be18fb99f8f07417da1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a> (double, double, double)</td></tr>
<tr class="separator:a4e40667f6198be18fb99f8f07417da1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc4318ebe71bfe439dc5c6816aec9e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a3dc4318ebe71bfe439dc5c6816aec9e9">_gompertz_normal_dmeasure</a> (double *, double *, double *, double *, int, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a3dc4318ebe71bfe439dc5c6816aec9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7b791e4e3d33b6ac0b5dd04425c9be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a1a7b791e4e3d33b6ac0b5dd04425c9be">_gompertz_normal_rmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a1a7b791e4e3d33b6ac0b5dd04425c9be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad181675b4773a3f401bedc49de88b54c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ad181675b4773a3f401bedc49de88b54c">_gompertz_normal_emeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ad181675b4773a3f401bedc49de88b54c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6fd08b625a00245a898d5375b90a725"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ac6fd08b625a00245a898d5375b90a725">_gompertz_normal_vmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ac6fd08b625a00245a898d5375b90a725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf2fd72947e8ff6f76c2a8d70e649d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a2cf2fd72947e8ff6f76c2a8d70e649d3">_gompertz_step</a> (double *, const double *, const int *, const int *, const int *, const double *, double, double)</td></tr>
<tr class="separator:a2cf2fd72947e8ff6f76c2a8d70e649d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0665a1991b34b2d1c9c85db01ed034b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ad0665a1991b34b2d1c9c85db01ed034b">_gompertz_skeleton</a> (double *, double *, const double *, const int *, const int *, const int *, const double *, double)</td></tr>
<tr class="separator:ad0665a1991b34b2d1c9c85db01ed034b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825a990c0794920e7661efabe955a9e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a825a990c0794920e7661efabe955a9e1">_gompertz_to_trans</a> (double *, const double *, const int *)</td></tr>
<tr class="separator:a825a990c0794920e7661efabe955a9e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab01a70b6ea0338ce91c04f773b54a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#adab01a70b6ea0338ce91c04f773b54a2">_gompertz_from_trans</a> (double *, const double *, const int *)</td></tr>
<tr class="separator:adab01a70b6ea0338ce91c04f773b54a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a632ad1476e98dfe96ef9ee0e7f939b45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45">R_init_pomp</a> (DllInfo *)</td></tr>
<tr class="separator:a632ad1476e98dfe96ef9ee0e7f939b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0537073d1cb88f92ea923a0c28d2ac9d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a0537073d1cb88f92ea923a0c28d2ac9d">logmeanexp</a> (const SEXP, const SEXP)</td></tr>
<tr class="separator:a0537073d1cb88f92ea923a0c28d2ac9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6345040eb63a38c0ff7ae42f3ea35ff"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a> (SEXP)</td></tr>
<tr class="separator:ae6345040eb63a38c0ff7ae42f3ea35ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fc25ac8149dbd6da367aa01dd9ad9ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlookup__table__t.html">lookup_table_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a> (SEXP, int *)</td></tr>
<tr class="separator:a8fc25ac8149dbd6da367aa01dd9ad9ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbec5a723223278096829f0532d5dc3a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a> (SEXP, SEXP)</td></tr>
<tr class="separator:afbec5a723223278096829f0532d5dc3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6439566617e54cb9f4507f7ad2824f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a> (<a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, double, double *)</td></tr>
<tr class="separator:ade6439566617e54cb9f4507f7ad2824f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09bcd3caa641c11a9e456e7a4fdafffa"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a09bcd3caa641c11a9e456e7a4fdafffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb8fb617fb1a4584e553f08810105f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a8eb8fb617fb1a4584e553f08810105f9">_ou2_step</a> (double *, const double *, const int *, const int *, const int *, const double *, double, double)</td></tr>
<tr class="separator:a8eb8fb617fb1a4584e553f08810105f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499e2ed0106272324438f9c988015671"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a499e2ed0106272324438f9c988015671">_ou2_pdf</a> (double *, double *, double *, double, double, const double *, const int *, const int *, const int *, const double *)</td></tr>
<tr class="separator:a499e2ed0106272324438f9c988015671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaef81a8193fa69cf2c0589f8ac56187"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#acaef81a8193fa69cf2c0589f8ac56187">_ou2_skel</a> (double *, double *, double *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:acaef81a8193fa69cf2c0589f8ac56187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af750b0a42d4a28fc0fd251947a27d385"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#af750b0a42d4a28fc0fd251947a27d385">_ou2_dmeasure</a> (double *, double *, double *, double *, int, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:af750b0a42d4a28fc0fd251947a27d385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b56b325d719e42ac66e1367b4f72f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a9b56b325d719e42ac66e1367b4f72f8e">_ou2_rmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:a9b56b325d719e42ac66e1367b4f72f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e80084cfe8b5c5c76de464571a95c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ad5e80084cfe8b5c5c76de464571a95c4">_ou2_emeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:ad5e80084cfe8b5c5c76de464571a95c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8e43ec5af20eb48754c1014606057a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#adc8e43ec5af20eb48754c1014606057a">_ou2_vmeasure</a> (double *, double *, double *, int *, int *, int *, int *, double *, double)</td></tr>
<tr class="separator:adc8e43ec5af20eb48754c1014606057a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ee70ea223bd1cd7359810d1e0c8a49"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab6ee70ea223bd1cd7359810d1e0c8a49">do_partrans</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab6ee70ea223bd1cd7359810d1e0c8a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9eda32aa6838894c1096d31d5672ad"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#abb9eda32aa6838894c1096d31d5672ad">pfilter</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:abb9eda32aa6838894c1096d31d5672ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada19523cc1edc44a799fce734f25c934"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a> (SEXP, SEXP, <a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ada19523cc1edc44a799fce734f25c934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90946f2aeaeb4f5826c8de7facb25999"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a> (SEXP)</td></tr>
<tr class="separator:a90946f2aeaeb4f5826c8de7facb25999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17019a937f12763c2df28735e19b88c3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a> (SEXP)</td></tr>
<tr class="separator:a17019a937f12763c2df28735e19b88c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f31f12db7a1e75775f01eb11ead99d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a91f31f12db7a1e75775f01eb11ead99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c714747e1b49d142af4d58fee24446"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a34c714747e1b49d142af4d58fee24446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87d831ce816f581c1145704489ae791"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab87d831ce816f581c1145704489ae791">probe_acf</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab87d831ce816f581c1145704489ae791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00b01cfe308e46e0f8a0e830f363a9a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aa00b01cfe308e46e0f8a0e830f363a9a">probe_ccf</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa00b01cfe308e46e0f8a0e830f363a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d070d973eba13345ec32d0dd772520f"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a9d070d973eba13345ec32d0dd772520f">probe_marginal_setup</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a9d070d973eba13345ec32d0dd772520f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac769062b9d41abb5d572eeaf6cf05b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#afac769062b9d41abb5d572eeaf6cf05b">probe_marginal_solve</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:afac769062b9d41abb5d572eeaf6cf05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7d9cf2e04e141bce1bdfa71f9c576b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aac7d9cf2e04e141bce1bdfa71f9c576b">probe_nlar</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aac7d9cf2e04e141bce1bdfa71f9c576b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4822de0304baafeca236b97ecb216b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a9f4822de0304baafeca236b97ecb216b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8f78d126b50ffa8da9b867053278df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a> (int, double *, int, int *, int)</td></tr>
<tr class="separator:a2f8f78d126b50ffa8da9b867053278df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3de8f433818929ff221b26769ed9e6c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab3de8f433818929ff221b26769ed9e6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fdad74a815d2783d4f6f7053a6cb3ca"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a0fdad74a815d2783d4f6f7053a6cb3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82bdfc4b0763ddd79d74e02f60e790a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab82bdfc4b0763ddd79d74e02f60e790a">do_rprior</a> (SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ab82bdfc4b0763ddd79d74e02f60e790a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af129ae090fa637ebcec13e50e6c0d7be"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:af129ae090fa637ebcec13e50e6c0d7be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9d3b94c1a9a99e0db90e251f670e853"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa9d3b94c1a9a99e0db90e251f670e853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9390ea094fe7c28762eb6ac23f1c144"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ad9390ea094fe7c28762eb6ac23f1c144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d94e3819f568bb29c6d5e77f02a3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a> (double *, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, double *)</td></tr>
<tr class="separator:a02d94e3819f568bb29c6d5e77f02a3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdcf759e7db4fcc8f07d2692c18183b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a> (double *, double, double, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, int *, double *)</td></tr>
<tr class="separator:adcdcf759e7db4fcc8f07d2692c18183b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87734543f5fc40ed123f9f1664e3b7a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a> (double *, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *, SEXP, double *)</td></tr>
<tr class="separator:a87734543f5fc40ed123f9f1664e3b7a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06448ff2e2ef1613edd4618634dbed6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a> (double *, double, double, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *, int *, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *, SEXP, double *)</td></tr>
<tr class="separator:ae06448ff2e2ef1613edd4618634dbed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1187e52d896c25c1cdb5dd593dbc291"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291">do_skeleton</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:af1187e52d896c25c1cdb5dd593dbc291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91cd56241914126e7f0a89c67bfac2f3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a91cd56241914126e7f0a89c67bfac2f3">sobol_sequence</a> (SEXP, SEXP)</td></tr>
<tr class="separator:a91cd56241914126e7f0a89c67bfac2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac796abcef7f5d6add4d98023a0bde62b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:ac796abcef7f5d6add4d98023a0bde62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab735e5526875ee755d72af6c8750bc05"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ab735e5526875ee755d72af6c8750bc05">synth_loglik</a> (SEXP, SEXP)</td></tr>
<tr class="separator:ab735e5526875ee755d72af6c8750bc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bcec7f4a5a240606fb8235312d5cc45"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45">iterate_map</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a1bcec7f4a5a240606fb8235312d5cc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9632871950917c7b954b1784b74ec78"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aa9632871950917c7b954b1784b74ec78">pomp_desolve_setup</a> (SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa9632871950917c7b954b1784b74ec78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9d4b991e534272c7dc4a6602be32ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a5c9d4b991e534272c7dc4a6602be32ec">pomp_vf_eval</a> (int *, double *, double *, double *, double *, int *)</td></tr>
<tr class="separator:a5c9d4b991e534272c7dc4a6602be32ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1f879a376bbbef32d6d8fde12078ed"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#abc1f879a376bbbef32d6d8fde12078ed">pomp_desolve_takedown</a> (void)</td></tr>
<tr class="separator:abc1f879a376bbbef32d6d8fde12078ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a3814da0f600c71a99fd3fe5ba215ca"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a5a3814da0f600c71a99fd3fe5ba215ca">LogitTransform</a> (SEXP)</td></tr>
<tr class="separator:a5a3814da0f600c71a99fd3fe5ba215ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc031bd56388c0dbb1b6e4aacb3971c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a6cc031bd56388c0dbb1b6e4aacb3971c">ExpitTransform</a> (SEXP)</td></tr>
<tr class="separator:a6cc031bd56388c0dbb1b6e4aacb3971c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adc7fa1db20bdddfae3611911961f6c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a9adc7fa1db20bdddfae3611911961f6c">LogBarycentricTransform</a> (SEXP)</td></tr>
<tr class="separator:a9adc7fa1db20bdddfae3611911961f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a534d4c8bcea55d9f5a6e7d8b34e55408"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a534d4c8bcea55d9f5a6e7d8b34e55408">InverseLogBarycentricTransform</a> (SEXP)</td></tr>
<tr class="separator:a534d4c8bcea55d9f5a6e7d8b34e55408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e269d1663ac1f67722366434b79ef6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#ac8e269d1663ac1f67722366434b79ef6">set_pomp_userdata</a> (SEXP)</td></tr>
<tr class="separator:ac8e269d1663ac1f67722366434b79ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f11ca97854cd188080da40020f738eb"><td class="memItemLeft" align="right" valign="top">const SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a0f11ca97854cd188080da40020f738eb">get_userdata</a> (const char *)</td></tr>
<tr class="separator:a0f11ca97854cd188080da40020f738eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeacd76a8b2af7c6428eea36b13f74b6"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#abeacd76a8b2af7c6428eea36b13f74b6">get_userdata_int</a> (const char *)</td></tr>
<tr class="separator:abeacd76a8b2af7c6428eea36b13f74b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa40ae6e425fd9dc49c29992629be0e2"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aaa40ae6e425fd9dc49c29992629be0e2">get_userdata_double</a> (const char *)</td></tr>
<tr class="separator:aaa40ae6e425fd9dc49c29992629be0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55c56601a4d47af6f8d162ff1aa9503"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#aa55c56601a4d47af6f8d162ff1aa9503">do_vmeasure</a> (SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:aa55c56601a4d47af6f8d162ff1aa9503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c47fabab25be7910ba58cc20426bf35"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decls_8h.html#a1c47fabab25be7910ba58cc20426bf35">wpfilter</a> (SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</td></tr>
<tr class="separator:a1c47fabab25be7910ba58cc20426bf35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="adab01a70b6ea0338ce91c04f773b54a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab01a70b6ea0338ce91c04f773b54a2">&#9670;&nbsp;</a></span>_gompertz_from_trans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_from_trans </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>__p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>__pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>__parindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00113">113</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a> = exp(<a class="code" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a> = exp(<a class="code" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = exp(<a class="code" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = exp(<a class="code" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a> = exp(<a class="code" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a216f42bf177ca87e5f7724df32173717"><div class="ttname"><a href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a></div><div class="ttdeci">#define X_0</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00095">gompertz.c:95</a></div></div>
<div class="ttc" id="agompertz_8c_html_a62969232668331297e2dca1ae2ddd10d"><div class="ttname"><a href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a></div><div class="ttdeci">#define r</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00091">gompertz.c:91</a></div></div>
<div class="ttc" id="agompertz_8c_html_a678ef311e74501d7b800f0b47500374a"><div class="ttname"><a href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a></div><div class="ttdeci">#define sigma</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00093">gompertz.c:93</a></div></div>
<div class="ttc" id="agompertz_8c_html_a757a8fce372da1cf6bf283ad0d551b5d"><div class="ttname"><a href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a></div><div class="ttdeci">#define T_sigma</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00098">gompertz.c:98</a></div></div>
<div class="ttc" id="agompertz_8c_html_a7d82cf2074afa4cfb2f3ccef3147b5f1"><div class="ttname"><a href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a></div><div class="ttdeci">#define T_tau</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00099">gompertz.c:99</a></div></div>
<div class="ttc" id="agompertz_8c_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00092">gompertz.c:92</a></div></div>
<div class="ttc" id="agompertz_8c_html_aa7082577997805000f8e8b56846642cd"><div class="ttname"><a href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a></div><div class="ttdeci">#define tau</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00094">gompertz.c:94</a></div></div>
<div class="ttc" id="agompertz_8c_html_ab4d3d6d4c67ada71eec73c01852981f0"><div class="ttname"><a href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a></div><div class="ttdeci">#define T_K</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00097">gompertz.c:97</a></div></div>
<div class="ttc" id="agompertz_8c_html_ad5a2597d3f99cc31bb9bf4e0471f3a37"><div class="ttname"><a href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a></div><div class="ttdeci">#define T_r</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00096">gompertz.c:96</a></div></div>
<div class="ttc" id="agompertz_8c_html_ae51e7437f94eebfb3a19f094cdc7fe0d"><div class="ttname"><a href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a></div><div class="ttdeci">#define T_X_0</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00100">gompertz.c:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dc4318ebe71bfe439dc5c6816aec9e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc4318ebe71bfe439dc5c6816aec9e9">&#9670;&nbsp;</a></span>_gompertz_normal_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lik</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>give_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00020">20</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  *lik = dlnorm(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,log(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>,give_log);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a207fd5507206d307cd63f95374fcd00d"><div class="ttname"><a href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a></div><div class="ttdeci">#define X</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00014">gompertz.c:14</a></div></div>
<div class="ttc" id="agompertz_8c_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00011">gompertz.c:11</a></div></div>
<div class="ttc" id="agompertz_8c_html_a798e4073d613ca5ba9618e1b3253df14"><div class="ttname"><a href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a></div><div class="ttdeci">#define Y</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00013">gompertz.c:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad181675b4773a3f401bedc49de88b54c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad181675b4773a3f401bedc49de88b54c">&#9670;&nbsp;</a></span>_gompertz_normal_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00040">40</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*exp(<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>/2);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a423a96c51fa2ea8a6406113803acbbc1"><div class="ttname"><a href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a></div><div class="ttdeci">#define EY</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00016">gompertz.c:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a7b791e4e3d33b6ac0b5dd04425c9be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a7b791e4e3d33b6ac0b5dd04425c9be">&#9670;&nbsp;</a></span>_gompertz_normal_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00030">30</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = rlnorm(log(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6fd08b625a00245a898d5375b90a725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6fd08b625a00245a898d5375b90a725">&#9670;&nbsp;</a></span>_gompertz_normal_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>vmatindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00050">50</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                          {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">double</span> et = exp(<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a> = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*et*(et-1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a99670a9dfb3b867756c0a48bfad3c4da"><div class="ttname"><a href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a></div><div class="ttdeci">#define VY</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00017">gompertz.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0665a1991b34b2d1c9c85db01ed034b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0665a1991b34b2d1c9c85db01ed034b">&#9670;&nbsp;</a></span>_gompertz_skeleton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_skeleton </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00070">70</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">double</span> S = exp(-<a class="code" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a> = R_pow(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S); <span class="comment">// X is not over-written in the skeleton function</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a3e727802b38f4a8209fdde8333e080bb"><div class="ttname"><a href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a></div><div class="ttdeci">#define XPRIME</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00015">gompertz.c:15</a></div></div>
<div class="ttc" id="agompertz_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00008">gompertz.c:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cf2fd72947e8ff6f76c2a8d70e649d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf2fd72947e8ff6f76c2a8d70e649d3">&#9670;&nbsp;</a></span>_gompertz_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_step </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00058">58</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> S = exp(-<a class="code" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">double</span> eps = (<a class="code" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a> &gt; 0.0) ? exp(rnorm(0,<a class="code" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a>)) : 1.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = R_pow(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S)*eps; <span class="comment">// note X is over-written by this line</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_ab899f53048f1f06a224b5eb1fa369750"><div class="ttname"><a href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a></div><div class="ttdeci">#define SIGMA</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00010">gompertz.c:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a825a990c0794920e7661efabe955a9e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a825a990c0794920e7661efabe955a9e1">&#9670;&nbsp;</a></span>_gompertz_to_trans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_to_trans </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>__pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>__p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>__parindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00102">102</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a> = log(<a class="code" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a> = log(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a> = log(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a> = log(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a> = log(<a class="code" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af750b0a42d4a28fc0fd251947a27d385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af750b0a42d4a28fc0fd251947a27d385">&#9670;&nbsp;</a></span>_ou2_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lik</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>give_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00106">106</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> f = 0.0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  f += (ISNA(<a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>)) ? 0.0 : dnorm(<a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>,x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd,1);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  f += (ISNA(<a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>)) ? 0.0 : dnorm(<a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>,x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd,1);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  *lik = (give_log) ? f : exp(f);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a1964818ccd90a6173ea48cecb652feeb"><div class="ttname"><a href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a></div><div class="ttdeci">#define X1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00059">ou2.c:59</a></div></div>
<div class="ttc" id="aou2_8c_html_a294189cdea31dda8faf609b9b3e2000a"><div class="ttname"><a href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a></div><div class="ttdeci">#define Y1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00062">ou2.c:62</a></div></div>
<div class="ttc" id="aou2_8c_html_a3128cc29e366777d66d8b049451ca8a0"><div class="ttname"><a href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a></div><div class="ttdeci">#define Y2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00063">ou2.c:63</a></div></div>
<div class="ttc" id="aou2_8c_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00057">ou2.c:57</a></div></div>
<div class="ttc" id="aou2_8c_html_a79ae03a0214cb30e57b9e8835f2a0019"><div class="ttname"><a href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a></div><div class="ttdeci">#define X2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00060">ou2.c:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5e80084cfe8b5c5c76de464571a95c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e80084cfe8b5c5c76de464571a95c4">&#9670;&nbsp;</a></span>_ou2_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00132">132</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a499e2ed0106272324438f9c988015671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499e2ed0106272324438f9c988015671">&#9670;&nbsp;</a></span>_ou2_pdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_pdf </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00082">82</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (t2-t1 != 1)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ou2_pdf error: transitions must be consecutive&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  f[0] = <a class="code" href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a">dens_ou2</a>(x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],z[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],z[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                  <a class="code" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>,1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a3f470cf546586fe861be7be3c24557bc"><div class="ttname"><a href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a></div><div class="ttdeci">#define SIGMA3</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00056">ou2.c:56</a></div></div>
<div class="ttc" id="aou2_8c_html_a6e6cd685f94be3c0552ee4cb3e0881ff"><div class="ttname"><a href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a></div><div class="ttdeci">#define ALPHA2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00051">ou2.c:51</a></div></div>
<div class="ttc" id="aou2_8c_html_a8c409ae997e2b81c3b15dd2f40f78a8a"><div class="ttname"><a href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a">dens_ou2</a></div><div class="ttdeci">static double dens_ou2(double x1, double x2, double z1, double z2, double alpha1, double alpha2, double alpha3, double alpha4, double sigma1, double sigma2, double sigma3, int give_log)</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00029">ou2.c:30</a></div></div>
<div class="ttc" id="aou2_8c_html_ab2ee134520af69f566c53e1653198f29"><div class="ttname"><a href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a></div><div class="ttdeci">#define SIGMA1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00054">ou2.c:54</a></div></div>
<div class="ttc" id="aou2_8c_html_ae5afe6a4069844a8988fffedaa523856"><div class="ttname"><a href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a></div><div class="ttdeci">#define SIGMA2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00055">ou2.c:55</a></div></div>
<div class="ttc" id="aou2_8c_html_aef2261269821a4680fe2d8389edb6af1"><div class="ttname"><a href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a></div><div class="ttdeci">#define ALPHA3</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00052">ou2.c:52</a></div></div>
<div class="ttc" id="aou2_8c_html_af8e4e3fc5b56a3cf8340fd6534c71e00"><div class="ttname"><a href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a></div><div class="ttdeci">#define ALPHA4</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00053">ou2.c:53</a></div></div>
<div class="ttc" id="aou2_8c_html_afec7121cee3ac42de7f64aefd50c66cf"><div class="ttname"><a href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a></div><div class="ttdeci">#define ALPHA1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00050">ou2.c:50</a></div></div>
<div class="ttc" id="apomp_8h_html_ad25a1c617278c25cbcbb9b9a3a6b8024"><div class="ttname"><a href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a></div><div class="ttdeci">#define err(...)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00021">pomp.h:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a499e2ed0106272324438f9c988015671_cgraph.png" border="0" usemap="#adecls_8h_a499e2ed0106272324438f9c988015671_cgraph" alt=""/></div>
<map name="adecls_8h_a499e2ed0106272324438f9c988015671_cgraph" id="adecls_8h_a499e2ed0106272324438f9c988015671_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,87,32"/>
<area shape="rect" href="ou2_8c.html#a8c409ae997e2b81c3b15dd2f40f78a8a" title=" " alt="" coords="135,5,219,32"/>
</map>
</div>

</div>
</div>
<a id="a9b56b325d719e42ac66e1367b4f72f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b56b325d719e42ac66e1367b4f72f8e">&#9670;&nbsp;</a></span>_ou2_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00120">120</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = rnorm(x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = rnorm(x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acaef81a8193fa69cf2c0589f8ac56187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaef81a8193fa69cf2c0589f8ac56187">&#9670;&nbsp;</a></span>_ou2_skel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_skel </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00095">95</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  f[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>] = <a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>*x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>*x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  f[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>] = <a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>*x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>*x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8eb8fb617fb1a4584e553f08810105f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb8fb617fb1a4584e553f08810105f9">&#9670;&nbsp;</a></span>_ou2_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_step </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00071">71</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd">sim_ou2</a>(&amp;x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],&amp;x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,<a class="code" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a202fca38e8cd5e9f0a9e0c33921b01cd"><div class="ttname"><a href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd">sim_ou2</a></div><div class="ttdeci">static void sim_ou2(double *x1, double *x2, double alpha1, double alpha2, double alpha3, double alpha4, double sigma1, double sigma2, double sigma3)</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00009">ou2.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph.png" border="0" usemap="#adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph" alt=""/></div>
<map name="adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph" id="adecls_8h_a8eb8fb617fb1a4584e553f08810105f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,93,32"/>
<area shape="rect" href="ou2_8c.html#a202fca38e8cd5e9f0a9e0c33921b01cd" title=" " alt="" coords="141,5,219,32"/>
</map>
</div>

</div>
</div>
<a id="adc8e43ec5af20eb48754c1014606057a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8e43ec5af20eb48754c1014606057a">&#9670;&nbsp;</a></span>_ou2_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>vmatindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00143">143</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a> = <a class="code" href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a> = sd*sd;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a> = <a class="code" href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a> = 0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a30a3d62562a3da42fdc0697719aad10f"><div class="ttname"><a href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a></div><div class="ttdeci">#define V12</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00067">ou2.c:67</a></div></div>
<div class="ttc" id="aou2_8c_html_a5bab15beab8e28bbd9f89c19407c7397"><div class="ttname"><a href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a></div><div class="ttdeci">#define V21</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00066">ou2.c:66</a></div></div>
<div class="ttc" id="aou2_8c_html_a767d301ad391daed2e4bab0288565f7d"><div class="ttname"><a href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a></div><div class="ttdeci">#define V22</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00068">ou2.c:68</a></div></div>
<div class="ttc" id="aou2_8c_html_a87942002cab74af29b13ec07a3b27edf"><div class="ttname"><a href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a></div><div class="ttdeci">#define V11</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00065">ou2.c:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9390ea094fe7c28762eb6ac23f1c144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9390ea094fe7c28762eb6ac23f1c144">&#9670;&nbsp;</a></span>add_skel_args()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP add_skel_args </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Pnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Cnames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00010">10</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  SEXP var;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">int</span> v;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="comment">// Covariates</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(Cnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Cnames,v)));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">// Parameters</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(Pnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Pnames,v)));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// Latent state variables</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,v)));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// Time</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,install(<span class="stringliteral">&quot;t&quot;</span>));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a2e65cd991bb60dd57098ab40b91ac722"><div class="ttname"><a href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a></div><div class="ttdeci">SEXP Snames</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00140">trajectory.c:140</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a94fe754831aa7e8eeb4053fa11b537cd"><div class="ttname"><a href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a></div><div class="ttdeci">SEXP args</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00139">trajectory.c:139</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph.png" border="0" usemap="#adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph" alt=""/></div>
<map name="adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph" id="adecls_8h_ad9390ea094fe7c28762eb6ac23f1c144_icgraph">
<area shape="rect" title=" " alt="" coords="213,56,328,83"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="35,5,135,32"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="35,56,136,83"/>
<area shape="rect" href="decls_8h.html#aa9632871950917c7b954b1784b74ec78" title=" " alt="" coords="5,107,165,133"/>
</map>
</div>

</div>
</div>
<a id="a91f31f12db7a1e75775f01eb11ead99d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f31f12db7a1e75775f01eb11ead99d">&#9670;&nbsp;</a></span>apply_probe_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_data </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>probes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00004">4</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                                                 {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  SEXP retval, data, vals;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <span class="keywordtype">int</span> nprobe;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  nprobe = LENGTH(probes);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  PROTECT(data = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  PROTECT(vals = NEW_LIST(nprobe));</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SET_NAMES(vals,GET_NAMES(probes));</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nprobe; i++) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    SET_ELEMENT(vals,i,eval(PROTECT(lang2(VECTOR_ELT(probes,i),data)),</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                            CLOENV(VECTOR_ELT(probes,i))));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordflow">if</span> (!IS_NUMERIC(VECTOR_ELT(vals,i))) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %d returns a non-numeric result&quot;</span>,i+1);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    }</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(vals = VectorToPairList(vals));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(retval = eval(PROTECT(LCONS(install(<span class="stringliteral">&quot;c&quot;</span>),vals)),R_BaseEnv));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph.png" border="0" usemap="#adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph" alt=""/></div>
<map name="adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph" id="adecls_8h_a91f31f12db7a1e75775f01eb11ead99d_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,295,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a34c714747e1b49d142af4d58fee24446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34c714747e1b49d142af4d58fee24446">&#9670;&nbsp;</a></span>apply_probe_sim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_sim </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>probes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>datval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00029">29</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                                           {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP x, y, names, sims;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  SEXP returntype, retval, val, valnames;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> nprobe, nsims, nobs, ntimes, nvals;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">double</span> *xp, *yp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> p, s, i, j, k, len0 = 0, len = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  PROTECT(nsim = AS_INTEGER(nsim));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> ((LENGTH(nsim)!=1) || (INTEGER(nsim)[0]&lt;=0))</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a positive integer.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// &#39;names&#39; holds the names of the probe values</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// we get these from a previous call to &#39;apply_probe_data&#39;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  nprobe = LENGTH(probes);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  nvals = LENGTH(datval);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  PROTECT(names = GET_NAMES(datval));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(returntype = NEW_INTEGER(1));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  *(INTEGER(returntype)) = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  PROTECT(sims = <a class="code" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a>(<span class="keywordtype">object</span>,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,nsim,returntype,gnsi));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  PROTECT(y = VECTOR_ELT(sims,1));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  *(INTEGER(gnsi)) = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  nobs = INTEGER(GET_DIM(y))[0];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  nsims = INTEGER(GET_DIM(y))[1];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  ntimes = INTEGER(GET_DIM(y))[2];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// set up temporary storage</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  xdim[0] = nobs; xdim[1] = ntimes;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// set up matrix to hold results</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  xdim[0] = nsims; xdim[1] = nvals;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(retval = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(valnames = NEW_LIST(2));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  SET_ELEMENT(valnames,1,names);        <span class="comment">// set column names</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  SET_DIMNAMES(retval,valnames);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">for</span> (p = 0, k = 0; p &lt; nprobe; p++, k += len) { <span class="comment">// loop over probes</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (s = 0; s &lt; nsims; s++) { <span class="comment">// loop over simulations</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">// copy the data from y[,s,] to x[,]</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      xp = REAL(x);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      yp = REAL(y)+nobs*s;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; ntimes; j++, yp += nobs*nsims) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, xp++) *xp = yp[i];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="comment">// evaluate the probe on the simulated data</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      PROTECT(val = eval(PROTECT(lang2(VECTOR_ELT(probes,p),x)),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                         CLOENV(VECTOR_ELT(probes,p))));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span> (!IS_NUMERIC(val)) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %d returns a non-numeric result.&quot;</span>,p+1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      len = LENGTH(val);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span> (s == 0)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        len0 = len;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len != len0) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;variable-sized results returned by probe %d.&quot;</span>,p+1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> (k+len &gt; nvals)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      xp = REAL(retval); yp = REAL(val);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) xp[s+nsims*(i+k)] = yp[i];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      UNPROTECT(2);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (k != nvals)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  UNPROTECT(9);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_aa9d3b94c1a9a99e0db90e251f670e853"><div class="ttname"><a href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853">do_simulate</a></div><div class="ttdeci">SEXP do_simulate(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="simulate_8c_source.html#l00006">simulate.c:6</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a26453e4cfff7ec27ff31d617583dcae4"><div class="ttname"><a href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a></div><div class="ttdeci">static R_INLINE void setrownames(SEXP x, SEXP names, int rank)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00110">pomp_defines.h:110</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a8ab2bdfb97326c698544007bd60c1a49"><div class="ttname"><a href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a></div><div class="ttdeci">static R_INLINE SEXP makearray(int rank, const int *dim)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00040">pomp_defines.h:40</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a58d967e1449ba00d87d2f6d70b50d525"><div class="ttname"><a href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a></div><div class="ttdeci">SEXP params</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00128">trajectory.c:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34c714747e1b49d142af4d58fee24446_cgraph.png" border="0" usemap="#adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph" alt=""/></div>
<map name="adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph" id="adecls_8h_a34c714747e1b49d142af4d58fee24446_cgraph">
<area shape="rect" title=" " alt="" coords="5,552,139,579"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="187,552,289,579"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="922,273,1033,300"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="931,805,1023,832"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="733,147,820,173"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="355,1236,425,1263"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="510,552,617,579"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="340,628,440,655"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="337,349,443,376"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="523,1160,604,1187"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="523,1211,603,1237"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="695,1109,858,1136"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1240,1692,1357,1719"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="693,1160,860,1187"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="530,1464,597,1491"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="491,1261,636,1288"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="736,1211,817,1237"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="705,1363,848,1389"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="924,1337,1031,1364"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="924,1211,1031,1237"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="923,653,1031,680"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="917,1388,1037,1415"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="926,1515,1029,1541"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="1085,1667,1192,1693"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,400,817,427"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="717,299,836,325"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="737,349,817,376"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="736,552,817,579"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="501,1413,625,1440"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="689,603,864,629"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="505,957,622,984"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,1464,817,1491"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="737,1515,817,1541"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="710,1565,843,1592"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="712,1413,841,1440"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="736,704,817,731"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="684,1008,869,1035"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="736,957,817,984"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="753,1312,801,1339"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="939,1287,1016,1313"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a34c714747e1b49d142af4d58fee24446_icgraph.png" border="0" usemap="#adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph" alt=""/></div>
<map name="adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph" id="adecls_8h_a34c714747e1b49d142af4d58fee24446_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a41860ab8f0d4fb23e3ce010e6ad2ff2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41860ab8f0d4fb23e3ce010e6ad2ff2f">&#9670;&nbsp;</a></span>bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00051">51</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                              {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  SEXP y, xr;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> nk = nb+deg+1;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span> dx, minx, maxx;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> *knots = NULL;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">double</span> *xdata, *ydata;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (deg &lt; 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (nb &lt;= deg) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; degree&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (d &lt; 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  knots = (<span class="keywordtype">double</span> *) R_Calloc(nk,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  xdata = REAL(xr);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  ydata = REAL(y);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  minx = REAL(range)[0];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  maxx = REAL(range)[1];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">if</span> (minx &gt;= maxx) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;improper range &#39;rg&#39;&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  dx = (maxx-minx)/((<span class="keywordtype">double</span>) (nb-deg));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  knots[0] = minx-deg*dx;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">for</span> (i = 1; i &lt; nk; i++) knots[i] = knots[i-1]+dx;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nb; i++) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(ydata,xdata,nx,i,deg,d,&amp;knots[0]);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    ydata += nx;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  R_Free(knots);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">return</span>(y);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_a2237300eb36fec7026017251da56382e"><div class="ttname"><a href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a></div><div class="ttdeci">static void bspline_eval(double *y, const double *x, int nx, int i, int degree, int deriv, const double *knots)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00009">bspline.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph.png" border="0" usemap="#adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph" alt=""/></div>
<map name="adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph" id="adecls_8h_a41860ab8f0d4fb23e3ce010e6ad2ff2f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="164,5,268,32"/>
</map>
</div>

</div>
</div>
<a id="ab24fa1bb0f03a3d3443051e82d0246b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab24fa1bb0f03a3d3443051e82d0246b8">&#9670;&nbsp;</a></span>bspline_basis_eval_deriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bspline_basis_eval_deriv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>knots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00115">115</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                                                 {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbasis; i++) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(&amp;y[i],&amp;x,1,i,degree,deriv,knots);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph.png" border="0" usemap="#adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph" alt=""/></div>
<map name="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph" id="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,47"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="199,13,303,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph.png" border="0" usemap="#adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph" alt=""/></div>
<map name="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph" id="adecls_8h_ab24fa1bb0f03a3d3443051e82d0246b8_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,301,47"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,13,108,39"/>
</map>
</div>

</div>
</div>
<a id="a7eb19c7180d18dc9f384cea477ee1a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb19c7180d18dc9f384cea477ee1a83">&#9670;&nbsp;</a></span>D_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00121">121</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                                                      {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">int</span> k, n, nx, ns, np, nt;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> *F, *<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  SEXP f;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  PROTECT(x = AS_NUMERIC(x)); nx = LENGTH(x); <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(x);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  PROTECT(log = AS_INTEGER(log));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  n = (nx &gt; ns) ? nx : ns;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  n = (n &gt; np) ? n : np;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  n = (n &gt; nt) ? n : nt;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(f = NEW_NUMERIC(n)); F = REAL(f);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    F[k] = <a class="code" href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d">dbetabinom</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k%nx],S[k%ns],P[k%np],T[k%nt],INTEGER(log)[0]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a6c490604aea6eace860456a7a4dc5a8d"><div class="ttname"><a href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d">dbetabinom</a></div><div class="ttdeci">static R_INLINE double dbetabinom(double x, double size, double prob, double theta, int give_log)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00292">pomp.h:293</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph.png" border="0" usemap="#adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph" alt=""/></div>
<map name="adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph" id="adecls_8h_a7eb19c7180d18dc9f384cea477ee1a83_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="pomp_8h.html#a6c490604aea6eace860456a7a4dc5a8d" title=" " alt="" coords="164,5,264,32"/>
</map>
</div>

</div>
</div>
<a id="aa7cf2dcaaa5333231ed19998fd9dfde6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7cf2dcaaa5333231ed19998fd9dfde6">&#9670;&nbsp;</a></span>D_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00049">49</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                                            {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> *dim, n;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  SEXP f;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (dim[0] != ntrans)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;NROW(&#39;x&#39;) should match length of &#39;rate&#39;&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  n = dim[1];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(f = NEW_NUMERIC(n));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  PROTECT(size = AS_NUMERIC(size));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  PROTECT(rate = AS_NUMERIC(rate));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(log = AS_LOGICAL(log));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5">deulermultinom_multi</a>(ntrans,n,REAL(size),REAL(rate),REAL(deltat),REAL(x),INTEGER(log),REAL(f));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="ttc" id="adistributions_8c_html_a7f6bc8c3509b09313972b4ccd73c00c5"><div class="ttname"><a href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5">deulermultinom_multi</a></div><div class="ttdeci">static void deulermultinom_multi(int m, int n, double *size, double *rate, double *deltat, double *trans, int *give_log, double *f)</div><div class="ttdef"><b>Definition:</b> <a href="distributions_8c_source.html#l00015">distributions.c:15</a></div></div>
<div class="ttc" id="apomp_8h_html_a8224a361dddd2ad59b411982e5ea746f"><div class="ttname"><a href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a></div><div class="ttdeci">#define warn(...)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00022">pomp.h:22</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph.png" border="0" usemap="#adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph" alt=""/></div>
<map name="adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph" id="adecls_8h_aa7cf2dcaaa5333231ed19998fd9dfde6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,147,32"/>
<area shape="rect" href="distributions_8c.html#a7f6bc8c3509b09313972b4ccd73c00c5" title=" " alt="" coords="195,5,361,32"/>
<area shape="rect" href="pomp_8h.html#a0ed4cc2bf09ba401406d3175da73226c" title=" " alt="" coords="409,5,536,32"/>
</map>
</div>

</div>
</div>
<a id="a6b4fa54c658fe6c6677c51e8346d728c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b4fa54c658fe6c6677c51e8346d728c">&#9670;&nbsp;</a></span>do_dinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dinit </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dinit_8c_source.html#l00220">220</a> of file <a class="el" href="dinit_8c_source.html">dinit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  SEXP F, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, covar;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  PROTECT(t0=AS_NUMERIC(t0));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(x));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// extract the process function</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dinit&quot;</span>)));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// extract other arguments</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// evaluate the density</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  PROTECT(F = <a class="code" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9">init_density</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,x,t0,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,covar,log,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  UNPROTECT(7);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="ttc" id="adinit_8c_html_aaf4b691dc5d079394332aedad44ea9c9"><div class="ttname"><a href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9">init_density</a></div><div class="ttdeci">static SEXP init_density(SEXP func, SEXP X, SEXP t0, SEXP params, SEXP covar, SEXP log, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="dinit_8c_source.html#l00097">dinit.c:98</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_ad396407a99088c710b270a9c1dc3aa9d"><div class="ttname"><a href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a></div><div class="ttdeci">static R_INLINE SEXP as_matrix(SEXP x)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00145">pomp_defines.h:145</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae1150d665d648766c28508b57a8cb644"><div class="ttname"><a href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a></div><div class="ttdeci">SEXP fn</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00138">trajectory.c:138</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph.png" border="0" usemap="#adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph" alt=""/></div>
<map name="adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph" id="adecls_8h_a6b4fa54c658fe6c6677c51e8346d728c_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,80,184"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="134,69,221,96"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="128,183,227,209"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="303,5,413,32"/>
<area shape="rect" href="dinit_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="317,56,399,83"/>
<area shape="rect" href="dinit_8c.html#ac5823a47b6e0715358465cf3df99ca1e" title=" " alt="" coords="318,107,398,133"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="277,157,439,184"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="275,208,441,235"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="287,259,429,285"/>
<area shape="rect" href="dinit_8c.html#ab9898e68b5f39ca1a0289d0cb11ed576" title=" " alt="" coords="317,309,399,336"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="305,360,411,387"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="489,208,609,235"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="498,259,601,285"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="657,259,764,285"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="812,259,929,285"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="495,309,603,336"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="503,360,595,387"/>
</map>
</div>

</div>
</div>
<a id="a983ad52a265f059c6e25be89cdf97fd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983ad52a265f059c6e25be89cdf97fd7">&#9670;&nbsp;</a></span>do_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dmeasure_8c_source.html#l00111">111</a> of file <a class="el" href="dmeasure_8c_source.html">dmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp, nobs;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP cvec, pompfun;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ans;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  SEXP F;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  PROTECT(y = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(y));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  dim = INTEGER(GET_DIM(y));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  nobs = dim[0];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[1])</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 2nd dimension of &#39;y&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(y)));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dmeasure&quot;</span>)));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// create array to store results</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  PROTECT(F = <a class="code" href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763">ret_array</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">int</span> nprotect = 13;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">double</span> *ys = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// build argument list</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Onames,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames,log)); nprotect++;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, ys += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">// evaluate the call</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        PROTECT(</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                ans = <a class="code" href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c">eval_call</a>(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                time,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                ys,nobs,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                )</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span> (k == 0 &amp;&amp; j == 0 &amp;&amp; LENGTH(ans) != 1)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;dmeasure&#39; returns a vector of length %d when it should return a scalar.&quot;</span>,LENGTH(ans));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        *ft = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> give_log;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="pomp_8h.html#a512b62346ff39e290130b66f0498805a">pomp_dmeasure</a> *ff = NULL;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">double</span> *yp = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// extract state, parameter, covariate, observable indices</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, yp += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        (*ff)(ft,yp,xp,pp,give_log,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        *ft = R_NaReal;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;dmeasure&#39; unspecified: likelihood undefined.&quot;</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a8fc25ac8149dbd6da367aa01dd9ad9ed"><div class="ttname"><a href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a></div><div class="ttdeci">lookup_table_t make_covariate_table(SEXP, int *)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00011">lookup_table.c:11</a></div></div>
<div class="ttc" id="adecls_8h_html_ada19523cc1edc44a799fce734f25c934"><div class="ttname"><a href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a></div><div class="ttdeci">SEXP pomp_fun_handler(SEXP, SEXP, pompfunmode *, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00030">pomp_fun.c:30</a></div></div>
<div class="ttc" id="adecls_8h_html_ade6439566617e54cb9f4507f7ad2824f"><div class="ttname"><a href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a></div><div class="ttdeci">void table_lookup(lookup_table_t *, double, double *)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00053">lookup_table.c:53</a></div></div>
<div class="ttc" id="adecls_8h_html_ae6345040eb63a38c0ff7ae42f3ea35ff"><div class="ttname"><a href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a></div><div class="ttdeci">SEXP get_covariate_names(SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00007">lookup_table.c:7</a></div></div>
<div class="ttc" id="admeasure_8c_html_a7ef96aa5550bad09e38528b3b9b91b3b"><div class="ttname"><a href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Onames, SEXP Snames, SEXP Pnames, SEXP Cnames, SEXP log)</div><div class="ttdef"><b>Definition:</b> <a href="dmeasure_8c_source.html#l00010">dmeasure.c:11</a></div></div>
<div class="ttc" id="admeasure_8c_html_a9a858c8c108cd54973666dd765f8718c"><div class="ttname"><a href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *y, int nobs, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="dmeasure_8c_source.html#l00075">dmeasure.c:75</a></div></div>
<div class="ttc" id="admeasure_8c_html_af4fb5592481eef6dc2aaf6f158871763"><div class="ttname"><a href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nreps, int ntimes)</div><div class="ttdef"><b>Definition:</b> <a href="dmeasure_8c_source.html#l00101">dmeasure.c:101</a></div></div>
<div class="ttc" id="apomp_8h_html_a512b62346ff39e290130b66f0498805a"><div class="ttname"><a href="pomp_8h.html#a512b62346ff39e290130b66f0498805a">pomp_dmeasure</a></div><div class="ttdeci">void pomp_dmeasure(double *lik, const double *y, const double *x, const double *p, int give_log, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00085">pomp.h:86</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a8b775a55898690bdc11c348d0b5dc8c1"><div class="ttname"><a href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a></div><div class="ttdeci">static R_INLINE SEXP as_state_array(SEXP x)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00183">pomp_defines.h:183</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a></div><div class="ttdeci">pompfunmode</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a></div><div class="ttdeci">@ Rfun</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a></div><div class="ttdeci">@ native</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a></div><div class="ttdeci">@ undef</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a></div><div class="ttdeci">@ regNative</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="astructlookup__table__t_html"><div class="ttname"><a href="structlookup__table__t.html">lookup_table_t</a></div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00020">pomp_defines.h:20</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a14099a72d03b2c4a17df78083aaefedb"><div class="ttname"><a href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a></div><div class="ttdeci">int npars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00132">trajectory.c:132</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a4edeebb04b42d65deaf721d0abbc091e"><div class="ttname"><a href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div><div class="ttdeci">int ncovars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00133">trajectory.c:133</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a6c1c1c275092d79f830aa36620cfd33d"><div class="ttname"><a href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a></div><div class="ttdeci">pompfunmode mode</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00126">trajectory.c:126</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a72f66d373d52ab42fd8af134bd7f9cda"><div class="ttname"><a href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div><div class="ttdeci">int nreps</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00134">trajectory.c:134</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac0e9686ed371713a6e6717115c66f602"><div class="ttname"><a href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a></div><div class="ttdeci">SEXP cov</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00129">trajectory.c:129</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00131">trajectory.c:131</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph.png" border="0" usemap="#adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph" alt=""/></div>
<map name="adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph" id="adecls_8h_a983ad52a265f059c6e25be89cdf97fd7_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,116,235"/>
<area shape="rect" href="dmeasure_8c.html#a7ef96aa5550bad09e38528b3b9b91b3b" title=" " alt="" coords="207,5,288,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,56,291,83"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,107,307,133"/>
<area shape="rect" href="dmeasure_8c.html#a9a858c8c108cd54973666dd765f8718c" title=" " alt="" coords="207,157,287,184"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="166,208,329,235"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="164,259,331,285"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="176,309,319,336"/>
<area shape="rect" href="dmeasure_8c.html#af4fb5592481eef6dc2aaf6f158871763" title=" " alt="" coords="207,360,288,387"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="194,411,301,437"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,81,494,108"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,259,499,285"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,309,490,336"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,309,653,336"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,309,819,336"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,360,493,387"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,411,485,437"/>
</map>
</div>

</div>
</div>
<a id="a2d3d47b7ef5f3a691582c1000108cdb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d3d47b7ef5f3a691582c1000108cdb7">&#9670;&nbsp;</a></span>do_dprior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprior </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprior_8c_source.html#l00051">51</a> of file <a class="el" href="dprior_8c_source.html">dprior.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  SEXP Pnames, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprior&quot;</span>)));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// to store results</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  PROTECT(F = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> nprotect = 6;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169">add_args</a>(Pnames,log,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>)); nprotect++;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(F); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      PROTECT(ans = <a class="code" href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      *pt = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">int</span> give_log, *pidx = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a> *ff = NULL;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// construct state, parameter, covariate, observable indices</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    R_CheckUserInterrupt();     <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (j = 0, pt = REAL(F), ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      (*ff)(pt,ps,give_log,pidx);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> give_log, j;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">double</span> *pt;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (j = 0, pt = REAL(F); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pt++)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      *pt = (give_log) ? 0.0 : 1.0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="ttc" id="adprior_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition:</b> <a href="dprior_8c_source.html#l00034">dprior.c:34</a></div></div>
<div class="ttc" id="adprior_8c_html_a2136fa17c5e1e54de6d6a4e5fe62f169"><div class="ttname"><a href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP names, SEXP log, SEXP args)</div><div class="ttdef"><b>Definition:</b> <a href="dprior_8c_source.html#l00010">dprior.c:10</a></div></div>
<div class="ttc" id="apomp_8h_html_a3faa3c7fe8f69a8f03b0cf34bb6d66b6"><div class="ttname"><a href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a></div><div class="ttdeci">void pomp_dprior(double *lik, const double *p, int give_log, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00110">pomp.h:111</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph.png" border="0" usemap="#adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph" alt=""/></div>
<map name="adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph" id="adecls_8h_a2d3d47b7ef5f3a691582c1000108cdb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,88,108"/>
<area shape="rect" href="dprior_8c.html#a2136fa17c5e1e54de6d6a4e5fe62f169" title=" " alt="" coords="167,5,248,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="164,56,251,83"/>
<area shape="rect" href="dprior_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="167,107,247,133"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="136,157,279,184"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="331,56,442,83"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="327,132,447,159"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="335,183,438,209"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="495,183,601,209"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="649,183,767,209"/>
</map>
</div>

</div>
</div>
<a id="a6ef1a476d6745db7455441c65c74fd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef1a476d6745db7455441c65c74fd61">&#9670;&nbsp;</a></span>do_dprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprocess_8c_source.html#l00273">273</a> of file <a class="el" href="dprocess_8c_source.html">dprocess.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, covar;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  PROTECT(times=AS_NUMERIC(times));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// extract the process function</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprocess&quot;</span>)));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// extract other arguments</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// evaluate the density</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611">onestep_density</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,x,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,covar,log,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  UNPROTECT(7);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="adprocess_8c_html_af743054a6e56b1e76d6ee59866b22611"><div class="ttname"><a href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611">onestep_density</a></div><div class="ttdeci">static SEXP onestep_density(SEXP func, SEXP x, SEXP times, SEXP params, SEXP covar, SEXP log, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="dprocess_8c_source.html#l00127">dprocess.c:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph.png" border="0" usemap="#adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph" alt=""/></div>
<map name="adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph" id="adecls_8h_a6ef1a476d6745db7455441c65c74fd61_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,108,83"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="177,5,264,32"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="161,56,280,83"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="156,183,285,209"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="361,5,472,32"/>
<area shape="rect" href="dprocess_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="376,56,457,83"/>
<area shape="rect" href="dprocess_8c.html#a7853b2436f140d9aa7ca0bac61dc21c6" title=" " alt="" coords="377,107,457,133"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="335,157,498,184"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="333,208,500,235"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="345,259,488,285"/>
<area shape="rect" href="dprocess_8c.html#af4fb5592481eef6dc2aaf6f158871763" title=" " alt="" coords="376,309,457,336"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="363,360,470,387"/>
<area shape="rect" href="dprocess_8c.html#a7113f106ccbbafb6a71989d6f6e9811d" title=" " alt="" coords="575,56,641,83"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="548,208,668,235"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="557,259,659,285"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="716,259,823,285"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="871,259,988,285"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="554,309,662,336"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="562,360,654,387"/>
</map>
</div>

</div>
</div>
<a id="ac1ec1439680776719b9b8b9ebdbf9a33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1ec1439680776719b9b8b9ebdbf9a33">&#9670;&nbsp;</a></span>do_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_emeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emeasure_8c_source.html#l00098">98</a> of file <a class="el" href="emeasure_8c_source.html">emeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;emeasure&quot;</span>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                  ans = <a class="code" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                  time,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                  )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          nobs = LENGTH(ans);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          nprotect += 3;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          first = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                  ans = <a class="code" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                  time,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                  )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  );</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="pomp_8h.html#a3f0c4a869b9b0e27422e503eaf380bd5">pomp_emeasure</a> *ff = NULL;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,dim)); nprotect++;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div>
<div class="ttc" id="aemeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="emeasure_8c_source.html#l00060">emeasure.c:60</a></div></div>
<div class="ttc" id="aemeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="emeasure_8c_source.html#l00010">emeasure.c:10</a></div></div>
<div class="ttc" id="aemeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="emeasure_8c_source.html#l00084">emeasure.c:84</a></div></div>
<div class="ttc" id="apomp_8h_html_a3f0c4a869b9b0e27422e503eaf380bd5"><div class="ttname"><a href="pomp_8h.html#a3f0c4a869b9b0e27422e503eaf380bd5">pomp_emeasure</a></div><div class="ttdeci">void pomp_emeasure(double *f, const double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00092">pomp.h:93</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a263b864ea80d9008e4c96ffe013f1dff"><div class="ttname"><a href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a></div><div class="ttdeci">static R_INLINE void fixdimnames(SEXP x, const char **names, int n)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00129">pomp_defines.h:129</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_ac56010c8d35a155162376d066856f663"><div class="ttname"><a href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a></div><div class="ttdeci">static R_INLINE int invalid_names(SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00055">pomp_defines.h:55</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph.png" border="0" usemap="#adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph" alt=""/></div>
<map name="adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph" id="adecls_8h_ac1ec1439680776719b9b8b9ebdbf9a33_cgraph">
<area shape="rect" title=" " alt="" coords="5,309,116,336"/>
<area shape="rect" href="emeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="207,5,288,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,107,291,133"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,152,494,179"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,157,307,184"/>
<area shape="rect" href="emeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="207,360,287,387"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,215,493,241"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="166,411,329,437"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,487,819,513"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="164,563,331,589"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,291,485,317"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="176,512,319,539"/>
<area shape="rect" href="emeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="207,259,288,285"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="194,613,301,640"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,563,499,589"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,512,490,539"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,512,653,539"/>
</map>
</div>

</div>
</div>
<a id="ab6ee70ea223bd1cd7359810d1e0c8a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ee70ea223bd1cd7359810d1e0c8a49">&#9670;&nbsp;</a></span>do_partrans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_partrans </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="partrans_8c_source.html#l00049">49</a> of file <a class="el" href="partrans_8c_source.html">partrans.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  SEXP Pnames, tparams, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ob;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a> direc;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> qvec, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  qvec = isNull(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <span class="comment">// is &#39;params&#39; a vector?</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  PROTECT(tparams = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// coerce &#39;params&#39; to matrix</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  PROTECT(tparams = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(tparams));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  dim = INTEGER(GET_DIM(tparams));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams)));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// determine direction of transformation and extract corresponding pomp_fun</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  direc = (<a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a>) *(INTEGER(dir));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;partrans&quot;</span>)));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">switch</span> (direc) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a>: <span class="keywordflow">default</span>:   <span class="comment">// from estimation scale</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;from&quot;</span>)));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a>:                      <span class="comment">// to estimation scale</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;to&quot;</span>)));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    SEXP ans, nm;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">double</span> *pa, *ps = REAL(tparams);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> *posn;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    PROTECT(ans = <a class="code" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user transformation functions must return named numeric vectors.&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    posn = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    nprotect += 4;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (j = 1, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      PROTECT(ans = <a class="code" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="pomp_8h.html#ad6fffa3f10a13bfb8faf085bc4f4c953">pomp_transform</a> *ff;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">int</span> *idx;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    idx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(tparams); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      (*ff)(pt,ps,idx);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">break</span>;  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (qvec) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams))); nprotect++;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    SET_DIM(tparams,R_NilValue);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    SET_NAMES(tparams,Pnames);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">return</span> tparams;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="apartrans_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00033">partrans.c:33</a></div></div>
<div class="ttc" id="apartrans_8c_html_ad0f00e555a10801616b1d7f177d88ec3"><div class="ttname"><a href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00012">partrans.c:12</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6b"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a></div><div class="ttdeci">direction_t</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a></div><div class="ttdeci">@ from</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a></div><div class="ttdeci">@ to</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00010">partrans.c:10</a></div></div>
<div class="ttc" id="apomp_8h_html_ad6fffa3f10a13bfb8faf085bc4f4c953"><div class="ttname"><a href="pomp_8h.html#ad6fffa3f10a13bfb8faf085bc4f4c953">pomp_transform</a></div><div class="ttdeci">void pomp_transform(double *pt, const double *p, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00114">pomp.h:115</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a76a484fb785e5a4b35f15e41a1b8fc1b"><div class="ttname"><a href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a></div><div class="ttdeci">static R_INLINE SEXP matchnames(SEXP provided, SEXP needed, const char *where)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00059">pomp_defines.h:60</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph.png" border="0" usemap="#adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph" alt=""/></div>
<map name="adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph" id="adecls_8h_ab6ee70ea223bd1cd7359810d1e0c8a49_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,104,159"/>
<area shape="rect" href="partrans_8c.html#ad0f00e555a10801616b1d7f177d88ec3" title=" " alt="" coords="183,5,264,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="180,56,267,83"/>
<area shape="rect" href="partrans_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="183,107,263,133"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="665,183,783,209"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="511,208,617,235"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="152,259,295,285"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="347,56,458,83"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="343,259,463,285"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="351,309,454,336"/>
</map>
</div>

</div>
</div>
<a id="ab3de8f433818929ff221b26769ed9e6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3de8f433818929ff221b26769ed9e6c">&#9670;&nbsp;</a></span>do_rinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rinit </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rinit_8c_source.html#l00091">91</a> of file <a class="el" href="rinit_8c_source.html">rinit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  SEXP Pnames, Cnames, <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, pcnames;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  SEXP x = R_NilValue;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  SEXP pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> npar, nrep, nvar, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nsims, ns;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  nsims = *(INTEGER(AS_INTEGER(nsim)));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  PROTECT(pcnames = GET_COLNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  npar = dim[0]; nrep = dim[1];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ns = nsims*nrep;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*(REAL(t0)),<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// extract userdata</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rinit&quot;</span>)));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">double</span> *time = REAL(AS_NUMERIC(t0));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">double</span> *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">double</span> *xs, *xt = NULL;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">int</span> *midx;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    PROTECT(ans = <a class="code" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps,npar,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_NAMES(ans));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    nvar = LENGTH(ans);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    xs = REAL(ans);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    midx = INTEGER(PROTECT(match(Pnames,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,0)));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; nvar; j++) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">if</span> (midx[j] != 0)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;a state variable and a parameter share the name: &#39;%s&#39;.&quot;</span>,CHAR(STRING_ELT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,j)));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    PROTECT(x = <a class="code" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a>(nvar,ns,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    xt = REAL(x);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    nprotect += 6;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (j = 1, xt += nvar; j &lt; ns; j++, xt += nvar) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      PROTECT(ans = <a class="code" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps+npar*(j%nrep),npar,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      xs = REAL(ans);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">if</span> (LENGTH(ans) != nvar)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; returns vectors of variable length.&quot;</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">double</span> *xt, *ps, time;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="pomp_8h.html#a849cb5008ab19114475e2730a51ff9d7">pomp_rinit</a> *ff = NULL;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    nvar = *INTEGER(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;nstatevars&quot;</span>)));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    PROTECT(x = <a class="code" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a>(nvar,ns,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)); nprotect++;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    time = *(REAL(t0));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (j = 0, xt = REAL(x), ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; ns; j++, xt += nvar)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      (*ff)(xt,ps+npar*(j%nrep),time,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    PROTECT(x = <a class="code" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede">pomp_default_rinit</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,Pnames,npar,nrep,ns)); nprotect++;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// now add column names</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (nrep &gt; 1) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    SEXP dn, xn;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> k, *p;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (isNull(pcnames)) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      PROTECT(pcnames = NEW_INTEGER(nrep)); nprotect++;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">for</span> (k = 0, p = INTEGER(pcnames); k &lt; nrep; k++, p++) *p = k+1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">int</span> k, *sp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      SEXP us;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      PROTECT(us = mkString(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      PROTECT(xn = NEW_INTEGER(ns));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">for</span> (k = 0, sp = INTEGER(xn); k &lt; ns; k++, sp++) *sp = (k/nrep)+1;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      PROTECT(xn = <a class="code" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416">paste0</a>(pcnames,us,xn));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      PROTECT(dn = GET_DIMNAMES(x));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      nprotect += 4;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      SET_ELEMENT(dn,1,xn);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      SET_DIMNAMES(x,dn);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      PROTECT(dn = GET_DIMNAMES(x)); nprotect++;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      SET_ELEMENT(dn,1,pcnames);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      SET_DIMNAMES(x,dn);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a849cb5008ab19114475e2730a51ff9d7"><div class="ttname"><a href="pomp_8h.html#a849cb5008ab19114475e2730a51ff9d7">pomp_rinit</a></div><div class="ttdeci">void pomp_rinit(double *x, const double *p, double t0, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00039">pomp.h:40</a></div></div>
<div class="ttc" id="arinit_8c_html_a1d34a269c2da0e05ebce19a2d07bf123"><div class="ttname"><a href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int m, int n, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00079">rinit.c:79</a></div></div>
<div class="ttc" id="arinit_8c_html_a4d765252bd25e8eb50da6837a15b5416"><div class="ttname"><a href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416">paste0</a></div><div class="ttdeci">static R_INLINE SEXP paste0(SEXP a, SEXP b, SEXP c)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00010">rinit.c:10</a></div></div>
<div class="ttc" id="arinit_8c_html_a966f509fab1f9d9e38fc64d7e5773ede"><div class="ttname"><a href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede">pomp_default_rinit</a></div><div class="ttdeci">static SEXP pomp_default_rinit(SEXP params, SEXP Pnames, int npar, int nrep, int nsim)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00254">rinit.c:254</a></div></div>
<div class="ttc" id="arinit_8c_html_ac243dd8b5b0b777968905b257e24dc9c"><div class="ttname"><a href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t0, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00058">rinit.c:59</a></div></div>
<div class="ttc" id="arinit_8c_html_afdfe8d3f0939427e72c44c0e4f3bb102"><div class="ttname"><a href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00021">rinit.c:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph.png" border="0" usemap="#adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph" alt=""/></div>
<map name="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph" id="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,76,285"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="167,5,248,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="164,56,251,83"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="167,107,247,133"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="126,157,289,184"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="663,335,780,361"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="124,259,291,285"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="174,309,241,336"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="135,360,280,387"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="358,360,439,387"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="136,461,279,488"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="154,512,261,539"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="343,56,454,83"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="507,309,614,336"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="507,360,615,387"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="515,411,607,437"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="339,411,459,437"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="347,461,450,488"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="507,461,614,488"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph.png" border="0" usemap="#adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph" alt=""/></div>
<map name="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph" id="adecls_8h_ab3de8f433818929ff221b26769ed9e6c_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,559,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a0fdad74a815d2783d4f6f7053a6cb3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fdad74a815d2783d4f6f7053a6cb3ca">&#9670;&nbsp;</a></span>do_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rmeasure_8c_source.html#l00098">98</a> of file <a class="el" href="rmeasure_8c_source.html">rmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rmeasure&quot;</span>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                  ans = <a class="code" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                  time,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                  )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          nobs = LENGTH(ans);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          nprotect += 3;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          first = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                  ans = <a class="code" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                  time,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                  )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                  );</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="pomp_8h.html#ab50f528dfb03feaa03e7846023767637">pomp_rmeasure</a> *ff = NULL;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,dim)); nprotect++;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_ab50f528dfb03feaa03e7846023767637"><div class="ttname"><a href="pomp_8h.html#ab50f528dfb03feaa03e7846023767637">pomp_rmeasure</a></div><div class="ttdeci">void pomp_rmeasure(double *y, const double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00078">pomp.h:79</a></div></div>
<div class="ttc" id="armeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="rmeasure_8c_source.html#l00060">rmeasure.c:60</a></div></div>
<div class="ttc" id="armeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="rmeasure_8c_source.html#l00010">rmeasure.c:10</a></div></div>
<div class="ttc" id="armeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="rmeasure_8c_source.html#l00084">rmeasure.c:84</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph.png" border="0" usemap="#adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph" alt=""/></div>
<map name="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph" id="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,309,112,336"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="203,5,284,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="200,107,287,133"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="379,152,490,179"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="184,157,303,184"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="203,360,283,387"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="381,215,489,241"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="162,411,325,437"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="697,487,815,513"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="160,563,327,589"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="389,291,481,317"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="172,512,315,539"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="203,259,284,285"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="190,613,297,640"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="375,563,495,589"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="383,512,486,539"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="543,512,649,539"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph.png" border="0" usemap="#adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph" alt=""/></div>
<map name="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph" id="adecls_8h_a0fdad74a815d2783d4f6f7053a6cb3ca_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,595,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ab82bdfc4b0763ddd79d74e02f60e790a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82bdfc4b0763ddd79d74e02f60e790a">&#9670;&nbsp;</a></span>do_rprior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprior </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprior_8c_source.html#l00058">58</a> of file <a class="el" href="rprior_8c_source.html">rprior.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  SEXP Pnames, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369">ret_array</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprior&quot;</span>)));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">int</span> nprotect = 5;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    SEXP ans, nm;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">double</span> *pa, *p = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> *posn = NULL;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// set up the function call</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames)); nprotect++;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, p += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        PROTECT(ans = <a class="code" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,p,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprior&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        posn = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        nprotect += 4;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        pa = REAL(ans);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) p[posn[i]] = pa[i];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        first = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        PROTECT(ans = <a class="code" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,p,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        PROTECT(ans = AS_NUMERIC(ans));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        pa = REAL(ans);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) p[posn[i]] = pa[i];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        UNPROTECT(2);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">double</span> *p;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> *pidx = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a> *ff = NULL;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// extract parameter index</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    R_CheckUserInterrupt();     <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">for</span> (j = 0, p = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, p += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      (*ff)(p,pidx);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// just duplicate</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rprior&#39; unspecified: duplicating parameters.&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a910c57a1b150c29312792eba4a5fb2d3"><div class="ttname"><a href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a></div><div class="ttdeci">void pomp_rprior(double *p, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00106">pomp.h:107</a></div></div>
<div class="ttc" id="arprior_8c_html_a0d7fde328f6573bb69afd5d887d92599"><div class="ttname"><a href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *p, int n)</div><div class="ttdef"><b>Definition:</b> <a href="rprior_8c_source.html#l00031">rprior.c:31</a></div></div>
<div class="ttc" id="arprior_8c_html_a47e0916f81aa8c67b2cd749534467369"><div class="ttname"><a href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(SEXP params)</div><div class="ttdef"><b>Definition:</b> <a href="rprior_8c_source.html#l00047">rprior.c:47</a></div></div>
<div class="ttc" id="arprior_8c_html_ad0f00e555a10801616b1d7f177d88ec3"><div class="ttname"><a href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="rprior_8c_source.html#l00010">rprior.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph.png" border="0" usemap="#adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph" alt=""/></div>
<map name="adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph" id="adecls_8h_ab82bdfc4b0763ddd79d74e02f60e790a_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,85,159"/>
<area shape="rect" href="rprior_8c.html#ad0f00e555a10801616b1d7f177d88ec3" title=" " alt="" coords="164,5,245,32"/>
<area shape="rect" href="rprior_8c.html#a0d7fde328f6573bb69afd5d887d92599" title=" " alt="" coords="165,56,245,83"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="651,132,768,159"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="494,157,601,184"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="133,208,276,235"/>
<area shape="rect" href="rprior_8c.html#a47e0916f81aa8c67b2cd749534467369" title=" " alt="" coords="164,309,245,336"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="324,208,444,235"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="333,259,435,285"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="341,309,427,336"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="330,360,438,387"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="492,309,603,336"/>
</map>
</div>

</div>
</div>
<a id="af129ae090fa637ebcec13e50e6c0d7be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af129ae090fa637ebcec13e50e6c0d7be">&#9670;&nbsp;</a></span>do_rprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprocess_8c_source.html#l00025">25</a> of file <a class="el" href="rprocess_8c_source.html">rprocess.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> *xdim, type, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, ntimes;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, copy, rproc, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, accumvars, covar;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SEXP dimXstart, dimP;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(times) &lt; 1: no work to do.&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  PROTECT(xstart = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(xstart));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  PROTECT(dimXstart = GET_DIM(xstart));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  xdim = INTEGER(dimXstart);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = xdim[0]; nrepsx = xdim[1];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(dimP = GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  xdim = INTEGER(dimP);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = xdim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = xdim[1];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">if</span> (nrepsx &gt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {         <span class="comment">// more ICs than parameters</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (nrepsx % <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != 0) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; dims[1] = nrepsx;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      PROTECT(copy = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dims));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      tgt = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nrepsx; j++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          *tgt = src[k+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = nrepsx;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nrepsx &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {  <span class="comment">// more parameters than ICs</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dims[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      PROTECT(copy = duplicate(xstart));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      PROTECT(xstart = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dims));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(xstart,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      tgt = REAL(xstart);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          *tgt = src[k+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*(j%nrepsx)];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  PROTECT(rproc = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprocess&quot;</span>)));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  nprotect += 4;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// extract the process function</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  type = *(INTEGER(GET_SLOT(rproc,install(<span class="stringliteral">&quot;type&quot;</span>))));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="comment">// one-step simulator</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                  accumvars,covar,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>: <span class="comment">// discrete-time and Euler</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordtype">double</span> deltat;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      deltat = *(REAL(AS_NUMERIC(GET_SLOT(rproc,install(<span class="stringliteral">&quot;delta.t&quot;</span>)))));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                  accumvars,covar,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a>: <span class="comment">// Gillespie&#39;s method</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, vmatrix, hmax;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;rate.fn&quot;</span>)));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      PROTECT(vmatrix = GET_SLOT(rproc,install(<span class="stringliteral">&quot;v&quot;</span>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      PROTECT(hmax = GET_SLOT(rproc,install(<span class="stringliteral">&quot;hmax&quot;</span>)));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,vmatrix,covar,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                accumvars,hmax,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      nprotect += 4;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f">pomp_default_rprocess</a>(xstart,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    nprotect++;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,3);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a19293a3a394b4e0885714f833bc2a96b"><div class="ttname"><a href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b">euler_simulator</a></div><div class="ttdeci">SEXP euler_simulator(SEXP, SEXP, SEXP, SEXP, SEXP, double, rprocmode, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00107">euler.c:108</a></div></div>
<div class="ttc" id="adecls_8h_html_ac796abcef7f5d6add4d98023a0bde62b"><div class="ttname"><a href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b">SSA_simulator</a></div><div class="ttdeci">SEXP SSA_simulator(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00228">ssa.c:228</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a></div><div class="ttdeci">@ gill</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a></div><div class="ttdeci">@ discrete</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a></div><div class="ttdeci">@ dflt</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a></div><div class="ttdeci">@ onestep</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a></div><div class="ttdeci">@ euler</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="arprocess_8c_html_a37e868d572ef0240fa585840f2aed80f"><div class="ttname"><a href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f">pomp_default_rprocess</a></div><div class="ttdeci">static SEXP pomp_default_rprocess(SEXP xstart, int nvars, int nreps, int ntimes)</div><div class="ttdef"><b>Definition:</b> <a href="rprocess_8c_source.html#l00010">rprocess.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph.png" border="0" usemap="#adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph" alt=""/></div>
<map name="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph" id="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_cgraph">
<area shape="rect" title=" " alt="" coords="5,128,105,155"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="172,27,259,53"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="563,77,674,104"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="153,457,277,484"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="565,216,673,243"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="573,140,665,167"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="331,77,505,104"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="157,787,274,813"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="377,280,459,307"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="378,432,458,459"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="337,635,499,661"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="881,457,999,484"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="335,685,501,712"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="727,533,833,560"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="351,483,485,509"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="353,331,483,357"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="347,837,489,864"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="377,179,459,205"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="565,913,672,940"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="559,837,679,864"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="567,685,670,712"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="325,939,511,965"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="377,888,459,915"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="394,989,442,1016"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="580,989,657,1016"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph.png" border="0" usemap="#adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph" alt=""/></div>
<map name="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph" id="adecls_8h_af129ae090fa637ebcec13e50e6c0d7be_icgraph">
<area shape="rect" title=" " alt="" coords="488,5,588,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="aa9d3b94c1a9a99e0db90e251f670e853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d3b94c1a9a99e0db90e251f670e853">&#9670;&nbsp;</a></span>do_simulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_simulate </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rettype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="simulate_8c_source.html#l00006">6</a> of file <a class="el" href="simulate_8c_source.html">simulate.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  SEXP t0, times, x0, x, y;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  SEXP ans = R_NilValue, ans_names = R_NilValue;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  SEXP simnames;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> return_type = *(INTEGER(rettype)); <span class="comment">// 0 = array, 1 = pomps</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">if</span> (LENGTH(nsim) != 1) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a single integer&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  PROTECT(t0 = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;t0&quot;</span>)));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(times = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// initialize the simulations</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(x0 = <a class="code" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a>(<span class="keywordtype">object</span>,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,t0,nsim,gnsi));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(simnames = GET_COLNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// call &#39;rprocess&#39; to simulate state process</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  PROTECT(x = <a class="code" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a>(<span class="keywordtype">object</span>,x0,t0,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">// call &#39;rmeasure&#39; to simulate the measurement process</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  PROTECT(y = <a class="code" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a>(<span class="keywordtype">object</span>,x,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(x,simnames);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(y,simnames);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">switch</span> (return_type) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">case</span> 0:  <span class="comment">// return a list of arrays</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    PROTECT(ans = NEW_LIST(2));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(ans_names = NEW_CHARACTER(2));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    SET_STRING_ELT(ans_names,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    SET_STRING_ELT(ans_names,1,mkChar(<span class="stringliteral">&quot;obs&quot;</span>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    SET_ELEMENT(ans,0,x);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    SET_ELEMENT(ans,1,y);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// a list to hold the pomp objects</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      SEXP pp, xx, yy, po;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *xdim;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">int</span> nvar, npar, nobs, nsim, ntim, nparsets;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">int</span> dim[2], i, j, k;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      PROTECT(po = duplicate(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;t0&quot;</span>),t0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;times&quot;</span>),times);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      xdim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      nvar = xdim[0]; nsim = xdim[1]; ntim = xdim[2];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      xdim = INTEGER(GET_DIM(y));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      nobs = xdim[0]; <span class="comment">// second dimensions of &#39;x&#39; and &#39;y&#39; must agree</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      xdim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      npar = xdim[0]; nparsets = xdim[1];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      dim[0] = nvar; dim[1] = ntim;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      PROTECT(xx = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(xx,GET_ROWNAMES(GET_DIMNAMES(x)),2);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;states&quot;</span>),xx);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      dim[0] = nobs; dim[1] = ntim;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      PROTECT(yy = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(yy,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;data&quot;</span>),yy);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      PROTECT(pp = NEW_NUMERIC(npar));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      SET_NAMES(pp,GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;params&quot;</span>),pp);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      PROTECT(ans = NEW_LIST(nsim));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      SET_NAMES(ans,simnames);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      nprotect += 5;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; nsim; k++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        SEXP po2;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">double</span> *xs = REAL(x), *ys = REAL(y), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">double</span> *xt, *yt, *pt;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        PROTECT(po2 = duplicate(po));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        xt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;states&quot;</span>)));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        yt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        pt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;params&quot;</span>)));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        memcpy(pt,ps+npar*(k%nparsets),npar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// copy x[,k,] and y[,k,] into po2</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; ntim; j++) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; nvar; i++, xt++) *xt = xs[i+nvar*(k+nsim*j)];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, yt++) *yt = ys[i+nobs*(k+nsim*j)];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        SET_ELEMENT(ans,k,po2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a0fdad74a815d2783d4f6f7053a6cb3ca"><div class="ttname"><a href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca">do_rmeasure</a></div><div class="ttdeci">SEXP do_rmeasure(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="rmeasure_8c_source.html#l00098">rmeasure.c:98</a></div></div>
<div class="ttc" id="adecls_8h_html_ab3de8f433818929ff221b26769ed9e6c"><div class="ttname"><a href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c">do_rinit</a></div><div class="ttdeci">SEXP do_rinit(SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00091">rinit.c:91</a></div></div>
<div class="ttc" id="adecls_8h_html_af129ae090fa637ebcec13e50e6c0d7be"><div class="ttname"><a href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be">do_rprocess</a></div><div class="ttdeci">SEXP do_rprocess(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="rprocess_8c_source.html#l00025">rprocess.c:25</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a796a0cd2011dadc57c790c46532ef00b"><div class="ttname"><a href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a></div><div class="ttdeci">static R_INLINE void setcolnames(SEXP x, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00121">pomp_defines.h:121</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph.png" border="0" usemap="#adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph" alt=""/></div>
<map name="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph" id="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_cgraph">
<area shape="rect" title=" " alt="" coords="5,635,108,661"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="552,77,639,104"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="741,331,851,357"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="173,1445,244,1472"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="750,964,842,991"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="329,457,435,484"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="159,635,259,661"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="156,1825,261,1852"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="341,1471,423,1497"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="342,1521,422,1548"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="514,939,677,965"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1059,1471,1176,1497"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="512,989,679,1016"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="349,1724,415,1751"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="309,1623,455,1649"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="555,1597,636,1624"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="524,1091,667,1117"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="743,824,849,851"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="743,1597,849,1624"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="742,635,850,661"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="736,1091,856,1117"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="745,1243,847,1269"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="904,1395,1011,1421"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,179,636,205"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="536,280,655,307"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="555,229,635,256"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="555,432,636,459"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="320,1167,444,1193"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="508,584,683,611"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="323,837,441,864"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,1293,636,1320"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="555,1344,635,1371"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="529,1192,662,1219"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="531,1243,660,1269"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="555,1040,636,1067"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="503,787,688,813"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="555,837,636,864"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="571,685,619,712"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="757,685,835,712"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph.png" border="0" usemap="#adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph" alt=""/></div>
<map name="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph" id="adecls_8h_aa9d3b94c1a9a99e0db90e251f670e853_icgraph">
<area shape="rect" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="af1187e52d896c25c1cdb5dd593dbc291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1187e52d896c25c1cdb5dd593dbc291">&#9670;&nbsp;</a></span>do_skeleton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_skeleton </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00326">326</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, nrepp, nrepx, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Cnames, Pnames;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  SEXP pompfun, <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, ob;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  ntimes = LENGTH(t);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepx = dim[1];</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;t&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// 2nd dimension of &#39;x&#39; and &#39;params&#39; need not agree</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepp &gt; nrepx) ? nrepp : nrepx;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepx != 0))</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;2nd dimensions of &#39;x&#39; and &#39;params&#39; are incompatible&quot;</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  PROTECT(F = <a class="code" href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e">ret_array</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordtype">int</span> nprotect = 12;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a>(REAL(F),REAL(t),REAL(x),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    &amp;covariate_table,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff = NULL;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a>(</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                         REAL(F),REAL(t),REAL(x),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                         <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                         sidx,pidx,cidx,&amp;covariate_table,ff,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">int</span> i, n = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++, ft++) *ft = R_NaReal;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a1c79f52f1a622f5a59fea40ad9dfe1f4"><div class="ttname"><a href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a></div><div class="ttdeci">void pomp_skeleton(double *f, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00072">pomp.h:73</a></div></div>
<div class="ttc" id="askeleton_8c_html_a4c519c3f1f7ceca7aae16c0aa702cfeb"><div class="ttname"><a href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *f, double *time, double *x, double *p, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, int *sidx, int *pidx, int *cidx, lookup_table_t *covar_table, pomp_skeleton *fun, SEXP args, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00245">skeleton.c:245</a></div></div>
<div class="ttc" id="askeleton_8c_html_a53b6db198caa0f42fbbccb00bc27a12e"><div class="ttname"><a href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nvars, int nreps, int ntimes, SEXP Snames)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00081">skeleton.c:81</a></div></div>
<div class="ttc" id="askeleton_8c_html_a82ea4779fc1cc65f27c3546cbb6669c8"><div class="ttname"><a href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00010">skeleton.c:10</a></div></div>
<div class="ttc" id="askeleton_8c_html_ab5870e93076f917246e64740c1416a05"><div class="ttname"><a href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *f, double *time, double *x, double *p, SEXP fn, SEXP args, SEXP Snames, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, lookup_table_t *covar_table, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00093">skeleton.c:94</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph.png" border="0" usemap="#adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph" alt=""/></div>
<map name="adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph" id="adecls_8h_af1187e52d896c25c1cdb5dd593dbc291_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,105,235"/>
<area shape="rect" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8" title=" " alt="" coords="179,5,294,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="193,56,280,83"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="177,107,296,133"/>
<area shape="rect" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="157,208,317,235"/>
<area shape="rect" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="173,259,301,285"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="155,360,318,387"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="153,411,320,437"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="165,309,308,336"/>
<area shape="rect" href="skeleton_8c.html#a53b6db198caa0f42fbbccb00bc27a12e" title=" " alt="" coords="196,157,277,184"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="373,56,483,83"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="375,208,481,235"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="388,259,468,285"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="691,335,808,361"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="536,360,643,387"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="368,461,488,488"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="377,411,479,437"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="374,107,482,133"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="382,157,474,184"/>
</map>
</div>

</div>
</div>
<a id="aa55c56601a4d47af6f8d162ff1aa9503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55c56601a4d47af6f8d162ff1aa9503">&#9670;&nbsp;</a></span>do_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_vmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmeasure_8c_source.html#l00099">99</a> of file <a class="el" href="vmeasure_8c_source.html">vmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> nobs = 0, nans = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1">as_state_array</a>(x));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;vmeasure&quot;</span>)));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                  ans = <a class="code" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                  time,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                  )</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                  );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          nans = LENGTH(ans);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          nobs = (int) sqrt(nans);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <span class="keywordflow">if</span> (nans != nobs*nobs)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a symmetric square matrix.&quot;</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(ans)));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(Onames))</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a matrix with row-names.&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          nprotect += 3;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          yt += nans;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          first = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                  ans = <a class="code" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                  <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                  time,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                  xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                  ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                  )</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nans)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          yt += nans;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    SEXP vmatindex;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx, *vmidx;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="pomp_8h.html#ad514ab0a8cca7242600f76a41ac1b45e">pomp_vmeasure</a> *ff = NULL;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    nans = nobs*nobs;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    PROTECT(vmatindex = NEW_INTEGER(nans)); nprotect++;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    vmidx = INTEGER(vmatindex);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nobs; k++) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nobs; j++) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        vmidx[j+nobs*k] = oidx[j]+nobs*oidx[k];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nans) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        (*ff)(yt,xp,pp,vmidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">int</span> dim[4] = {nobs, nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[4] = {<span class="stringliteral">&quot;var1&quot;</span>,<span class="stringliteral">&quot;var2&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(4,dim)); nprotect++;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,4);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b">setcolnames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,4);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_ad514ab0a8cca7242600f76a41ac1b45e"><div class="ttname"><a href="pomp_8h.html#ad514ab0a8cca7242600f76a41ac1b45e">pomp_vmeasure</a></div><div class="ttdeci">void pomp_vmeasure(double *f, const double *x, const double *p, const int *vmatindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00099">pomp.h:100</a></div></div>
<div class="ttc" id="avmeasure_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="vmeasure_8c_source.html#l00060">vmeasure.c:60</a></div></div>
<div class="ttc" id="avmeasure_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="vmeasure_8c_source.html#l00010">vmeasure.c:10</a></div></div>
<div class="ttc" id="avmeasure_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="vmeasure_8c_source.html#l00084">vmeasure.c:84</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph.png" border="0" usemap="#adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph" alt=""/></div>
<map name="adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph" id="adecls_8h_aa55c56601a4d47af6f8d162ff1aa9503_cgraph">
<area shape="rect" title=" " alt="" coords="5,335,116,361"/>
<area shape="rect" href="vmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="207,5,288,32"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="204,107,291,133"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="383,155,494,181"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="188,157,307,184"/>
<area shape="rect" href="vmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="207,411,287,437"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="385,212,493,239"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="166,461,329,488"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="701,563,819,589"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="164,613,331,640"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="393,275,485,301"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="176,563,319,589"/>
<area shape="rect" href="vmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="207,259,288,285"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="386,351,491,377"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="194,664,301,691"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="379,563,499,589"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="387,613,490,640"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="547,588,653,615"/>
</map>
</div>

</div>
</div>
<a id="a19293a3a394b4e0885714f833bc2a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19293a3a394b4e0885714f833bc2a96b">&#9670;&nbsp;</a></span>euler_simulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP euler_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>accumvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00107">107</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, nzeros, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, t0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP cvec, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (deltat &lt;= 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;delta.t&#39; should be a positive number.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  dim = INTEGER(GET_DIM(xstart)); <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  t0 = *(REAL(tstart));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(covar,&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// indices of accumulator variables</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordtype">int</span> *zidx = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// extract user function</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// array to hold results</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// copy the start values into the result array</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  memcpy(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(xstart),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// set up</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">int</span> *pidx = 0, *sidx = 0, *cidx = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a> *ff = NULL;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// construct list of all arguments</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">break</span>;                              <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// main computation loop</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">int</span> step;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">double</span> *xt, *time, t;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">for</span> (</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       step = 0, xt = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>), time = REAL(times), t = t0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       step &lt; ntimes;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       step++, xt += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       ) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">double</span> dt;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> nstep = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (t &gt; time[step]) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;times&#39; must be an increasing sequence.&quot;</span>);  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        xt[zidx[i]+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*j] = 0.0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// determine size and number of time-steps</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">switch</span> (method) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="keywordflow">default</span>:      <span class="comment">// one step</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      dt = time[step]-t;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      nstep = 1;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>:              <span class="comment">// fixed step</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      dt = deltat;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      nstep = <a class="code" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a>(t,time[step],dt);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>:                 <span class="comment">// Euler method</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      dt = deltat;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      nstep = <a class="code" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a>(t,time[step],&amp;dt);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// loop over individual steps</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nstep; k++) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(&amp;covariate_table,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">double</span> *ap, *pm, *xm, *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">for</span> (j = 0, pm = ps, xm = xt; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pm += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, xm += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            SEXP ans, nm;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;              PROTECT(ans = <a class="code" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprocess&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;              pidx = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(nm,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;              nprotect += 3;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              first = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;              PROTECT(ans = <a class="code" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;              UNPROTECT(1);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          (*ff)(xm,pm,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t,dt);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">default</span>:                              <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">break</span>;                              <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      t += dt;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">if</span> ((method == <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>) &amp;&amp; (k == nstep-2)) { <span class="comment">// penultimate step</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        dt = time[step]-t;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        t = time[step]-dt;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (step &lt; ntimes-1)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      memcpy(xt+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,xt,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// clean up</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="ttc" id="aeuler_8c_html_a0681d20c093a288da04bffa9adbfe48a"><div class="ttname"><a href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a></div><div class="ttdeci">int num_map_steps(double t1, double t2, double deltat)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00342">euler.c:342</a></div></div>
<div class="ttc" id="aeuler_8c_html_a3da8d135fe6d232031cf7c314f432265"><div class="ttname"><a href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a></div><div class="ttdeci">int num_euler_steps(double t1, double t2, double *deltat)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00317">euler.c:317</a></div></div>
<div class="ttc" id="aeuler_8c_html_ad78b5357467ce6dfb3b594a64a0e3d08"><div class="ttname"><a href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *dt, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00067">euler.c:67</a></div></div>
<div class="ttc" id="aeuler_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="euler_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00010">euler.c:10</a></div></div>
<div class="ttc" id="aeuler_8c_html_aff505c906b432ad2e9b72dc28feb374d"><div class="ttname"><a href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int n, int nreps, int ntimes, SEXP names)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00092">euler.c:92</a></div></div>
<div class="ttc" id="apomp_8h_html_abd7cfb2f9064495241ac3474f912d36d"><div class="ttname"><a href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a></div><div class="ttdeci">void pomp_onestep_sim(double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00058">pomp.h:59</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph.png" border="0" usemap="#adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph" alt=""/></div>
<map name="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph" id="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,129,285"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="220,5,301,32"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="221,56,301,83"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="179,107,342,133"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="715,208,832,235"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="177,208,344,235"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="560,259,667,285"/>
<area shape="rect" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265" title=" " alt="" coords="194,309,327,336"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="196,360,325,387"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="189,411,332,437"/>
<area shape="rect" href="euler_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="220,461,301,488"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="207,512,314,539"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="392,335,512,361"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="401,385,503,412"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="398,436,506,463"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="406,487,498,513"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="397,537,507,564"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph.png" border="0" usemap="#adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph" alt=""/></div>
<map name="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph" id="adecls_8h_a19293a3a394b4e0885714f833bc2a96b_icgraph">
<area shape="rect" title=" " alt="" coords="636,5,760,32"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="488,5,588,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a87734543f5fc40ed123f9f1664e3b7a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87734543f5fc40ed123f9f1664e3b7a7">&#9670;&nbsp;</a></span>eval_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>cidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00245">245</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      xp = &amp;x[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k)];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      pp = &amp;p[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp)];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      (*fun)(f,xp,pp,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a6d8415c759496fb5460bce9a56445919"><div class="ttname"><a href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a></div><div class="ttdeci">lookup_table_t covar_table</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00130">trajectory.c:130</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph.png" border="0" usemap="#adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph" alt=""/></div>
<map name="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph" id="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,165,32"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="213,5,320,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph.png" border="0" usemap="#adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph" alt=""/></div>
<map name="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph" id="adecls_8h_a87734543f5fc40ed123f9f1664e3b7a7_icgraph">
<area shape="rect" title=" " alt="" coords="168,31,328,57"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="13,5,113,32"/>
<area shape="rect" href="decls_8h.html#a5c9d4b991e534272c7dc4a6602be32ec" title=" " alt="" coords="5,56,120,83"/>
</map>
</div>

</div>
</div>
<a id="a02d94e3819f568bb29c6d5e77f02a3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d94e3819f568bb29c6d5e77f02a3d8">&#9670;&nbsp;</a></span>eval_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00093">93</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SEXP ans, nm;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">double</span> *fs;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        PROTECT(ans = <a class="code" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                x+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">if</span> (LENGTH(ans)!=<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm))</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        posn = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        nprotect += 3;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        first = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        PROTECT(ans = <a class="code" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                x+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="askeleton_8c_html_a9e133b8f86812dcd3682439751eaef63"><div class="ttname"><a href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a></div><div class="ttdeci">static R_INLINE SEXP eval_call(SEXP fn, SEXP args, double *t, double *x, int nvar, double *p, int npar, double *c, int ncov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00057">skeleton.c:57</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph.png" border="0" usemap="#adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph" alt=""/></div>
<map name="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph" id="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,133,108"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="195,5,275,32"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="336,81,453,108"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="181,107,288,133"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="181,157,288,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph.png" border="0" usemap="#adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph" alt=""/></div>
<map name="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph" id="adecls_8h_a02d94e3819f568bb29c6d5e77f02a3d8_icgraph">
<area shape="rect" title=" " alt="" coords="168,31,296,57"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="13,5,113,32"/>
<area shape="rect" href="decls_8h.html#a5c9d4b991e534272c7dc4a6602be32ec" title=" " alt="" coords="5,56,120,83"/>
</map>
</div>

</div>
</div>
<a id="a6cc031bd56388c0dbb1b6e4aacb3971c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc031bd56388c0dbb1b6e4aacb3971c">&#9670;&nbsp;</a></span>ExpitTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP ExpitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00026">26</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                             {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span> *x;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  x = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  n = LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, x++)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    *x = 1.0/(1.0+exp(-(*x)));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6345040eb63a38c0ff7ae42f3ea35ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6345040eb63a38c0ff7ae42f3ea35ff">&#9670;&nbsp;</a></span>get_covariate_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP get_covariate_names </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00007">7</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                       {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordflow">return</span> GET_ROWNAMES(GET_DIMNAMES(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph.png" border="0" usemap="#adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph" alt=""/></div>
<map name="adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph" id="adecls_8h_ae6345040eb63a38c0ff7ae42f3ea35ff_icgraph">
<area shape="rect" title=" " alt="" coords="873,335,1036,361"/>
<area shape="rect" href="decls_8h.html#a983ad52a265f059c6e25be89cdf97fd7" title=" " alt="" coords="690,5,801,32"/>
<area shape="rect" href="decls_8h.html#ac1ec1439680776719b9b8b9ebdbf9a33" title=" " alt="" coords="690,56,801,83"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="529,195,599,221"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,321,108,348"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="511,487,617,513"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="695,259,795,285"/>
<area shape="rect" href="decls_8h.html#aa55c56601a4d47af6f8d162ff1aa9503" title=" " alt="" coords="690,309,801,336"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="683,208,807,235"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="696,411,795,437"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="695,461,796,488"/>
<area shape="rect" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a" title=" " alt="" coords="337,467,463,493"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="681,664,810,691"/>
<area shape="rect" href="decls_8h.html#aa9632871950917c7b954b1784b74ec78" title=" " alt="" coords="665,613,825,640"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="687,360,804,387"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="349,321,451,348"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,321,289,348"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="514,321,614,348"/>
<area shape="rect" href="decls_8h.html#a6b4fa54c658fe6c6677c51e8346d728c" title=" " alt="" coords="527,411,601,437"/>
<area shape="rect" href="decls_8h.html#a6ef1a476d6745db7455441c65c74fd61" title=" " alt="" coords="513,664,615,691"/>
</map>
</div>

</div>
</div>
<a id="a0f11ca97854cd188080da40020f738eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f11ca97854cd188080da40020f738eb">&#9670;&nbsp;</a></span>get_userdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const SEXP get_userdata </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00013">13</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                           {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  SEXP elt = <a class="code" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">return</span> elt;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div>
<div class="ttc" id="apomp__defines_8h_html_ab39b1553739e35037c2a8846ba65594f"><div class="ttname"><a href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a></div><div class="ttdeci">static R_INLINE SEXP getListElement(SEXP list, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00232">pomp_defines.h:232</a></div></div>
<div class="ttc" id="auserdata_8c_html_a1157d519a72b891b41cef2d20a90bebb"><div class="ttname"><a href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a></div><div class="ttdeci">#define USERDATA</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00006">userdata.c:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0f11ca97854cd188080da40020f738eb_cgraph.png" border="0" usemap="#adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph" alt=""/></div>
<map name="adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph" id="adecls_8h_a0f11ca97854cd188080da40020f738eb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,112,32"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="160,5,280,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a0f11ca97854cd188080da40020f738eb_icgraph.png" border="0" usemap="#adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph" alt=""/></div>
<map name="adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph" id="adecls_8h_a0f11ca97854cd188080da40020f738eb_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,263,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="aaa40ae6e425fd9dc49c29992629be0e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa40ae6e425fd9dc49c29992629be0e2">&#9670;&nbsp;</a></span>get_userdata_double()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double* get_userdata_double </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00026">26</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                                     {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  SEXP elt = <a class="code" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (!isReal(elt)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not a numeric vector.&quot;</span>,name);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">return</span> REAL(elt);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aaa40ae6e425fd9dc49c29992629be0e2_cgraph.png" border="0" usemap="#adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_cgraph" alt=""/></div>
<map name="adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_cgraph" id="adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="212,5,332,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aaa40ae6e425fd9dc49c29992629be0e2_icgraph.png" border="0" usemap="#adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_icgraph" alt=""/></div>
<map name="adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_icgraph" id="adecls_8h_aaa40ae6e425fd9dc49c29992629be0e2_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,315,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="abeacd76a8b2af7c6428eea36b13f74b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeacd76a8b2af7c6428eea36b13f74b6">&#9670;&nbsp;</a></span>get_userdata_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int* get_userdata_int </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00019">19</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                                               {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  SEXP elt = <a class="code" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">if</span> (!isInteger(elt)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not an integer.&quot;</span>,name);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">return</span> INTEGER(elt);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_abeacd76a8b2af7c6428eea36b13f74b6_cgraph.png" border="0" usemap="#adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_cgraph" alt=""/></div>
<map name="adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_cgraph" id="adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,32"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="184,5,304,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_abeacd76a8b2af7c6428eea36b13f74b6_icgraph.png" border="0" usemap="#adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_icgraph" alt=""/></div>
<map name="adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_icgraph" id="adecls_8h_abeacd76a8b2af7c6428eea36b13f74b6_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,287,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a534d4c8bcea55d9f5a6e7d8b34e55408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a534d4c8bcea55d9f5a6e7d8b34e55408">&#9670;&nbsp;</a></span>InverseLogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP InverseLogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00047">47</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                             {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(LENGTH(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>)));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102">from_log_barycentric</a>(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),LENGTH(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a3e9f93a24377bb00084d9400134fd102"><div class="ttname"><a href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102">from_log_barycentric</a></div><div class="ttdeci">static R_INLINE void from_log_barycentric(double *xt, const double *x, int n)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00259">pomp.h:260</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph.png" border="0" usemap="#adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph" alt=""/></div>
<map name="adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph" id="adecls_8h_a534d4c8bcea55d9f5a6e7d8b34e55408_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,239,32"/>
<area shape="rect" href="pomp_8h.html#a3e9f93a24377bb00084d9400134fd102" title=" " alt="" coords="287,5,447,32"/>
</map>
</div>

</div>
</div>
<a id="a1bcec7f4a5a240606fb8235312d5cc45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bcec7f4a5a240606fb8235312d5cc45">&#9670;&nbsp;</a></span>iterate_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP iterate_map </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00019">19</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP skel, pompfun;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  SEXP accumvars;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEXP repnames;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> *zidx = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepp, ntimes, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nzeros;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">double</span> deltat, t;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  PROTECT(skel = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  deltat = *(REAL(GET_SLOT(skel,install(<span class="stringliteral">&quot;delta.t&quot;</span>))));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  t = *(REAL(AS_NUMERIC(t0)));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  PROTECT(x0 = duplicate(x0));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(x0 = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(x0));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  PROTECT(repnames = GET_COLNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// extract user-defined function</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(pompfun = GET_SLOT(skel,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// create array to store results</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7">ret_array</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,repnames));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// get names and indices of accumulator variables</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span> nprotect = 15;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (nzeros &gt; 0) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    zidx = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// set up the computations</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a>(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      &amp;covariate_table,zidx,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a>(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,sidx,pidx,cidx,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      &amp;covariate_table,zidx,ff,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">break</span>; <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_ad9390ea094fe7c28762eb6ac23f1c144"><div class="ttname"><a href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00010">skeleton.c:10</a></div></div>
<div class="ttc" id="adecls_8h_html_adcdcf759e7db4fcc8f07d2692c18183b"><div class="ttname"><a href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b">iterate_skeleton_R</a></div><div class="ttdeci">void iterate_skeleton_R(double *, double, double, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, lookup_table_t *, int *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00161">skeleton.c:161</a></div></div>
<div class="ttc" id="adecls_8h_html_ae06448ff2e2ef1613edd4618634dbed6"><div class="ttname"><a href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6">iterate_skeleton_native</a></div><div class="ttdeci">void iterate_skeleton_native(double *, double, double, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, lookup_table_t *, int *, pomp_skeleton *, SEXP, double *)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00274">skeleton.c:274</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a2109a7d0e874cf7da59ecdde93f802b7"><div class="ttname"><a href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7">ret_array</a></div><div class="ttdeci">static R_INLINE SEXP ret_array(int nvars, int nreps, int ntimes, SEXP Snames, SEXP repnames)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00006">trajectory.c:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph.png" border="0" usemap="#adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph" alt=""/></div>
<map name="adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph" id="adecls_8h_a1bcec7f4a5a240606fb8235312d5cc45_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,107,285"/>
<area shape="rect" href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144" title=" " alt="" coords="185,31,299,57"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="199,81,285,108"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="161,208,323,235"/>
<area shape="rect" href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6" title=" " alt="" coords="155,259,329,285"/>
<area shape="rect" href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b" title=" " alt="" coords="171,309,313,336"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="555,436,661,463"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="159,563,325,589"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="171,512,313,539"/>
<area shape="rect" href="trajectory_8c.html#a2109a7d0e874cf7da59ecdde93f802b7" title=" " alt="" coords="201,132,283,159"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="387,5,497,32"/>
<area shape="rect" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d" title=" " alt="" coords="377,208,507,235"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="389,259,495,285"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="402,309,482,336"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="709,411,827,437"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="382,563,502,589"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="391,512,493,539"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="388,56,496,83"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="396,107,488,133"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="389,157,495,184"/>
</map>
</div>

</div>
</div>
<a id="ae06448ff2e2ef1613edd4618634dbed6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06448ff2e2ef1613edd4618634dbed6">&#9670;&nbsp;</a></span>iterate_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nzeros</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>cidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>zeroindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00274">274</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">double</span> *xs, *Xs;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    nsteps = <a class="code" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        *xs = 0.0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">for</span> (j = 0, Xs = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, xs = x; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, Xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        (*fun)(Xs,xs,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      memcpy(x,<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        t += deltat;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        t = *time;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (nsteps == 0) memcpy(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a4e40667f6198be18fb99f8f07417da1d"><div class="ttname"><a href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a></div><div class="ttdeci">int num_map_steps(double, double, double)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00342">euler.c:342</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph.png" border="0" usemap="#adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph" alt=""/></div>
<map name="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph" id="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,180,57"/>
<area shape="rect" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d" title=" " alt="" coords="228,5,357,32"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="239,56,346,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph.png" border="0" usemap="#adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph" alt=""/></div>
<map name="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph" id="adecls_8h_ae06448ff2e2ef1613edd4618634dbed6_icgraph">
<area shape="rect" title=" " alt="" coords="155,5,329,32"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="5,5,107,32"/>
</map>
</div>

</div>
</div>
<a id="adcdcf759e7db4fcc8f07d2692c18183b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcdcf759e7db4fcc8f07d2692c18183b">&#9670;&nbsp;</a></span>iterate_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nzeros</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>zeroindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00161">161</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  SEXP ans, nm;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">double</span> *ap, *xs;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    nsteps = <a class="code" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        *xs = 0.0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = x; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          PROTECT(ans = <a class="code" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663">invalid_names</a>(nm)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          posn = INTEGER(PROTECT(<a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          nprotect += 3;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          first = 0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          PROTECT(ans = <a class="code" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63">eval_call</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        t += deltat;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        t = *time;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    memcpy(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph.png" border="0" usemap="#adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph" alt=""/></div>
<map name="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph" id="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,148,133"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="221,5,301,32"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="373,81,491,108"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="207,107,314,133"/>
<area shape="rect" href="decls_8h.html#a4e40667f6198be18fb99f8f07417da1d" title=" " alt="" coords="196,157,325,184"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="207,208,314,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph.png" border="0" usemap="#adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph" alt=""/></div>
<map name="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph" id="adecls_8h_adcdcf759e7db4fcc8f07d2692c18183b_icgraph">
<area shape="rect" title=" " alt="" coords="155,5,297,32"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="5,5,107,32"/>
</map>
</div>

</div>
</div>
<a id="a17019a937f12763c2df28735e19b88c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17019a937f12763c2df28735e19b88c3">&#9670;&nbsp;</a></span>load_stack_decr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_decr </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00130">130</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                 {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  SEXP s;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  void (*ff)(<span class="keywordtype">int</span> *);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  PROTECT(s = ScalarInteger(NA_INTEGER));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  ff = (void (*)(<span class="keywordtype">int</span> *)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_decr&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  ff(INTEGER(s));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (*(INTEGER(s)) &lt; 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;impossible!&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a17019a937f12763c2df28735e19b88c3_icgraph.png" border="0" usemap="#adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph" alt=""/></div>
<map name="adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph" id="adecls_8h_a17019a937f12763c2df28735e19b88c3_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,283,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a90946f2aeaeb4f5826c8de7facb25999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90946f2aeaeb4f5826c8de7facb25999">&#9670;&nbsp;</a></span>load_stack_incr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_incr </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00121">121</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                 {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  void (*ff)(void);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  ff = (void (*)(void)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_incr&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  ff();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph.png" border="0" usemap="#adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph" alt=""/></div>
<map name="adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph" id="adecls_8h_a90946f2aeaeb4f5826c8de7facb25999_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,279,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a9adc7fa1db20bdddfae3611911961f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adc7fa1db20bdddfae3611911961f6c">&#9670;&nbsp;</a></span>LogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00038">38</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                      {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = NEW_NUMERIC(LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92">to_log_barycentric</a>(REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a6a5fa3ea6a4ce20374a9d9d761f04c92"><div class="ttname"><a href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92">to_log_barycentric</a></div><div class="ttdeci">static R_INLINE void to_log_barycentric(double *xt, const double *x, int n)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00249">pomp.h:250</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph.png" border="0" usemap="#adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph" alt=""/></div>
<map name="adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph" id="adecls_8h_a9adc7fa1db20bdddfae3611911961f6c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,191,32"/>
<area shape="rect" href="pomp_8h.html#a6a5fa3ea6a4ce20374a9d9d761f04c92" title=" " alt="" coords="239,5,381,32"/>
</map>
</div>

</div>
</div>
<a id="a5a3814da0f600c71a99fd3fe5ba215ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a3814da0f600c71a99fd3fe5ba215ca">&#9670;&nbsp;</a></span>LogitTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>P</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00014">14</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                             {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">double</span> *p;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(P = duplicate(AS_NUMERIC(P)));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  p = REAL(P);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  n = LENGTH(P);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, p++)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    *p = <a class="code" href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618">logit</a>(*p);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">return</span> P;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a4b9004ae67cdf750e5354cf295e91618"><div class="ttname"><a href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618">logit</a></div><div class="ttdeci">static R_INLINE double logit(double p)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00118">pomp.h:118</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph.png" border="0" usemap="#adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph" alt=""/></div>
<map name="adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph" id="adecls_8h_a5a3814da0f600c71a99fd3fe5ba215ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,125,32"/>
<area shape="rect" href="pomp_8h.html#a4b9004ae67cdf750e5354cf295e91618" title=" " alt="" coords="173,5,224,32"/>
</map>
</div>

</div>
</div>
<a id="a0537073d1cb88f92ea923a0c28d2ac9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0537073d1cb88f92ea923a0c28d2ac9d">&#9670;&nbsp;</a></span>logmeanexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP logmeanexp </td>
          <td>(</td>
          <td class="paramtype">const&#160;</td>
          <td class="paramname"><em>SEXP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const&#160;</td>
          <td class="paramname"><em>SEXP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="logmeanexp_8c_source.html#l00007">7</a> of file <a class="el" href="logmeanexp_8c_source.html">logmeanexp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                                {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordtype">int</span> j, n = LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="keywordtype">int</span> k = *INTEGER(Drop)-1; <span class="comment">// zero-based index</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">double</span> *x = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> m = R_NegInf;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> s = 0;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      m = (x[j] &gt; m) ? (<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] : m;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      s += expl((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] - m);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> (k &gt;= 0 &amp;&amp; k &lt; n) n--;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span> ScalarReal(m + log(s/n));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afbec5a723223278096829f0532d5dc3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbec5a723223278096829f0532d5dc3a">&#9670;&nbsp;</a></span>lookup_in_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP lookup_in_table </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00024">24</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                          {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> xdim[2], nvar;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> j, nt;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span> *tp, *xp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEXP Cnames, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  nt = LENGTH(t);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> tab = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(covar,&amp;nvar);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (nt &gt; 1) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    xdim[0] = nvar; xdim[1] = nt;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames,2);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(nvar));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    SET_NAMES(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">for</span> (j = 0, tp = REAL(t), xp = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>); j &lt; nt; j++, tp++, xp += nvar)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;tab,*tp,xp);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  UNPROTECT(3);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="alookup__table_8c_html_a036b9fb7cfc62e3984889f95024971a0"><div class="ttname"><a href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a></div><div class="ttdeci">void table_lookup(lookup_table_t *tab, double x, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00053">lookup_table.c:53</a></div></div>
<div class="ttc" id="alookup__table_8c_html_a1e57a24640cb0d9f6f8d55e02c3d553f"><div class="ttname"><a href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a></div><div class="ttdeci">lookup_table_t make_covariate_table(SEXP object, int *ncovar)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00011">lookup_table.c:11</a></div></div>
<div class="ttc" id="alookup__table_8c_html_aa7a80c78f9ef26859eea09b5299e702b"><div class="ttname"><a href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a></div><div class="ttdeci">SEXP get_covariate_names(SEXP object)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00007">lookup_table.c:7</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afbec5a723223278096829f0532d5dc3a_cgraph.png" border="0" usemap="#adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph" alt=""/></div>
<map name="adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph" id="adecls_8h_afbec5a723223278096829f0532d5dc3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,131,133"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="181,5,343,32"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="179,56,345,83"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="216,107,308,133"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="207,157,317,184"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="209,208,315,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afbec5a723223278096829f0532d5dc3a_icgraph.png" border="0" usemap="#adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph" alt=""/></div>
<map name="adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph" id="adecls_8h_afbec5a723223278096829f0532d5dc3a_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,281,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a8fc25ac8149dbd6da367aa01dd9ad9ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fc25ac8149dbd6da367aa01dd9ad9ed">&#9670;&nbsp;</a></span>make_covariate_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> make_covariate_table </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ncovar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00011">11</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                               {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> tab;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  dim = INTEGER(GET_DIM(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  *ncovar = tab.<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> = dim[0];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> = dim[1];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = 0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a> = *(INTEGER(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;order&quot;</span>))));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">return</span> tab;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
<div class="ttc" id="astructlookup__table__t_html_a5bc85f841e0c15e15a7b8b7e12172ea1"><div class="ttname"><a href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">lookup_table_t::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00022">pomp_defines.h:22</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a73816c282d64530aafb1dd154ee41f60"><div class="ttname"><a href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">lookup_table_t::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a83e4e0655a5836172df9d671ed4d726c"><div class="ttname"><a href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">lookup_table_t::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00023">pomp_defines.h:23</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a928f893d2851476723521ae3c7d29749"><div class="ttname"><a href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">lookup_table_t::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_aa071aabe5391f11c0d915907ad16dd28"><div class="ttname"><a href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">lookup_table_t::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00024">pomp_defines.h:24</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_afc0a89e59da489c4fd7fd4aca70c298d"><div class="ttname"><a href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">lookup_table_t::y</a></div><div class="ttdeci">double * y</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00025">pomp_defines.h:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph.png" border="0" usemap="#adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph" alt=""/></div>
<map name="adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph" id="adecls_8h_a8fc25ac8149dbd6da367aa01dd9ad9ed_icgraph">
<area shape="rect" title=" " alt="" coords="873,335,1040,361"/>
<area shape="rect" href="decls_8h.html#a983ad52a265f059c6e25be89cdf97fd7" title=" " alt="" coords="690,5,801,32"/>
<area shape="rect" href="decls_8h.html#ac1ec1439680776719b9b8b9ebdbf9a33" title=" " alt="" coords="690,56,801,83"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="529,195,599,221"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,321,108,348"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="511,487,617,513"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="695,259,795,285"/>
<area shape="rect" href="decls_8h.html#aa55c56601a4d47af6f8d162ff1aa9503" title=" " alt="" coords="690,309,801,336"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="683,208,807,235"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="696,411,795,437"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="695,461,796,488"/>
<area shape="rect" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a" title=" " alt="" coords="337,467,463,493"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="681,664,810,691"/>
<area shape="rect" href="decls_8h.html#aa9632871950917c7b954b1784b74ec78" title=" " alt="" coords="665,613,825,640"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="687,360,804,387"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="349,321,451,348"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,321,289,348"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="514,321,614,348"/>
<area shape="rect" href="decls_8h.html#a6b4fa54c658fe6c6677c51e8346d728c" title=" " alt="" coords="527,411,601,437"/>
<area shape="rect" href="decls_8h.html#a6ef1a476d6745db7455441c65c74fd61" title=" " alt="" coords="513,664,615,691"/>
</map>
</div>

</div>
</div>
<a id="a2f8f78d126b50ffa8da9b867053278df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f8f78d126b50ffa8da9b867053278df">&#9670;&nbsp;</a></span>nosort_resamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nosort_resamp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00025">25</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">double</span> du, u;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt; nw; j++) w[j] += w[j-1];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> (w[nw-1] &lt;= 0.0)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;systematic_resampling&#39;: non-positive sum of weights&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  du = w[nw-1] / ((double) np);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  u = -du*unif_rand();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">for</span> (i = 0, j = 0; j &lt; np; j++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    u += du;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// In the following line, the second test is needed to correct</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// the infamous Bug of St. Patrick, 2017-03-17.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">while</span> ((u &gt; w[i]) &amp;&amp; (i &lt; nw-1)) i++;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    p[j] = i;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (offset)                   <span class="comment">// add offset if needed</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; np; j++) p[j] += offset;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph.png" border="0" usemap="#adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph" alt=""/></div>
<map name="adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph" id="adecls_8h_a2f8f78d126b50ffa8da9b867053278df_icgraph">
<area shape="rect" title=" " alt="" coords="379,56,497,83"/>
<area shape="rect" href="decls_8h.html#abb9eda32aa6838894c1096d31d5672ad" title=" " alt="" coords="213,5,274,32"/>
<area shape="rect" href="decls_8h.html#a9f4822de0304baafeca236b97ecb216b" title=" " alt="" coords="156,56,331,83"/>
<area shape="rect" href="decls_8h.html#a1c47fabab25be7910ba58cc20426bf35" title=" " alt="" coords="207,107,279,133"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,56,108,83"/>
</map>
</div>

</div>
</div>
<a id="a80981cb1dec869d1c736129470da780f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80981cb1dec869d1c736129470da780f">&#9670;&nbsp;</a></span>num_euler_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_euler_steps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00317">317</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                                           {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// nstep will be the number of Euler steps to take in going from t1 to t2.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// note also that the stepsize changes.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// this choice is meant to be conservative</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// (i.e., so that the actual deltat does not exceed the specified deltat</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// by more than the relative tolerance &#39;tol&#39;)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// and to counteract roundoff error.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// It seems to work well, but is not guaranteed:</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// suggestions would be appreciated.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">if</span> (t1 &gt;= t2) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    *deltat = 0.0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    nstep = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t1+*deltat &gt;= t2) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    *deltat = t2-t1;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    nstep = 1;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    nstep = (int) ceil((t2-t1)/(*deltat)/(1+tol));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    *deltat = (t2-t1)/((<span class="keywordtype">double</span>) nstep);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">return</span> nstep;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a80981cb1dec869d1c736129470da780f_icgraph.png" border="0" usemap="#adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph" alt=""/></div>
<map name="adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph" id="adecls_8h_a80981cb1dec869d1c736129470da780f_icgraph">
<area shape="rect" title=" " alt="" coords="808,5,941,32"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="636,5,760,32"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="488,5,588,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a4e40667f6198be18fb99f8f07417da1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e40667f6198be18fb99f8f07417da1d">&#9670;&nbsp;</a></span>num_map_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_map_steps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00342">342</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                                        {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// nstep will be the number of discrete-time steps to take in going from t1 to t2.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  nstep = (int) floor((t2-t1)/deltat/(1-tol));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">return</span> (nstep &gt; 0) ? nstep : 0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph.png" border="0" usemap="#adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph" alt=""/></div>
<map name="adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph" id="adecls_8h_a4e40667f6198be18fb99f8f07417da1d_icgraph">
<area shape="rect" title=" " alt="" coords="860,56,989,83"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="663,5,787,32"/>
<area shape="rect" href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6" title=" " alt="" coords="637,56,812,83"/>
<area shape="rect" href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b" title=" " alt="" coords="653,107,796,133"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="489,5,589,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="488,81,589,108"/>
</map>
</div>

</div>
</div>
<a id="ac91f1740c904de28f294b3e9dc2bc812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac91f1740c904de28f294b3e9dc2bc812">&#9670;&nbsp;</a></span>periodic_bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP periodic_bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00085">85</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                         {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  SEXP y, xr;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">double</span> pd = NUMERIC_VALUE(period);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> *xrd, *ydata, *val;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  xrd = REAL(xr);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  ydata = REAL(y);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  val = (<span class="keywordtype">double</span> *) R_alloc(nb,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>(xrd[j],pd,deg,nb,d,val);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nb; k++) ydata[j+nx*k] = val[k];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">return</span> y;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_a2f083190a387483412260be17208ee1e"><div class="ttname"><a href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a></div><div class="ttdeci">void periodic_bspline_basis_eval_deriv(double x, double period, int degree, int nbasis, int deriv, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00122">bspline.c:122</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph.png" border="0" usemap="#adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph" alt=""/></div>
<map name="adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph" id="adecls_8h_ac91f1740c904de28f294b3e9dc2bc812_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,175,39"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="223,5,392,47"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="440,13,544,39"/>
</map>
</div>

</div>
</div>
<a id="af3e746ce7f69a999ad8ff316f10fd1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3e746ce7f69a999ad8ff316f10fd1d2">&#9670;&nbsp;</a></span>periodic_bspline_basis_eval_deriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void periodic_bspline_basis_eval_deriv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00122">122</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">int</span> nknots = nbasis+2*degree+1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">int</span> shift = (degree-1)/2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">double</span> *knots = NULL, *yy = NULL;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">double</span> dx;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (period &lt;= 0.0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have period &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (nbasis &lt;= 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (degree &lt; 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (nbasis &lt; degree) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt;= degree&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">if</span> (deriv &lt; 0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  knots = (<span class="keywordtype">double</span> *) R_Calloc(nknots+degree+1,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  yy = (<span class="keywordtype">double</span> *) R_Calloc(nknots,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  dx = period/((double) nbasis);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> (k = -degree; k &lt;= nbasis+degree; k++) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    knots[degree+k] = k*dx;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  x = fmod(x,period);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (x &lt; 0.0) x += period;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nknots; k++) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="bspline_8c.html#a2237300eb36fec7026017251da56382e">bspline_eval</a>(&amp;yy[k],&amp;x,1,k,degree,deriv,knots);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; degree; k++) yy[k] += yy[nbasis+k];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nbasis; k++) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    j = (shift+k)%nbasis;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    y[k] = yy[j];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  R_Free(yy); R_Free(knots);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph.png" border="0" usemap="#adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph" alt=""/></div>
<map name="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph" id="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,47"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="223,13,327,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph.png" border="0" usemap="#adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph" alt=""/></div>
<map name="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph" id="adecls_8h_af3e746ce7f69a999ad8ff316f10fd1d2_icgraph">
<area shape="rect" title=" " alt="" coords="223,23,392,65"/>
<area shape="rect" href="bspline_8c.html#a5300e64c53a9cbb6aa52d351bd338883" title=" " alt="" coords="5,5,175,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="39,56,141,83"/>
</map>
</div>

</div>
</div>
<a id="abb9eda32aa6838894c1096d31d5672ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9eda32aa6838894c1096d31d5672ad">&#9670;&nbsp;</a></span>pfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>predmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>predvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>filtmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>trackancestry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>doparRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>wave</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfilter_8c_source.html#l00016">16</a> of file <a class="el" href="pfilter_8c_source.html">pfilter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  SEXP pm = R_NilValue, pv = R_NilValue, fm = R_NilValue;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  SEXP anc = R_NilValue, wmean = R_NilValue;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  SEXP ess, loglik;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  SEXP newstates = R_NilValue, newparams = R_NilValue;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP retval, retvalnames;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[2] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">double</span> *xw = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws, maxw, sum;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> *xanc = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP dimX, dimP, newdim, Xnames, Pnames;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> *dim, np;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = 0, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> do_pm, do_pv, do_fm, do_ta, do_pr, do_wave, all_fail = 0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(dimX = GET_DIM(x));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  dim = INTEGER(dimX);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  PROTECT(dimP = GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  dim = INTEGER(dimP);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % dim[1] != 0)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be a multiple of ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(weights = duplicate(weights));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  np = *(INTEGER(AS_INTEGER(Np))); <span class="comment">// number of particles to resample</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  do_pm = *(LOGICAL(AS_LOGICAL(predmean))); <span class="comment">// calculate prediction means?</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  do_pv = *(LOGICAL(AS_LOGICAL(predvar)));  <span class="comment">// calculate prediction variances?</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  do_fm = *(LOGICAL(AS_LOGICAL(filtmean))); <span class="comment">// calculate filtering means?</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  do_ta = *(LOGICAL(AS_LOGICAL(trackancestry))); <span class="comment">// track ancestry?</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Do we need to do parameter resampling?</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  do_pr = *(LOGICAL(AS_LOGICAL(doparRS)));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// Do we need to take a weighted average over the parameters?</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  do_wave = *(LOGICAL(AS_LOGICAL(wave)));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (dim[1] != <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be equal to ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// log likelihood</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  xw = REAL(weights);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// check and normalize the weights</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">for</span> (k = 0, maxw = R_NegInf; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (ISNAN(xw[k]) || xw[k] == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      PROTECT(retval = NEW_INTEGER(1)); nprotect++;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      *INTEGER(retval) = k+1; <span class="comment">// return the index of the peccant particle</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      UNPROTECT(nprotect);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (maxw &lt; xw[k]) maxw = xw[k];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (maxw == R_NegInf) all_fail = 1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    *(REAL(loglik)) = R_NegInf;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    *(REAL(ess)) = 0;             <span class="comment">// zero effective sample size</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (k = 0, w = 0, ws = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      xw[k] = exp(xw[k]-maxw);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (xw[k] != 0) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        w += xw[k];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        ws += xw[k]*xw[k];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    *(REAL(loglik)) = maxw + log(w/((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)); <span class="comment">// mean of weights is likelihood</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    *(REAL(ess)) = w*w/ws;      <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    PROTECT(pm = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    PROTECT(pv = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    PROTECT(fm = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    PROTECT(anc = NEW_INTEGER(np)); nprotect++;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    xanc = INTEGER(anc);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    PROTECT(wmean = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)); nprotect++;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    SET_NAMES(wmean,Pnames);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">double</span> *tmp = (do_pv) ? REAL(pv) : 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc">pred_mean_var</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,do_pv,REAL(x),REAL(pm),tmp);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">//  compute filter mean</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6">filt_mean</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,all_fail,w,xw,REAL(x),REAL(fm));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// compute weighted average of parameters</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (all_fail)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;%s %s&quot;</span>,<span class="stringliteral">&quot;filtering failure at last filter iteration:&quot;</span>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;           <span class="stringliteral">&quot;using unweighted mean for point estimate.&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">double</span> *xwm = REAL(wmean);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, xwm++) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">double</span> *xp = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)+j;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (all_fail) {           <span class="comment">// unweighted average</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) sum += *xp;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        *xwm = sum/((<span class="keywordtype">long</span> double) <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordflow">if</span> (xw[k]!=0) sum += xw[k]*(*xp);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        *xwm = sum/w;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (!all_fail) { <span class="comment">// resample the particles unless we have filtering failure</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">double</span> *ss = 0, *st = 0, *ps = 0, *pt = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// create storage for new states</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    xdim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; xdim[1] = np;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    PROTECT(newstates = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newstates,Xnames,2);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newstates,dimnm,2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ss = REAL(x);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    st = REAL(newstates);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      xdim[0] = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; xdim[1] = np;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      PROTECT(newparams = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newparams,Pnames,2);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newparams,dimnm,2);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      pt = REAL(newparams);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// resample</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(weights),np,sample,0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordtype">int</span> sp = sample[k];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordtype">double</span> *xx, *xp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        *st = *xx;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">for</span> (j = 0, xp = ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, pt++, xp++)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          *pt = *xp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">if</span> (do_ta) xanc[k] = sp+1;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// don&#39;t resample: just drop 3rd dimension in x prior to return</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    PROTECT(newdim = NEW_INTEGER(2)); nprotect++;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    dim = INTEGER(newdim);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    dim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    SET_DIM(x,newdim);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,Xnames,2);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(x,dimnm,2);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (do_ta)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) xanc[k] = k+1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  PROTECT(retval = NEW_LIST(9));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(9));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  nprotect += 2;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;pm&quot;</span>));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  SET_STRING_ELT(retvalnames,5,mkChar(<span class="stringliteral">&quot;pv&quot;</span>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  SET_STRING_ELT(retvalnames,6,mkChar(<span class="stringliteral">&quot;fm&quot;</span>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  SET_STRING_ELT(retvalnames,7,mkChar(<span class="stringliteral">&quot;ancestry&quot;</span>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  SET_STRING_ELT(retvalnames,8,mkChar(<span class="stringliteral">&quot;wmean&quot;</span>));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  SET_ELEMENT(retval,0,loglik);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  SET_ELEMENT(retval,1,ess);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    SET_ELEMENT(retval,2,x);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    SET_ELEMENT(retval,2,newstates);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (all_fail || !do_pr) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    SET_ELEMENT(retval,3,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    SET_ELEMENT(retval,3,newparams);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (do_pm) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    SET_ELEMENT(retval,4,pm);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    SET_ELEMENT(retval,5,pv);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    SET_ELEMENT(retval,6,fm);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    SET_ELEMENT(retval,7,anc);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    SET_ELEMENT(retval,8,wmean);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a2f8f78d126b50ffa8da9b867053278df"><div class="ttname"><a href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int, double *, int, int *, int)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
<div class="ttc" id="apfilter_8c_html_a5a2b1c00965b1b0dc8e1c931ceede8d6"><div class="ttname"><a href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6">filt_mean</a></div><div class="ttdeci">static void filt_mean(int, int, int, long double, const double *, const double *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="pfilter_8c_source.html#l00294">pfilter.c:294</a></div></div>
<div class="ttc" id="apfilter_8c_html_a753cef4b66fbcd5c1df4a4cb94e04edc"><div class="ttname"><a href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc">pred_mean_var</a></div><div class="ttdeci">static void pred_mean_var(int, int, int, const double *, double *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="pfilter_8c_source.html#l00266">pfilter.c:266</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph.png" border="0" usemap="#adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph" alt=""/></div>
<map name="adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph" id="adecls_8h_abb9eda32aa6838894c1096d31d5672ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,67,184"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="133,5,219,32"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="285,31,396,57"/>
<area shape="rect" href="pfilter_8c.html#a5a2b1c00965b1b0dc8e1c931ceede8d6" title=" " alt="" coords="134,107,218,133"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="122,157,230,184"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="130,208,222,235"/>
<area shape="rect" href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df" title=" " alt="" coords="117,259,235,285"/>
<area shape="rect" href="pfilter_8c.html#a753cef4b66fbcd5c1df4a4cb94e04edc" title=" " alt="" coords="115,309,237,336"/>
</map>
</div>

</div>
</div>
<a id="aa9632871950917c7b954b1784b74ec78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9632871950917c7b954b1784b74ec78">&#9670;&nbsp;</a></span>pomp_desolve_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_desolve_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00156">156</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                                       {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  SEXP pompfun, ob;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// extract user-defined skeleton function</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>)));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = <a class="code" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = <a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>) = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code" href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>)))) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_setup&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a0e74f51a4d7e89b6a52cc7d78cc8f5ca"><div class="ttname"><a href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a></div><div class="ttdeci">#define RFUN(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00153">trajectory.c:153</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a852c03f3cb2e07fb73c219e4f9a7bf9f"><div class="ttname"><a href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a></div><div class="ttdeci">#define COMMON(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00152">trajectory.c:152</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a8ad5c5cfa2eab8626017e1b9ed0a3f7c"><div class="ttname"><a href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a></div><div class="ttdeci">SEXP cindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00146">trajectory.c:146</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a980f881d230271d4e5084135e85a521b"><div class="ttname"><a href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a></div><div class="ttdeci">pomp_skeleton * fun</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00147">trajectory.c:147</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab488f90e51bbc91068510577c6d742db"><div class="ttname"><a href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a></div><div class="ttdeci">SEXP sindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00144">trajectory.c:144</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab8af0f07388320ad03576d4d4c0c1bc1"><div class="ttname"><a href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a></div><div class="ttdeci">SEXP pindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00145">trajectory.c:145</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac39df6bb0605d87c14d69c0767c29b92"><div class="ttname"><a href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a></div><div class="ttdeci">#define NAT(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00154">trajectory.c:154</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac8d8b2659244f8b65022c653e1604b05"><div class="ttname"><a href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a></div><div class="ttdeci">SEXP object</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00127">trajectory.c:127</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa9632871950917c7b954b1784b74ec78_cgraph.png" border="0" usemap="#adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph" alt=""/></div>
<map name="adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph" id="adecls_8h_aa9632871950917c7b954b1784b74ec78_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,165,108"/>
<area shape="rect" href="decls_8h.html#ad9390ea094fe7c28762eb6ac23f1c144" title=" " alt="" coords="239,5,354,32"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="215,56,378,83"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="213,107,380,133"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="225,157,368,184"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="428,132,548,159"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="437,183,539,209"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="596,183,703,209"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="751,183,868,209"/>
</map>
</div>

</div>
</div>
<a id="abc1f879a376bbbef32d6d8fde12078ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1f879a376bbbef32d6d8fde12078ed">&#9670;&nbsp;</a></span>pomp_desolve_takedown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_desolve_takedown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00292">292</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                  {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = R_NilValue;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = R_NilValue;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = R_NilValue;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = R_NilValue;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = R_NilValue;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>) = 0;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_takedown&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada19523cc1edc44a799fce734f25c934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada19523cc1edc44a799fce734f25c934">&#9670;&nbsp;</a></span>pomp_fun_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_fun_handler </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>O</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00030">30</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  SEXP f = R_NilValue;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  SEXP sidx, pidx, oidx, cidx;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  *<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = *(INTEGER(GET_SLOT(pfun,install(<span class="stringliteral">&quot;mode&quot;</span>))));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">switch</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:                    <span class="comment">// R function</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;R.fun&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:  <span class="comment">// native code</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (*(LOGICAL(gnsi))) {     <span class="comment">// get native symbol information?</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      SEXP nf, pack;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      PROTECT(nf = GET_SLOT(pfun,install(<span class="stringliteral">&quot;native.fun&quot;</span>)));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      PROTECT(pack = GET_SLOT(pfun,install(<span class="stringliteral">&quot;PACKAGE&quot;</span>)));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span> (LENGTH(pack) &lt; 1) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        PROTECT(pack = mkString(<span class="stringliteral">&quot;&quot;</span>)); nprotect++; <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        SEXP nsi;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        PROTECT(nsi = eval(PROTECT(lang3(install(<span class="stringliteral">&quot;getNativeSymbolInfo&quot;</span>),nf,pack)),R_BaseEnv));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        PROTECT(f = <a class="code" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f">getListElement</a>(nsi,<span class="stringliteral">&quot;address&quot;</span>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        nprotect += 3;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, *pkg;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        fname = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(nf,0));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        DL_FUNC <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = R_GetCCallable(pkg,fname);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        PROTECT(f = R_MakeExternalPtrFn(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,R_NilValue,R_NilValue)); nprotect++;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      SET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>),f);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">if</span> (S != NA_STRING) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        PROTECT(sidx = <a class="code" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(S,pfun,<span class="stringliteral">&quot;statenames&quot;</span>,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>),sidx);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (P != NA_STRING) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        PROTECT(pidx = <a class="code" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(P,pfun,<span class="stringliteral">&quot;paramnames&quot;</span>,<span class="stringliteral">&quot;parameters&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>),pidx);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span> (O != NA_STRING) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        PROTECT(oidx = <a class="code" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(O,pfun,<span class="stringliteral">&quot;obsnames&quot;</span>,<span class="stringliteral">&quot;observables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>),oidx);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">if</span> (C != NA_STRING) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        PROTECT(cidx = <a class="code" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a>(C,pfun,<span class="stringliteral">&quot;covarnames&quot;</span>,<span class="stringliteral">&quot;covariates&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>),cidx);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    } <span class="keywordflow">else</span> {                    <span class="comment">// native symbol info is stored</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    PROTECT(f = R_NilValue); nprotect++;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    *<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="ttc" id="apomp__fun_8c_html_ad3048ea27b0cd1af35870f0b0db5228e"><div class="ttname"><a href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e">name_index</a></div><div class="ttdeci">static R_INLINE SEXP name_index(SEXP provided, SEXP object, const char *slot, const char *humanreadable)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00010">pomp_fun.c:10</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ada19523cc1edc44a799fce734f25c934_cgraph.png" border="0" usemap="#adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph" alt=""/></div>
<map name="adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph" id="adecls_8h_ada19523cc1edc44a799fce734f25c934_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="196,5,316,32"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="205,56,307,83"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="364,56,471,83"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="519,56,636,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ada19523cc1edc44a799fce734f25c934_icgraph.png" border="0" usemap="#adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph" alt=""/></div>
<map name="adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph" id="adecls_8h_ada19523cc1edc44a799fce734f25c934_icgraph">
<area shape="rect" title=" " alt="" coords="851,385,993,412"/>
<area shape="rect" href="decls_8h.html#a983ad52a265f059c6e25be89cdf97fd7" title=" " alt="" coords="667,5,778,32"/>
<area shape="rect" href="decls_8h.html#a2d3d47b7ef5f3a691582c1000108cdb7" title=" " alt="" coords="681,56,764,83"/>
<area shape="rect" href="decls_8h.html#ac1ec1439680776719b9b8b9ebdbf9a33" title=" " alt="" coords="667,107,778,133"/>
<area shape="rect" href="decls_8h.html#ab6ee70ea223bd1cd7359810d1e0c8a49" title=" " alt="" coords="673,157,772,184"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="506,639,577,665"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,321,108,348"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="488,436,595,463"/>
<area shape="rect" href="decls_8h.html#ab82bdfc4b0763ddd79d74e02f60e790a" title=" " alt="" coords="683,360,763,387"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="673,411,773,437"/>
<area shape="rect" href="decls_8h.html#aa55c56601a4d47af6f8d162ff1aa9503" title=" " alt="" coords="667,461,778,488"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="661,259,785,285"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="673,563,772,589"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="672,613,773,640"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="658,765,787,792"/>
<area shape="rect" href="decls_8h.html#aa9632871950917c7b954b1784b74ec78" title=" " alt="" coords="643,715,803,741"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="664,309,781,336"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,392,440,419"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,347,289,373"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="491,309,591,336"/>
<area shape="rect" href="decls_8h.html#a6b4fa54c658fe6c6677c51e8346d728c" title=" " alt="" coords="504,563,579,589"/>
<area shape="rect" href="decls_8h.html#a6ef1a476d6745db7455441c65c74fd61" title=" " alt="" coords="490,765,593,792"/>
</map>
</div>

</div>
</div>
<a id="a5c9d4b991e534272c7dc4a6602be32ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9d4b991e534272c7dc4a6602be32ec">&#9670;&nbsp;</a></span>pomp_vf_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pomp_vf_eval </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>neq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ydot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>yout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00260">260</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:            <span class="comment">// R function</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="decls_8h.html#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a>(ydot,t,y,REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>),<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>),</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      &amp;<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:      <span class="comment">// native code</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="decls_8h.html#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a>(ydot,t,y,REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>)),INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>)),INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>)),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      &amp;<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>),<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_vf_eval&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="adecls_8h_html_a02d94e3819f568bb29c6d5e77f02a3d8"><div class="ttname"><a href="decls_8h.html#a02d94e3819f568bb29c6d5e77f02a3d8">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *, double *, double *, double *, SEXP, SEXP, SEXP, int, int, int, int, int, int, int, lookup_table_t *, double *)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00093">skeleton.c:94</a></div></div>
<div class="ttc" id="adecls_8h_html_a87734543f5fc40ed123f9f1664e3b7a7"><div class="ttname"><a href="decls_8h.html#a87734543f5fc40ed123f9f1664e3b7a7">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *, double *, double *, double *, int, int, int, int, int, int, int, int *, int *, int *, lookup_table_t *, pomp_skeleton *, SEXP, double *)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00245">skeleton.c:245</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph.png" border="0" usemap="#adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph" alt=""/></div>
<map name="adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph" id="adecls_8h_a5c9d4b991e534272c7dc4a6602be32ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,120,57"/>
<area shape="rect" href="decls_8h.html#a87734543f5fc40ed123f9f1664e3b7a7" title=" " alt="" coords="168,5,328,32"/>
<area shape="rect" href="decls_8h.html#a02d94e3819f568bb29c6d5e77f02a3d8" title=" " alt="" coords="184,56,312,83"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="376,5,483,32"/>
<area shape="rect" href="skeleton_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="389,56,469,83"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="531,132,648,159"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="376,157,483,184"/>
</map>
</div>

</div>
</div>
<a id="ab87d831ce816f581c1145704489ae791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87d831ce816f581c1145704489ae791">&#9670;&nbsp;</a></span>probe_acf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_acf </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00100">100</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                              {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  SEXP ans, ans_names;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> nlag, correlation, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, n;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> j, k, l;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> *p, *p1, *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> *lag;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  nlag = LENGTH(lags);                        <span class="comment">// number of lags</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  lag = INTEGER(lags);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = INTEGER(GET_DIM(x))[0];       <span class="comment">// number of variables</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  n = INTEGER(GET_DIM(x))[1];               <span class="comment">// number of observations</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  PROTECT(ans = NEW_NUMERIC(nlag*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(REAL(ans),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,lag,nlag);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    l = 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = (<span class="keywordtype">double</span> *) R_alloc(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,&amp;l,1); <span class="comment">// compute lag-0 covariance</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (j = 0, p = REAL(ans), p1 = <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, p1++)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, p++)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        *p /= *p1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  PROTECT(ans_names = NEW_STRING(nlag*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">for</span> (j = 0, l = 0; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, l++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;acf[%d]&quot;</span>,lag[k]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      SET_STRING_ELT(ans_names,l,mkChar(tmp));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="aprobe__acf_8c_html_a5d99d0781d78dd79d7516d73c89f62ea"><div class="ttname"><a href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a></div><div class="ttdeci">static void pomp_acf_compute(double *acf, double *x, int n, int nvars, int *lags, int nlag)</div><div class="ttdef"><b>Definition:</b> <a href="probe__acf_8c_source.html#l00011">probe_acf.c:11</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab87d831ce816f581c1145704489ae791_cgraph.png" border="0" usemap="#adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph" alt=""/></div>
<map name="adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph" id="adecls_8h_ab87d831ce816f581c1145704489ae791_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,92,32"/>
<area shape="rect" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea" title=" " alt="" coords="140,5,291,32"/>
</map>
</div>

</div>
</div>
<a id="aa00b01cfe308e46e0f8a0e830f363a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa00b01cfe308e46e0f8a0e830f363a9a">&#9670;&nbsp;</a></span>probe_ccf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_ccf </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00145">145</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                      {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  SEXP ans, ans_names;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[2], xx, *p;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">int</span> nlag, n, correlation;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  nlag = LENGTH(lags);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  n = LENGTH(x);                <span class="comment">// n = # of observations</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (n != LENGTH(y)) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;x&#39; and &#39;y&#39; must have equal lengths&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = duplicate(AS_NUMERIC(y)));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  PROTECT(ans = NEW_NUMERIC(nlag));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727">pomp_ccf_compute</a>(REAL(ans),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,INTEGER(lags),nlag);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    k = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(&amp;<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0],REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of x</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea">pomp_acf_compute</a>(&amp;<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1],REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of y</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    xx = sqrt(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0]*<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1]);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">for</span> (k = 0, p = REAL(ans); k &lt; nlag; k++, p++) *p /= xx; <span class="comment">// convert to correlation</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  PROTECT(ans_names = NEW_STRING(nlag));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;ccf[%d]&quot;</span>,INTEGER(lags)[k]);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    SET_STRING_ELT(ans_names,k,mkChar(tmp));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="aprobe__acf_8c_html_ae6e4e25744357eec0f8ca5705bea9727"><div class="ttname"><a href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727">pomp_ccf_compute</a></div><div class="ttdeci">static void pomp_ccf_compute(double *ccf, double *x, double *y, int n, int *lags, int nlag)</div><div class="ttdef"><b>Definition:</b> <a href="probe__acf_8c_source.html#l00047">probe_acf.c:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph.png" border="0" usemap="#adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph" alt=""/></div>
<map name="adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph" id="adecls_8h_aa00b01cfe308e46e0f8a0e830f363a9a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,91,57"/>
<area shape="rect" href="probe__acf_8c.html#a5d99d0781d78dd79d7516d73c89f62ea" title=" " alt="" coords="139,5,289,32"/>
<area shape="rect" href="probe__acf_8c.html#ae6e4e25744357eec0f8ca5705bea9727" title=" " alt="" coords="139,56,289,83"/>
</map>
</div>

</div>
</div>
<a id="a9d070d973eba13345ec32d0dd772520f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d070d973eba13345ec32d0dd772520f">&#9670;&nbsp;</a></span>probe_marginal_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00010">10</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                                                            {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  SEXP z, mm, <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, retval, retvalnames;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> n, nx, np, df, dim[2];</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  np = *(INTEGER(AS_INTEGER(order))); <span class="comment">// order of polynomial regression</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  n = LENGTH(ref);            <span class="comment">// n = number of observations</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  nx = n - df;                <span class="comment">// nx = rows in model matrix</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  dim[0] = nx; dim[1] = np;       <span class="comment">// dimensions of model matrix</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (nx &lt; 1) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have diff &lt; number of observations&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(z = duplicate(AS_NUMERIC(ref)));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(mm = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = NEW_NUMERIC(np));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PROTECT(pivot = NEW_INTEGER(np));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  PROTECT(retval = NEW_LIST(3));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(3));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;mm&quot;</span>));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;tau&quot;</span>));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;pivot&quot;</span>));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  SET_ELEMENT(retval,0,mm);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  SET_ELEMENT(retval,1,<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  SET_ELEMENT(retval,2,pivot);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156">order_reg_model_matrix</a>(REAL(z),REAL(mm),REAL(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="ttc" id="aprobe__marginal_8c_html_a9accae76d6ed9147d0db36478294f156"><div class="ttname"><a href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156">order_reg_model_matrix</a></div><div class="ttdeci">static void order_reg_model_matrix(double *z, double *X, double *tau, int *pivot, int n, int np, int diff)</div><div class="ttdef"><b>Definition:</b> <a href="probe__marginal_8c_source.html#l00078">probe_marginal.c:78</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph.png" border="0" usemap="#adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph" alt=""/></div>
<map name="adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph" id="adecls_8h_a9d070d973eba13345ec32d0dd772520f_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,172,57"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="265,5,357,32"/>
<area shape="rect" href="probe__marginal_8c.html#a9accae76d6ed9147d0db36478294f156" title=" " alt="" coords="220,56,403,83"/>
<area shape="rect" href="pomp__mat_8h.html#a305b5b8bb23bc880b442f68dc1219ed6" title=" " alt="" coords="451,56,529,83"/>
</map>
</div>

</div>
</div>
<a id="afac769062b9d41abb5d572eeaf6cf05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac769062b9d41abb5d572eeaf6cf05b">&#9670;&nbsp;</a></span>probe_marginal_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_solve </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>setup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00043">43</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                                          {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, mm, <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, beta, beta_names;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> n, nx, np, df;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  n = LENGTH(x);              <span class="comment">// n = number of observations</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// unpack the setup information</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  PROTECT(mm = VECTOR_ELT(setup,0));    <span class="comment">//  QR-decomposed model matrix</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = VECTOR_ELT(setup,1));   <span class="comment">// diagonals</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  PROTECT(pivot = VECTOR_ELT(setup,2)); <span class="comment">// pivots</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  nx = INTEGER(GET_DIM(mm))[0]; <span class="comment">// nx = number of rows in model matrix</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  np = INTEGER(GET_DIM(mm))[1]; <span class="comment">// np = order of polynomial</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (n-df != nx) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;ref&#39; must equal length of data&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  PROTECT(beta = NEW_NUMERIC(np));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PROTECT(beta_names = NEW_STRING(np));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; np; i++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;marg.%d&quot;</span>,i+1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    SET_STRING_ELT(beta_names,i,mkChar(tmp));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  SET_NAMES(beta,beta_names);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1">order_reg_solve</a>(REAL(beta),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(mm),REAL(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span>(beta);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="ttc" id="aprobe__marginal_8c_html_ab7ed44d923122eec45887a267060c3e1"><div class="ttname"><a href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1">order_reg_solve</a></div><div class="ttdeci">static void order_reg_solve(double *beta, double *x, double *mm, double *tau, int *pivot, int n, int np, int diff)</div><div class="ttdef"><b>Definition:</b> <a href="probe__marginal_8c_source.html#l00117">probe_marginal.c:117</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph.png" border="0" usemap="#adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph" alt=""/></div>
<map name="adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph" id="adecls_8h_afac769062b9d41abb5d572eeaf6cf05b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,172,57"/>
<area shape="rect" href="probe__marginal_8c.html#ab7ed44d923122eec45887a267060c3e1" title=" " alt="" coords="220,31,347,57"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="395,5,527,32"/>
<area shape="rect" href="pomp__mat_8h.html#a595e9be65aee622370178eb5a49f85c2" title=" " alt="" coords="413,56,508,83"/>
</map>
</div>

</div>
</div>
<a id="aac7d9cf2e04e141bce1bdfa71f9c576b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac7d9cf2e04e141bce1bdfa71f9c576b">&#9670;&nbsp;</a></span>probe_nlar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_nlar </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>powers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__nlar_8c_source.html#l00009">9</a> of file <a class="el" href="probe__nlar_8c_source.html">probe_nlar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                                 {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  SEXP y, beta, beta_names;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> n, nterms;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">double</span> *mm;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  n = LENGTH(x);                <span class="comment">// n = # of observations</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  nterms = LENGTH(lags);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(y = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  PROTECT(beta = NEW_NUMERIC(nterms));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  mm = (<span class="keywordtype">double</span> *) R_alloc(n*nterms,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">// storage for the model matrix</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c">poly_nlar_fit</a>(REAL(beta),REAL(y),n,nterms,INTEGER(lags),INTEGER(powers),mm);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PROTECT(beta_names = NEW_STRING(nterms));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nterms; k++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;nlar.%d^%d&quot;</span>,INTEGER(lags)[k],INTEGER(powers)[k]);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    SET_STRING_ELT(beta_names,k,mkChar(tmp));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SET_NAMES(beta,beta_names);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  UNPROTECT(3);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">return</span> beta;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
<div class="ttc" id="aprobe__nlar_8c_html_afd315040fac0de8def98fd667a0e440c"><div class="ttname"><a href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c">poly_nlar_fit</a></div><div class="ttdeci">static void poly_nlar_fit(double *beta, double *y, int n, int nterms, int *lag, int *power, double *X)</div><div class="ttdef"><b>Definition:</b> <a href="probe__nlar_8c_source.html#l00039">probe_nlar.c:39</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph.png" border="0" usemap="#adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph" alt=""/></div>
<map name="adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph" id="adecls_8h_aac7d9cf2e04e141bce1bdfa71f9c576b_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,96,83"/>
<area shape="rect" href="probe__nlar_8c.html#afd315040fac0de8def98fd667a0e440c" title=" " alt="" coords="144,56,247,83"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="295,5,427,32"/>
<area shape="rect" href="pomp__mat_8h.html#a305b5b8bb23bc880b442f68dc1219ed6" title=" " alt="" coords="321,56,400,83"/>
<area shape="rect" href="pomp__mat_8h.html#a595e9be65aee622370178eb5a49f85c2" title=" " alt="" coords="313,107,408,133"/>
</map>
</div>

</div>
</div>
<a id="a3d15947a5f8c829a5672f83b2246d7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d15947a5f8c829a5672f83b2246d7b8">&#9670;&nbsp;</a></span>R_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00103">103</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                                            {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> k, nval, ns, np, nt;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP ans;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  PROTECT(n = AS_INTEGER(n)); nval = INTEGER(n)[0];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  PROTECT(ans = NEW_NUMERIC(nval)); <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(ans);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k] = <a class="code" href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5">rbetabinom</a>(S[k%ns],P[k%np],T[k%nt]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a27ce90ca6f901016f2745cd1408cbde5"><div class="ttname"><a href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5">rbetabinom</a></div><div class="ttdeci">static R_INLINE double rbetabinom(double size, double prob, double theta)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00285">pomp.h:286</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph.png" border="0" usemap="#adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph" alt=""/></div>
<map name="adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph" id="adecls_8h_a3d15947a5f8c829a5672f83b2246d7b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="pomp_8h.html#a27ce90ca6f901016f2745cd1408cbde5" title=" " alt="" coords="164,5,261,32"/>
</map>
</div>

</div>
</div>
<a id="a6133e3ef45a5d9fe3deab72750062df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6133e3ef45a5d9fe3deab72750062df9">&#9670;&nbsp;</a></span>R_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00023">23</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                                                  {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> dim[2];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP x, nm;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  PROTECT(n = AS_INTEGER(n));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  PROTECT(size = AS_NUMERIC(size));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  PROTECT(rate = AS_NUMERIC(rate));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  dim[0] = ntrans;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  dim[1] = *INTEGER(n);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">if</span> (dim[1] == NA_INTEGER || dim[1] &lt; 0)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: &#39;n&#39; must be a non-negative integer.&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  PROTECT(x = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,dim));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(nm = GET_NAMES(rate));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(x,nm,2);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372">reulermultinom_multi</a>(dim[0],dim[1],REAL(size),REAL(rate),REAL(deltat),REAL(x));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="adistributions_8c_html_a535016daa0c6d33c1868cc3eace73372"><div class="ttname"><a href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372">reulermultinom_multi</a></div><div class="ttdeci">static void reulermultinom_multi(int m, int n, double *size, double *rate, double *deltat, double *trans)</div><div class="ttdef"><b>Definition:</b> <a href="distributions_8c_source.html#l00007">distributions.c:7</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph.png" border="0" usemap="#adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph" alt=""/></div>
<map name="adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph" id="adecls_8h_a6133e3ef45a5d9fe3deab72750062df9_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,145,83"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="229,5,321,32"/>
<area shape="rect" href="distributions_8c.html#a535016daa0c6d33c1868cc3eace73372" title=" " alt="" coords="193,56,357,83"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="220,107,331,133"/>
<area shape="rect" href="pomp_8h.html#af728af2cd3b4be45164906d02a3206a9" title=" " alt="" coords="405,56,528,83"/>
</map>
</div>

</div>
</div>
<a id="a05f8691fcce63ae69c6eb740a5e39f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05f8691fcce63ae69c6eb740a5e39f41">&#9670;&nbsp;</a></span>R_GammaWN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_GammaWN </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00077">77</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                 {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> k, nval, nsig, ndt;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">double</span> *x, *sig, *dt;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  SEXP ans;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  PROTECT(n = AS_INTEGER(n));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  nval = INTEGER(n)[0];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  nsig = LENGTH(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  sig = REAL(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  ndt = LENGTH(deltat);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  dt = REAL(deltat);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  PROTECT(ans = NEW_NUMERIC(nval));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  x = REAL(ans);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    x[k] = <a class="code" href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e">rgammawn</a>(sig[k%nsig],dt[k%ndt]);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a52cad6bd7c9be6be2215659798114e0e"><div class="ttname"><a href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e">rgammawn</a></div><div class="ttdeci">static R_INLINE double rgammawn(double sigma, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00128">pomp.h:129</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph.png" border="0" usemap="#adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph" alt=""/></div>
<map name="adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph" id="adecls_8h_a05f8691fcce63ae69c6eb740a5e39f41_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,119,32"/>
<area shape="rect" href="pomp_8h.html#a52cad6bd7c9be6be2215659798114e0e" title=" " alt="" coords="167,5,263,32"/>
</map>
</div>

</div>
</div>
<a id="a632ad1476e98dfe96ef9ee0e7f939b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a632ad1476e98dfe96ef9ee0e7f939b45">&#9670;&nbsp;</a></span>R_init_pomp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void R_init_pomp </td>
          <td>(</td>
          <td class="paramtype">DllInfo *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00053">53</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                 {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// C functions provided for users</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;bspline_basis_eval_deriv&quot;</span>,(DL_FUNC) &amp;<a class="code" href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c">bspline_basis_eval_deriv</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;periodic_bspline_basis_eval_deriv&quot;</span>,(DL_FUNC) &amp;<a class="code" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a0f11ca97854cd188080da40020f738eb">get_userdata</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_int&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#abeacd76a8b2af7c6428eea36b13f74b6">get_userdata_int</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_double&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#aaa40ae6e425fd9dc49c29992629be0e2">get_userdata_double</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;pomp_fun_handler&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_incr&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_decr&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;make_covariate_table&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_covariate_names&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;table_lookup&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f">table_lookup</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;lookup_in_table&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_data&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_sim&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;systematic_resampling&quot;</span>,(DL_FUNC) &amp;<a class="code" href="decls_8h.html#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;randwalk_perturbation&quot;</span>, (DL_FUNC) &amp;<a class="code" href="decls_8h.html#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// Register routines</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  R_registerRoutines(info,NULL,<a class="code" href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a>,NULL,NULL);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  R_useDynamicSymbols(info,TRUE);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  R_forceSymbols(info,FALSE);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_ad552306d18f13eac5425052762f64a0c"><div class="ttname"><a href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c">bspline_basis_eval_deriv</a></div><div class="ttdeci">void bspline_basis_eval_deriv(double x, double *knots, int degree, int nbasis, int deriv, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00115">bspline.c:115</a></div></div>
<div class="ttc" id="adecls_8h_html_a09bcd3caa641c11a9e456e7a4fdafffa"><div class="ttname"><a href="decls_8h.html#a09bcd3caa641c11a9e456e7a4fdafffa">randwalk_perturbation</a></div><div class="ttdeci">SEXP randwalk_perturbation(SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="mif2_8c_source.html#l00006">mif2.c:6</a></div></div>
<div class="ttc" id="adecls_8h_html_a0f11ca97854cd188080da40020f738eb"><div class="ttname"><a href="decls_8h.html#a0f11ca97854cd188080da40020f738eb">get_userdata</a></div><div class="ttdeci">const SEXP get_userdata(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00013">userdata.c:13</a></div></div>
<div class="ttc" id="adecls_8h_html_a17019a937f12763c2df28735e19b88c3"><div class="ttname"><a href="decls_8h.html#a17019a937f12763c2df28735e19b88c3">load_stack_decr</a></div><div class="ttdeci">SEXP load_stack_decr(SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00130">pomp_fun.c:130</a></div></div>
<div class="ttc" id="adecls_8h_html_a34c714747e1b49d142af4d58fee24446"><div class="ttname"><a href="decls_8h.html#a34c714747e1b49d142af4d58fee24446">apply_probe_sim</a></div><div class="ttdeci">SEXP apply_probe_sim(SEXP, SEXP, SEXP, SEXP, SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="probe_8c_source.html#l00029">probe.c:29</a></div></div>
<div class="ttc" id="adecls_8h_html_a90946f2aeaeb4f5826c8de7facb25999"><div class="ttname"><a href="decls_8h.html#a90946f2aeaeb4f5826c8de7facb25999">load_stack_incr</a></div><div class="ttdeci">SEXP load_stack_incr(SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00121">pomp_fun.c:121</a></div></div>
<div class="ttc" id="adecls_8h_html_a91f31f12db7a1e75775f01eb11ead99d"><div class="ttname"><a href="decls_8h.html#a91f31f12db7a1e75775f01eb11ead99d">apply_probe_data</a></div><div class="ttdeci">SEXP apply_probe_data(SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="probe_8c_source.html#l00004">probe.c:4</a></div></div>
<div class="ttc" id="adecls_8h_html_a9f4822de0304baafeca236b97ecb216b"><div class="ttname"><a href="decls_8h.html#a9f4822de0304baafeca236b97ecb216b">systematic_resampling</a></div><div class="ttdeci">SEXP systematic_resampling(SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00009">resample.c:9</a></div></div>
<div class="ttc" id="adecls_8h_html_aaa40ae6e425fd9dc49c29992629be0e2"><div class="ttname"><a href="decls_8h.html#aaa40ae6e425fd9dc49c29992629be0e2">get_userdata_double</a></div><div class="ttdeci">const double * get_userdata_double(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00026">userdata.c:26</a></div></div>
<div class="ttc" id="adecls_8h_html_abeacd76a8b2af7c6428eea36b13f74b6"><div class="ttname"><a href="decls_8h.html#abeacd76a8b2af7c6428eea36b13f74b6">get_userdata_int</a></div><div class="ttdeci">const int * get_userdata_int(const char *)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00019">userdata.c:19</a></div></div>
<div class="ttc" id="adecls_8h_html_afbec5a723223278096829f0532d5dc3a"><div class="ttname"><a href="decls_8h.html#afbec5a723223278096829f0532d5dc3a">lookup_in_table</a></div><div class="ttdeci">SEXP lookup_in_table(SEXP, SEXP)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00024">lookup_table.c:24</a></div></div>
<div class="ttc" id="ainit_8c_html_aa5ecd2cda6339e38a7040278a02baaa5"><div class="ttname"><a href="init_8c.html#aa5ecd2cda6339e38a7040278a02baaa5">callMethods</a></div><div class="ttdeci">static const R_CallMethodDef callMethods[]</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00004">init.c:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph.png" border="0" usemap="#adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph" alt=""/></div>
<map name="adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph" id="adecls_8h_a632ad1476e98dfe96ef9ee0e7f939b45_cgraph">
<area shape="rect" title=" " alt="" coords="5,1652,108,1679"/>
<area shape="rect" href="decls_8h.html#a91f31f12db7a1e75775f01eb11ead99d" title=" " alt="" coords="174,5,313,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="177,1253,310,1280"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="974,816,1137,843"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="972,867,1139,893"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="984,1373,1127,1400"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="1002,259,1109,285"/>
<area shape="rect" href="bspline_8c.html#ad552306d18f13eac5425052762f64a0c" title=" " alt="" coords="171,1830,316,1871"/>
<area shape="rect" href="decls_8h.html#a0f11ca97854cd188080da40020f738eb" title=" " alt="" coords="391,1728,497,1755"/>
<area shape="rect" href="decls_8h.html#aaa40ae6e425fd9dc49c29992629be0e2" title=" " alt="" coords="563,1779,721,1805"/>
<area shape="rect" href="decls_8h.html#abeacd76a8b2af7c6428eea36b13f74b6" title=" " alt="" coords="379,1677,509,1704"/>
<area shape="rect" href="decls_8h.html#a17019a937f12763c2df28735e19b88c3" title=" " alt="" coords="180,1961,307,1988"/>
<area shape="rect" href="decls_8h.html#a90946f2aeaeb4f5826c8de7facb25999" title=" " alt="" coords="182,2012,305,2039"/>
<area shape="rect" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a" title=" " alt="" coords="993,1576,1118,1603"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="159,1895,328,1937"/>
<area shape="rect" href="decls_8h.html#a09bcd3caa641c11a9e456e7a4fdafffa" title=" " alt="" coords="557,1627,727,1653"/>
<area shape="rect" href="decls_8h.html#a9f4822de0304baafeca236b97ecb216b" title=" " alt="" coords="156,2063,331,2089"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="393,689,495,716"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="1219,816,1329,843"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="1228,1323,1320,1349"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="1012,309,1099,336"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="607,335,677,361"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="794,613,901,640"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="592,993,692,1020"/>
<area shape="rect" href="pomp__defines_8h.html#a796a0cd2011dadc57c790c46532ef00b" title=" " alt="" coords="589,613,695,640"/>
<area shape="rect" href="rinit_8c.html#afdfe8d3f0939427e72c44c0e4f3bb102" title=" " alt="" coords="807,157,888,184"/>
<area shape="rect" href="rinit_8c.html#ac243dd8b5b0b777968905b257e24dc9c" title=" " alt="" coords="807,208,887,235"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="1560,791,1677,817"/>
<area shape="rect" href="rinit_8c.html#a4d765252bd25e8eb50da6837a15b5416" title=" " alt="" coords="814,107,881,133"/>
<area shape="rect" href="rinit_8c.html#a966f509fab1f9d9e38fc64d7e5773ede" title=" " alt="" coords="775,309,920,336"/>
<area shape="rect" href="rinit_8c.html#a1d34a269c2da0e05ebce19a2d07bf123" title=" " alt="" coords="1015,157,1096,184"/>
<area shape="rect" href="pomp__defines_8h.html#a70fd8ac5f480dcaebc10fe9cb9074732" title=" " alt="" coords="1221,157,1327,184"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="1220,259,1328,285"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="1214,1703,1334,1729"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="1223,1373,1325,1400"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="1405,1323,1512,1349"/>
<area shape="rect" href="rmeasure_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="1015,411,1096,437"/>
<area shape="rect" href="pomp__defines_8h.html#a8b775a55898690bdc11c348d0b5dc8c1" title=" " alt="" coords="996,613,1115,640"/>
<area shape="rect" href="rmeasure_8c.html#a9e133b8f86812dcd3682439751eaef63" title=" " alt="" coords="1015,461,1095,488"/>
<area shape="rect" href="rmeasure_8c.html#aff505c906b432ad2e9b72dc28feb374d" title=" " alt="" coords="1015,664,1096,691"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="785,1120,909,1147"/>
<area shape="rect" href="rprocess_8c.html#a37e868d572ef0240fa585840f2aed80f" title=" " alt="" coords="968,1323,1143,1349"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="789,1019,906,1045"/>
<area shape="rect" href="euler_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="1015,1171,1096,1197"/>
<area shape="rect" href="euler_8c.html#ad78b5357467ce6dfb3b594a64a0e3d08" title=" " alt="" coords="1015,1120,1095,1147"/>
<area shape="rect" href="bspline_8c.html#a2237300eb36fec7026017251da56382e" title=" " alt="" coords="392,1869,496,1896"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="1193,1475,1355,1501"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="1191,1525,1357,1552"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="1221,1576,1327,1603"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="385,2063,503,2089"/>
</map>
</div>

</div>
</div>
<a id="a09bcd3caa641c11a9e456e7a4fdafffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09bcd3caa641c11a9e456e7a4fdafffa">&#9670;&nbsp;</a></span>randwalk_perturbation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP randwalk_perturbation </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rw_sd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mif2_8c_source.html#l00006">6</a> of file <a class="el" href="mif2_8c_source.html">mif2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordtype">double</span> *xp = 0, *rw, *xrw, *xs;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  SEXP Pnames, rwnames, <a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">int</span> *dim, *pidx;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> nrw = 0, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">// unpack parameter matrix</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  xp = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// names of parameters undergoing random walk</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(rwnames = GET_NAMES(rw_sd));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  nrw = LENGTH(rwnames); rw = REAL(rw_sd);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// indices of parameters undergoing random walk</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a> = <a class="code" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b">matchnames</a>(Pnames,rwnames,<span class="stringliteral">&quot;parameters&quot;</span>));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  pidx = INTEGER(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">for</span> (j = 0, xrw = rw; j &lt; nrw; j++, pidx++, xrw++) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">for</span> (k = 0, xs = xp+(*pidx); k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xs += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      *xs += *xrw * norm_rand();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph.png" border="0" usemap="#adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph" alt=""/></div>
<map name="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph" id="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,32"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="223,5,329,32"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="377,5,495,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph.png" border="0" usemap="#adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph" alt=""/></div>
<map name="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph" id="adecls_8h_a09bcd3caa641c11a9e456e7a4fdafffa_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,325,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ac8e269d1663ac1f67722366434b79ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e269d1663ac1f67722366434b79ef6">&#9670;&nbsp;</a></span>set_pomp_userdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP set_pomp_userdata </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00008">8</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                                       {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a> = userdata;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a91cd56241914126e7f0a89c67bfac2f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91cd56241914126e7f0a89c67bfac2f3">&#9670;&nbsp;</a></span>sobol_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP sobol_sequence </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sobolseq_8c_source.html#l00234">234</a> of file <a class="el" href="sobolseq_8c_source.html">sobolseq.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  SEXP data;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = (<span class="keywordtype">unsigned</span> int) INTEGER(dim)[0];</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = (<span class="keywordtype">unsigned</span> int) INTEGER(length)[0];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">double</span> *dp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="structnlopt__soboldata__s.html">nlopt_sobol</a> s = <a class="code" href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a">nlopt_sobol_create</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) d);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (s==0) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;dimension is too high&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  PROTECT(data = allocMatrix(REALSXP,d,n)); dp = REAL(data);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51">nlopt_sobol_skip</a>(s,n,dp);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (k = 1; k &lt; n; k++) <a class="code" href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b">sobol_gen</a>(s,dp+k*d);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701">nlopt_sobol_destroy</a>(s);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">return</span>(data);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="ttc" id="asobolseq_8c_html_a0d659e93ebfd9865ee974260fc1f2701"><div class="ttname"><a href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701">nlopt_sobol_destroy</a></div><div class="ttdeci">static void nlopt_sobol_destroy(nlopt_sobol s)</div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00196">sobolseq.c:196</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a144bd11f1148a8f19f75b0567ad4d95a"><div class="ttname"><a href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a">nlopt_sobol_create</a></div><div class="ttdeci">static nlopt_sobol nlopt_sobol_create(unsigned sdim)</div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00188">sobolseq.c:188</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a66138f1615f8bea909b9ad7107ce3c51"><div class="ttname"><a href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51">nlopt_sobol_skip</a></div><div class="ttdeci">static void nlopt_sobol_skip(nlopt_sobol s, unsigned n, double *x)</div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00225">sobolseq.c:225</a></div></div>
<div class="ttc" id="asobolseq_8c_html_a8a0ebcfa3fdd7c7a8296647c972fe54b"><div class="ttname"><a href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b">sobol_gen</a></div><div class="ttdeci">static int sobol_gen(soboldata *sd, double *x)</div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00096">sobolseq.c:96</a></div></div>
<div class="ttc" id="astructnlopt__soboldata__s_html"><div class="ttname"><a href="structnlopt__soboldata__s.html">nlopt_soboldata_s</a></div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00065">sobolseq.c:65</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph.png" border="0" usemap="#adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph" alt=""/></div>
<map name="adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph" id="adecls_8h_a91cd56241914126e7f0a89c67bfac2f3_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,132,108"/>
<area shape="rect" href="sobolseq_8c.html#a144bd11f1148a8f19f75b0567ad4d95a" title=" " alt="" coords="184,5,329,32"/>
<area shape="rect" href="sobolseq_8c.html#a0d659e93ebfd9865ee974260fc1f2701" title=" " alt="" coords="180,56,333,83"/>
<area shape="rect" href="sobolseq_8c.html#a66138f1615f8bea909b9ad7107ce3c51" title=" " alt="" coords="191,107,322,133"/>
<area shape="rect" href="sobolseq_8c.html#a8a0ebcfa3fdd7c7a8296647c972fe54b" title=" " alt="" coords="394,132,482,159"/>
<area shape="rect" href="sobolseq_8c.html#a26079fb02c638050adfae1b98eebb878" title=" " alt="" coords="395,5,481,32"/>
<area shape="rect" href="sobolseq_8c.html#a7da449b80c90d93929ca447c026f4c6d" title=" " alt="" coords="381,56,495,83"/>
<area shape="rect" href="sobolseq_8c.html#a5750aa319cae41f5f03c7af0e490922c" title=" " alt="" coords="543,132,639,159"/>
</map>
</div>

</div>
</div>
<a id="ac796abcef7f5d6add4d98023a0bde62b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac796abcef7f5d6add4d98023a0bde62b">&#9670;&nbsp;</a></span>SSA_simulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP SSA_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>vmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>accumvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>hmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssa_8c_source.html#l00228">228</a> of file <a class="el" href="ssa_8c_source.html">ssa.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">int</span> *dim, xdim[3];</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">int</span> nvar, nvarv, nevent, npar, nrep, ntimes;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  SEXP statenames, paramnames, covarnames;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, covdim;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">int</span> nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, zindex, vindex;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">int</span> *sidx, *pidx, *cidx, *zidx, *vidx;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Vnames;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  Rboolean hasvnames;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">double</span> t0;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  dim = INTEGER(GET_DIM(xstart)); nvar = dim[0]; nrep = dim[1];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); npar = dim[0];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  dim = INTEGER(GET_DIM(vmatrix)); nvarv = dim[0]; nevent = dim[1];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span> (nvarv != nvar)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;number of state variables must equal the number of rows in &#39;v&#39;.&quot;</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  t0 = *(REAL(tstart));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  PROTECT(Cnames = <a class="code" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  PROTECT(Vnames = GET_ROWNAMES(GET_DIMNAMES(vmatrix)));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  covariate_table = <a class="code" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed">make_covariate_table</a>(covar,&amp;covdim);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  PROTECT(statenames = GET_SLOT(func,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  PROTECT(paramnames = GET_SLOT(func,install(<span class="stringliteral">&quot;paramnames&quot;</span>)));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  PROTECT(covarnames = GET_SLOT(func,install(<span class="stringliteral">&quot;covarnames&quot;</span>)));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a> = LENGTH(covarnames);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  hasvnames = !isNull(Vnames);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  PROTECT(hmax = AS_NUMERIC(hmax));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>))) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a> = (<a class="code" href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a> *) <a class="code" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9">__pomp_Rfun_ssa_ratefn</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a> = nvar;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a> = npar;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a> = covdim;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    PROTECT(<a class="code" href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a> = <a class="code" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    PROTECT(<a class="code" href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a> = <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a> = 1;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  xdim[0] = nvar; xdim[1] = nrep; xdim[2] = ntimes;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(3,xdim)); nprotect++;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,3);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (nzeros&gt;0) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    PROTECT(zindex = <a class="code" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    zidx = INTEGER(zindex);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    zidx = 0;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span> (hasvnames) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    PROTECT(vindex = <a class="code" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,Vnames,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    vidx = INTEGER(vindex);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    vidx = 0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nrep; i++) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <a class="code" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c">SSA</a>(<a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>,i,nvar,nevent,npar,nrep,ntimes,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          REAL(xstart),t0,REAL(times),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(vmatrix),</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          nzeros,zidx,sidx,pidx,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,cidx,hasvnames,vidx,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          covdim,&amp;covariate_table,REAL(hmax));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a7cbbce02475d974d83e25dc46c4b6f1d"><div class="ttname"><a href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a></div><div class="ttdeci">double pomp_ssa_rate_fn(int event, double t, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00051">pomp.h:52</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a2285fe40c11882d02308957485772528"><div class="ttname"><a href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a></div><div class="ttdeci">#define MATCHROWNAMES(X, N, W)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00013">pomp_defines.h:13</a></div></div>
<div class="ttc" id="assa_8c_html_a08a1d63aa145b71449d68985c31ab32c"><div class="ttname"><a href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c">SSA</a></div><div class="ttdeci">static void SSA(pomp_ssa_rate_fn *ratefun, int irep, int nvar, int nevent, int npar, int nrep, int ntimes, double *xstart, double t, const double *times, const double *params, double *xout, const double *v, int nzero, const int *izero, const int *istate, const int *ipar, int ncovar, const int *icovar, Rboolean hasvname, const int *ivmat, int mcov, lookup_table_t *tab, const double *hmax)</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00120">ssa.c:120</a></div></div>
<div class="ttc" id="assa_8c_html_a492c6ccf2bde2bebcd32e73e0933ee92"><div class="ttname"><a href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a></div><div class="ttdeci">#define FIRST</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00198">ssa.c:198</a></div></div>
<div class="ttc" id="assa_8c_html_a6ee98078df1e27286ab249d0ceb99dc9"><div class="ttname"><a href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a></div><div class="ttdeci">#define NPAR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00194">ssa.c:194</a></div></div>
<div class="ttc" id="assa_8c_html_a8c08e69dae809f2cec273c05025824f9"><div class="ttname"><a href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9">__pomp_Rfun_ssa_ratefn</a></div><div class="ttdeci">static double __pomp_Rfun_ssa_ratefn(int j, double t, const double *x, const double *p, int *stateindex, int *parindex, int *covindex, double *c)</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00201">ssa.c:201</a></div></div>
<div class="ttc" id="assa_8c_html_aacac4c9fd5f97b563c3e886e6c78af77"><div class="ttname"><a href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a></div><div class="ttdeci">#define RXR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00199">ssa.c:199</a></div></div>
<div class="ttc" id="assa_8c_html_ad4005a40cf60593ea8924e927d57f9eb"><div class="ttname"><a href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a></div><div class="ttdeci">#define NCOV</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00195">ssa.c:195</a></div></div>
<div class="ttc" id="assa_8c_html_ad5195ac8f863f5a9a7eaa0db094f7639"><div class="ttname"><a href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a></div><div class="ttdeci">#define NVAR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00193">ssa.c:193</a></div></div>
<div class="ttc" id="assa_8c_html_ae5591ed3a1a462f91141cff304975884"><div class="ttname"><a href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884">add_args</a></div><div class="ttdeci">static R_INLINE SEXP add_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00011">ssa.c:11</a></div></div>
<div class="ttc" id="assa_8c_html_af97b4b249542bc8c012be3f4614bdcf0"><div class="ttname"><a href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a></div><div class="ttdeci">#define RATEFN</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00197">ssa.c:197</a></div></div>
<div class="ttc" id="assa_8c_html_aff1b09d6630c6c0942f78171e74c1b9d"><div class="ttname"><a href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a></div><div class="ttdeci">#define ARGS</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00196">ssa.c:196</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph.png" border="0" usemap="#adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph" alt=""/></div>
<map name="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph" id="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_cgraph">
<area shape="rect" title=" " alt="" coords="5,183,123,209"/>
<area shape="rect" href="ssa_8c.html#a8c08e69dae809f2cec273c05025824f9" title=" " alt="" coords="171,5,356,32"/>
<area shape="rect" href="ssa_8c.html#ae5591ed3a1a462f91141cff304975884" title=" " alt="" coords="223,56,304,83"/>
<area shape="rect" href="decls_8h.html#ae6345040eb63a38c0ff7ae42f3ea35ff" title=" " alt="" coords="182,107,345,133"/>
<area shape="rect" href="decls_8h.html#a8fc25ac8149dbd6da367aa01dd9ad9ed" title=" " alt="" coords="180,157,347,184"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="217,208,309,235"/>
<area shape="rect" href="decls_8h.html#ada19523cc1edc44a799fce734f25c934" title=" " alt="" coords="192,259,335,285"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="208,309,319,336"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="239,360,287,387"/>
<area shape="rect" href="pomp__defines_8h.html#ab39b1553739e35037c2a8846ba65594f" title=" " alt="" coords="404,221,524,248"/>
<area shape="rect" href="pomp__fun_8c.html#ad3048ea27b0cd1af35870f0b0db5228e" title=" " alt="" coords="413,272,515,299"/>
<area shape="rect" href="pomp__defines_8h.html#a76a484fb785e5a4b35f15e41a1b8fc1b" title=" " alt="" coords="572,272,679,299"/>
<area shape="rect" href="pomp__defines_8h.html#ac56010c8d35a155162376d066856f663" title=" " alt="" coords="727,272,844,299"/>
<area shape="rect" href="ssa_8c.html#ababe355bb7829a954134d13bfe49fabd" title=" " alt="" coords="425,335,503,361"/>
<area shape="rect" href="decls_8h.html#ade6439566617e54cb9f4507f7ad2824f" title=" " alt="" coords="411,385,517,412"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph.png" border="0" usemap="#adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph" alt=""/></div>
<map name="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph" id="adecls_8h_ac796abcef7f5d6add4d98023a0bde62b_icgraph">
<area shape="rect" title=" " alt="" coords="636,5,753,32"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="488,5,588,32"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ab735e5526875ee755d72af6c8750bc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab735e5526875ee755d72af6c8750bc05">&#9670;&nbsp;</a></span>synth_loglik()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP synth_loglik </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ysim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ydat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="synth__lik_8c_source.html#l00104">104</a> of file <a class="el" href="synth__lik_8c_source.html">synth_lik.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                         {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SEXP loglik, dim, y;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  PROTECT(y = duplicate(AS_NUMERIC(ydat)));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  PROTECT(dim = GET_DIM(ysim));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  PROTECT(ysim = AS_NUMERIC(ysim));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd">robust_synth_loglik</a>(REAL(ysim),INTEGER(dim),REAL(y),REAL(loglik));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">return</span> loglik;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="ttc" id="asynth__lik_8c_html_a357cf49307356489922f2cb22efac4fd"><div class="ttname"><a href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd">robust_synth_loglik</a></div><div class="ttdeci">static void robust_synth_loglik(double *y, int *dim, double *ydat, double *loglik)</div><div class="ttdef"><b>Definition:</b> <a href="synth__lik_8c_source.html#l00011">synth_lik.c:11</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph.png" border="0" usemap="#adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph" alt=""/></div>
<map name="adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph" id="adecls_8h_ab735e5526875ee755d72af6c8750bc05_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,107,32"/>
<area shape="rect" href="synth__lik_8c.html#a357cf49307356489922f2cb22efac4fd" title=" " alt="" coords="155,5,304,32"/>
<area shape="rect" href="pomp__mat_8h.html#a614853020d1cfbd754ac82a5895b5547" title=" " alt="" coords="352,5,484,32"/>
</map>
</div>

</div>
</div>
<a id="a9f4822de0304baafeca236b97ecb216b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4822de0304baafeca236b97ecb216b">&#9670;&nbsp;</a></span>systematic_resampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP systematic_resampling </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00009">9</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> m, n;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SEXP perm;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  m = *(INTEGER(AS_INTEGER(np)));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  n = LENGTH(weights);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PROTECT(perm = NEW_INTEGER(m));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(weights = AS_NUMERIC(weights));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a>(n,REAL(weights),m,INTEGER(perm),1);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span>(perm);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="ttc" id="aresample_8c_html_a37f1a2acca063e96f0efa73705ec87b2"><div class="ttname"><a href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int nw, double *w, int np, int *p, int offset)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph.png" border="0" usemap="#adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph" alt=""/></div>
<map name="adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph" id="adecls_8h_a9f4822de0304baafeca236b97ecb216b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="228,5,347,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph.png" border="0" usemap="#adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph" alt=""/></div>
<map name="adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph" id="adecls_8h_a9f4822de0304baafeca236b97ecb216b_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,331,32"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ade6439566617e54cb9f4507f7ad2824f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6439566617e54cb9f4507f7ad2824f">&#9670;&nbsp;</a></span>table_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void table_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>tab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00053">53</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> flag = 0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> j, k, n;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> e;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> ((tab == 0) || (tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> &lt; 1) || (tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> &lt; 1)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = findInterval(tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>,tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>,x,1,1,tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>,&amp;flag);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// warn only if we are *outside* the interval</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> ((x &lt; tab-&gt;x[0]) || (x &gt; tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>-1]))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="pomp_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;table_lookup&#39;: extrapolating at %le.&quot;</span>, x);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">switch</span> (tab-&gt;<a class="code" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>: <span class="comment">// linear interpolation</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    e = (x - tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]) / (tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>] - tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (j = 0, k = tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>*tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>, n = k-tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j &lt; tab-&gt;width; j++, k++, n++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      y[j] = e*(tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k])+(1-e)*(tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[n]);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">case</span> 0: <span class="comment">// piecewise constant</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (flag &lt; 0) n = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flag &gt; 0) n = tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> n = tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (j = 0, k = n*tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j &lt; tab-&gt;width; j++, k++) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      y[j] = tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph.png" border="0" usemap="#adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph" alt=""/></div>
<map name="adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph" id="adecls_8h_ade6439566617e54cb9f4507f7ad2824f_icgraph">
<area shape="rect" title=" " alt="" coords="1060,360,1167,387"/>
<area shape="rect" href="decls_8h.html#a983ad52a265f059c6e25be89cdf97fd7" title=" " alt="" coords="869,5,980,32"/>
<area shape="rect" href="decls_8h.html#ac1ec1439680776719b9b8b9ebdbf9a33" title=" " alt="" coords="869,56,980,83"/>
<area shape="rect" href="decls_8h.html#ab3de8f433818929ff221b26769ed9e6c" title=" " alt="" coords="529,157,599,184"/>
<area shape="rect" href="decls_8h.html#a632ad1476e98dfe96ef9ee0e7f939b45" title=" " alt="" coords="5,208,108,235"/>
<area shape="rect" href="decls_8h.html#a0fdad74a815d2783d4f6f7053a6cb3ca" title=" " alt="" coords="511,208,617,235"/>
<area shape="rect" href="decls_8h.html#aa55c56601a4d47af6f8d162ff1aa9503" title=" " alt="" coords="869,411,980,437"/>
<area shape="rect" href="decls_8h.html#a19293a3a394b4e0885714f833bc2a96b" title=" " alt="" coords="665,309,789,336"/>
<area shape="rect" href="decls_8h.html#a87734543f5fc40ed123f9f1664e3b7a7" title=" " alt="" coords="845,512,1005,539"/>
<area shape="rect" href="decls_8h.html#a02d94e3819f568bb29c6d5e77f02a3d8" title=" " alt="" coords="861,461,989,488"/>
<area shape="rect" href="dinit_8c.html#aaf4b691dc5d079394332aedad44ea9c9" title=" " alt="" coords="875,563,974,589"/>
<area shape="rect" href="decls_8h.html#ae06448ff2e2ef1613edd4618634dbed6" title=" " alt="" coords="837,664,1012,691"/>
<area shape="rect" href="decls_8h.html#adcdcf759e7db4fcc8f07d2692c18183b" title=" " alt="" coords="853,613,996,640"/>
<area shape="rect" href="decls_8h.html#afbec5a723223278096829f0532d5dc3a" title=" " alt="" coords="337,335,463,361"/>
<area shape="rect" href="dprocess_8c.html#af743054a6e56b1e76d6ee59866b22611" title=" " alt="" coords="860,715,989,741"/>
<area shape="rect" href="ssa_8c.html#a08a1d63aa145b71449d68985c31ab32c" title=" " alt="" coords="901,259,949,285"/>
<area shape="rect" href="decls_8h.html#aa9d3b94c1a9a99e0db90e251f670e853" title=" " alt="" coords="349,208,451,235"/>
<area shape="rect" href="decls_8h.html#a34c714747e1b49d142af4d58fee24446" title=" " alt="" coords="156,208,289,235"/>
<area shape="rect" href="decls_8h.html#af129ae090fa637ebcec13e50e6c0d7be" title=" " alt="" coords="514,259,614,285"/>
<area shape="rect" href="decls_8h.html#af1187e52d896c25c1cdb5dd593dbc291" title=" " alt="" coords="677,512,777,539"/>
<area shape="rect" href="decls_8h.html#a5c9d4b991e534272c7dc4a6602be32ec" title=" " alt="" coords="670,461,785,488"/>
<area shape="rect" href="decls_8h.html#a6b4fa54c658fe6c6677c51e8346d728c" title=" " alt="" coords="690,563,765,589"/>
<area shape="rect" href="decls_8h.html#a1bcec7f4a5a240606fb8235312d5cc45" title=" " alt="" coords="677,639,778,665"/>
<area shape="rect" href="decls_8h.html#a6ef1a476d6745db7455441c65c74fd61" title=" " alt="" coords="676,715,779,741"/>
<area shape="rect" href="decls_8h.html#ac796abcef7f5d6add4d98023a0bde62b" title=" " alt="" coords="669,259,786,285"/>
</map>
</div>

</div>
</div>
<a id="a1c47fabab25be7910ba58cc20426bf35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c47fabab25be7910ba58cc20426bf35">&#9670;&nbsp;</a></span>wpfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP wpfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Trigger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wpfilter_8c_source.html#l00010">10</a> of file <a class="el" href="wpfilter_8c_source.html">wpfilter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  SEXP dimX, dimP, Xnames, Pnames;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, np;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">//  int npars;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="comment">//  int do_pr = 0;  // do parameter resampling?  at the moment, we do not</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordtype">int</span> *dim, k;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  PROTECT(dimX = GET_DIM(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  dim = INTEGER(dimX);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  PROTECT(Params = <a class="code" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d">as_matrix</a>(Params));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  PROTECT(dimP = GET_DIM(Params));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  dim = INTEGER(dimP);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">//  npars = dim[0];</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (dim[1] &gt; 1 &amp;&amp; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != dim[1])                     <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="pomp_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;params&#39;) does not match ncol(&#39;states&#39;)&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(Params)));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  np = *INTEGER(AS_INTEGER(Np));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">//  do_pr = (dim[1] &gt; 1);           // resample parameters as well as states</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  PROTECT(Weights = duplicate(AS_NUMERIC(Weights)));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  PROTECT(W = duplicate(AS_NUMERIC(W)));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">double</span> trigger, target;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  trigger = *REAL(AS_NUMERIC(Trigger));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  target = *REAL(AS_NUMERIC(Target));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// add W to Weights. check weights for NAN or +Inf. find max of weights.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> maxlogw = R_NegInf, oldw = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span> *xW = REAL(Weights);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span> *xw = REAL(W);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    oldw += exp(*xW);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    *xW += *xw;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (ISNAN(*xW) || *xW == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      SEXP rv;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      PROTECT(rv = ScalarInteger(k+1)); nprotect++;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      UNPROTECT(nprotect);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (maxlogw &lt; *xW) maxlogw = *xW;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// set up return list</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  SEXP retval, retvalnames, newdim;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  PROTECT(retval = NEW_LIST(5));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(5));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  PROTECT(newdim = NEW_INTEGER(2));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  nprotect += 3;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  dim = INTEGER(newdim);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  dim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  SET_DIM(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,newdim);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Xnames,2);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,2);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;weights&quot;</span>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  SEXP ess, loglik;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// conditional log likelihood</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  nprotect += 2;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (maxlogw == R_NegInf) {    <span class="comment">// all particles have zero likelihood</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    *REAL(ess) = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    *REAL(loglik) = R_NegInf;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws = 0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    xw = REAL(W);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    xW = REAL(Weights);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      *xW -= maxlogw;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      *xw = exp(*xW);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">if</span> (*xw != 0) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        w += *xw;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        ws += (*xw)*(*xw);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    *(REAL(ess)) = w*w/ws;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    *(REAL(loglik)) = maxlogw + log(w) - log(oldw);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  SET_ELEMENT(retval,3,ess);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  SET_ELEMENT(retval,4,loglik);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (maxlogw == R_NegInf || (*REAL(ess) &gt;= <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*trigger &amp;&amp; np == <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)) { <span class="comment">// do not resample</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    SET_ELEMENT(retval,0,<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    SET_ELEMENT(retval,2,Weights);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  } <span class="keywordflow">else</span> {                      <span class="comment">// no resampling</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// create storage for new states</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    SEXP newstates = R_NilValue;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">double</span> *ss = 0, *st = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordtype">int</span> xdim[] = {<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, np};</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      PROTECT(newstates = <a class="code" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49">makearray</a>(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4">setrownames</a>(newstates,Xnames,2);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff">fixdimnames</a>(newstates,dimnm,2);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      ss = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      st = REAL(newstates);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    SET_ELEMENT(retval,0,newstates);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//    SEXP newparams = R_NilValue;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//    double *ps = 0, *pt = 0;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// if (do_pr) {</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">//   int xdim[] = {npars, np};</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//   PROTECT(newparams = makearray(2,xdim)); nprotect++;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">//   setrownames(newparams,Pnames,2);</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//   fixdimnames(newparams,dimnm,2);</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">//   ps = REAL(Params);</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">//   pt = REAL(newparams);</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">//   SET_ELEMENT(retval,1,newparams);</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// } else {</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// create storage for new weights</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    SEXP newweights = R_NilValue;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> *ws = 0, *wt = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      PROTECT(newweights = NEW_NUMERIC(np)); nprotect++;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      ws = REAL(Weights);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      wt = REAL(newweights);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    SET_ELEMENT(retval,2,newweights);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// compute target resampling weights</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">for</span> (k = 0, xw = REAL(W), xW = REAL(Weights); k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      *xw = *xW;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      *xW *= target;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      *xw = exp(*xw - *xW);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// do resampling</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      GetRNGstate();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df">nosort_resamp</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(W),np,sample,0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      PutRNGstate();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordtype">int</span> sp = sample[k], j;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordtype">double</span> *xx;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="comment">//      double *xp;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          *st = *xx;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// if (do_pr) {</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">//   for (j = 0, xp = ps+npars*sp; j &lt; npars; j++, pt++, xp++)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">//     *pt = *xp;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">// }</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        wt[k] = ws[sp];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="decls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph.png" border="0" usemap="#adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph" alt=""/></div>
<map name="adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph" id="adecls_8h_a1c47fabab25be7910ba58cc20426bf35_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,77,133"/>
<area shape="rect" href="pomp__defines_8h.html#ad396407a99088c710b270a9c1dc3aa9d" title=" " alt="" coords="141,5,228,32"/>
<area shape="rect" href="pomp__defines_8h.html#a26453e4cfff7ec27ff31d617583dcae4" title=" " alt="" coords="292,31,403,57"/>
<area shape="rect" href="pomp__defines_8h.html#a263b864ea80d9008e4c96ffe013f1dff" title=" " alt="" coords="131,107,239,133"/>
<area shape="rect" href="pomp__defines_8h.html#a8ab2bdfb97326c698544007bd60c1a49" title=" " alt="" coords="139,157,231,184"/>
<area shape="rect" href="decls_8h.html#a2f8f78d126b50ffa8da9b867053278df" title=" " alt="" coords="125,208,244,235"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="decls_8h.html">decls.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
