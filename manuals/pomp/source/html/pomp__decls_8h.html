<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pomp: src/pomp_decls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pomp
   </div>
   <div id="projectbrief">Inference for partially observed Markov processes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pomp__decls_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pomp_decls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h__dep__incl.png" border="0" usemap="#asrc_2pomp__decls_8hdep" alt=""/></div>
<map name="asrc_2pomp__decls_8hdep" id="asrc_2pomp__decls_8hdep">
<area shape="rect" title=" " alt="" coords="2097,5,2232,32"/>
<area shape="rect" href="pomp__internal_8h.html" title=" " alt="" coords="2089,80,2240,107"/>
<area shape="rect" href="bspline_8c.html" title=" " alt="" coords="5,155,108,181"/>
<area shape="rect" href="distributions_8c.html" title=" " alt="" coords="132,155,269,181"/>
<area shape="rect" href="dmeasure_8c.html" title=" " alt="" coords="293,155,415,181"/>
<area shape="rect" href="dprior_8c.html" title=" " alt="" coords="439,155,533,181"/>
<area shape="rect" href="dprocess_8c.html" title=" " alt="" coords="558,155,673,181"/>
<area shape="rect" href="emeasure_8c.html" title=" " alt="" coords="697,155,819,181"/>
<area shape="rect" href="euler_8c.html" title=" " alt="" coords="843,155,932,181"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="957,155,1034,181"/>
<area shape="rect" href="logmeanexp_8c.html" title=" " alt="" coords="1059,155,1196,181"/>
<area shape="rect" href="lookup__table_8c.html" title=" " alt="" coords="1220,155,1360,181"/>
<area shape="rect" href="mif2_8c.html" title=" " alt="" coords="1384,155,1471,181"/>
<area shape="rect" href="ou2_8c.html" title=" " alt="" coords="1495,155,1575,181"/>
<area shape="rect" href="partrans_8c.html" title=" " alt="" coords="1600,155,1711,181"/>
<area shape="rect" href="pfilter_8c.html" title=" " alt="" coords="1735,155,1829,181"/>
<area shape="rect" href="pomp__fun_8c.html" title=" " alt="" coords="1853,155,1975,181"/>
<area shape="rect" href="pomp__mat_8h.html" title=" " alt="" coords="2101,155,2228,181"/>
<area shape="rect" href="probe__marginal_8c.html" title=" " alt="" coords="1897,229,2056,256"/>
<area shape="rect" href="probe__nlar_8c.html" title=" " alt="" coords="2081,229,2206,256"/>
<area shape="rect" href="synth__lik_8c.html" title=" " alt="" coords="2230,229,2345,256"/>
<area shape="rect" href="probe_8c.html" title=" " alt="" coords="2303,155,2397,181"/>
<area shape="rect" href="probe__acf_8c.html" title=" " alt="" coords="2421,155,2540,181"/>
<area shape="rect" href="resample_8c.html" title=" " alt="" coords="2563,155,2681,181"/>
<area shape="rect" href="rinit_8c.html" title=" " alt="" coords="2705,155,2787,181"/>
<area shape="rect" href="rmeasure_8c.html" title=" " alt="" coords="2812,155,2931,181"/>
<area shape="rect" href="rprior_8c.html" title=" " alt="" coords="2955,155,3046,181"/>
<area shape="rect" href="rprocess_8c.html" title=" " alt="" coords="3071,155,3181,181"/>
<area shape="rect" href="simulate_8c.html" title=" " alt="" coords="3205,155,3319,181"/>
<area shape="rect" href="skeleton_8c.html" title=" " alt="" coords="3343,155,3453,181"/>
<area shape="rect" href="sobolseq_8c.html" title=" " alt="" coords="3478,155,3593,181"/>
<area shape="rect" href="ssa_8c.html" title=" " alt="" coords="3617,155,3696,181"/>
<area shape="rect" href="trajectory_8c.html" title=" " alt="" coords="3721,155,3838,181"/>
<area shape="rect" href="transformations_8c.html" title=" " alt="" coords="3862,155,4022,181"/>
<area shape="rect" href="userdata_8c.html" title=" " alt="" coords="4047,155,4160,181"/>
<area shape="rect" href="vmeasure_8c.html" title=" " alt="" coords="4184,155,4305,181"/>
<area shape="rect" href="wpfilter_8c.html" title=" " alt="" coords="4330,155,4437,181"/>
</map>
</div>
</div>
<p><a href="pomp__decls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a71cbe26144698d7db860dc0f9f0fff0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a> (double *y, const double *x, int nx, int i, int degree, int deriv, const double *knots)</td></tr>
<tr class="separator:a71cbe26144698d7db860dc0f9f0fff0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ae33a36d3f40dd64783f1dae67ff8b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a91ae33a36d3f40dd64783f1dae67ff8b">bspline_basis</a> (SEXP range, SEXP x, SEXP nbasis, SEXP degree, SEXP deriv)</td></tr>
<tr class="separator:a91ae33a36d3f40dd64783f1dae67ff8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5300e64c53a9cbb6aa52d351bd338883"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5300e64c53a9cbb6aa52d351bd338883">periodic_bspline_basis</a> (SEXP x, SEXP nbasis, SEXP degree, SEXP period, SEXP deriv)</td></tr>
<tr class="separator:a5300e64c53a9cbb6aa52d351bd338883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabb1ca64e069e1b7767c31435e761d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#acabb1ca64e069e1b7767c31435e761d8">periodic_bspline_basis_eval</a> (double x, double period, int degree, int nbasis, double *y)</td></tr>
<tr class="separator:acabb1ca64e069e1b7767c31435e761d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f083190a387483412260be17208ee1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a> (double x, double period, int degree, int nbasis, int deriv, double *y)</td></tr>
<tr class="separator:a2f083190a387483412260be17208ee1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abacea3217a3136190d12e38f91a7f128"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#abacea3217a3136190d12e38f91a7f128">R_Euler_Multinom</a> (SEXP n, SEXP size, SEXP rate, SEXP deltat)</td></tr>
<tr class="separator:abacea3217a3136190d12e38f91a7f128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa055d45aa938bf55afe432967292b892"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa055d45aa938bf55afe432967292b892">D_Euler_Multinom</a> (SEXP x, SEXP size, SEXP rate, SEXP deltat, SEXP log)</td></tr>
<tr class="separator:aa055d45aa938bf55afe432967292b892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256259848397b531d0b334182b9c6ca1"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a256259848397b531d0b334182b9c6ca1">R_GammaWN</a> (SEXP n, SEXP <a class="el" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>, SEXP deltat)</td></tr>
<tr class="separator:a256259848397b531d0b334182b9c6ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ca33711b215b87cc650765175f1ca8"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa8ca33711b215b87cc650765175f1ca8">R_BetaBinom</a> (SEXP n, SEXP size, SEXP prob, SEXP theta)</td></tr>
<tr class="separator:aa8ca33711b215b87cc650765175f1ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631dafe45b2fd04f5fb99e59c1c4f1cf"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a631dafe45b2fd04f5fb99e59c1c4f1cf">D_BetaBinom</a> (SEXP x, SEXP size, SEXP prob, SEXP theta, SEXP log)</td></tr>
<tr class="separator:a631dafe45b2fd04f5fb99e59c1c4f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326516e59ec4f791bcc752ef5f763c71"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a326516e59ec4f791bcc752ef5f763c71">do_dmeasure</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP y, SEXP x, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP log, SEXP gnsi)</td></tr>
<tr class="separator:a326516e59ec4f791bcc752ef5f763c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41223e2376a1ecca8a599619048da63"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa41223e2376a1ecca8a599619048da63">do_dprior</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP log, SEXP gnsi)</td></tr>
<tr class="separator:aa41223e2376a1ecca8a599619048da63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6438a8b3220ecd24e531d5b3dd4534"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a2a6438a8b3220ecd24e531d5b3dd4534">do_dprocess</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP log, SEXP gnsi)</td></tr>
<tr class="separator:a2a6438a8b3220ecd24e531d5b3dd4534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab362c459382493c6f7f4721dc5bf6457"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ab362c459382493c6f7f4721dc5bf6457">do_emeasure</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:ab362c459382493c6f7f4721dc5bf6457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f6b69b51bdf12eb0fe150ccc05f80d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a83f6b69b51bdf12eb0fe150ccc05f80d">euler_model_simulator</a> (SEXP func, SEXP xstart, SEXP tstart, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, double deltat, <a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a> method, SEXP accumvars, SEXP covar, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, SEXP gnsi)</td></tr>
<tr class="separator:a83f6b69b51bdf12eb0fe150ccc05f80d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da8d135fe6d232031cf7c314f432265"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a> (double t1, double t2, double *deltat)</td></tr>
<tr class="separator:a3da8d135fe6d232031cf7c314f432265"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0681d20c093a288da04bffa9adbfe48a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a> (double t1, double t2, double deltat)</td></tr>
<tr class="separator:a0681d20c093a288da04bffa9adbfe48a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e104e02f3e2f197f3527742692b3379"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a3e104e02f3e2f197f3527742692b3379">_gompertz_normal_dmeasure</a> (double *lik, double *y, double *x, double *p, int give_log, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covars, double t)</td></tr>
<tr class="separator:a3e104e02f3e2f197f3527742692b3379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446a3650c179d439b7a9fbd19b898f0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a446a3650c179d439b7a9fbd19b898f0f">_gompertz_normal_rmeasure</a> (double *y, double *x, double *p, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covars, double t)</td></tr>
<tr class="separator:a446a3650c179d439b7a9fbd19b898f0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77159d0224fb1966b1be9459560ac68e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a77159d0224fb1966b1be9459560ac68e">_gompertz_normal_emeasure</a> (double *f, double *x, double *p, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covars, double t)</td></tr>
<tr class="separator:a77159d0224fb1966b1be9459560ac68e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244feb924f5f70105a411229d4f1dc28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a244feb924f5f70105a411229d4f1dc28">_gompertz_normal_vmeasure</a> (double *f, double *x, double *p, int *vmatindex, int *stateindex, int *parindex, int *covindex, double *covars, double t)</td></tr>
<tr class="separator:a244feb924f5f70105a411229d4f1dc28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291abfa2131cba9d126c40848f244c8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a291abfa2131cba9d126c40848f244c8d">_gompertz_step</a> (double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covar, double t, double deltat)</td></tr>
<tr class="separator:a291abfa2131cba9d126c40848f244c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea03fa2e44da9e3cf5ecdfd62511831"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aaea03fa2e44da9e3cf5ecdfd62511831">_gompertz_skeleton</a> (double *f, double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covar, double t)</td></tr>
<tr class="separator:aaea03fa2e44da9e3cf5ecdfd62511831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5373a67e9cf38b01e66427eb874d7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aca5373a67e9cf38b01e66427eb874d7a">_gompertz_to_trans</a> (double *__pt, const double *__p, const int *__parindex)</td></tr>
<tr class="separator:aca5373a67e9cf38b01e66427eb874d7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18828beb7b3f836de491fa5b6382ae51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a18828beb7b3f836de491fa5b6382ae51">_gompertz_from_trans</a> (double *__p, const double *__pt, const int *__parindex)</td></tr>
<tr class="separator:a18828beb7b3f836de491fa5b6382ae51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac82c44c250cd2f69f3259d56f09c1c26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ac82c44c250cd2f69f3259d56f09c1c26">R_init_pomp</a> (DllInfo *info)</td></tr>
<tr class="separator:ac82c44c250cd2f69f3259d56f09c1c26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eedb5370776fe4e1523f4e9a3e71bd3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a7eedb5370776fe4e1523f4e9a3e71bd3">logmeanexp</a> (const SEXP <a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, const SEXP Drop)</td></tr>
<tr class="separator:a7eedb5370776fe4e1523f4e9a3e71bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a80c78f9ef26859eea09b5299e702b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>)</td></tr>
<tr class="separator:aa7a80c78f9ef26859eea09b5299e702b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e57a24640cb0d9f6f8d55e02c3d553f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlookup__table__t.html">lookup_table_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, int *ncovar)</td></tr>
<tr class="separator:a1e57a24640cb0d9f6f8d55e02c3d553f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5964c67b353b466461b1eb1269e129"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aaf5964c67b353b466461b1eb1269e129">lookup_in_table</a> (SEXP covar, SEXP t)</td></tr>
<tr class="separator:aaf5964c67b353b466461b1eb1269e129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a036b9fb7cfc62e3984889f95024971a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a> (<a class="el" href="structlookup__table__t.html">lookup_table_t</a> *tab, double x, double *y)</td></tr>
<tr class="separator:a036b9fb7cfc62e3984889f95024971a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add4b451ca3aa78a5e56183372c18bdb7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#add4b451ca3aa78a5e56183372c18bdb7">randwalk_perturbation</a> (SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP rw_sd)</td></tr>
<tr class="separator:add4b451ca3aa78a5e56183372c18bdb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a169ee0dc87d392a574e8815b934d19f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a169ee0dc87d392a574e8815b934d19f1">_ou2_step</a> (double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t, double deltat)</td></tr>
<tr class="separator:a169ee0dc87d392a574e8815b934d19f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1c5b49ac4fe519757a8f7598d509306"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ad1c5b49ac4fe519757a8f7598d509306">_ou2_pdf</a> (double *f, double *x, double *z, double t1, double t2, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</td></tr>
<tr class="separator:ad1c5b49ac4fe519757a8f7598d509306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac9eb3292d0599698a9cb747241ad32c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aac9eb3292d0599698a9cb747241ad32c">_ou2_skel</a> (double *f, double *x, double *p, int *stateindex, int *parindex, int *covindex, double *covars, double t)</td></tr>
<tr class="separator:aac9eb3292d0599698a9cb747241ad32c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56f31e6a8ce88a0e25ba27fa8c7d0d26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a56f31e6a8ce88a0e25ba27fa8c7d0d26">_ou2_dmeasure</a> (double *lik, double *y, double *x, double *p, int give_log, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covar, double t)</td></tr>
<tr class="separator:a56f31e6a8ce88a0e25ba27fa8c7d0d26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c2ea1338c663656b2a023cf559c741"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a78c2ea1338c663656b2a023cf559c741">_ou2_rmeasure</a> (double *y, double *x, double *p, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covar, double t)</td></tr>
<tr class="separator:a78c2ea1338c663656b2a023cf559c741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bedc5f36f1e31c0b61160e735b104e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a4bedc5f36f1e31c0b61160e735b104e3">_ou2_emeasure</a> (double *y, double *x, double *p, int *obsindex, int *stateindex, int *parindex, int *covindex, double *covar, double t)</td></tr>
<tr class="separator:a4bedc5f36f1e31c0b61160e735b104e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39104e744ca71e0cd070ff508eb64a9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a39104e744ca71e0cd070ff508eb64a9a">_ou2_vmeasure</a> (double *f, double *x, double *p, int *vmatindex, int *stateindex, int *parindex, int *covindex, double *covar, double t)</td></tr>
<tr class="separator:a39104e744ca71e0cd070ff508eb64a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51832cdc1f6e9a2f22df3a0f385cb86"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ac51832cdc1f6e9a2f22df3a0f385cb86">do_partrans</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP dir, SEXP gnsi)</td></tr>
<tr class="separator:ac51832cdc1f6e9a2f22df3a0f385cb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfcb3a7b41bc3b2b9315163717854242"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#acfcb3a7b41bc3b2b9315163717854242">pfilter</a> (SEXP x, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP Np, SEXP predmean, SEXP predvar, SEXP filtmean, SEXP trackancestry, SEXP doparRS, SEXP weights, SEXP wave)</td></tr>
<tr class="separator:acfcb3a7b41bc3b2b9315163717854242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94db08f2d9f751e7832aaadb5ae6920e"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a> (SEXP pfun, SEXP gnsi, <a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *<a class="el" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>, SEXP S, SEXP P, SEXP O, SEXP C)</td></tr>
<tr class="separator:a94db08f2d9f751e7832aaadb5ae6920e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae1bdf9e79d36d8fc709cbc509d4c8c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5ae1bdf9e79d36d8fc709cbc509d4c8c">load_stack_incr</a> (SEXP pack)</td></tr>
<tr class="separator:a5ae1bdf9e79d36d8fc709cbc509d4c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a653dae61a3500aaadf64fdefa79c4b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a0a653dae61a3500aaadf64fdefa79c4b">load_stack_decr</a> (SEXP pack)</td></tr>
<tr class="separator:a0a653dae61a3500aaadf64fdefa79c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3f83f20679bad53b6c982ed9dde8ea"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#add3f83f20679bad53b6c982ed9dde8ea">apply_probe_data</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP probes)</td></tr>
<tr class="separator:add3f83f20679bad53b6c982ed9dde8ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2595c6a453ae9fad2f232595ced5ccc"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ad2595c6a453ae9fad2f232595ced5ccc">apply_probe_sim</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP nsim, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP probes, SEXP datval, SEXP gnsi)</td></tr>
<tr class="separator:ad2595c6a453ae9fad2f232595ced5ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb81a79c270779cdaa8ab7f2270c4569"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aeb81a79c270779cdaa8ab7f2270c4569">probe_acf</a> (SEXP x, SEXP lags, SEXP corr)</td></tr>
<tr class="separator:aeb81a79c270779cdaa8ab7f2270c4569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95593efb3dabcae5680a0ac5fb800fa3"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a95593efb3dabcae5680a0ac5fb800fa3">probe_ccf</a> (SEXP x, SEXP y, SEXP lags, SEXP corr)</td></tr>
<tr class="separator:a95593efb3dabcae5680a0ac5fb800fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33683f39715bc5813eab0d124dbc9899"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a33683f39715bc5813eab0d124dbc9899">probe_marginal_setup</a> (SEXP ref, SEXP order, SEXP diff)</td></tr>
<tr class="separator:a33683f39715bc5813eab0d124dbc9899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a1a19b1194b1b0380d189ff12188a4b"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a3a1a19b1194b1b0380d189ff12188a4b">probe_marginal_solve</a> (SEXP x, SEXP setup, SEXP diff)</td></tr>
<tr class="separator:a3a1a19b1194b1b0380d189ff12188a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f90ddaaa65be036697557e76d8e0d0c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a9f90ddaaa65be036697557e76d8e0d0c">probe_nlar</a> (SEXP x, SEXP lags, SEXP powers)</td></tr>
<tr class="separator:a9f90ddaaa65be036697557e76d8e0d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982475f3663a786d7883672aa2ed072e"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a982475f3663a786d7883672aa2ed072e">systematic_resampling</a> (SEXP weights, SEXP np)</td></tr>
<tr class="separator:a982475f3663a786d7883672aa2ed072e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f1a2acca063e96f0efa73705ec87b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a> (int nw, double *w, int np, int *p, int offset)</td></tr>
<tr class="separator:a37f1a2acca063e96f0efa73705ec87b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad963b9a55d662fd9085f90fa1d05b399"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ad963b9a55d662fd9085f90fa1d05b399">do_rinit</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP t0, SEXP nsim, SEXP gnsi)</td></tr>
<tr class="separator:ad963b9a55d662fd9085f90fa1d05b399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4917309d8b878da9adfc8ee6223bc2a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa4917309d8b878da9adfc8ee6223bc2a">do_rmeasure</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:aa4917309d8b878da9adfc8ee6223bc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff3b8f1d525f9c301d07b63276b76b43"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aff3b8f1d525f9c301d07b63276b76b43">do_rprior</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:aff3b8f1d525f9c301d07b63276b76b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f2867fc46d33e1778108853725d74a"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a91f2867fc46d33e1778108853725d74a">do_rprocess</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP xstart, SEXP tstart, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:a91f2867fc46d33e1778108853725d74a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe89f4789c66d534f2521bc3c4c98e7"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#adbe89f4789c66d534f2521bc3c4c98e7">do_simulate</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP nsim, SEXP rettype, SEXP gnsi)</td></tr>
<tr class="separator:adbe89f4789c66d534f2521bc3c4c98e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ea4779fc1cc65f27c3546cbb6669c8"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a> (SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, SEXP <a class="el" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, SEXP Pnames, SEXP Cnames)</td></tr>
<tr class="separator:a82ea4779fc1cc65f27c3546cbb6669c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5870e93076f917246e64740c1416a05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a> (double *f, double *time, double *x, double *p, SEXP <a class="el" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, SEXP <a class="el" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, int <a class="el" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, int <a class="el" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, int <a class="el" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, int ntimes, int nrepx, int nrepp, int <a class="el" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *<a class="el" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>, double *<a class="el" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)</td></tr>
<tr class="separator:ab5870e93076f917246e64740c1416a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d2bf78c9a2e064a57e6c9bf3d52bc2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2">iterate_skeleton_R</a> (double *<a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, double t, double deltat, double *time, double *x, double *p, SEXP <a class="el" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, SEXP <a class="el" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, int <a class="el" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, int <a class="el" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, int <a class="el" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, int ntimes, int nrepp, int <a class="el" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, int nzeros, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *<a class="el" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>, int *zeroindex, double *<a class="el" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)</td></tr>
<tr class="separator:ab2d2bf78c9a2e064a57e6c9bf3d52bc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c519c3f1f7ceca7aae16c0aa702cfeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a> (double *f, double *time, double *x, double *p, int <a class="el" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, int <a class="el" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, int <a class="el" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, int ntimes, int nrepx, int nrepp, int <a class="el" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, int *sidx, int *pidx, int *cidx, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *<a class="el" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *<a class="el" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, double *<a class="el" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)</td></tr>
<tr class="separator:a4c519c3f1f7ceca7aae16c0aa702cfeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7782b5824af2ba096aa0d7f1c4834b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b">iterate_skeleton_native</a> (double *<a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, double t, double deltat, double *time, double *x, double *p, int <a class="el" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, int <a class="el" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, int <a class="el" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, int ntimes, int nrepp, int <a class="el" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, int nzeros, int *sidx, int *pidx, int *cidx, <a class="el" href="structlookup__table__t.html">lookup_table_t</a> *<a class="el" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>, int *zeroindex, <a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *<a class="el" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, double *<a class="el" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)</td></tr>
<tr class="separator:aca7782b5824af2ba096aa0d7f1c4834b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ce73bdd2e70be7b043dcfc1a5d259c"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a93ce73bdd2e70be7b043dcfc1a5d259c">do_skeleton</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x, SEXP t, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:a93ce73bdd2e70be7b043dcfc1a5d259c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670defd3a8b9d05d86bc8da76de23778"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a670defd3a8b9d05d86bc8da76de23778">sobol_sequence</a> (SEXP dim, SEXP length)</td></tr>
<tr class="separator:a670defd3a8b9d05d86bc8da76de23778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868191e685624fbffd57ee4f32859ac6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6">SSA_simulator</a> (SEXP func, SEXP xstart, SEXP tstart, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP vmatrix, SEXP covar, SEXP accumvars, SEXP hmax, SEXP <a class="el" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, SEXP gnsi)</td></tr>
<tr class="separator:a868191e685624fbffd57ee4f32859ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3bb9e9bce5419b23032d95b1bba531"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aba3bb9e9bce5419b23032d95b1bba531">synth_loglik</a> (SEXP ysim, SEXP ydat)</td></tr>
<tr class="separator:aba3bb9e9bce5419b23032d95b1bba531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ee9c5f69ec3b1b090448cb76634602d"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a3ee9c5f69ec3b1b090448cb76634602d">iterate_map</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP times, SEXP t0, SEXP x0, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:a3ee9c5f69ec3b1b090448cb76634602d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650670c909a5329eb24d77c821cd5e21"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a650670c909a5329eb24d77c821cd5e21">pomp_desolve_setup</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x0, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:a650670c909a5329eb24d77c821cd5e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a388d1f049a9d7284d0e7ba26591e6099"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099">pomp_vf_eval</a> (int *neq, double *t, double *y, double *ydot, double *yout, int *ip)</td></tr>
<tr class="separator:a388d1f049a9d7284d0e7ba26591e6099"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a37b08d4f29e8bdd81eb910cf4bff6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a7a37b08d4f29e8bdd81eb910cf4bff6d">pomp_desolve_takedown</a> (void)</td></tr>
<tr class="separator:a7a37b08d4f29e8bdd81eb910cf4bff6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d549367377037bf0c52dbf9ebfa0ccc"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5d549367377037bf0c52dbf9ebfa0ccc">LogitTransform</a> (SEXP P)</td></tr>
<tr class="separator:a5d549367377037bf0c52dbf9ebfa0ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68db7c3a0f761d40b1d94b8e71a633dc"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a68db7c3a0f761d40b1d94b8e71a633dc">ExpitTransform</a> (SEXP <a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)</td></tr>
<tr class="separator:a68db7c3a0f761d40b1d94b8e71a633dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e8b0b73f135519781c3b75e10172203"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5e8b0b73f135519781c3b75e10172203">LogBarycentricTransform</a> (SEXP <a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)</td></tr>
<tr class="separator:a5e8b0b73f135519781c3b75e10172203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7be026ee05148f7fcf4af0d35983a405"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a7be026ee05148f7fcf4af0d35983a405">InverseLogBarycentricTransform</a> (SEXP <a class="el" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>)</td></tr>
<tr class="separator:a7be026ee05148f7fcf4af0d35983a405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa019045daea9be339fd1e70e3441d252"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a> (SEXP userdata)</td></tr>
<tr class="separator:aa019045daea9be339fd1e70e3441d252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f810b1f9d483bd150f3e71102b9534"><td class="memItemLeft" align="right" valign="top">const SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a44f810b1f9d483bd150f3e71102b9534">get_userdata</a> (const char *name)</td></tr>
<tr class="separator:a44f810b1f9d483bd150f3e71102b9534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81184a02668adfde937ace9d4cd3c89"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ab81184a02668adfde937ace9d4cd3c89">get_userdata_int</a> (const char *name)</td></tr>
<tr class="separator:ab81184a02668adfde937ace9d4cd3c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5703410301afea05b3a3d521ad65597f"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5703410301afea05b3a3d521ad65597f">get_userdata_double</a> (const char *name)</td></tr>
<tr class="separator:a5703410301afea05b3a3d521ad65597f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ddde1fa5bcf8c3949fd4865a7ab474c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a> (void)</td></tr>
<tr class="separator:a5ddde1fa5bcf8c3949fd4865a7ab474c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97fc58eebfdaa733377f210c1dd48082"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#a97fc58eebfdaa733377f210c1dd48082">do_vmeasure</a> (SEXP <a class="el" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>, SEXP x, SEXP times, SEXP <a class="el" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>, SEXP gnsi)</td></tr>
<tr class="separator:a97fc58eebfdaa733377f210c1dd48082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac643fb3aad609b1078e9abb994ec6cf2"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomp__decls_8h.html#ac643fb3aad609b1078e9abb994ec6cf2">wpfilter</a> (SEXP <a class="el" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, SEXP Params, SEXP Weights, SEXP W, SEXP Trigger, SEXP Target, SEXP Np)</td></tr>
<tr class="separator:ac643fb3aad609b1078e9abb994ec6cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a18828beb7b3f836de491fa5b6382ae51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18828beb7b3f836de491fa5b6382ae51">&#9670;&nbsp;</a></span>_gompertz_from_trans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_from_trans </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>__p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>__pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>__parindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00098">98</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a> = exp(<a class="code" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a> = exp(<a class="code" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = exp(<a class="code" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = exp(<a class="code" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a> = exp(<a class="code" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a216f42bf177ca87e5f7724df32173717"><div class="ttname"><a href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a></div><div class="ttdeci">#define X_0</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00082">gompertz.c:82</a></div></div>
<div class="ttc" id="agompertz_8c_html_a62969232668331297e2dca1ae2ddd10d"><div class="ttname"><a href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a></div><div class="ttdeci">#define r</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00078">gompertz.c:78</a></div></div>
<div class="ttc" id="agompertz_8c_html_a678ef311e74501d7b800f0b47500374a"><div class="ttname"><a href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a></div><div class="ttdeci">#define sigma</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00080">gompertz.c:80</a></div></div>
<div class="ttc" id="agompertz_8c_html_a757a8fce372da1cf6bf283ad0d551b5d"><div class="ttname"><a href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a></div><div class="ttdeci">#define T_sigma</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00085">gompertz.c:85</a></div></div>
<div class="ttc" id="agompertz_8c_html_a7d82cf2074afa4cfb2f3ccef3147b5f1"><div class="ttname"><a href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a></div><div class="ttdeci">#define T_tau</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00086">gompertz.c:86</a></div></div>
<div class="ttc" id="agompertz_8c_html_a97d832ae23af4f215e801e37e4f94254"><div class="ttname"><a href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a></div><div class="ttdeci">#define K</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00079">gompertz.c:79</a></div></div>
<div class="ttc" id="agompertz_8c_html_aa7082577997805000f8e8b56846642cd"><div class="ttname"><a href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a></div><div class="ttdeci">#define tau</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00081">gompertz.c:81</a></div></div>
<div class="ttc" id="agompertz_8c_html_ab4d3d6d4c67ada71eec73c01852981f0"><div class="ttname"><a href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a></div><div class="ttdeci">#define T_K</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00084">gompertz.c:84</a></div></div>
<div class="ttc" id="agompertz_8c_html_ad5a2597d3f99cc31bb9bf4e0471f3a37"><div class="ttname"><a href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a></div><div class="ttdeci">#define T_r</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00083">gompertz.c:83</a></div></div>
<div class="ttc" id="agompertz_8c_html_ae51e7437f94eebfb3a19f094cdc7fe0d"><div class="ttname"><a href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a></div><div class="ttdeci">#define T_X_0</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00087">gompertz.c:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e104e02f3e2f197f3527742692b3379"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e104e02f3e2f197f3527742692b3379">&#9670;&nbsp;</a></span>_gompertz_normal_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lik</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>give_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00020">20</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                            {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  *lik = dlnorm(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,log(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>,give_log);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a207fd5507206d307cd63f95374fcd00d"><div class="ttname"><a href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a></div><div class="ttdeci">#define X</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00014">gompertz.c:14</a></div></div>
<div class="ttc" id="agompertz_8c_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00011">gompertz.c:11</a></div></div>
<div class="ttc" id="agompertz_8c_html_a798e4073d613ca5ba9618e1b3253df14"><div class="ttname"><a href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a></div><div class="ttdeci">#define Y</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00013">gompertz.c:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77159d0224fb1966b1be9459560ac68e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77159d0224fb1966b1be9459560ac68e">&#9670;&nbsp;</a></span>_gompertz_normal_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00034">34</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                            {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*exp(<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>/2);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a423a96c51fa2ea8a6406113803acbbc1"><div class="ttname"><a href="gompertz_8c.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a></div><div class="ttdeci">#define EY</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00016">gompertz.c:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a446a3650c179d439b7a9fbd19b898f0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446a3650c179d439b7a9fbd19b898f0f">&#9670;&nbsp;</a></span>_gompertz_normal_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00027">27</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                            {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = rlnorm(log(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a244feb924f5f70105a411229d4f1dc28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244feb924f5f70105a411229d4f1dc28">&#9670;&nbsp;</a></span>_gompertz_normal_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_normal_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>vmatindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00041">41</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                            {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">double</span> et = exp(<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>*<a class="code" href="gompertz_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a> = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>*et*(et-1);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a99670a9dfb3b867756c0a48bfad3c4da"><div class="ttname"><a href="gompertz_8c.html#a99670a9dfb3b867756c0a48bfad3c4da">VY</a></div><div class="ttdeci">#define VY</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00017">gompertz.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaea03fa2e44da9e3cf5ecdfd62511831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaea03fa2e44da9e3cf5ecdfd62511831">&#9670;&nbsp;</a></span>_gompertz_skeleton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_skeleton </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00059">59</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> S = exp(-<a class="code" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a> = R_pow(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S); <span class="comment">// X is not over-written in the skeleton function</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_a3e727802b38f4a8209fdde8333e080bb"><div class="ttname"><a href="gompertz_8c.html#a3e727802b38f4a8209fdde8333e080bb">XPRIME</a></div><div class="ttdeci">#define XPRIME</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00015">gompertz.c:15</a></div></div>
<div class="ttc" id="agompertz_8c_html_a5c71a5e59a53413cd6c270266d63b031"><div class="ttname"><a href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a></div><div class="ttdeci">#define R</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00008">gompertz.c:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a291abfa2131cba9d126c40848f244c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a291abfa2131cba9d126c40848f244c8d">&#9670;&nbsp;</a></span>_gompertz_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_step </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00049">49</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">double</span> S = exp(-<a class="code" href="gompertz_8c.html#a5c71a5e59a53413cd6c270266d63b031">R</a>*deltat);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">double</span> eps = (<a class="code" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a> &gt; 0.0) ? exp(rnorm(0,<a class="code" href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a>)) : 1.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = R_pow(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>,1-S)*R_pow(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,S)*eps; <span class="comment">// note X is over-written by this line</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="ttc" id="agompertz_8c_html_ab899f53048f1f06a224b5eb1fa369750"><div class="ttname"><a href="gompertz_8c.html#ab899f53048f1f06a224b5eb1fa369750">SIGMA</a></div><div class="ttdeci">#define SIGMA</div><div class="ttdef"><b>Definition:</b> <a href="gompertz_8c_source.html#l00010">gompertz.c:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca5373a67e9cf38b01e66427eb874d7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca5373a67e9cf38b01e66427eb874d7a">&#9670;&nbsp;</a></span>_gompertz_to_trans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _gompertz_to_trans </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>__pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>__p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>__parindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gompertz_8c_source.html#l00089">89</a> of file <a class="el" href="gompertz_8c_source.html">gompertz.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="gompertz_8c.html#ad5a2597d3f99cc31bb9bf4e0471f3a37">T_r</a> = log(<a class="code" href="gompertz_8c.html#a62969232668331297e2dca1ae2ddd10d">r</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="gompertz_8c.html#ab4d3d6d4c67ada71eec73c01852981f0">T_K</a> = log(<a class="code" href="gompertz_8c.html#a97d832ae23af4f215e801e37e4f94254">K</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="gompertz_8c.html#a757a8fce372da1cf6bf283ad0d551b5d">T_sigma</a> = log(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="gompertz_8c.html#a7d82cf2074afa4cfb2f3ccef3147b5f1">T_tau</a> = log(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="gompertz_8c.html#ae51e7437f94eebfb3a19f094cdc7fe0d">T_X_0</a> = log(<a class="code" href="gompertz_8c.html#a216f42bf177ca87e5f7724df32173717">X_0</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56f31e6a8ce88a0e25ba27fa8c7d0d26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56f31e6a8ce88a0e25ba27fa8c7d0d26">&#9670;&nbsp;</a></span>_ou2_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_dmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lik</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>give_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00096">96</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">double</span> f = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  f += (ISNA(<a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>)) ? 0.0 : dnorm(<a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a>,x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd,1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  f += (ISNA(<a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>)) ? 0.0 : dnorm(<a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a>,x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd,1);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  *lik = (give_log) ? f : exp(f);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a1964818ccd90a6173ea48cecb652feeb"><div class="ttname"><a href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a></div><div class="ttdeci">#define X1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00055">ou2.c:55</a></div></div>
<div class="ttc" id="aou2_8c_html_a294189cdea31dda8faf609b9b3e2000a"><div class="ttname"><a href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a></div><div class="ttdeci">#define Y1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00058">ou2.c:58</a></div></div>
<div class="ttc" id="aou2_8c_html_a3128cc29e366777d66d8b049451ca8a0"><div class="ttname"><a href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a></div><div class="ttdeci">#define Y2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00059">ou2.c:59</a></div></div>
<div class="ttc" id="aou2_8c_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00053">ou2.c:53</a></div></div>
<div class="ttc" id="aou2_8c_html_a79ae03a0214cb30e57b9e8835f2a0019"><div class="ttname"><a href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a></div><div class="ttdeci">#define X2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00056">ou2.c:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bedc5f36f1e31c0b61160e735b104e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bedc5f36f1e31c0b61160e735b104e3">&#9670;&nbsp;</a></span>_ou2_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_emeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00118">118</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1c5b49ac4fe519757a8f7598d509306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1c5b49ac4fe519757a8f7598d509306">&#9670;&nbsp;</a></span>_ou2_pdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_pdf </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00076">76</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">if</span> (t2-t1 != 1)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ou2_pdf error: transitions must be consecutive&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  f[0] = dens_ou2(x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],z[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],z[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>,1);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a3f470cf546586fe861be7be3c24557bc"><div class="ttname"><a href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a></div><div class="ttdeci">#define SIGMA3</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00052">ou2.c:52</a></div></div>
<div class="ttc" id="aou2_8c_html_a6e6cd685f94be3c0552ee4cb3e0881ff"><div class="ttname"><a href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a></div><div class="ttdeci">#define ALPHA2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00047">ou2.c:47</a></div></div>
<div class="ttc" id="aou2_8c_html_ab2ee134520af69f566c53e1653198f29"><div class="ttname"><a href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a></div><div class="ttdeci">#define SIGMA1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00050">ou2.c:50</a></div></div>
<div class="ttc" id="aou2_8c_html_ae5afe6a4069844a8988fffedaa523856"><div class="ttname"><a href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a></div><div class="ttdeci">#define SIGMA2</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00051">ou2.c:51</a></div></div>
<div class="ttc" id="aou2_8c_html_aef2261269821a4680fe2d8389edb6af1"><div class="ttname"><a href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a></div><div class="ttdeci">#define ALPHA3</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00048">ou2.c:48</a></div></div>
<div class="ttc" id="aou2_8c_html_af8e4e3fc5b56a3cf8340fd6534c71e00"><div class="ttname"><a href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a></div><div class="ttdeci">#define ALPHA4</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00049">ou2.c:49</a></div></div>
<div class="ttc" id="aou2_8c_html_afec7121cee3ac42de7f64aefd50c66cf"><div class="ttname"><a href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a></div><div class="ttdeci">#define ALPHA1</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00046">ou2.c:46</a></div></div>
<div class="ttc" id="apomp__internal_8h_html_ad25a1c617278c25cbcbb9b9a3a6b8024"><div class="ttname"><a href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a></div><div class="ttdeci">#define err(...)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__internal_8h_source.html#l00014">pomp_internal.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78c2ea1338c663656b2a023cf559c741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c2ea1338c663656b2a023cf559c741">&#9670;&nbsp;</a></span>_ou2_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_rmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>obsindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00108">108</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="ou2_8c.html#a294189cdea31dda8faf609b9b3e2000a">Y1</a> = rnorm(x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],sd);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="ou2_8c.html#a3128cc29e366777d66d8b049451ca8a0">Y2</a> = rnorm(x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],sd);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac9eb3292d0599698a9cb747241ad32c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac9eb3292d0599698a9cb747241ad32c">&#9670;&nbsp;</a></span>_ou2_skel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_skel </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00087">87</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  f[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>] = <a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>*x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>*x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  f[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>] = <a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>*x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>]+<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>*x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a169ee0dc87d392a574e8815b934d19f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a169ee0dc87d392a574e8815b934d19f1">&#9670;&nbsp;</a></span>_ou2_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_step </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>covars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00067">67</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  sim_ou2(&amp;x[<a class="code" href="ou2_8c.html#a1964818ccd90a6173ea48cecb652feeb">X1</a>],&amp;x[<a class="code" href="ou2_8c.html#a79ae03a0214cb30e57b9e8835f2a0019">X2</a>],<a class="code" href="ou2_8c.html#afec7121cee3ac42de7f64aefd50c66cf">ALPHA1</a>,<a class="code" href="ou2_8c.html#a6e6cd685f94be3c0552ee4cb3e0881ff">ALPHA2</a>,<a class="code" href="ou2_8c.html#aef2261269821a4680fe2d8389edb6af1">ALPHA3</a>,<a class="code" href="ou2_8c.html#af8e4e3fc5b56a3cf8340fd6534c71e00">ALPHA4</a>,<a class="code" href="ou2_8c.html#ab2ee134520af69f566c53e1653198f29">SIGMA1</a>,<a class="code" href="ou2_8c.html#ae5afe6a4069844a8988fffedaa523856">SIGMA2</a>,<a class="code" href="ou2_8c.html#a3f470cf546586fe861be7be3c24557bc">SIGMA3</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a39104e744ca71e0cd070ff508eb64a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39104e744ca71e0cd070ff508eb64a9a">&#9670;&nbsp;</a></span>_ou2_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ou2_vmeasure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>vmatindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>stateindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>parindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>covindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ou2_8c_source.html#l00127">127</a> of file <a class="el" href="ou2_8c_source.html">ou2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">double</span> sd = fabs(<a class="code" href="ou2_8c.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a> = <a class="code" href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a> = sd*sd;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a> = <a class="code" href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a> = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="aou2_8c_html_a30a3d62562a3da42fdc0697719aad10f"><div class="ttname"><a href="ou2_8c.html#a30a3d62562a3da42fdc0697719aad10f">V12</a></div><div class="ttdeci">#define V12</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00063">ou2.c:63</a></div></div>
<div class="ttc" id="aou2_8c_html_a5bab15beab8e28bbd9f89c19407c7397"><div class="ttname"><a href="ou2_8c.html#a5bab15beab8e28bbd9f89c19407c7397">V21</a></div><div class="ttdeci">#define V21</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00062">ou2.c:62</a></div></div>
<div class="ttc" id="aou2_8c_html_a767d301ad391daed2e4bab0288565f7d"><div class="ttname"><a href="ou2_8c.html#a767d301ad391daed2e4bab0288565f7d">V22</a></div><div class="ttdeci">#define V22</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00064">ou2.c:64</a></div></div>
<div class="ttc" id="aou2_8c_html_a87942002cab74af29b13ec07a3b27edf"><div class="ttname"><a href="ou2_8c.html#a87942002cab74af29b13ec07a3b27edf">V11</a></div><div class="ttdeci">#define V11</div><div class="ttdef"><b>Definition:</b> <a href="ou2_8c_source.html#l00061">ou2.c:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82ea4779fc1cc65f27c3546cbb6669c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82ea4779fc1cc65f27c3546cbb6669c8">&#9670;&nbsp;</a></span>add_skel_args()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP add_skel_args </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Pnames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Cnames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00019">19</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  SEXP var;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">int</span> v;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">// Covariates</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(Cnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Cnames,v)));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// Parameters</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(Pnames)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(Pnames,v)));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// Latent state variables</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">for</span> (v = LENGTH(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)-1; v &gt;= 0; v--) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,installChar(STRING_ELT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,v)));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Time</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  var = NEW_NUMERIC(1);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = LCONS(var,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  SET_TAG(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,install(<span class="stringliteral">&quot;t&quot;</span>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a2e65cd991bb60dd57098ab40b91ac722"><div class="ttname"><a href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a></div><div class="ttdeci">SEXP Snames</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00143">trajectory.c:143</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a94fe754831aa7e8eeb4053fa11b537cd"><div class="ttname"><a href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a></div><div class="ttdeci">SEXP args</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00142">trajectory.c:142</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a82ea4779fc1cc65f27c3546cbb6669c8_icgraph.png" border="0" usemap="#apomp__decls_8h_a82ea4779fc1cc65f27c3546cbb6669c8_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a82ea4779fc1cc65f27c3546cbb6669c8_icgraph" id="apomp__decls_8h_a82ea4779fc1cc65f27c3546cbb6669c8_icgraph">
<area shape="rect" title=" " alt="" coords="213,5,328,32"/>
<area shape="rect" href="pomp__decls_8h.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="5,5,165,32"/>
</map>
</div>

</div>
</div>
<a id="add3f83f20679bad53b6c982ed9dde8ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3f83f20679bad53b6c982ed9dde8ea">&#9670;&nbsp;</a></span>apply_probe_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_data </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>probes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00004">4</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                                                 {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  SEXP retval, data, vals;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <span class="keywordtype">int</span> nprobe;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  nprobe = LENGTH(probes);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  PROTECT(data = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  PROTECT(vals = NEW_LIST(nprobe));</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SET_NAMES(vals,GET_NAMES(probes));</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nprobe; i++) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    SET_ELEMENT(vals,i,eval(PROTECT(lang2(VECTOR_ELT(probes,i),data)),</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      CLOENV(VECTOR_ELT(probes,i))));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordflow">if</span> (!IS_NUMERIC(VECTOR_ELT(vals,i))) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %ld returns a non-numeric result&quot;</span>,i+1);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    }</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    UNPROTECT(1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(vals = VectorToPairList(vals));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(retval = eval(PROTECT(LCONS(install(<span class="stringliteral">&quot;c&quot;</span>),vals)),R_BaseEnv));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_add3f83f20679bad53b6c982ed9dde8ea_icgraph.png" border="0" usemap="#apomp__decls_8h_add3f83f20679bad53b6c982ed9dde8ea_icgraph" alt=""/></div>
<map name="apomp__decls_8h_add3f83f20679bad53b6c982ed9dde8ea_icgraph" id="apomp__decls_8h_add3f83f20679bad53b6c982ed9dde8ea_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,295,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ad2595c6a453ae9fad2f232595ced5ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2595c6a453ae9fad2f232595ced5ccc">&#9670;&nbsp;</a></span>apply_probe_sim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP apply_probe_sim </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>probes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>datval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe_8c_source.html#l00029">29</a> of file <a class="el" href="probe_8c_source.html">probe.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                       {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP x, y, names, sims;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  SEXP returntype, retval, val, valnames;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> nprobe, nsims, nobs, ntimes, nvals;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">double</span> *xp, *yp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> p, s, i, j, k, len0 = 0, len = 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  PROTECT(nsim = AS_INTEGER(nsim));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> ((LENGTH(nsim)!=1) || (INTEGER(nsim)[0]&lt;=0))</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a positive integer.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// &#39;names&#39; holds the names of the probe values</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// we get these from a previous call to &#39;apply_probe_data&#39;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  nprobe = LENGTH(probes);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  nvals = LENGTH(datval);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  PROTECT(names = GET_NAMES(datval));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(returntype = NEW_INTEGER(1));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  *(INTEGER(returntype)) = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  PROTECT(sims = <a class="code" href="pomp__decls_8h.html#adbe89f4789c66d534f2521bc3c4c98e7">do_simulate</a>(<span class="keywordtype">object</span>,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,nsim,returntype,gnsi));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  PROTECT(y = VECTOR_ELT(sims,1));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  *(INTEGER(gnsi)) = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  nobs = INTEGER(GET_DIM(y))[0];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  nsims = INTEGER(GET_DIM(y))[1];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  ntimes = INTEGER(GET_DIM(y))[2];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// set up temporary storage</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  xdim[0] = nobs; xdim[1] = ntimes;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  PROTECT(x = makearray(2,xdim));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  setrownames(x,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// set up matrix to hold results</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  xdim[0] = nsims; xdim[1] = nvals;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(retval = makearray(2,xdim));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(valnames = NEW_LIST(2));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  SET_ELEMENT(valnames,1,names);    <span class="comment">// set column names</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  SET_DIMNAMES(retval,valnames);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">for</span> (p = 0, k = 0; p &lt; nprobe; p++, k += len) { <span class="comment">// loop over probes</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (s = 0; s &lt; nsims; s++) { <span class="comment">// loop over simulations</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">// copy the data from y[,s,] to x[,]</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      xp = REAL(x);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      yp = REAL(y)+nobs*s;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; ntimes; j++, yp += nobs*nsims) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, xp++) *xp = yp[i];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="comment">// evaluate the probe on the simulated data</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      PROTECT(val = eval(PROTECT(lang2(VECTOR_ELT(probes,p),x)),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        CLOENV(VECTOR_ELT(probes,p))));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span> (!IS_NUMERIC(val)) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probe %ld returns a non-numeric result.&quot;</span>,p+1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      len = LENGTH(val);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span> (s == 0)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        len0 = len;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len != len0) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;variable-sized results returned by probe %ld.&quot;</span>,p+1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> (k+len &gt; nvals)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      xp = REAL(retval); yp = REAL(val);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) xp[s+nsims*(i+k)] = yp[i];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      UNPROTECT(2);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (k != nvals)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;probes return different number of values on different datasets.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  UNPROTECT(9);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="apomp__decls_8h_html_adbe89f4789c66d534f2521bc3c4c98e7"><div class="ttname"><a href="pomp__decls_8h.html#adbe89f4789c66d534f2521bc3c4c98e7">do_simulate</a></div><div class="ttdeci">SEXP do_simulate(SEXP object, SEXP params, SEXP nsim, SEXP rettype, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="simulate_8c_source.html#l00007">simulate.c:7</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a58d967e1449ba00d87d2f6d70b50d525"><div class="ttname"><a href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a></div><div class="ttdeci">SEXP params</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00131">trajectory.c:131</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_cgraph.png" border="0" usemap="#apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_cgraph" alt=""/></div>
<map name="apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_cgraph" id="apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,139,32"/>
<area shape="rect" href="pomp__decls_8h.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="187,5,289,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_icgraph.png" border="0" usemap="#apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_icgraph" alt=""/></div>
<map name="apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_icgraph" id="apomp__decls_8h_ad2595c6a453ae9fad2f232595ced5ccc_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a91ae33a36d3f40dd64783f1dae67ff8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91ae33a36d3f40dd64783f1dae67ff8b">&#9670;&nbsp;</a></span>bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00050">50</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                                              {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  SEXP y, xr;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> nk = nb+deg+1;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> dx, minx, maxx;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span> *knots = NULL;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> *xdata, *ydata;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (deg &lt; 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (nb &lt;= deg) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; degree&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (d &lt; 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  knots = (<span class="keywordtype">double</span> *) R_Calloc(nk,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  xdata = REAL(xr);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  ydata = REAL(y);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  minx = REAL(range)[0];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  maxx = REAL(range)[1];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (minx &gt;= maxx) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;improper range &#39;rg&#39;&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  dx = (maxx-minx)/((<span class="keywordtype">double</span>) (nb-deg));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  knots[0] = minx-deg*dx;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">for</span> (i = 1; i &lt; nk; i++) knots[i] = knots[i-1]+dx;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; nb; i++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(ydata,xdata,nx,i,deg,d,&amp;knots[0]);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    ydata += nx;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  R_Free(knots);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">return</span>(y);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_a71cbe26144698d7db860dc0f9f0fff0c"><div class="ttname"><a href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a></div><div class="ttdeci">void bspline_eval(double *y, const double *x, int nx, int i, int degree, int deriv, const double *knots)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00009">bspline.c:9</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a91ae33a36d3f40dd64783f1dae67ff8b_cgraph.png" border="0" usemap="#apomp__decls_8h_a91ae33a36d3f40dd64783f1dae67ff8b_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a91ae33a36d3f40dd64783f1dae67ff8b_cgraph" id="apomp__decls_8h_a91ae33a36d3f40dd64783f1dae67ff8b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c" title=" " alt="" coords="164,5,268,32"/>
</map>
</div>

</div>
</div>
<a id="a71cbe26144698d7db860dc0f9f0fff0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71cbe26144698d7db860dc0f9f0fff0c">&#9670;&nbsp;</a></span>bspline_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bspline_eval </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>knots</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00009">9</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordflow">if</span> (deriv &gt; degree) {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) y[j] = 0.0;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deriv &gt; 0) {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">int</span> i2 = i+1, p2 = degree-1, d2 = deriv-1;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">double</span> *y1 = (<span class="keywordtype">double</span> *) R_Calloc(nx,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">double</span> *y2 = (<span class="keywordtype">double</span> *) R_Calloc(nx,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordtype">double</span> a, b;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(y1,x,nx,i,p2,d2,knots);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(y2,x,nx,i2,p2,d2,knots);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      a = degree / (knots[i+degree]-knots[i]);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      b = degree / (knots[i2+degree]-knots[i2]);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      y[j] = a * y1[j] - b * y2[j];</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    R_Free(y1); R_Free(y2);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// deriv == 0</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">int</span> i2 = i+1, p2 = degree-1;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (degree &gt; 0) {  <span class="comment">// case deriv &lt; degree</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">double</span> *y1 = (<span class="keywordtype">double</span> *) R_Calloc(nx,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">double</span> *y2 = (<span class="keywordtype">double</span> *) R_Calloc(nx,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">double</span> a, b;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(y1,x,nx,i,p2,deriv,knots);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(y2,x,nx,i2,p2,deriv,knots);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        a = (x[j]-knots[i]) / (knots[i+degree]-knots[i]);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        b = (knots[i2+degree]-x[j]) / (knots[i2+degree]-knots[i2]);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        y[j] = a * y1[j] + b * y2[j];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      R_Free(y1); R_Free(y2);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (degree == 0) { <span class="comment">// case deriv == degree</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        y[j] = (<span class="keywordtype">double</span>) ((knots[i] &lt;= x[j]) &amp;&amp; (x[j] &lt; knots[i2]));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a71cbe26144698d7db860dc0f9f0fff0c_icgraph.png" border="0" usemap="#apomp__decls_8h_a71cbe26144698d7db860dc0f9f0fff0c_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a71cbe26144698d7db860dc0f9f0fff0c_icgraph" id="apomp__decls_8h_a71cbe26144698d7db860dc0f9f0fff0c_icgraph">
<area shape="rect" title=" " alt="" coords="625,64,729,91"/>
<area shape="rect" href="bspline_8c.html#a91ae33a36d3f40dd64783f1dae67ff8b" title=" " alt="" coords="437,5,548,32"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="408,57,577,98"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,97,108,124"/>
<area shape="rect" href="bspline_8c.html#a5300e64c53a9cbb6aa52d351bd338883" title=" " alt="" coords="173,21,343,48"/>
<area shape="rect" href="bspline_8c.html#acabb1ca64e069e1b7767c31435e761d8" title=" " alt="" coords="156,72,360,99"/>
</map>
</div>

</div>
</div>
<a id="a631dafe45b2fd04f5fb99e59c1c4f1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631dafe45b2fd04f5fb99e59c1c4f1cf">&#9670;&nbsp;</a></span>D_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00114">114</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                                      {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> k, n, nx, ns, np, nt;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">double</span> *F, *<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP f;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  PROTECT(x = AS_NUMERIC(x)); nx = LENGTH(x); <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(x);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  PROTECT(log = AS_INTEGER(log));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  n = (nx &gt; ns) ? nx : ns;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  n = (n &gt; np) ? n : np;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  n = (n &gt; nt) ? n : nt;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  PROTECT(f = NEW_NUMERIC(n)); F = REAL(f);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    F[k] = dbetabinom(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k%nx],S[k%ns],P[k%np],T[k%nt],INTEGER(log)[0]);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa055d45aa938bf55afe432967292b892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa055d45aa938bf55afe432967292b892">&#9670;&nbsp;</a></span>D_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP D_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00046">46</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                                                            {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> *dim, n;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  SEXP f;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span> (dim[0] != ntrans)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;NROW(&#39;x&#39;) should match length of &#39;rate&#39;&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  n = dim[1];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;deulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  PROTECT(f = NEW_NUMERIC(n));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  deulermultinom_multi(&amp;n,&amp;ntrans,REAL(size),REAL(rate),REAL(deltat),REAL(x),INTEGER(log),REAL(f));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="apomp__internal_8h_html_a8224a361dddd2ad59b411982e5ea746f"><div class="ttname"><a href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a></div><div class="ttdeci">#define warn(...)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__internal_8h_source.html#l00015">pomp_internal.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a326516e59ec4f791bcc752ef5f763c71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326516e59ec4f791bcc752ef5f763c71">&#9670;&nbsp;</a></span>do_dmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dmeasure_8c_source.html#l00109">109</a> of file <a class="el" href="dmeasure_8c_source.html">dmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp, nobs;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  SEXP cvec, pompfun;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ans;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP F;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  PROTECT(y = as_matrix(y));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  dim = INTEGER(GET_DIM(y));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  nobs = dim[0];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[1])</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 2nd dimension of &#39;y&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(y)));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dmeasure&quot;</span>)));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// create array to store results</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  PROTECT(F = ret_array(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordtype">int</span> nprotect = 13;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">double</span> *ys = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// build argument list</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = dmeas_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Onames,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames,log)); nprotect++;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, ys += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// evaluate the call</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        PROTECT(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          ans = eval_call(</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            time,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            ys,nobs,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          )</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        );</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (k == 0 &amp;&amp; j == 0 &amp;&amp; LENGTH(ans) != 1)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;dmeasure&#39; returns a vector of length %d when it should return a scalar.&quot;</span>,LENGTH(ans));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        *ft = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">int</span> give_log;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="pomp_8h.html#a3cce583e534ea0296d9b8cc814e125fc">pomp_measure_model_density</a> *ff = NULL;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">double</span> *yp = REAL(y), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *time = REAL(times);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// extract state, parameter, covariate, observable indices</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, yp += nobs) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        (*ff)(ft,yp,xp,pp,give_log,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ft++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        *ft = R_NaReal;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;dmeasure&#39; unspecified: likelihood undefined.&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="ttc" id="alookup__table_8c_html_a036b9fb7cfc62e3984889f95024971a0"><div class="ttname"><a href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a></div><div class="ttdeci">void table_lookup(lookup_table_t *tab, double x, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00053">lookup_table.c:53</a></div></div>
<div class="ttc" id="alookup__table_8c_html_a1e57a24640cb0d9f6f8d55e02c3d553f"><div class="ttname"><a href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a></div><div class="ttdeci">lookup_table_t make_covariate_table(SEXP object, int *ncovar)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00011">lookup_table.c:11</a></div></div>
<div class="ttc" id="alookup__table_8c_html_aa7a80c78f9ef26859eea09b5299e702b"><div class="ttname"><a href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a></div><div class="ttdeci">SEXP get_covariate_names(SEXP object)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00007">lookup_table.c:7</a></div></div>
<div class="ttc" id="apomp_8h_html_a3cce583e534ea0296d9b8cc814e125fc"><div class="ttname"><a href="pomp_8h.html#a3cce583e534ea0296d9b8cc814e125fc">pomp_measure_model_density</a></div><div class="ttdeci">void pomp_measure_model_density(double *lik, const double *y, double *x, const double *p, int give_log, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00231">pomp.h:231</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a5ddde1fa5bcf8c3949fd4865a7ab474c"><div class="ttname"><a href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a></div><div class="ttdeci">void unset_pomp_userdata(void)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00032">userdata.c:32</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a94db08f2d9f751e7832aaadb5ae6920e"><div class="ttname"><a href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a></div><div class="ttdeci">SEXP pomp_fun_handler(SEXP pfun, SEXP gnsi, pompfunmode *mode, SEXP S, SEXP P, SEXP O, SEXP C)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00032">pomp_fun.c:32</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_aa019045daea9be339fd1e70e3441d252"><div class="ttname"><a href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a></div><div class="ttdeci">void set_pomp_userdata(SEXP userdata)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00008">userdata.c:8</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a></div><div class="ttdeci">pompfunmode</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a></div><div class="ttdeci">@ Rfun</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a></div><div class="ttdeci">@ native</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a></div><div class="ttdeci">@ undef</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d"><div class="ttname"><a href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a></div><div class="ttdeci">@ regNative</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00016">pomp_defines.h:16</a></div></div>
<div class="ttc" id="astructlookup__table__t_html"><div class="ttname"><a href="structlookup__table__t.html">lookup_table_t</a></div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00020">pomp_defines.h:20</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a14099a72d03b2c4a17df78083aaefedb"><div class="ttname"><a href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a></div><div class="ttdeci">int npars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00135">trajectory.c:135</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a4edeebb04b42d65deaf721d0abbc091e"><div class="ttname"><a href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div><div class="ttdeci">int ncovars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00136">trajectory.c:136</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a6c1c1c275092d79f830aa36620cfd33d"><div class="ttname"><a href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a></div><div class="ttdeci">pompfunmode mode</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00129">trajectory.c:129</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a72f66d373d52ab42fd8af134bd7f9cda"><div class="ttname"><a href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div><div class="ttdeci">int nreps</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00137">trajectory.c:137</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac0e9686ed371713a6e6717115c66f602"><div class="ttname"><a href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a></div><div class="ttdeci">SEXP cov</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00132">trajectory.c:132</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae1150d665d648766c28508b57a8cb644"><div class="ttname"><a href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a></div><div class="ttdeci">SEXP fn</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00141">trajectory.c:141</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ae8f6d2fd6490d3153cb4133bf183a404"><div class="ttname"><a href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a></div><div class="ttdeci">int nvars</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00134">trajectory.c:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa41223e2376a1ecca8a599619048da63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41223e2376a1ecca8a599619048da63">&#9670;&nbsp;</a></span>do_dprior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprior </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprior_8c_source.html#l00050">50</a> of file <a class="el" href="dprior_8c_source.html">dprior.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  SEXP Pnames, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprior&quot;</span>)));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// to store results</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  PROTECT(F = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span> nprotect = 6;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(Pnames,log,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>)); nprotect++;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(F); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      *pt = *(REAL(AS_NUMERIC(ans)));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">int</span> give_log, *pidx = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a> *ff = NULL;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// construct state, parameter, covariate, observable indices</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    R_CheckUserInterrupt(); <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span> (j = 0, pt = REAL(F), ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt++)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      (*ff)(pt,ps,give_log,pidx);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">int</span> give_log, j;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">double</span> *pt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    give_log = *(INTEGER(AS_INTEGER(log)));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (j = 0, pt = REAL(F); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pt++)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      *pt = (give_log) ? 0.0 : 1.0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a3faa3c7fe8f69a8f03b0cf34bb6d66b6"><div class="ttname"><a href="pomp_8h.html#a3faa3c7fe8f69a8f03b0cf34bb6d66b6">pomp_dprior</a></div><div class="ttdeci">void pomp_dprior(double *lik, const double *p, int give_log, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00237">pomp.h:237</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a6438a8b3220ecd24e531d5b3dd4534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a6438a8b3220ecd24e531d5b3dd4534">&#9670;&nbsp;</a></span>do_dprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_dprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="dprocess_8c_source.html#l00250">250</a> of file <a class="el" href="dprocess_8c_source.html">dprocess.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">int</span> *xdim, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, ntimes;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, covar;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  PROTECT(times=AS_NUMERIC(times));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 2)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(times)&lt;2: with no transitions, there is no work to do.&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  xdim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = xdim[0]; nrepsx = xdim[1];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (ntimes != xdim[2])</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  xdim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = xdim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = xdim[1];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">int</span> nprotect = 3;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (nrepsx &gt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {         <span class="comment">// more states than parameters</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (nrepsx % <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != 0) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      SEXP copy;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; dims[1] = nrepsx;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      PROTECT(copy = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = makearray(2,dims));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      setrownames(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      tgt = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nrepsx; j++) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          *tgt = src[k+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = nrepsx;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nrepsx &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {  <span class="comment">// more parameters than states</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      SEXP copy;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordtype">int</span> dims[3];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dims[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; dims[2] = ntimes;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      PROTECT(copy = duplicate(x));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      PROTECT(x = makearray(3,dims));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      setrownames(x,GET_ROWNAMES(GET_DIMNAMES(copy)),3);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      tgt = REAL(x);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; ntimes; i++) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            *tgt = src[k+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*i)];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// extract the process function</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;dprocess&quot;</span>)));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// extract other arguments</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// evaluate the density</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = onestep_density(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,x,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,covar,log,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  nprotect += 4;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab362c459382493c6f7f4721dc5bf6457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab362c459382493c6f7f4721dc5bf6457">&#9670;&nbsp;</a></span>do_emeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_emeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emeasure_8c_source.html#l00101">101</a> of file <a class="el" href="emeasure_8c_source.html">emeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;emeasure&quot;</span>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              time,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            )</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          nobs = LENGTH(ans);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">if</span> (invalid_names(Onames))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      first = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;              time,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            )</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          );</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="pomp_8h.html#ae9bb1378a2799a6928d1225c2da63d81">pomp_measure_model_expectation</a> *ff = NULL;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = makearray(3,dim)); nprotect++;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    setrownames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    fixdimnames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;emeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_ae9bb1378a2799a6928d1225c2da63d81"><div class="ttname"><a href="pomp_8h.html#ae9bb1378a2799a6928d1225c2da63d81">pomp_measure_model_expectation</a></div><div class="ttdeci">void pomp_measure_model_expectation(double *f, const double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00223">pomp.h:223</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac51832cdc1f6e9a2f22df3a0f385cb86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51832cdc1f6e9a2f22df3a0f385cb86">&#9670;&nbsp;</a></span>do_partrans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_partrans </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="partrans_8c_source.html#l00050">50</a> of file <a class="el" href="partrans_8c_source.html">partrans.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SEXP Pnames, tparams, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, ob;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a> direc;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> qvec, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  qvec = isNull(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <span class="comment">// is &#39;params&#39; a vector?</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(tparams = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// coerce &#39;params&#39; to matrix</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PROTECT(tparams = as_matrix(tparams));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  dim = INTEGER(GET_DIM(tparams));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams)));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// determine direction of transformation and extract corresponding pomp_fun</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  direc = (<a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a>) *(INTEGER(dir));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;partrans&quot;</span>)));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">switch</span> (direc) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a>: <span class="keywordflow">default</span>:   <span class="comment">// from estimation scale</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;from&quot;</span>)));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a>:          <span class="comment">// to estimation scale</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;to&quot;</span>)));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    SEXP ans, nm;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">double</span> *pa, *ps = REAL(tparams);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> *posn;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (invalid_names(nm))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user transformation functions must return named numeric vectors.&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    posn = INTEGER(PROTECT(matchnames(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    nprotect += 4;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (j = 1, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) ps[posn[i]] = pa[i];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="pomp_8h.html#a36db4c064e42345dc674fab1e0a1b83c">pomp_transform_fn</a> *ff;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">double</span> *ps, *pt;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> *idx;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    idx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">for</span> (j = 0, ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), pt = REAL(tparams); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      (*ff)(pt,ps,idx);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">break</span>;  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">if</span> (qvec) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(tparams))); nprotect++;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    SET_DIM(tparams,R_NilValue);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    SET_NAMES(tparams,Pnames);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">return</span> tparams;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6b"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6b">direction_t</a></div><div class="ttdeci">direction_t</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00011">partrans.c:11</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6ba9edb3685af8fa8f6972aa4a1a5eb98c2">from</a></div><div class="ttdeci">@ from</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00011">partrans.c:11</a></div></div>
<div class="ttc" id="apartrans_8c_html_ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54"><div class="ttname"><a href="partrans_8c.html#ae9ae980041e438eed7a3af43ce4e9f6baf6d5fba6cbb9fe52e4176ef9fe5b1f54">to</a></div><div class="ttdeci">@ to</div><div class="ttdef"><b>Definition:</b> <a href="partrans_8c_source.html#l00011">partrans.c:11</a></div></div>
<div class="ttc" id="apomp_8h_html_a36db4c064e42345dc674fab1e0a1b83c"><div class="ttname"><a href="pomp_8h.html#a36db4c064e42345dc674fab1e0a1b83c">pomp_transform_fn</a></div><div class="ttdeci">void pomp_transform_fn(double *pt, const double *p, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00239">pomp.h:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad963b9a55d662fd9085f90fa1d05b399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad963b9a55d662fd9085f90fa1d05b399">&#9670;&nbsp;</a></span>do_rinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rinit </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rinit_8c_source.html#l00082">82</a> of file <a class="el" href="rinit_8c_source.html">rinit.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  SEXP Pnames, Cnames, <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, pcnames;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  SEXP x = R_NilValue;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SEXP pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> npar, nrep, nvar, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nsims, ns;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  nsims = *(INTEGER(AS_INTEGER(nsim)));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  PROTECT(pcnames = GET_COLNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  npar = dim[0]; nrep = dim[1];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  ns = nsims*nrep;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*(REAL(t0)),<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// extract userdata</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rinit&quot;</span>)));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">double</span> *time = REAL(AS_NUMERIC(t0));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">double</span> *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">double</span> *xs, *xt = NULL;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> *midx;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    PROTECT(ans = AS_NUMERIC(eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps,npar,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_NAMES(ans));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (invalid_names(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    nvar = LENGTH(ans);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    xs = REAL(ans);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    midx = INTEGER(PROTECT(match(Pnames,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,0)));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; nvar; j++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">if</span> (midx[j] != 0)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;a state variable and a parameter share the name: &#39;%s&#39;.&quot;</span>,CHAR(STRING_ELT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,j)));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    PROTECT(x = ret_array(nvar,ns,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    xt = REAL(x);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    nprotect += 5;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">for</span> (j = 1, xt += nvar; j &lt; ns; j++, xt += nvar) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,ps+npar*(j%nrep),npar,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      xs = REAL(ans);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">if</span> (LENGTH(ans) != nvar)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user &#39;rinit&#39; returns vectors of non-uniform length.&quot;</span>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      memcpy(xt,xs,nvar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      UNPROTECT(1);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">double</span> *xt, *ps, time;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="pomp_8h.html#a224e5b970a611148739b18bce21f9ca8">pomp_rinit</a> *ff = NULL;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    nvar = LENGTH(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    PROTECT(x = ret_array(nvar,ns,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>)); nprotect++;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    time = *(REAL(t0));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (j = 0, xt = REAL(x), ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>); j &lt; ns; j++, xt += nvar)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      (*ff)(xt,ps+npar*(j%nrep),time,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    PROTECT(x = pomp_default_rinit(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,Pnames,npar,nrep,ns)); nprotect++;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// now add column names</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (nrep &gt; 1) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    SEXP dn, xn;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">int</span> k, *p;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (isNull(pcnames)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      PROTECT(pcnames = NEW_INTEGER(nrep)); nprotect++;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">for</span> (k = 0, p = INTEGER(pcnames); k &lt; nrep; k++, p++) *p = k+1;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (nsims &gt; 1) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordtype">int</span> k, *sp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      PROTECT(xn = NEW_INTEGER(ns));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">for</span> (k = 0, sp = INTEGER(xn); k &lt; ns; k++, sp++) *sp = (k/nrep)+1;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      PROTECT(xn = paste(pcnames,xn,mkString(<span class="stringliteral">&quot;_&quot;</span>)));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      PROTECT(dn = GET_DIMNAMES(x));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      SET_ELEMENT(dn,1,xn);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      SET_DIMNAMES(x,dn);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      PROTECT(dn = GET_DIMNAMES(x)); nprotect++;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      SET_ELEMENT(dn,1,pcnames);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      SET_DIMNAMES(x,dn);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a224e5b970a611148739b18bce21f9ca8"><div class="ttname"><a href="pomp_8h.html#a224e5b970a611148739b18bce21f9ca8">pomp_rinit</a></div><div class="ttdeci">void pomp_rinit(double *x, const double *p, double t, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00199">pomp.h:199</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4917309d8b878da9adfc8ee6223bc2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4917309d8b878da9adfc8ee6223bc2a">&#9670;&nbsp;</a></span>do_rmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rmeasure_8c_source.html#l00101">101</a> of file <a class="el" href="rmeasure_8c_source.html">rmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> nobs = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rmeasure&quot;</span>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              time,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            )</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          nobs = LENGTH(ans);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          PROTECT(Onames = GET_NAMES(ans));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">if</span> (invalid_names(Onames))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      first = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;              time,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            )</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          );</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nobs)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          memcpy(yt,ys,nobs*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          yt += nobs;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="pomp_8h.html#a053e7c8f511ee3fee0bf92f05fb1684e">pomp_measure_model_simulator</a> *ff = NULL;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nobs) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        (*ff)(yt,xp,pp,oidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">int</span> dim[3] = {nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = makearray(3,dim)); nprotect++;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    setrownames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,3);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    fixdimnames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,3);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a053e7c8f511ee3fee0bf92f05fb1684e"><div class="ttname"><a href="pomp_8h.html#a053e7c8f511ee3fee0bf92f05fb1684e">pomp_measure_model_simulator</a></div><div class="ttdeci">void pomp_measure_model_simulator(double *y, double *x, const double *p, const int *obsindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00219">pomp.h:219</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff3b8f1d525f9c301d07b63276b76b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff3b8f1d525f9c301d07b63276b76b43">&#9670;&nbsp;</a></span>do_rprior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprior </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprior_8c_source.html#l00061">61</a> of file <a class="el" href="rprior_8c_source.html">rprior.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  SEXP Pnames, pompfun, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  SEXP P = R_NilValue;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprior&quot;</span>)));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,NA_STRING,Pnames,NA_STRING,NA_STRING));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  PROTECT(P = ret_array(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> nprotect = 6;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    SEXP ans, nm;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">double</span> *pa, *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>), *pt = REAL(P);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> *posn = NULL;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// set up the function call</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,Pnames)); nprotect++;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, pt += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (invalid_names(nm))</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprior&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        posn = INTEGER(PROTECT(matchnames(Pnames,nm,<span class="stringliteral">&quot;parameters&quot;</span>)));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) pt[posn[i]] = pa[i];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    first = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,ps,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        pa = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; LENGTH(ans); i++) pt[posn[i]] = pa[i];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">double</span> *ps;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">int</span> *pidx = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a> *ff = NULL;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// extract parameter index</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    R_CheckUserInterrupt(); <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (j = 0, ps = REAL(P); j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, ps += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      (*ff)(ps,pidx);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// just duplicate</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;rprior&#39; unspecified: duplicating parameters.&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">return</span> P;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a910c57a1b150c29312792eba4a5fb2d3"><div class="ttname"><a href="pomp_8h.html#a910c57a1b150c29312792eba4a5fb2d3">pomp_rprior</a></div><div class="ttdeci">void pomp_rprior(double *p, const int *parindex)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00235">pomp.h:235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91f2867fc46d33e1778108853725d74a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f2867fc46d33e1778108853725d74a">&#9670;&nbsp;</a></span>do_rprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_rprocess </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rprocess_8c_source.html#l00027">27</a> of file <a class="el" href="rprocess_8c_source.html">rprocess.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> *xdim, type, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, ntimes;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, copy, rproc, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, accumvars, covar;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  SEXP dimXstart, dimP;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[3] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  PROTECT(gnsi = duplicate(gnsi));</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(times) &lt; 1: no work to do.&quot;</span>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  PROTECT(xstart = as_matrix(xstart));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  PROTECT(dimXstart = GET_DIM(xstart));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  xdim = INTEGER(dimXstart);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = xdim[0]; nrepsx = xdim[1];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  PROTECT(dimP = GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  xdim = INTEGER(dimP);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = xdim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = xdim[1];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">if</span> (nrepsx &gt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {     <span class="comment">// more ICs than parameters</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (nrepsx % <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != 0) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; dims[1] = nrepsx;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      PROTECT(copy = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = makearray(2,dims));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      setrownames(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      tgt = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nrepsx; j++) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          *tgt = src[k+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = nrepsx;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nrepsx &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {  <span class="comment">// more parameters than ICs</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;the larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">double</span> *src, *tgt;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordtype">int</span> dims[2];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      dims[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dims[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      PROTECT(copy = duplicate(xstart));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      PROTECT(xstart = makearray(2,dims));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      setrownames(xstart,GET_ROWNAMES(GET_DIMNAMES(copy)),2);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      src = REAL(copy);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      tgt = REAL(xstart);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; k++, tgt++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          *tgt = src[k+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*(j%nrepsx)];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  PROTECT(rproc = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;rprocess&quot;</span>)));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  PROTECT(covar = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  nprotect += 4;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// extract the process function</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  type = *(INTEGER(GET_SLOT(rproc,install(<span class="stringliteral">&quot;type&quot;</span>))));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="comment">// one-step simulator</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span> deltat = 1.0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="euler_8c.html#a83f6b69b51bdf12eb0fe150ccc05f80d">euler_model_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      accumvars,covar,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>: <span class="comment">// discrete-time and Euler</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">double</span> deltat;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;step.fn&quot;</span>)));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    deltat = *(REAL(AS_NUMERIC(GET_SLOT(rproc,install(<span class="stringliteral">&quot;delta.t&quot;</span>)))));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="euler_8c.html#a83f6b69b51bdf12eb0fe150ccc05f80d">euler_model_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,deltat,type,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      accumvars,covar,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a>: <span class="comment">// Gillespie&#39;s method</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, vmatrix, hmax;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = GET_SLOT(rproc,install(<span class="stringliteral">&quot;rate.fn&quot;</span>)));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    PROTECT(vmatrix = GET_SLOT(rproc,install(<span class="stringliteral">&quot;v&quot;</span>)));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    PROTECT(hmax = GET_SLOT(rproc,install(<span class="stringliteral">&quot;hmax&quot;</span>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = <a class="code" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6">SSA_simulator</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,xstart,tstart,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,vmatrix,covar,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      accumvars,hmax,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,gnsi));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    nprotect += 4;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = pomp_default_rprocess(xstart,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    nprotect++;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  fixdimnames(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,3);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="ttc" id="aeuler_8c_html_a83f6b69b51bdf12eb0fe150ccc05f80d"><div class="ttname"><a href="euler_8c.html#a83f6b69b51bdf12eb0fe150ccc05f80d">euler_model_simulator</a></div><div class="ttdeci">SEXP euler_model_simulator(SEXP func, SEXP xstart, SEXP tstart, SEXP times, SEXP params, double deltat, rprocmode method, SEXP accumvars, SEXP covar, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00109">euler.c:109</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a868191e685624fbffd57ee4f32859ac6"><div class="ttname"><a href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6">SSA_simulator</a></div><div class="ttdeci">SEXP SSA_simulator(SEXP func, SEXP xstart, SEXP tstart, SEXP times, SEXP params, SEXP vmatrix, SEXP covar, SEXP accumvars, SEXP hmax, SEXP args, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00230">ssa.c:230</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a0e24e0126aae5a1f0e94feb82e032d23">gill</a></div><div class="ttdeci">@ gill</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a></div><div class="ttdeci">@ discrete</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a3911cbc079cca9f8b6953023b97c3598">dflt</a></div><div class="ttdeci">@ dflt</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a></div><div class="ttdeci">@ onestep</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e"><div class="ttname"><a href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a></div><div class="ttdeci">@ euler</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00017">pomp_defines.h:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe89f4789c66d534f2521bc3c4c98e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe89f4789c66d534f2521bc3c4c98e7">&#9670;&nbsp;</a></span>do_simulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_simulate </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nsim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rettype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="simulate_8c_source.html#l00007">7</a> of file <a class="el" href="simulate_8c_source.html">simulate.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  SEXP t0, times, x0, x, y;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  SEXP ans = R_NilValue, ans_names = R_NilValue;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SEXP simnames;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">int</span> return_type = *(INTEGER(rettype)); <span class="comment">// 0 = array, 1 = pomps</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">if</span> (LENGTH(nsim) != 1) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;nsim&#39; must be a single integer&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(t0 = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;t0&quot;</span>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  PROTECT(times = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">// initialize the simulations</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(x0 = <a class="code" href="pomp__decls_8h.html#ad963b9a55d662fd9085f90fa1d05b399">do_rinit</a>(<span class="keywordtype">object</span>,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,t0,nsim,gnsi));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  PROTECT(simnames = GET_COLNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">// call &#39;rprocess&#39; to simulate state process</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  PROTECT(x = <a class="code" href="pomp__decls_8h.html#a91f2867fc46d33e1778108853725d74a">do_rprocess</a>(<span class="keywordtype">object</span>,x0,t0,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">// call &#39;rmeasure&#39; to simulate the measurement process</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  PROTECT(y = <a class="code" href="pomp__decls_8h.html#aa4917309d8b878da9adfc8ee6223bc2a">do_rmeasure</a>(<span class="keywordtype">object</span>,x,times,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>,gnsi));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  setcolnames(x,simnames);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  setcolnames(y,simnames);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">switch</span> (return_type) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">case</span> 0:  <span class="comment">// return a list of arrays</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(ans = NEW_LIST(2));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    PROTECT(ans_names = NEW_CHARACTER(2));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    SET_STRING_ELT(ans_names,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    SET_STRING_ELT(ans_names,1,mkChar(<span class="stringliteral">&quot;obs&quot;</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    SET_ELEMENT(ans,0,x);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    SET_ELEMENT(ans,1,y);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// a list to hold the pomp objects</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      SEXP pp, xx, yy, po;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *xdim;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">int</span> nvar, npar, nobs, nsim, ntim, nparsets;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">int</span> dim[2], i, j, k;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      PROTECT(po = duplicate(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;t0&quot;</span>),t0);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;times&quot;</span>),times);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      xdim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      nvar = xdim[0]; nsim = xdim[1]; ntim = xdim[2];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      xdim = INTEGER(GET_DIM(y));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      nobs = xdim[0]; <span class="comment">// second dimensions of &#39;x&#39; and &#39;y&#39; must agree</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      xdim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      npar = xdim[0]; nparsets = xdim[1];</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      dim[0] = nvar; dim[1] = ntim;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      PROTECT(xx = makearray(2,dim));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      setrownames(xx,GET_ROWNAMES(GET_DIMNAMES(x)),2);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;states&quot;</span>),xx);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      dim[0] = nobs; dim[1] = ntim;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      PROTECT(yy = makearray(2,dim));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      setrownames(yy,GET_ROWNAMES(GET_DIMNAMES(y)),2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;data&quot;</span>),yy);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      PROTECT(pp = NEW_NUMERIC(npar));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      SET_NAMES(pp,GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      SET_SLOT(po,install(<span class="stringliteral">&quot;params&quot;</span>),pp);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      PROTECT(ans = NEW_LIST(nsim));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      SET_NAMES(ans,simnames);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      nprotect += 5;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; nsim; k++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        SEXP po2;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">double</span> *xs = REAL(x), *ys = REAL(y), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordtype">double</span> *xt, *yt, *pt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        PROTECT(po2 = duplicate(po));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        xt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;states&quot;</span>)));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        yt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;data&quot;</span>)));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        pt = REAL(GET_SLOT(po2,install(<span class="stringliteral">&quot;params&quot;</span>)));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        memcpy(pt,ps+npar*(k%nparsets),npar*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">// copy x[,k,] and y[,k,] into po2</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; ntim; j++) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; nvar; i++, xt++) *xt = xs[i+nvar*(k+nsim*j)];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; nobs; i++, yt++) *yt = ys[i+nobs*(k+nsim*j)];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        SET_ELEMENT(ans,k,po2);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="ttc" id="apomp__decls_8h_html_a91f2867fc46d33e1778108853725d74a"><div class="ttname"><a href="pomp__decls_8h.html#a91f2867fc46d33e1778108853725d74a">do_rprocess</a></div><div class="ttdeci">SEXP do_rprocess(SEXP object, SEXP xstart, SEXP tstart, SEXP times, SEXP params, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="rprocess_8c_source.html#l00027">rprocess.c:27</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_aa4917309d8b878da9adfc8ee6223bc2a"><div class="ttname"><a href="pomp__decls_8h.html#aa4917309d8b878da9adfc8ee6223bc2a">do_rmeasure</a></div><div class="ttdeci">SEXP do_rmeasure(SEXP object, SEXP x, SEXP times, SEXP params, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="rmeasure_8c_source.html#l00101">rmeasure.c:101</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_ad963b9a55d662fd9085f90fa1d05b399"><div class="ttname"><a href="pomp__decls_8h.html#ad963b9a55d662fd9085f90fa1d05b399">do_rinit</a></div><div class="ttdeci">SEXP do_rinit(SEXP object, SEXP params, SEXP t0, SEXP nsim, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="rinit_8c_source.html#l00082">rinit.c:82</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_adbe89f4789c66d534f2521bc3c4c98e7_icgraph.png" border="0" usemap="#apomp__decls_8h_adbe89f4789c66d534f2521bc3c4c98e7_icgraph" alt=""/></div>
<map name="apomp__decls_8h_adbe89f4789c66d534f2521bc3c4c98e7_icgraph" id="apomp__decls_8h_adbe89f4789c66d534f2521bc3c4c98e7_icgraph">
<area shape="rect" title=" " alt="" coords="337,5,440,32"/>
<area shape="rect" href="pomp__decls_8h.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="156,5,289,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a93ce73bdd2e70be7b043dcfc1a5d259c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ce73bdd2e70be7b043dcfc1a5d259c">&#9670;&nbsp;</a></span>do_skeleton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_skeleton </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00342">342</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, nrepp, nrepx, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Cnames, Pnames;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  SEXP pompfun, <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, ob;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>, F;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  ntimes = LENGTH(t);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepx = dim[1];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;t&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// 2nd dimension of &#39;x&#39; and &#39;params&#39; need not agree</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepp &gt; nrepx) ? nrepp : nrepx;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepx != 0))</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;2nd dimensions of &#39;x&#39; and &#39;params&#39; are incompatible&quot;</span>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  PROTECT(F = ret_array(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">int</span> nprotect = 12;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a>(REAL(F),REAL(t),REAL(x),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      &amp;covariate_table,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff = NULL;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a>(</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      REAL(F),REAL(t),REAL(x),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepx,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      sidx,pidx,cidx,&amp;covariate_table,ff,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">double</span> *ft = REAL(F);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">int</span> i, n = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++, ft++) *ft = R_NaReal;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">return</span> F;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a1c79f52f1a622f5a59fea40ad9dfe1f4"><div class="ttname"><a href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a></div><div class="ttdeci">void pomp_skeleton(double *f, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00215">pomp.h:215</a></div></div>
<div class="ttc" id="askeleton_8c_html_a4c519c3f1f7ceca7aae16c0aa702cfeb"><div class="ttname"><a href="skeleton_8c.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *f, double *time, double *x, double *p, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, int *sidx, int *pidx, int *cidx, lookup_table_t *covar_table, pomp_skeleton *fun, SEXP args, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00253">skeleton.c:253</a></div></div>
<div class="ttc" id="askeleton_8c_html_a82ea4779fc1cc65f27c3546cbb6669c8"><div class="ttname"><a href="skeleton_8c.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00019">skeleton.c:19</a></div></div>
<div class="ttc" id="askeleton_8c_html_ab5870e93076f917246e64740c1416a05"><div class="ttname"><a href="skeleton_8c.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *f, double *time, double *x, double *p, SEXP fn, SEXP args, SEXP Snames, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, lookup_table_t *covar_table, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00102">skeleton.c:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97fc58eebfdaa733377f210c1dd48082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97fc58eebfdaa733377f210c1dd48082">&#9670;&nbsp;</a></span>do_vmeasure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP do_vmeasure </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vmeasure_8c_source.html#l00102">102</a> of file <a class="el" href="vmeasure_8c_source.html">vmeasure.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">int</span> ntimes, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepsx, nrepsp;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> nobs = 0, nans = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Onames = R_NilValue;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SEXP pompfun;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = R_NilValue;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  SEXP cvec;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  ntimes = length(times);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (ntimes &lt; 1)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length(&#39;times&#39;) = 0, no work to do.&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  PROTECT(x = as_state_array(x));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  dim = INTEGER(GET_DIM(x));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; nrepsx = dim[1];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (ntimes != dim[2])</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;times&#39; and 3rd dimension of &#39;x&#39; do not agree.&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepsp = dim[1];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = (nrepsp &gt; nrepsx) ? nrepsp : nrepsx;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsp != 0) || (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % nrepsx != 0))</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;larger number of replicates is not a multiple of smaller.&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  PROTECT(pompfun = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;vmeasure&quot;</span>)));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  PROTECT(Onames = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsnames&quot;</span>)));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// extract the user-defined function</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Onames,Cnames));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// first do setup</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">double</span> *ys, *yt = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    SEXP ans;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>); <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              time,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            )</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      );</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          nans = LENGTH(ans);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      nobs = (int) sqrt(nans);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">if</span> (nans != nobs*nobs)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a symmetric square matrix.&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          PROTECT(Onames = GET_ROWNAMES(GET_DIMNAMES(ans)));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="keywordflow">if</span> (invalid_names(Onames))</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; must return a matrix with row-names.&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          yt += nans;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      first = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          PROTECT(</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            ans = eval_call(</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              time,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;              xs+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            )</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          );</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != nans)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; returns variable-length results.&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          ys = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          memcpy(yt,ys,nans*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          yt += nans;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">double</span> *yt = 0, *xp, *pp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">double</span> *time = REAL(times), *xs = REAL(x), *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    SEXP vmatindex;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">int</span> *oidx, *sidx, *pidx, *cidx, *vmidx;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="pomp_8h.html#abde17f5a684e4a1a6c276a2ce3da3715">pomp_measure_model_covariance</a> *ff = NULL;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    nans = nobs*nobs;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// extract observable, state, parameter covariate indices</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    oidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>)));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    PROTECT(vmatindex = NEW_INTEGER(nans)); nprotect++;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    vmidx = INTEGER(vmatindex);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nobs; k++) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nobs; j++) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    vmidx[j+nobs*k] = oidx[j]+nobs*oidx[k];</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// address of native routine</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = ret_array(nobs,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,Onames)); nprotect++;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) { <span class="comment">// loop over times</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      R_CheckUserInterrupt();   <span class="comment">// check for user interrupt</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, yt += nans) { <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        xp = &amp;xs[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepsx)+nrepsx*k)];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        pp = &amp;ps[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepsp)];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        (*ff)(yt,xp,pp,vmidx,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    nobs = LENGTH(Onames);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">int</span> dim[4] = {nobs, nobs, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes};</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[4] = {<span class="stringliteral">&quot;var1&quot;</span>,<span class="stringliteral">&quot;var2&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">double</span> *yt = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">int</span> i, n = nobs*nobs*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*ntimes;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = makearray(4,dim)); nprotect++;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    setrownames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames,4);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    setcolnames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,Onames);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    fixdimnames(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>,dimnm,4);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">for</span> (i = 0, yt = REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>); i &lt; n; i++, yt++) *yt = R_NaReal;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;&#39;vmeasure&#39; unspecified: NAs generated.&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_abde17f5a684e4a1a6c276a2ce3da3715"><div class="ttname"><a href="pomp_8h.html#abde17f5a684e4a1a6c276a2ce3da3715">pomp_measure_model_covariance</a></div><div class="ttdeci">void pomp_measure_model_covariance(double *f, const double *x, const double *p, const int *vmatindex, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00227">pomp.h:227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83f6b69b51bdf12eb0fe150ccc05f80d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f6b69b51bdf12eb0fe150ccc05f80d">&#9670;&nbsp;</a></span>euler_model_simulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP euler_model_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94">rprocmode</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>accumvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00109">109</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, ntimes, nzeros, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>, t0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP cvec, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (deltat &lt;= 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;delta.t&#39; should be a positive number.&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  dim = INTEGER(GET_DIM(xstart)); <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  t0 = *(REAL(tstart));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(covar,&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  PROTECT(cvec = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = REAL(cvec);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// indices of accumulator variables</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordtype">int</span> *zidx = INTEGER(PROTECT(matchnames(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// extract user function</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// array to hold results</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = ret_array(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// copy the start values into the result array</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  memcpy(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(xstart),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// set up</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> nprotect = 9;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">int</span> *pidx = 0, *sidx = 0, *cidx = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a> *ff = NULL;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// construct list of all arguments</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    GetRNGstate();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">break</span>;                              <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// main computation loop</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">int</span> step;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">double</span> *xt, *time, t;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">for</span> (</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       step = 0, xt = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>), time = REAL(times), t = t0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       step &lt; ntimes;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       step++, xt += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       ) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">double</span> dt;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">int</span> nstep = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (t &gt; time[step]) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;times&#39; must be an increasing sequence.&quot;</span>);  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        xt[zidx[i]+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*j] = 0.0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// determine size and number of time-steps</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">switch</span> (method) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a8e659bdb4aa674f348aed67fe394ba59">onestep</a>: <span class="keywordflow">default</span>:      <span class="comment">// one step</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      dt = time[step]-t;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      nstep = (dt &gt; 0) ? 1 : 0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94a32811eb9eed4b85ef0847fcde95b69ad">discrete</a>:              <span class="comment">// fixed step</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      dt = deltat;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      nstep = <a class="code" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a>(t,time[step],dt);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>:                 <span class="comment">// Euler method</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      dt = deltat;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      nstep = <a class="code" href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a>(t,time[step],&amp;dt);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// loop over individual steps</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nstep; k++) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;covariate_table,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// loop over replicates</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordtype">double</span> *ap, *pm, *xm, *ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">for</span> (j = 0, pm = ps, xm = xt; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, pm += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, xm += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        SEXP ans, nm;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <span class="keywordflow">if</span> (invalid_names(nm))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;rprocess&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          pidx = INTEGER(PROTECT(matchnames(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          nprotect += 3;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          first = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,&amp;dt,xm,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,pm,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xm[pidx[i]] = ap[i];</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      (*ff)(xm,pm,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t,dt);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">default</span>:                  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">break</span>;                  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      t += dt;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">if</span> ((method == <a class="code" href="pomp__defines_8h.html#a0aa36f1ae250f8c08c6222d21729af94aadb417b559f09f8023df24ecf53eec0e">euler</a>) &amp;&amp; (k == nstep-2)) { <span class="comment">// penultimate step</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        dt = time[step]-t;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        t = time[step]-dt;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (step &lt; ntimes-1)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      memcpy(xt+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,xt,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// clean up</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div>
<div class="ttc" id="aeuler_8c_html_a0681d20c093a288da04bffa9adbfe48a"><div class="ttname"><a href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a></div><div class="ttdeci">int num_map_steps(double t1, double t2, double deltat)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00344">euler.c:344</a></div></div>
<div class="ttc" id="aeuler_8c_html_a3da8d135fe6d232031cf7c314f432265"><div class="ttname"><a href="euler_8c.html#a3da8d135fe6d232031cf7c314f432265">num_euler_steps</a></div><div class="ttdeci">int num_euler_steps(double t1, double t2, double *deltat)</div><div class="ttdef"><b>Definition:</b> <a href="euler_8c_source.html#l00319">euler.c:319</a></div></div>
<div class="ttc" id="apomp_8h_html_abd7cfb2f9064495241ac3474f912d36d"><div class="ttname"><a href="pomp_8h.html#abd7cfb2f9064495241ac3474f912d36d">pomp_onestep_sim</a></div><div class="ttdeci">void pomp_onestep_sim(double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars, double t, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00206">pomp.h:206</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a83f6b69b51bdf12eb0fe150ccc05f80d_cgraph.png" border="0" usemap="#apomp__decls_8h_a83f6b69b51bdf12eb0fe150ccc05f80d_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a83f6b69b51bdf12eb0fe150ccc05f80d_cgraph" id="apomp__decls_8h_a83f6b69b51bdf12eb0fe150ccc05f80d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,177,57"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="227,5,390,32"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="225,56,392,83"/>
</map>
</div>

</div>
</div>
<a id="a4c519c3f1f7ceca7aae16c0aa702cfeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c519c3f1f7ceca7aae16c0aa702cfeb">&#9670;&nbsp;</a></span>eval_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>cidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00253">253</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">double</span> *xp, *pp;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      xp = &amp;x[<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k)];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      pp = &amp;p[<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp)];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      (*fun)(f,xp,pp,sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,*time);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a6d8415c759496fb5460bce9a56445919"><div class="ttname"><a href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a></div><div class="ttdeci">lookup_table_t covar_table</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00133">trajectory.c:133</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_cgraph.png" border="0" usemap="#apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_cgraph" id="apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,165,83"/>
<area shape="rect" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252" title=" " alt="" coords="221,5,372,32"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="243,56,350,83"/>
<area shape="rect" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c" title=" " alt="" coords="213,107,380,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_icgraph.png" border="0" usemap="#apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_icgraph" id="apomp__decls_8h_a4c519c3f1f7ceca7aae16c0aa702cfeb_icgraph">
<area shape="rect" title=" " alt="" coords="168,5,328,32"/>
<area shape="rect" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,5,120,32"/>
</map>
</div>

</div>
</div>
<a id="ab5870e93076f917246e64740c1416a05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5870e93076f917246e64740c1416a05">&#9670;&nbsp;</a></span>eval_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eval_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00102">102</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  SEXP ans, nm;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span> *fs;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// interpolate the covar functions for the covariates</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,*time,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, f += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          x+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans)!=<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="keywordflow">if</span> (invalid_names(nm))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          posn = INTEGER(PROTECT(matchnames(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      first = 0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,time,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          x+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*((j%nrepx)+nrepx*k),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        fs = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) f[posn[i]] = fs[i];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        UNPROTECT(1);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ab5870e93076f917246e64740c1416a05_cgraph.png" border="0" usemap="#apomp__decls_8h_ab5870e93076f917246e64740c1416a05_cgraph" alt=""/></div>
<map name="apomp__decls_8h_ab5870e93076f917246e64740c1416a05_cgraph" id="apomp__decls_8h_ab5870e93076f917246e64740c1416a05_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,32"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="181,5,288,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ab5870e93076f917246e64740c1416a05_icgraph.png" border="0" usemap="#apomp__decls_8h_ab5870e93076f917246e64740c1416a05_icgraph" alt=""/></div>
<map name="apomp__decls_8h_ab5870e93076f917246e64740c1416a05_icgraph" id="apomp__decls_8h_ab5870e93076f917246e64740c1416a05_icgraph">
<area shape="rect" title=" " alt="" coords="168,5,296,32"/>
<area shape="rect" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,5,120,32"/>
</map>
</div>

</div>
</div>
<a id="a68db7c3a0f761d40b1d94b8e71a633dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68db7c3a0f761d40b1d94b8e71a633dc">&#9670;&nbsp;</a></span>ExpitTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP ExpitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00026">26</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                             {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span> *x;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  x = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  n = LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, x++)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    *x = 1.0/(1.0+exp(-(*x)));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7a80c78f9ef26859eea09b5299e702b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a80c78f9ef26859eea09b5299e702b">&#9670;&nbsp;</a></span>get_covariate_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP get_covariate_names </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00007">7</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                       {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordflow">return</span> GET_ROWNAMES(GET_DIMNAMES(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_aa7a80c78f9ef26859eea09b5299e702b_icgraph.png" border="0" usemap="#apomp__decls_8h_aa7a80c78f9ef26859eea09b5299e702b_icgraph" alt=""/></div>
<map name="apomp__decls_8h_aa7a80c78f9ef26859eea09b5299e702b_icgraph" id="apomp__decls_8h_aa7a80c78f9ef26859eea09b5299e702b_icgraph">
<area shape="rect" title=" " alt="" coords="376,107,539,133"/>
<area shape="rect" href="euler_8c.html#a83f6b69b51bdf12eb0fe150ccc05f80d" title=" " alt="" coords="156,5,328,32"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="179,56,305,83"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,81,108,108"/>
<area shape="rect" href="pomp__decls_8h.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="162,157,322,184"/>
<area shape="rect" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="183,208,301,235"/>
</map>
</div>

</div>
</div>
<a id="a44f810b1f9d483bd150f3e71102b9534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f810b1f9d483bd150f3e71102b9534">&#9670;&nbsp;</a></span>get_userdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const SEXP get_userdata </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00012">12</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                                           {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  SEXP elt = getPairListElement(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">return</span> elt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
<div class="ttc" id="auserdata_8c_html_a1157d519a72b891b41cef2d20a90bebb"><div class="ttname"><a href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a></div><div class="ttdeci">#define USERDATA</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00006">userdata.c:6</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a44f810b1f9d483bd150f3e71102b9534_icgraph.png" border="0" usemap="#apomp__decls_8h_a44f810b1f9d483bd150f3e71102b9534_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a44f810b1f9d483bd150f3e71102b9534_icgraph" id="apomp__decls_8h_a44f810b1f9d483bd150f3e71102b9534_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,263,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a5703410301afea05b3a3d521ad65597f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5703410301afea05b3a3d521ad65597f">&#9670;&nbsp;</a></span>get_userdata_double()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double* get_userdata_double </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00025">25</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                                     {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP elt = getPairListElement(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (!isReal(elt)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not a numeric vector.&quot;</span>,name);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">return</span> REAL(elt);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a5703410301afea05b3a3d521ad65597f_icgraph.png" border="0" usemap="#apomp__decls_8h_a5703410301afea05b3a3d521ad65597f_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a5703410301afea05b3a3d521ad65597f_icgraph" id="apomp__decls_8h_a5703410301afea05b3a3d521ad65597f_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,315,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="ab81184a02668adfde937ace9d4cd3c89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab81184a02668adfde937ace9d4cd3c89">&#9670;&nbsp;</a></span>get_userdata_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int* get_userdata_int </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00018">18</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                               {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  SEXP elt = getPairListElement(<a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a>,name);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (isNull(elt)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;no user-data element &#39;%s&#39; is found.&quot;</span>,name);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> (!isInteger(elt)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;user-data element &#39;%s&#39; is not an integer.&quot;</span>,name);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span> INTEGER(elt);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ab81184a02668adfde937ace9d4cd3c89_icgraph.png" border="0" usemap="#apomp__decls_8h_ab81184a02668adfde937ace9d4cd3c89_icgraph" alt=""/></div>
<map name="apomp__decls_8h_ab81184a02668adfde937ace9d4cd3c89_icgraph" id="apomp__decls_8h_ab81184a02668adfde937ace9d4cd3c89_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,287,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a7be026ee05148f7fcf4af0d35983a405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7be026ee05148f7fcf4af0d35983a405">&#9670;&nbsp;</a></span>InverseLogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP InverseLogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00047">47</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                             {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(LENGTH(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>)));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  from_log_barycentric(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),LENGTH(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ee9c5f69ec3b1b090448cb76634602d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ee9c5f69ec3b1b090448cb76634602d">&#9670;&nbsp;</a></span>iterate_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP iterate_map </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00022">22</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  SEXP skel, pompfun;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SEXP accumvars;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP repnames;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> *zidx = 0;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, nrepp, ntimes, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, nzeros;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">double</span> deltat, t;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  PROTECT(skel = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  deltat = *(REAL(GET_SLOT(skel,install(<span class="stringliteral">&quot;delta.t&quot;</span>))));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  t = *(REAL(AS_NUMERIC(t0)));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  PROTECT(x0 = duplicate(x0));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  PROTECT(x0 = as_matrix(x0));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; nrepp = dim[1];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(repnames = GET_COLNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// extract user-defined function</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PROTECT(pompfun = GET_SLOT(skel,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// create array to store results</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = ret_array(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,ntimes,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,repnames));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// get names and indices of accumulator variables</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  PROTECT(accumvars = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;accumvars&quot;</span>)));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> nprotect = 15;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">if</span> (nzeros &gt; 0) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    zidx = INTEGER(PROTECT(matchnames(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// set up the computations</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = <a class="code" href="pomp__decls_8h.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames)); nprotect++;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="pomp__decls_8h.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2">iterate_skeleton_R</a>(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      &amp;covariate_table,zidx,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> *sidx, *pidx, *cidx;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *ff;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;ff)) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// construct state, parameter, covariate indices</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    sidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    pidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    cidx = INTEGER(GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b">iterate_skeleton_native</a>(REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),t,deltat,REAL(times),REAL(x0),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,ntimes,nrepp,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,nzeros,sidx,pidx,cidx,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      &amp;covariate_table,zidx,ff,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,REAL(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">break</span>; <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="apomp__decls_8h_html_a82ea4779fc1cc65f27c3546cbb6669c8"><div class="ttname"><a href="pomp__decls_8h.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a></div><div class="ttdeci">SEXP add_skel_args(SEXP args, SEXP Snames, SEXP Pnames, SEXP Cnames)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00019">skeleton.c:19</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_ab2d2bf78c9a2e064a57e6c9bf3d52bc2"><div class="ttname"><a href="pomp__decls_8h.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2">iterate_skeleton_R</a></div><div class="ttdeci">void iterate_skeleton_R(double *X, double t, double deltat, double *time, double *x, double *p, SEXP fn, SEXP args, SEXP Snames, int nvars, int npars, int ncovars, int ntimes, int nrepp, int nreps, int nzeros, lookup_table_t *covar_table, int *zeroindex, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00169">skeleton.c:169</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_aca7782b5824af2ba096aa0d7f1c4834b"><div class="ttname"><a href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b">iterate_skeleton_native</a></div><div class="ttdeci">void iterate_skeleton_native(double *X, double t, double deltat, double *time, double *x, double *p, int nvars, int npars, int ncovars, int ntimes, int nrepp, int nreps, int nzeros, int *sidx, int *pidx, int *cidx, lookup_table_t *covar_table, int *zeroindex, pomp_skeleton *fun, SEXP args, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00286">skeleton.c:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca7782b5824af2ba096aa0d7f1c4834b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7782b5824af2ba096aa0d7f1c4834b">&#9670;&nbsp;</a></span>iterate_skeleton_native()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_native </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nzeros</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>cidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>zeroindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp_8h.html#a1c79f52f1a622f5a59fea40ad9dfe1f4">pomp_skeleton</a> *&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00286">286</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">double</span> *xs, *Xs;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    nsteps = <a class="code" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        *xs = 0.0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">for</span> (j = 0, Xs = <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, xs = x; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, Xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        (*fun)(Xs,xs,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),sidx,pidx,cidx,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,t);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      memcpy(x,<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        t += deltat;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        t = *time;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (nsteps == 0) memcpy(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_aca7782b5824af2ba096aa0d7f1c4834b_cgraph.png" border="0" usemap="#apomp__decls_8h_aca7782b5824af2ba096aa0d7f1c4834b_cgraph" alt=""/></div>
<map name="apomp__decls_8h_aca7782b5824af2ba096aa0d7f1c4834b_cgraph" id="apomp__decls_8h_aca7782b5824af2ba096aa0d7f1c4834b_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,180,108"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="247,5,376,32"/>
<area shape="rect" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252" title=" " alt="" coords="236,56,387,83"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="258,107,365,133"/>
<area shape="rect" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c" title=" " alt="" coords="228,157,395,184"/>
</map>
</div>

</div>
</div>
<a id="ab2d2bf78c9a2e064a57e6c9bf3d52bc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2d2bf78c9a2e064a57e6c9bf3d52bc2">&#9670;&nbsp;</a></span>iterate_skeleton_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iterate_skeleton_R </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Snames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncovars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntimes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrepp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nreps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nzeros</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>covar_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>zeroindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="skeleton_8c_source.html#l00169">169</a> of file <a class="el" href="skeleton_8c_source.html">skeleton.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  SEXP ans, nm;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">double</span> *ap, *xs;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">int</span> nsteps;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">int</span> *posn = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">int</span> h, i, j, k;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">int</span> first = 1;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; ntimes; k++, time++, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    R_CheckUserInterrupt();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// compute number of steps needed</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    nsteps = <a class="code" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a">num_map_steps</a>(t,*time,deltat);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// set accumulator variables to zero</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nzeros; i++)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = &amp;x[zeroindex[i]]; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        *xs = 0.0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">for</span> (h = 0; h &lt; nsteps; h++) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// interpolate the covariates</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>,t,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">for</span> (j = 0, xs = x; j &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; j++, xs += <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (first) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keywordflow">if</span> (LENGTH(ans) != <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; returns a vector of %d state variables but %d are expected.&quot;</span>,LENGTH(ans),<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="comment">// get name information to fix alignment problems</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          PROTECT(nm = GET_NAMES(ans));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> (invalid_names(nm)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;skeleton&#39; must return a named numeric vector.&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          posn = INTEGER(PROTECT(matchnames(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,nm,<span class="stringliteral">&quot;state variables&quot;</span>)));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      nprotect += 3;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          first = 0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          PROTECT(ans = eval_call(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,&amp;t,xs,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,p+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*(j%nrepp),<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>,<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          ap = REAL(AS_NUMERIC(ans));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; i++) xs[posn[i]] = ap[i];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          UNPROTECT(1);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">if</span> (h != nsteps-1) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        t += deltat;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        t = *time;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    memcpy(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,x,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ab2d2bf78c9a2e064a57e6c9bf3d52bc2_cgraph.png" border="0" usemap="#apomp__decls_8h_ab2d2bf78c9a2e064a57e6c9bf3d52bc2_cgraph" alt=""/></div>
<map name="apomp__decls_8h_ab2d2bf78c9a2e064a57e6c9bf3d52bc2_cgraph" id="apomp__decls_8h_ab2d2bf78c9a2e064a57e6c9bf3d52bc2_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,148,57"/>
<area shape="rect" href="euler_8c.html#a0681d20c093a288da04bffa9adbfe48a" title=" " alt="" coords="196,5,325,32"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="207,56,314,83"/>
</map>
</div>

</div>
</div>
<a id="a0a653dae61a3500aaadf64fdefa79c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a653dae61a3500aaadf64fdefa79c4b">&#9670;&nbsp;</a></span>load_stack_decr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_decr </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00132">132</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                 {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  SEXP s;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  void (*ff)(<span class="keywordtype">int</span> *);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  PROTECT(s = NEW_INTEGER(1));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  ff = (void (*)(<span class="keywordtype">int</span> *)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_decr&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  ff(INTEGER(s));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span> (*(INTEGER(s)) &lt; 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;impossible!&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a0a653dae61a3500aaadf64fdefa79c4b_icgraph.png" border="0" usemap="#apomp__decls_8h_a0a653dae61a3500aaadf64fdefa79c4b_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a0a653dae61a3500aaadf64fdefa79c4b_icgraph" id="apomp__decls_8h_a0a653dae61a3500aaadf64fdefa79c4b_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,283,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a5ae1bdf9e79d36d8fc709cbc509d4c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae1bdf9e79d36d8fc709cbc509d4c8c">&#9670;&nbsp;</a></span>load_stack_incr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP load_stack_incr </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00123">123</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                 {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *pkg;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  void (*ff)(void);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  ff = (void (*)(void)) R_GetCCallable(pkg,<span class="stringliteral">&quot;__pomp_load_stack_incr&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  ff();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a5ae1bdf9e79d36d8fc709cbc509d4c8c_icgraph.png" border="0" usemap="#apomp__decls_8h_a5ae1bdf9e79d36d8fc709cbc509d4c8c_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a5ae1bdf9e79d36d8fc709cbc509d4c8c_icgraph" id="apomp__decls_8h_a5ae1bdf9e79d36d8fc709cbc509d4c8c_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,279,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a5e8b0b73f135519781c3b75e10172203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e8b0b73f135519781c3b75e10172203">&#9670;&nbsp;</a></span>LogBarycentricTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogBarycentricTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00038">38</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                      {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = NEW_NUMERIC(LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  to_log_barycentric(REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d549367377037bf0c52dbf9ebfa0ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d549367377037bf0c52dbf9ebfa0ccc">&#9670;&nbsp;</a></span>LogitTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP LogitTransform </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>P</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="transformations_8c_source.html#l00014">14</a> of file <a class="el" href="transformations_8c_source.html">transformations.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                             {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">double</span> *p;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordtype">int</span> k, n;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(P = duplicate(AS_NUMERIC(P)));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  p = REAL(P);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  n = LENGTH(P);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; n; k++, p++)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    *p = logit(*p);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">return</span> P;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7eedb5370776fe4e1523f4e9a3e71bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eedb5370776fe4e1523f4e9a3e71bd3">&#9670;&nbsp;</a></span>logmeanexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP logmeanexp </td>
          <td>(</td>
          <td class="paramtype">const SEXP&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SEXP&#160;</td>
          <td class="paramname"><em>Drop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="logmeanexp_8c_source.html#l00007">7</a> of file <a class="el" href="logmeanexp_8c_source.html">logmeanexp.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                                {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  SEXP ans;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  PROTECT(ans = NEW_NUMERIC(1));</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">int</span> j, n = LENGTH(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> k = *INTEGER(Drop)-1; <span class="comment">// zero-based index</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">double</span> *x = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>), *a = REAL(ans);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> m = R_NegInf;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> s = 0;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      m = (x[j] &gt; m) ? (<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] : m;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  }</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">if</span> (j != k)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      s += expl((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) x[j] - m);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  }</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> (k &gt;= 0 &amp;&amp; k &lt; n) n--;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  *a = m + log(s/n);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf5964c67b353b466461b1eb1269e129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf5964c67b353b466461b1eb1269e129">&#9670;&nbsp;</a></span>lookup_in_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP lookup_in_table </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00024">24</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                          {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> xdim[2], nvar;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> j, nt;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span> *tp, *xp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEXP Cnames, <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  PROTECT(t = AS_NUMERIC(t));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  nt = LENGTH(t);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> tab = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(covar,&amp;nvar);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (nt &gt; 1) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    xdim[0] = nvar; xdim[1] = nt;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = makearray(2,xdim));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    setrownames(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames,2);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = NEW_NUMERIC(nvar));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    SET_NAMES(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Cnames);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">for</span> (j = 0, tp = REAL(t), xp = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>); j &lt; nt; j++, tp++, xp += nvar)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>(&amp;tab,*tp,xp);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  UNPROTECT(3);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_cgraph.png" border="0" usemap="#apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_cgraph" alt=""/></div>
<map name="apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_cgraph" id="apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,131,57"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="181,5,343,32"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="179,56,345,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_icgraph.png" border="0" usemap="#apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_icgraph" alt=""/></div>
<map name="apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_icgraph" id="apomp__decls_8h_aaf5964c67b353b466461b1eb1269e129_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,281,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a1e57a24640cb0d9f6f8d55e02c3d553f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e57a24640cb0d9f6f8d55e02c3d553f">&#9670;&nbsp;</a></span>make_covariate_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> make_covariate_table </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ncovar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00011">11</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                               {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> tab;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  dim = INTEGER(GET_DIM(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>))));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  *ncovar = tab.<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> = dim[0];</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> = dim[1];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = 0;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;times&quot;</span>)));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a> = REAL(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;table&quot;</span>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  tab.<a class="code" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a> = *(INTEGER(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;order&quot;</span>))));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">return</span> tab;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
<div class="ttc" id="astructlookup__table__t_html_a5bc85f841e0c15e15a7b8b7e12172ea1"><div class="ttname"><a href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">lookup_table_t::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00022">pomp_defines.h:22</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a73816c282d64530aafb1dd154ee41f60"><div class="ttname"><a href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">lookup_table_t::width</a></div><div class="ttdeci">int width</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a83e4e0655a5836172df9d671ed4d726c"><div class="ttname"><a href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">lookup_table_t::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00023">pomp_defines.h:23</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_a928f893d2851476723521ae3c7d29749"><div class="ttname"><a href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">lookup_table_t::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00021">pomp_defines.h:21</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_aa071aabe5391f11c0d915907ad16dd28"><div class="ttname"><a href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">lookup_table_t::x</a></div><div class="ttdeci">double * x</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00024">pomp_defines.h:24</a></div></div>
<div class="ttc" id="astructlookup__table__t_html_afc0a89e59da489c4fd7fd4aca70c298d"><div class="ttname"><a href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">lookup_table_t::y</a></div><div class="ttdeci">double * y</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00025">pomp_defines.h:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a1e57a24640cb0d9f6f8d55e02c3d553f_icgraph.png" border="0" usemap="#apomp__decls_8h_a1e57a24640cb0d9f6f8d55e02c3d553f_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a1e57a24640cb0d9f6f8d55e02c3d553f_icgraph" id="apomp__decls_8h_a1e57a24640cb0d9f6f8d55e02c3d553f_icgraph">
<area shape="rect" title=" " alt="" coords="376,107,543,133"/>
<area shape="rect" href="euler_8c.html#a83f6b69b51bdf12eb0fe150ccc05f80d" title=" " alt="" coords="156,5,328,32"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="179,56,305,83"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,81,108,108"/>
<area shape="rect" href="pomp__decls_8h.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="162,157,322,184"/>
<area shape="rect" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="183,208,301,235"/>
</map>
</div>

</div>
</div>
<a id="a37f1a2acca063e96f0efa73705ec87b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37f1a2acca063e96f0efa73705ec87b2">&#9670;&nbsp;</a></span>nosort_resamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nosort_resamp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00025">25</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">double</span> du, u;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">for</span> (j = 1; j &lt; nw; j++) w[j] += w[j-1];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> (w[nw-1] &lt;= 0.0)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;systematic_resampling&#39;: non-positive sum of weights&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  du = w[nw-1] / ((double) np);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  u = -du*unif_rand();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">for</span> (i = 0, j = 0; j &lt; np; j++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    u += du;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// In the following line, the second test is needed to correct</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// the infamous Bug of St. Patrick, 2017-03-17.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">while</span> ((u &gt; w[i]) &amp;&amp; (i &lt; nw-1)) i++;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    p[j] = i;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (offset)           <span class="comment">// add offset if needed</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; np; j++) p[j] += offset;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a37f1a2acca063e96f0efa73705ec87b2_icgraph.png" border="0" usemap="#apomp__decls_8h_a37f1a2acca063e96f0efa73705ec87b2_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a37f1a2acca063e96f0efa73705ec87b2_icgraph" id="apomp__decls_8h_a37f1a2acca063e96f0efa73705ec87b2_icgraph">
<area shape="rect" title=" " alt="" coords="379,5,497,32"/>
<area shape="rect" href="pomp__decls_8h.html#a982475f3663a786d7883672aa2ed072e" title=" " alt="" coords="156,5,331,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a3da8d135fe6d232031cf7c314f432265"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da8d135fe6d232031cf7c314f432265">&#9670;&nbsp;</a></span>num_euler_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_euler_steps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00319">319</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                                           {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// nstep will be the number of Euler steps to take in going from t1 to t2.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// note also that the stepsize changes.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// this choice is meant to be conservative</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// (i.e., so that the actual deltat does not exceed the specified deltat</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// by more than the relative tolerance &#39;tol&#39;)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// and to counteract roundoff error.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// It seems to work well, but is not guaranteed:</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// suggestions would be appreciated.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (t1 &gt;= t2) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    *deltat = 0.0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    nstep = 0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t1+*deltat &gt;= t2) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    *deltat = t2-t1;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    nstep = 1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    nstep = (int) ceil((t2-t1)/(*deltat)/(1+tol));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    *deltat = (t2-t1)/((<span class="keywordtype">double</span>) nstep);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">return</span> nstep;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0681d20c093a288da04bffa9adbfe48a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0681d20c093a288da04bffa9adbfe48a">&#9670;&nbsp;</a></span>num_map_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_map_steps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="euler_8c_source.html#l00344">344</a> of file <a class="el" href="euler_8c_source.html">euler.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">double</span> tol = sqrt(DBL_EPSILON);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordtype">int</span> nstep;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// nstep will be the number of discrete-time steps to take in going from t1 to t2.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  nstep = (int) floor((t2-t1)/deltat/(1-tol));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">return</span> (nstep &gt; 0) ? nstep : 0;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a0681d20c093a288da04bffa9adbfe48a_icgraph.png" border="0" usemap="#apomp__decls_8h_a0681d20c093a288da04bffa9adbfe48a_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a0681d20c093a288da04bffa9adbfe48a_icgraph" id="apomp__decls_8h_a0681d20c093a288da04bffa9adbfe48a_icgraph">
<area shape="rect" title=" " alt="" coords="228,31,357,57"/>
<area shape="rect" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="pomp__decls_8h.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2" title=" " alt="" coords="21,56,164,83"/>
</map>
</div>

</div>
</div>
<a id="a5300e64c53a9cbb6aa52d351bd338883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5300e64c53a9cbb6aa52d351bd338883">&#9670;&nbsp;</a></span>periodic_bspline_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP periodic_bspline_basis </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00084">84</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                         {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SEXP y, xr;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">int</span> nx = LENGTH(x);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> nb = INTEGER_VALUE(nbasis);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> deg = INTEGER_VALUE(degree);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">int</span> d = INTEGER_VALUE(deriv);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">double</span> pd = NUMERIC_VALUE(period);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">double</span> *xrd, *ydata, *val;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  PROTECT(xr = AS_NUMERIC(x));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  xrd = REAL(xr);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  PROTECT(y = allocMatrix(REALSXP,nx,nb));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  ydata = REAL(y);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  val = (<span class="keywordtype">double</span> *) R_alloc(nb,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">for</span> (j = 0; j &lt; nx; j++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>(xrd[j],pd,deg,nb,d,val);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nb; k++) ydata[j+nx*k] = val[k];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">return</span> y;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_a2f083190a387483412260be17208ee1e"><div class="ttname"><a href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a></div><div class="ttdeci">void periodic_bspline_basis_eval_deriv(double x, double period, int degree, int nbasis, int deriv, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00123">bspline.c:123</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a5300e64c53a9cbb6aa52d351bd338883_cgraph.png" border="0" usemap="#apomp__decls_8h_a5300e64c53a9cbb6aa52d351bd338883_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a5300e64c53a9cbb6aa52d351bd338883_cgraph" id="apomp__decls_8h_a5300e64c53a9cbb6aa52d351bd338883_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,175,39"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="223,5,392,47"/>
<area shape="rect" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c" title=" " alt="" coords="440,13,544,39"/>
</map>
</div>

</div>
</div>
<a id="acabb1ca64e069e1b7767c31435e761d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabb1ca64e069e1b7767c31435e761d8">&#9670;&nbsp;</a></span>periodic_bspline_basis_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void periodic_bspline_basis_eval </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00118">118</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                         {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="bspline_8c.html#a2f083190a387483412260be17208ee1e">periodic_bspline_basis_eval_deriv</a>(x,period,degree,nbasis,0,y);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_cgraph.png" border="0" usemap="#apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_cgraph" alt=""/></div>
<map name="apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_cgraph" id="apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,209,39"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="257,5,427,47"/>
<area shape="rect" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c" title=" " alt="" coords="475,13,579,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_icgraph.png" border="0" usemap="#apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_icgraph" alt=""/></div>
<map name="apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_icgraph" id="apomp__decls_8h_acabb1ca64e069e1b7767c31435e761d8_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,360,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a2f083190a387483412260be17208ee1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f083190a387483412260be17208ee1e">&#9670;&nbsp;</a></span>periodic_bspline_basis_eval_deriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void periodic_bspline_basis_eval_deriv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbasis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="bspline_8c_source.html#l00123">123</a> of file <a class="el" href="bspline_8c_source.html">bspline.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">int</span> nknots = nbasis+2*degree+1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">int</span> shift = (degree-1)/2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">double</span> *knots = NULL, *yy = NULL;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">double</span> dx;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (period &lt;= 0.0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have period &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (nbasis &lt;= 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (degree &lt; 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have degree &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">if</span> (nbasis &lt; degree) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have nbasis &gt;= degree&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (deriv &lt; 0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have deriv &gt;= 0&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  knots = (<span class="keywordtype">double</span> *) R_Calloc(nknots+degree+1,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  yy = (<span class="keywordtype">double</span> *) R_Calloc(nknots,<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  dx = period/((double) nbasis);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">for</span> (k = -degree; k &lt;= nbasis+degree; k++) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    knots[degree+k] = k*dx;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  x = fmod(x,period);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (x &lt; 0.0) x += period;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nknots; k++) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>(&amp;yy[k],&amp;x,1,k,degree,deriv,knots);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; degree; k++) yy[k] += yy[nbasis+k];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nbasis; k++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    j = (shift+k)%nbasis;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    y[k] = yy[j];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  R_Free(yy); R_Free(knots);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a2f083190a387483412260be17208ee1e_cgraph.png" border="0" usemap="#apomp__decls_8h_a2f083190a387483412260be17208ee1e_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a2f083190a387483412260be17208ee1e_cgraph" id="apomp__decls_8h_a2f083190a387483412260be17208ee1e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,47"/>
<area shape="rect" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c" title=" " alt="" coords="223,13,327,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a2f083190a387483412260be17208ee1e_icgraph.png" border="0" usemap="#apomp__decls_8h_a2f083190a387483412260be17208ee1e_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a2f083190a387483412260be17208ee1e_icgraph" id="apomp__decls_8h_a2f083190a387483412260be17208ee1e_icgraph">
<area shape="rect" title=" " alt="" coords="408,23,577,65"/>
<area shape="rect" href="bspline_8c.html#a5300e64c53a9cbb6aa52d351bd338883" title=" " alt="" coords="173,5,343,32"/>
<area shape="rect" href="bspline_8c.html#acabb1ca64e069e1b7767c31435e761d8" title=" " alt="" coords="156,56,360,83"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,56,108,83"/>
</map>
</div>

</div>
</div>
<a id="acfcb3a7b41bc3b2b9315163717854242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfcb3a7b41bc3b2b9315163717854242">&#9670;&nbsp;</a></span>pfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>predmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>predvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>filtmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>trackancestry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>doparRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>wave</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfilter_8c_source.html#l00016">16</a> of file <a class="el" href="pfilter_8c_source.html">pfilter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  SEXP pm = R_NilValue, pv = R_NilValue, fm = R_NilValue;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  SEXP anc = R_NilValue, wmean = R_NilValue;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  SEXP ess, loglik;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  SEXP newstates = R_NilValue, newparams = R_NilValue;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  SEXP retval, retvalnames;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[2] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">double</span> *xw = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws, maxw, sum;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">int</span> *xanc = 0;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SEXP dimX, dimP, newdim, Xnames, Pnames;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">int</span> *dim, np;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = 0, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> do_pm, do_pv, do_fm, do_ta, do_pr, do_wave, all_fail = 0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(dimX = GET_DIM(x));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  dim = INTEGER(dimX);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(x)));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = as_matrix(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  PROTECT(dimP = GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  dim = INTEGER(dimP);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> % dim[1] != 0)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be a multiple of ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  PROTECT(weights = duplicate(weights)); <span class="comment">// FIXME: unnecessary copy</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  np = *(INTEGER(AS_INTEGER(Np))); <span class="comment">// number of particles to resample</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  do_pm = *(LOGICAL(AS_LOGICAL(predmean))); <span class="comment">// calculate prediction means?</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  do_pv = *(LOGICAL(AS_LOGICAL(predvar)));  <span class="comment">// calculate prediction variances?</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  do_fm = *(LOGICAL(AS_LOGICAL(filtmean))); <span class="comment">// calculate filtering means?</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  do_ta = *(LOGICAL(AS_LOGICAL(trackancestry))); <span class="comment">// track ancestry?</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Do we need to do parameter resampling?</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  do_pr = *(LOGICAL(AS_LOGICAL(doparRS)));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// Do we need to take a weighted average over the parameters?</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  do_wave = *(LOGICAL(AS_LOGICAL(wave)));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (dim[1] != <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;states&#39;) should be equal to ncol(&#39;params&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// log likelihood</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  xw = REAL(weights);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// check and normalize the weights</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">for</span> (k = 0, maxw = R_NegInf; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (ISNAN(xw[k]) || xw[k] == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      PROTECT(retval = NEW_INTEGER(1)); nprotect++;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      *INTEGER(retval) = k+1; <span class="comment">// return the index of the peccant particle</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      UNPROTECT(nprotect);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }    </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (maxw &lt; xw[k]) maxw = xw[k];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (maxw == R_NegInf) all_fail = 1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    *(REAL(loglik)) = R_NegInf;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    *(REAL(ess)) = 0;             <span class="comment">// zero effective sample size</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (k = 0, w = 0, ws = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      xw[k] = exp(xw[k]-maxw);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (xw[k] != 0) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    w += xw[k];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    ws += xw[k]*xw[k];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    *(REAL(loglik)) = maxw + log(w/((<span class="keywordtype">long</span> <span class="keywordtype">double</span>) <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)); <span class="comment">// mean of weights is likelihood</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    *(REAL(ess)) = w*w/ws;      <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    PROTECT(pm = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    PROTECT(pv = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    PROTECT(fm = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>)); nprotect++;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    PROTECT(anc = NEW_INTEGER(np)); nprotect++;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    xanc = INTEGER(anc);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    PROTECT(wmean = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>)); nprotect++;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    SET_NAMES(wmean,Pnames);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (do_pm || do_pv) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">double</span> *tmp = (do_pv) ? REAL(pv) : 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    pred_mean_var(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,do_pv,REAL(x),REAL(pm),tmp);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">//  compute filter mean</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    filt_mean(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,all_fail,w,xw,REAL(x),REAL(fm));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// compute weighted average of parameters</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (all_fail)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;%s %s&quot;</span>,<span class="stringliteral">&quot;filtering failure at last filter iteration:&quot;</span>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;       <span class="stringliteral">&quot;using unweighted mean for point estimate.&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">double</span> *xwm = REAL(wmean);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, xwm++) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">double</span> *xp = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)+j;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (all_fail) {           <span class="comment">// unweighted average</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) sum += *xp;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        *xwm = sum/((<span class="keywordtype">long</span> double) <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">for</span> (k = 0, sum = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xp += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (xw[k]!=0) sum += xw[k]*(*xp);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        *xwm = sum/w;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (!all_fail) { <span class="comment">// resample the particles unless we have filtering failure</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">int</span> xdim[2];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">double</span> *ss = 0, *st = 0, *ps = 0, *pt = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// create storage for new states</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    xdim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; xdim[1] = np;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    PROTECT(newstates = makearray(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    setrownames(newstates,Xnames,2);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    fixdimnames(newstates,dimnm,2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ss = REAL(x);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    st = REAL(newstates);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      xdim[0] = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; xdim[1] = np;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      PROTECT(newparams = makearray(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      setrownames(newparams,Pnames,2);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      fixdimnames(newparams,dimnm,2);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      ps = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      pt = REAL(newparams);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// resample</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="pomp__decls_8h.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(weights),np,sample,0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordtype">int</span> sp = sample[k];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordtype">double</span> *xx, *xp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        *st = *xx;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (do_pr) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">for</span> (j = 0, xp = ps+<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>; j++, pt++, xp++)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          *pt = *xp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">if</span> (do_ta) xanc[k] = sp+1;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// don&#39;t resample: just drop 3rd dimension in x prior to return</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    PROTECT(newdim = NEW_INTEGER(2)); nprotect++;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    dim = INTEGER(newdim);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    dim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    SET_DIM(x,newdim);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    setrownames(x,Xnames,2);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    fixdimnames(x,dimnm,2);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (do_ta)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) xanc[k] = k+1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  PROTECT(retval = NEW_LIST(9));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(9));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  nprotect += 2;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;pm&quot;</span>));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  SET_STRING_ELT(retvalnames,5,mkChar(<span class="stringliteral">&quot;pv&quot;</span>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  SET_STRING_ELT(retvalnames,6,mkChar(<span class="stringliteral">&quot;fm&quot;</span>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  SET_STRING_ELT(retvalnames,7,mkChar(<span class="stringliteral">&quot;ancestry&quot;</span>));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  SET_STRING_ELT(retvalnames,8,mkChar(<span class="stringliteral">&quot;wmean&quot;</span>));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  SET_ELEMENT(retval,0,loglik);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  SET_ELEMENT(retval,1,ess);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (all_fail) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    SET_ELEMENT(retval,2,x);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    SET_ELEMENT(retval,2,newstates);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (all_fail || !do_pr) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    SET_ELEMENT(retval,3,<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    SET_ELEMENT(retval,3,newparams);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (do_pm) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    SET_ELEMENT(retval,4,pm);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">if</span> (do_pv) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    SET_ELEMENT(retval,5,pv);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (do_fm) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    SET_ELEMENT(retval,6,fm);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (do_ta) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    SET_ELEMENT(retval,7,anc);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (do_wave) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    SET_ELEMENT(retval,8,wmean);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="ttc" id="apomp__decls_8h_html_a37f1a2acca063e96f0efa73705ec87b2"><div class="ttname"><a href="pomp__decls_8h.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int nw, double *w, int np, int *p, int offset)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a650670c909a5329eb24d77c821cd5e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650670c909a5329eb24d77c821cd5e21">&#9670;&nbsp;</a></span>pomp_desolve_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_desolve_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00159">159</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                                                       {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  SEXP pompfun, ob;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">int</span> *dim;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// extract user-defined skeleton function</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  PROTECT(ob = GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;skeleton&quot;</span>)));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  PROTECT(pompfun = GET_SLOT(ob,install(<span class="stringliteral">&quot;skel.fn&quot;</span>)));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// extract &#39;userdata&#39; as pairlist</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a> = VectorToPairList(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;userdata&quot;</span>))));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = <a class="code" href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = <a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  dim = INTEGER(GET_DIM(x0));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// set up the covariate table</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>) = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>)),&amp;<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = NEW_NUMERIC(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  R_PreserveObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(x0)));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(GET_SLOT(<span class="keywordtype">object</span>,install(<span class="stringliteral">&quot;covar&quot;</span>))));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(pompfun,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">int</span> nprotect = 8;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code" href="pomp__decls_8h.html#a82ea4779fc1cc65f27c3546cbb6669c8">add_skel_args</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = <a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    PROTECT(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = GET_SLOT(pompfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>)))) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (!isNull(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>))) R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    R_PreserveObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_setup&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">return</span> R_NilValue;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="ttc" id="atrajectory_8c_html_a0e74f51a4d7e89b6a52cc7d78cc8f5ca"><div class="ttname"><a href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a></div><div class="ttdeci">#define RFUN(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00156">trajectory.c:156</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a852c03f3cb2e07fb73c219e4f9a7bf9f"><div class="ttname"><a href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a></div><div class="ttdeci">#define COMMON(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00155">trajectory.c:155</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a8ad5c5cfa2eab8626017e1b9ed0a3f7c"><div class="ttname"><a href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a></div><div class="ttdeci">SEXP cindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00149">trajectory.c:149</a></div></div>
<div class="ttc" id="atrajectory_8c_html_a980f881d230271d4e5084135e85a521b"><div class="ttname"><a href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a></div><div class="ttdeci">pomp_skeleton * fun</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00150">trajectory.c:150</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab488f90e51bbc91068510577c6d742db"><div class="ttname"><a href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a></div><div class="ttdeci">SEXP sindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00147">trajectory.c:147</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ab8af0f07388320ad03576d4d4c0c1bc1"><div class="ttname"><a href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a></div><div class="ttdeci">SEXP pindex</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00148">trajectory.c:148</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac39df6bb0605d87c14d69c0767c29b92"><div class="ttname"><a href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a></div><div class="ttdeci">#define NAT(X)</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00157">trajectory.c:157</a></div></div>
<div class="ttc" id="atrajectory_8c_html_ac8d8b2659244f8b65022c653e1604b05"><div class="ttname"><a href="trajectory_8c.html#ac8d8b2659244f8b65022c653e1604b05">object</a></div><div class="ttdeci">SEXP object</div><div class="ttdef"><b>Definition:</b> <a href="trajectory_8c_source.html#l00130">trajectory.c:130</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a650670c909a5329eb24d77c821cd5e21_cgraph.png" border="0" usemap="#apomp__decls_8h_a650670c909a5329eb24d77c821cd5e21_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a650670c909a5329eb24d77c821cd5e21_cgraph" id="apomp__decls_8h_a650670c909a5329eb24d77c821cd5e21_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,165,108"/>
<area shape="rect" href="pomp__decls_8h.html#a82ea4779fc1cc65f27c3546cbb6669c8" title=" " alt="" coords="239,5,354,32"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="215,56,378,83"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="213,107,380,133"/>
<area shape="rect" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="225,157,368,184"/>
</map>
</div>

</div>
</div>
<a id="a7a37b08d4f29e8bdd81eb910cf4bff6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a37b08d4f29e8bdd81eb910cf4bff6d">&#9670;&nbsp;</a></span>pomp_desolve_takedown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pomp_desolve_takedown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00295">295</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                  {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  R_ReleaseObject(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<span class="keywordtype">object</span>) = R_NilValue;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>) = R_NilValue;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>) = R_NilValue;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>) = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) = 0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>) = 0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>) = 0;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>: {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>));</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>) = R_NilValue;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>) = R_NilValue;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>: {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>) = 0;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    R_ReleaseObject(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>) = R_NilValue;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>) = R_NilValue;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_desolve_takedown&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94db08f2d9f751e7832aaadb5ae6920e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94db08f2d9f751e7832aaadb5ae6920e">&#9670;&nbsp;</a></span>pomp_fun_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pomp_fun_handler </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>pfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> *&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>O</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pomp__fun_8c_source.html#l00032">32</a> of file <a class="el" href="pomp__fun_8c_source.html">pomp_fun.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> nprotect = 0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  SEXP f = R_NilValue;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  SEXP sidx, pidx, oidx, cidx;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  *<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = *(INTEGER(GET_SLOT(pfun,install(<span class="stringliteral">&quot;mode&quot;</span>))));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">switch</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:            <span class="comment">// R function</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;R.fun&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:  <span class="comment">// native code</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (*(LOGICAL(gnsi))) { <span class="comment">// get native symbol information?</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      SEXP nf, pack;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      PROTECT(nf = GET_SLOT(pfun,install(<span class="stringliteral">&quot;native.fun&quot;</span>)));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      PROTECT(pack = GET_SLOT(pfun,install(<span class="stringliteral">&quot;PACKAGE&quot;</span>)));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      nprotect += 2;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">if</span> (LENGTH(pack) &lt; 1) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        PROTECT(pack = mkString(<span class="stringliteral">&quot;&quot;</span>)); nprotect++; <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        SEXP nsi;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        PROTECT(nsi = eval(PROTECT(lang3(install(<span class="stringliteral">&quot;getNativeSymbolInfo&quot;</span>),nf,pack)),R_BaseEnv));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        PROTECT(f = getListElement(nsi,<span class="stringliteral">&quot;address&quot;</span>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    nprotect += 3;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, *pkg;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        fname = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(nf,0));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        pkg = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) CHAR(STRING_ELT(pack,0));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        DL_FUNC <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = R_GetCCallable(pkg,fname);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        PROTECT(f = R_MakeExternalPtrFn(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>,R_NilValue,R_NilValue)); nprotect++;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      SET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>),f);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> (S != NA_STRING) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        PROTECT(sidx = name_index(S,pfun,<span class="stringliteral">&quot;statenames&quot;</span>,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;stateindex&quot;</span>),sidx);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">if</span> (P != NA_STRING) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        PROTECT(pidx = name_index(P,pfun,<span class="stringliteral">&quot;paramnames&quot;</span>,<span class="stringliteral">&quot;parameters&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;paramindex&quot;</span>),pidx);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span> (O != NA_STRING) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        PROTECT(oidx = name_index(O,pfun,<span class="stringliteral">&quot;obsnames&quot;</span>,<span class="stringliteral">&quot;observables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;obsindex&quot;</span>),oidx);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span> (C != NA_STRING) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        PROTECT(cidx = name_index(C,pfun,<span class="stringliteral">&quot;covarnames&quot;</span>,<span class="stringliteral">&quot;covariates&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        SET_SLOT(pfun,install(<span class="stringliteral">&quot;covarindex&quot;</span>),cidx);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    } <span class="keywordflow">else</span> {            <span class="comment">// native symbol info is stored</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      PROTECT(f = GET_SLOT(pfun,install(<span class="stringliteral">&quot;address&quot;</span>))); nprotect++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    PROTECT(f = R_NilValue); nprotect++;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    *<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">return</span> f;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a94db08f2d9f751e7832aaadb5ae6920e_icgraph.png" border="0" usemap="#apomp__decls_8h_a94db08f2d9f751e7832aaadb5ae6920e_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a94db08f2d9f751e7832aaadb5ae6920e_icgraph" id="apomp__decls_8h_a94db08f2d9f751e7832aaadb5ae6920e_icgraph">
<area shape="rect" title=" " alt="" coords="213,56,356,83"/>
<area shape="rect" href="pomp__decls_8h.html#a650670c909a5329eb24d77c821cd5e21" title=" " alt="" coords="5,5,165,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="34,56,137,83"/>
<area shape="rect" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="27,107,144,133"/>
</map>
</div>

</div>
</div>
<a id="a388d1f049a9d7284d0e7ba26591e6099"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a388d1f049a9d7284d0e7ba26591e6099">&#9670;&nbsp;</a></span>pomp_vf_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pomp_vf_eval </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>neq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ydot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>yout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trajectory_8c_source.html#l00263">263</a> of file <a class="el" href="trajectory_8c_source.html">trajectory.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:            <span class="comment">// R function</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="pomp__decls_8h.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a>(ydot,t,y,REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>),<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),<a class="code" href="trajectory_8c.html#a0e74f51a4d7e89b6a52cc7d78cc8f5ca">RFUN</a>(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>),</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      &amp;<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:      <span class="comment">// native code</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a>(ydot,t,y,REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>),1,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>),</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab488f90e51bbc91068510577c6d742db">sindex</a>)),INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>)),INTEGER(<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a8ad5c5cfa2eab8626017e1b9ed0a3f7c">cindex</a>)),</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      &amp;<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#a6d8415c759496fb5460bce9a56445919">covar_table</a>),<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a980f881d230271d4e5084135e85a521b">fun</a>),<a class="code" href="trajectory_8c.html#ac39df6bb0605d87c14d69c0767c29b92">NAT</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>),REAL(<a class="code" href="trajectory_8c.html#a852c03f3cb2e07fb73c219e4f9a7bf9f">COMMON</a>(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>)));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">default</span>: <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;in &#39;pomp_vf_eval&#39;: unrecognized &#39;mode&#39;&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="ttc" id="apomp__decls_8h_html_a4c519c3f1f7ceca7aae16c0aa702cfeb"><div class="ttname"><a href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb">eval_skeleton_native</a></div><div class="ttdeci">void eval_skeleton_native(double *f, double *time, double *x, double *p, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, int *sidx, int *pidx, int *cidx, lookup_table_t *covar_table, pomp_skeleton *fun, SEXP args, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00253">skeleton.c:253</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_ab5870e93076f917246e64740c1416a05"><div class="ttname"><a href="pomp__decls_8h.html#ab5870e93076f917246e64740c1416a05">eval_skeleton_R</a></div><div class="ttdeci">void eval_skeleton_R(double *f, double *time, double *x, double *p, SEXP fn, SEXP args, SEXP Snames, int nvars, int npars, int ncovars, int ntimes, int nrepx, int nrepp, int nreps, lookup_table_t *covar_table, double *cov)</div><div class="ttdef"><b>Definition:</b> <a href="skeleton_8c_source.html#l00102">skeleton.c:102</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a388d1f049a9d7284d0e7ba26591e6099_cgraph.png" border="0" usemap="#apomp__decls_8h_a388d1f049a9d7284d0e7ba26591e6099_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a388d1f049a9d7284d0e7ba26591e6099_cgraph" id="apomp__decls_8h_a388d1f049a9d7284d0e7ba26591e6099_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,120,108"/>
<area shape="rect" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="168,56,328,83"/>
<area shape="rect" href="pomp__decls_8h.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="184,107,312,133"/>
<area shape="rect" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252" title=" " alt="" coords="384,5,535,32"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="406,107,513,133"/>
<area shape="rect" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c" title=" " alt="" coords="376,56,543,83"/>
</map>
</div>

</div>
</div>
<a id="aeb81a79c270779cdaa8ab7f2270c4569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb81a79c270779cdaa8ab7f2270c4569">&#9670;&nbsp;</a></span>probe_acf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_acf </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00100">100</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                              {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  SEXP ans, ans_names;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> nlag, correlation, <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, n;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">int</span> j, k, l;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> *p, *p1, *<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">int</span> *lag;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  nlag = LENGTH(lags);                <span class="comment">// number of lags</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  lag = INTEGER(lags);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = INTEGER(GET_DIM(x))[0];   <span class="comment">// number of variables</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  n = INTEGER(GET_DIM(x))[1];           <span class="comment">// number of observations</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  PROTECT(ans = NEW_NUMERIC(nlag*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  pomp_acf_compute(REAL(ans),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,lag,nlag);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    l = 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a> = (<span class="keywordtype">double</span> *) R_alloc(<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    pomp_acf_compute(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>,REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>,&amp;l,1); <span class="comment">// compute lag-0 covariance</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (j = 0, p = REAL(ans), p1 = <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, p1++)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, p++)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        *p /= *p1;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  PROTECT(ans_names = NEW_STRING(nlag*<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">for</span> (j = 0, l = 0; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++, l++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;acf[%d]&quot;</span>,lag[k]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      SET_STRING_ELT(ans_names,l,mkChar(tmp));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95593efb3dabcae5680a0ac5fb800fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95593efb3dabcae5680a0ac5fb800fa3">&#9670;&nbsp;</a></span>probe_ccf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_ccf </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__acf_8c_source.html#l00145">145</a> of file <a class="el" href="probe__acf_8c_source.html">probe_acf.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                      {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  SEXP ans, ans_names;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, <a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[2], xx, *p;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">int</span> nlag, n, correlation;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  nlag = LENGTH(lags);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  PROTECT(lags = AS_INTEGER(lags));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  correlation = *(INTEGER(AS_INTEGER(corr))); <span class="comment">// correlation, or covariance?</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  n = LENGTH(x);        <span class="comment">// n = # of observations</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (n != LENGTH(y)) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;x&#39; and &#39;y&#39; must have equal lengths&quot;</span>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a> = duplicate(AS_NUMERIC(y)));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  PROTECT(ans = NEW_NUMERIC(nlag));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  pomp_ccf_compute(REAL(ans),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,INTEGER(lags),nlag);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">if</span> (correlation) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    k = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    pomp_acf_compute(&amp;<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0],REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of x</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    pomp_acf_compute(&amp;<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1],REAL(<a class="code" href="gompertz_8c.html#a798e4073d613ca5ba9618e1b3253df14">Y</a>),n,1,&amp;k,1); <span class="comment">// compute lag-0 covariance of y</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    xx = sqrt(<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[0]*<a class="code" href="trajectory_8c.html#ac0e9686ed371713a6e6717115c66f602">cov</a>[1]);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">for</span> (k = 0, p = REAL(ans); k &lt; nlag; k++, p++) *p /= xx; <span class="comment">// convert to correlation</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  PROTECT(ans_names = NEW_STRING(nlag));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nlag; k++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;ccf[%d]&quot;</span>,INTEGER(lags)[k]);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    SET_STRING_ELT(ans_names,k,mkChar(tmp));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  SET_NAMES(ans,ans_names);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a33683f39715bc5813eab0d124dbc9899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33683f39715bc5813eab0d124dbc9899">&#9670;&nbsp;</a></span>probe_marginal_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_setup </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00010">10</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                                                            {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  SEXP z, mm, <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, retval, retvalnames;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> n, nx, np, df, dim[2];</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  np = *(INTEGER(AS_INTEGER(order))); <span class="comment">// order of polynomial regression</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  n = LENGTH(ref);            <span class="comment">// n = number of observations</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  nx = n - df;                <span class="comment">// nx = rows in model matrix</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  dim[0] = nx; dim[1] = np;       <span class="comment">// dimensions of model matrix</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> (nx &lt; 1) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;must have diff &lt; number of observations&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(z = duplicate(AS_NUMERIC(ref)));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  PROTECT(mm = makearray(2,dim));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = NEW_NUMERIC(np));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PROTECT(pivot = NEW_INTEGER(np));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  PROTECT(retval = NEW_LIST(3));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(3));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;mm&quot;</span>));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;tau&quot;</span>));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;pivot&quot;</span>));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  SET_ELEMENT(retval,0,mm);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  SET_ELEMENT(retval,1,<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  SET_ELEMENT(retval,2,pivot);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  order_reg_model_matrix(REAL(z),REAL(mm),REAL(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a1a19b1194b1b0380d189ff12188a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a1a19b1194b1b0380d189ff12188a4b">&#9670;&nbsp;</a></span>probe_marginal_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_marginal_solve </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>setup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__marginal_8c_source.html#l00043">43</a> of file <a class="el" href="probe__marginal_8c_source.html">probe_marginal.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                                          {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, mm, <a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>, pivot, beta, beta_names;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> n, nx, np, df;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  df = *(INTEGER(AS_INTEGER(diff)));  <span class="comment">// order of differencing</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  n = LENGTH(x);              <span class="comment">// n = number of observations</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// unpack the setup information</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  PROTECT(mm = VECTOR_ELT(setup,0));    <span class="comment">//  QR-decomposed model matrix</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a> = VECTOR_ELT(setup,1));   <span class="comment">// diagonals</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  PROTECT(pivot = VECTOR_ELT(setup,2)); <span class="comment">// pivots</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  nx = INTEGER(GET_DIM(mm))[0]; <span class="comment">// nx = number of rows in model matrix</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  np = INTEGER(GET_DIM(mm))[1]; <span class="comment">// np = order of polynomial</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (n-df != nx) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;length of &#39;ref&#39; must equal length of data&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  PROTECT(beta = NEW_NUMERIC(np));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  PROTECT(beta_names = NEW_STRING(np));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; np; i++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;marg.%d&quot;</span>,i+1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    SET_STRING_ELT(beta_names,i,mkChar(tmp));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  SET_NAMES(beta,beta_names);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  order_reg_solve(REAL(beta),REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(mm),REAL(<a class="code" href="gompertz_8c.html#aa7082577997805000f8e8b56846642cd">tau</a>),INTEGER(pivot),n,np,df);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span>(beta);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f90ddaaa65be036697557e76d8e0d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f90ddaaa65be036697557e76d8e0d0c">&#9670;&nbsp;</a></span>probe_nlar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP probe_nlar </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>powers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="probe__nlar_8c_source.html#l00009">9</a> of file <a class="el" href="probe__nlar_8c_source.html">probe_nlar.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                                 {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  SEXP y, beta, beta_names;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> n, nterms;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">double</span> *mm;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">char</span> tmp[BUFSIZ];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  n = LENGTH(x);        <span class="comment">// n = # of observations</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  nterms = LENGTH(lags);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(y = duplicate(AS_NUMERIC(x)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  PROTECT(beta = NEW_NUMERIC(nterms));</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  mm = (<span class="keywordtype">double</span> *) R_alloc(n*nterms,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); <span class="comment">// storage for the model matrix</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  poly_nlar_fit(REAL(beta),REAL(y),n,nterms,INTEGER(lags),INTEGER(powers),mm);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  PROTECT(beta_names = NEW_STRING(nterms));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nterms; k++) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    snprintf(tmp,BUFSIZ,<span class="stringliteral">&quot;nlar.%d^%d&quot;</span>,INTEGER(lags)[k],INTEGER(powers)[k]);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    SET_STRING_ELT(beta_names,k,mkChar(tmp));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  SET_NAMES(beta,beta_names);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  UNPROTECT(3);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">return</span> beta;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8ca33711b215b87cc650765175f1ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ca33711b215b87cc650765175f1ca8">&#9670;&nbsp;</a></span>R_BetaBinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_BetaBinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00096">96</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                                            {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> k, nval, ns, np, nt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, *S, *P, *T;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  SEXP ans;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  PROTECT(n = AS_INTEGER(n)); nval = INTEGER(n)[0];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  PROTECT(size = AS_NUMERIC(size)); ns = LENGTH(size); S = REAL(size);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  PROTECT(prob = AS_NUMERIC(prob)); np = LENGTH(prob); P = REAL(prob);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  PROTECT(theta = AS_NUMERIC(theta)); nt = LENGTH(theta); T = REAL(theta);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  PROTECT(ans = NEW_NUMERIC(nval)); <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = REAL(ans);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>[k] = rbetabinom(S[k%ns],P[k%np],T[k%nt]);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  UNPROTECT(5);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abacea3217a3136190d12e38f91a7f128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abacea3217a3136190d12e38f91a7f128">&#9670;&nbsp;</a></span>R_Euler_Multinom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_Euler_Multinom </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00025">25</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                                                  {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">int</span> ntrans = length(rate);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> dim[2];</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEXP nn, x, nm;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (length(size)&gt;1)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;size&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">if</span> (length(deltat)&gt;1)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;reulermultinom&#39;: only the first element of &#39;dt&#39; is meaningful&quot;</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  PROTECT(nn = AS_INTEGER(n));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  dim[0] = ntrans;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  dim[1] = INTEGER(nn)[0];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  PROTECT(x = makearray(2,dim));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PROTECT(nm = GET_NAMES(rate));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  setrownames(x,nm,2);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  reulermultinom_multi(INTEGER(nn),&amp;ntrans,REAL(size),REAL(rate),REAL(deltat),REAL(x));</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  UNPROTECT(3);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a256259848397b531d0b334182b9c6ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a256259848397b531d0b334182b9c6ca1">&#9670;&nbsp;</a></span>R_GammaWN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP R_GammaWN </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>deltat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributions_8c_source.html#l00070">70</a> of file <a class="el" href="distributions_8c_source.html">distributions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                                 {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">int</span> k, nval, nsig, ndt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">double</span> *x, *sig, *dt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  SEXP ans;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  PROTECT(n = AS_INTEGER(n));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  nval = INTEGER(n)[0];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a> = AS_NUMERIC(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  nsig = LENGTH(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  sig = REAL(<a class="code" href="gompertz_8c.html#a678ef311e74501d7b800f0b47500374a">sigma</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  PROTECT(deltat = AS_NUMERIC(deltat));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  ndt = LENGTH(deltat);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  dt = REAL(deltat);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  PROTECT(ans = NEW_NUMERIC(nval));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  x = REAL(ans);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nval; k++) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    x[k] = rgammawn(sig[k%nsig],dt[k%ndt]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac82c44c250cd2f69f3259d56f09c1c26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac82c44c250cd2f69f3259d56f09c1c26">&#9670;&nbsp;</a></span>R_init_pomp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void R_init_pomp </td>
          <td>(</td>
          <td class="paramtype">DllInfo *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="init_8c_source.html#l00053">53</a> of file <a class="el" href="init_8c_source.html">init.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                 {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// C functions provided for users</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;bspline_eval&quot;</span>,(DL_FUNC) &amp;<a class="code" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c">bspline_eval</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;periodic_bspline_basis_eval&quot;</span>,(DL_FUNC) &amp;<a class="code" href="bspline_8c.html#acabb1ca64e069e1b7767c31435e761d8">periodic_bspline_basis_eval</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a44f810b1f9d483bd150f3e71102b9534">get_userdata</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_int&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#ab81184a02668adfde937ace9d4cd3c89">get_userdata_int</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_userdata_double&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a5703410301afea05b3a3d521ad65597f">get_userdata_double</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;pomp_fun_handler&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_incr&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a5ae1bdf9e79d36d8fc709cbc509d4c8c">load_stack_incr</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;load_stack_decr&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a0a653dae61a3500aaadf64fdefa79c4b">load_stack_decr</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;set_pomp_userdata&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;unset_pomp_userdata&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;make_covariate_table&quot;</span>,(DL_FUNC) &amp;<a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;get_covariate_names&quot;</span>,(DL_FUNC) &amp;<a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;table_lookup&quot;</span>,(DL_FUNC) &amp;<a class="code" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0">table_lookup</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;lookup_in_table&quot;</span>,(DL_FUNC) &amp;<a class="code" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129">lookup_in_table</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_data&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#add3f83f20679bad53b6c982ed9dde8ea">apply_probe_data</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;apply_probe_sim&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#ad2595c6a453ae9fad2f232595ced5ccc">apply_probe_sim</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;systematic_resampling&quot;</span>,(DL_FUNC) &amp;<a class="code" href="pomp__decls_8h.html#a982475f3663a786d7883672aa2ed072e">systematic_resampling</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  R_RegisterCCallable(<span class="stringliteral">&quot;pomp&quot;</span>,<span class="stringliteral">&quot;randwalk_perturbation&quot;</span>, (DL_FUNC) &amp;<a class="code" href="mif2_8c.html#add4b451ca3aa78a5e56183372c18bdb7">randwalk_perturbation</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Register routines</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  R_registerRoutines(info,NULL,callMethods,NULL,NULL);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  R_useDynamicSymbols(info,TRUE);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="ttc" id="abspline_8c_html_acabb1ca64e069e1b7767c31435e761d8"><div class="ttname"><a href="bspline_8c.html#acabb1ca64e069e1b7767c31435e761d8">periodic_bspline_basis_eval</a></div><div class="ttdeci">void periodic_bspline_basis_eval(double x, double period, int degree, int nbasis, double *y)</div><div class="ttdef"><b>Definition:</b> <a href="bspline_8c_source.html#l00118">bspline.c:118</a></div></div>
<div class="ttc" id="alookup__table_8c_html_aaf5964c67b353b466461b1eb1269e129"><div class="ttname"><a href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129">lookup_in_table</a></div><div class="ttdeci">SEXP lookup_in_table(SEXP covar, SEXP t)</div><div class="ttdef"><b>Definition:</b> <a href="lookup__table_8c_source.html#l00024">lookup_table.c:24</a></div></div>
<div class="ttc" id="amif2_8c_html_add4b451ca3aa78a5e56183372c18bdb7"><div class="ttname"><a href="mif2_8c.html#add4b451ca3aa78a5e56183372c18bdb7">randwalk_perturbation</a></div><div class="ttdeci">SEXP randwalk_perturbation(SEXP params, SEXP rw_sd)</div><div class="ttdef"><b>Definition:</b> <a href="mif2_8c_source.html#l00006">mif2.c:6</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a0a653dae61a3500aaadf64fdefa79c4b"><div class="ttname"><a href="pomp__decls_8h.html#a0a653dae61a3500aaadf64fdefa79c4b">load_stack_decr</a></div><div class="ttdeci">SEXP load_stack_decr(SEXP pack)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00132">pomp_fun.c:132</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a44f810b1f9d483bd150f3e71102b9534"><div class="ttname"><a href="pomp__decls_8h.html#a44f810b1f9d483bd150f3e71102b9534">get_userdata</a></div><div class="ttdeci">const SEXP get_userdata(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00012">userdata.c:12</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a5703410301afea05b3a3d521ad65597f"><div class="ttname"><a href="pomp__decls_8h.html#a5703410301afea05b3a3d521ad65597f">get_userdata_double</a></div><div class="ttdeci">const double * get_userdata_double(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00025">userdata.c:25</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a5ae1bdf9e79d36d8fc709cbc509d4c8c"><div class="ttname"><a href="pomp__decls_8h.html#a5ae1bdf9e79d36d8fc709cbc509d4c8c">load_stack_incr</a></div><div class="ttdeci">SEXP load_stack_incr(SEXP pack)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__fun_8c_source.html#l00123">pomp_fun.c:123</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_a982475f3663a786d7883672aa2ed072e"><div class="ttname"><a href="pomp__decls_8h.html#a982475f3663a786d7883672aa2ed072e">systematic_resampling</a></div><div class="ttdeci">SEXP systematic_resampling(SEXP weights, SEXP np)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00009">resample.c:9</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_ab81184a02668adfde937ace9d4cd3c89"><div class="ttname"><a href="pomp__decls_8h.html#ab81184a02668adfde937ace9d4cd3c89">get_userdata_int</a></div><div class="ttdeci">const int * get_userdata_int(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="userdata_8c_source.html#l00018">userdata.c:18</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_ad2595c6a453ae9fad2f232595ced5ccc"><div class="ttname"><a href="pomp__decls_8h.html#ad2595c6a453ae9fad2f232595ced5ccc">apply_probe_sim</a></div><div class="ttdeci">SEXP apply_probe_sim(SEXP object, SEXP nsim, SEXP params, SEXP probes, SEXP datval, SEXP gnsi)</div><div class="ttdef"><b>Definition:</b> <a href="probe_8c_source.html#l00029">probe.c:29</a></div></div>
<div class="ttc" id="apomp__decls_8h_html_add3f83f20679bad53b6c982ed9dde8ea"><div class="ttname"><a href="pomp__decls_8h.html#add3f83f20679bad53b6c982ed9dde8ea">apply_probe_data</a></div><div class="ttdeci">SEXP apply_probe_data(SEXP object, SEXP probes)</div><div class="ttdef"><b>Definition:</b> <a href="probe_8c_source.html#l00004">probe.c:4</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_ac82c44c250cd2f69f3259d56f09c1c26_cgraph.png" border="0" usemap="#apomp__decls_8h_ac82c44c250cd2f69f3259d56f09c1c26_cgraph" alt=""/></div>
<map name="apomp__decls_8h_ac82c44c250cd2f69f3259d56f09c1c26_cgraph" id="apomp__decls_8h_ac82c44c250cd2f69f3259d56f09c1c26_cgraph">
<area shape="rect" title=" " alt="" coords="5,436,108,463"/>
<area shape="rect" href="pomp__decls_8h.html#add3f83f20679bad53b6c982ed9dde8ea" title=" " alt="" coords="189,5,327,32"/>
<area shape="rect" href="pomp__decls_8h.html#ad2595c6a453ae9fad2f232595ced5ccc" title=" " alt="" coords="191,56,325,83"/>
<area shape="rect" href="bspline_8c.html#a71cbe26144698d7db860dc0f9f0fff0c" title=" " alt="" coords="625,324,729,351"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="411,295,574,321"/>
<area shape="rect" href="pomp__decls_8h.html#a44f810b1f9d483bd150f3e71102b9534" title=" " alt="" coords="205,208,311,235"/>
<area shape="rect" href="pomp__decls_8h.html#a5703410301afea05b3a3d521ad65597f" title=" " alt="" coords="179,259,337,285"/>
<area shape="rect" href="pomp__decls_8h.html#ab81184a02668adfde937ace9d4cd3c89" title=" " alt="" coords="193,309,323,336"/>
<area shape="rect" href="pomp__decls_8h.html#a0a653dae61a3500aaadf64fdefa79c4b" title=" " alt="" coords="195,360,321,387"/>
<area shape="rect" href="pomp__decls_8h.html#a5ae1bdf9e79d36d8fc709cbc509d4c8c" title=" " alt="" coords="197,411,319,437"/>
<area shape="rect" href="lookup__table_8c.html#aaf5964c67b353b466461b1eb1269e129" title=" " alt="" coords="195,461,321,488"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="409,483,576,509"/>
<area shape="rect" href="bspline_8c.html#acabb1ca64e069e1b7767c31435e761d8" title=" " alt="" coords="156,563,360,589"/>
<area shape="rect" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="187,613,329,640"/>
<area shape="rect" href="mif2_8c.html#add4b451ca3aa78a5e56183372c18bdb7" title=" " alt="" coords="173,664,343,691"/>
<area shape="rect" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252" title=" " alt="" coords="183,715,333,741"/>
<area shape="rect" href="pomp__decls_8h.html#a982475f3663a786d7883672aa2ed072e" title=" " alt="" coords="171,765,345,792"/>
<area shape="rect" href="lookup__table_8c.html#a036b9fb7cfc62e3984889f95024971a0" title=" " alt="" coords="205,816,311,843"/>
<area shape="rect" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c" title=" " alt="" coords="175,867,341,893"/>
<area shape="rect" href="pomp__decls_8h.html#adbe89f4789c66d534f2521bc3c4c98e7" title=" " alt="" coords="441,56,544,83"/>
<area shape="rect" href="bspline_8c.html#a2f083190a387483412260be17208ee1e" title=" " alt="" coords="408,545,577,586"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="433,765,552,792"/>
</map>
</div>

</div>
</div>
<a id="add4b451ca3aa78a5e56183372c18bdb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add4b451ca3aa78a5e56183372c18bdb7">&#9670;&nbsp;</a></span>randwalk_perturbation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP randwalk_perturbation </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>rw_sd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mif2_8c_source.html#l00006">6</a> of file <a class="el" href="mif2_8c_source.html">mif2.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordtype">double</span> *xp = 0, *rw, *xrw, *xs;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  SEXP Pnames, rwnames, <a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">int</span> *dim, *pidx;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> nrw = 0, <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a> = duplicate(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">// unpack parameter matrix</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  xp = REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// names of parameters undergoing random walk</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  PROTECT(rwnames = GET_NAMES(rw_sd));</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  nrw = LENGTH(rwnames); rw = REAL(rw_sd);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// indices of parameters undergoing random walk</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a> = matchnames(Pnames,rwnames,<span class="stringliteral">&quot;parameters&quot;</span>));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  pidx = INTEGER(<a class="code" href="trajectory_8c.html#ab8af0f07388320ad03576d4d4c0c1bc1">pindex</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">for</span> (j = 0, xrw = rw; j &lt; nrw; j++, pidx++, xrw++) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">for</span> (k = 0, xs = xp+(*pidx); k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xs += <a class="code" href="trajectory_8c.html#a14099a72d03b2c4a17df78083aaefedb">npars</a>) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      *xs += *xrw * norm_rand();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">return</span>(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_add4b451ca3aa78a5e56183372c18bdb7_icgraph.png" border="0" usemap="#apomp__decls_8h_add4b451ca3aa78a5e56183372c18bdb7_icgraph" alt=""/></div>
<map name="apomp__decls_8h_add4b451ca3aa78a5e56183372c18bdb7_icgraph" id="apomp__decls_8h_add4b451ca3aa78a5e56183372c18bdb7_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,325,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="aa019045daea9be339fd1e70e3441d252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa019045daea9be339fd1e70e3441d252">&#9670;&nbsp;</a></span>set_pomp_userdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_pomp_userdata </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>userdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00008">8</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                                       {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a> = userdata;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_aa019045daea9be339fd1e70e3441d252_icgraph.png" border="0" usemap="#apomp__decls_8h_aa019045daea9be339fd1e70e3441d252_icgraph" alt=""/></div>
<map name="apomp__decls_8h_aa019045daea9be339fd1e70e3441d252_icgraph" id="apomp__decls_8h_aa019045daea9be339fd1e70e3441d252_icgraph">
<area shape="rect" title=" " alt="" coords="391,81,541,108"/>
<area shape="rect" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="175,5,335,32"/>
<area shape="rect" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="168,56,343,83"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="204,107,307,133"/>
<area shape="rect" href="pomp__decls_8h.html#a868191e685624fbffd57ee4f32859ac6" title=" " alt="" coords="197,157,314,184"/>
<area shape="rect" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,5,120,32"/>
</map>
</div>

</div>
</div>
<a id="a670defd3a8b9d05d86bc8da76de23778"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a670defd3a8b9d05d86bc8da76de23778">&#9670;&nbsp;</a></span>sobol_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP sobol_sequence </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sobolseq_8c_source.html#l00234">234</a> of file <a class="el" href="sobolseq_8c_source.html">sobolseq.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  SEXP data;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = (<span class="keywordtype">unsigned</span> int) INTEGER(dim)[0];</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = (<span class="keywordtype">unsigned</span> int) INTEGER(length)[0];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">double</span> *dp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="structnlopt__soboldata__s.html">nlopt_sobol</a> s = nlopt_sobol_create((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) d);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (s==0) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;dimension is too high&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  PROTECT(data = allocMatrix(REALSXP,d,n)); dp = REAL(data);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  nlopt_sobol_skip(s,n,dp);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (k = 1; k &lt; n; k++) sobol_gen(s,dp+k*d);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  nlopt_sobol_destroy(s);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  UNPROTECT(1);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">return</span>(data);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="ttc" id="astructnlopt__soboldata__s_html"><div class="ttname"><a href="structnlopt__soboldata__s.html">nlopt_soboldata_s</a></div><div class="ttdef"><b>Definition:</b> <a href="sobolseq_8c_source.html#l00065">sobolseq.c:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a868191e685624fbffd57ee4f32859ac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a868191e685624fbffd57ee4f32859ac6">&#9670;&nbsp;</a></span>SSA_simulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP SSA_simulator </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>tstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>vmatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>accumvars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>hmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>gnsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssa_8c_source.html#l00230">230</a> of file <a class="el" href="ssa_8c_source.html">ssa.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">int</span> *dim, xdim[3];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">int</span> nvar, nvarv, nevent, npar, nrep, ntimes;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  SEXP statenames, paramnames, covarnames;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>, covdim;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">int</span> nzeros = LENGTH(accumvars);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0">pompfunmode</a> <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> = <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  SEXP <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>, zindex, vindex;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">int</span> *sidx, *pidx, *cidx, *zidx, *vidx;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  SEXP <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>, <a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>, Pnames, Cnames, Vnames;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="structlookup__table__t.html">lookup_table_t</a> covariate_table;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  Rboolean hasvnames;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">double</span> t0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  dim = INTEGER(GET_DIM(xstart)); nvar = dim[0]; nrep = dim[1];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  dim = INTEGER(GET_DIM(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)); npar = dim[0];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  dim = INTEGER(GET_DIM(vmatrix)); nvarv = dim[0]; nevent = dim[1];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (nvarv != nvar)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;number of state variables must equal the number of rows in &#39;v&#39;.&quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  ntimes = LENGTH(times);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  PROTECT(tstart = AS_NUMERIC(tstart));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  PROTECT(times = AS_NUMERIC(times));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  t0 = *(REAL(tstart));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> (t0 &gt; *(REAL(times))) <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;&#39;t0&#39; must be no later than &#39;times[1]&#39;.&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a> = GET_ROWNAMES(GET_DIMNAMES(xstart)));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>)));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  PROTECT(Cnames = <a class="code" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b">get_covariate_names</a>(covar));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  PROTECT(Vnames = GET_ROWNAMES(GET_DIMNAMES(vmatrix)));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  covariate_table = <a class="code" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f">make_covariate_table</a>(covar,&amp;covdim);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  PROTECT(statenames = GET_SLOT(func,install(<span class="stringliteral">&quot;statenames&quot;</span>)));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  PROTECT(paramnames = GET_SLOT(func,install(<span class="stringliteral">&quot;paramnames&quot;</span>)));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  PROTECT(covarnames = GET_SLOT(func,install(<span class="stringliteral">&quot;covarnames&quot;</span>)));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a> = LENGTH(covarnames);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  hasvnames = !isNull(Vnames);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  PROTECT(hmax = AS_NUMERIC(hmax));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  PROTECT(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a> = <a class="code" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e">pomp_fun_handler</a>(func,gnsi,&amp;<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,NA_STRING,Cnames));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">int</span> nprotect = 11;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0adfae35394ef2ad547edb9abfc391cab4">undef</a>: <span class="keywordflow">default</span>:  <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;unrecognized &#39;mode&#39; %d&quot;</span>,<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a>); <span class="comment">// #nocov</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a>: <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>:</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    *((<span class="keywordtype">void</span> **) (&amp;(<a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>))) = R_ExternalPtrAddr(<a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252">set_pomp_userdata</a>(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a010cbf4e4887691452cc62528b4485ad">Rfun</a>:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a> = (<a class="code" href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a> *) __pomp_Rfun_ssa_ratefn;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a> = nvar;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a> = npar;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a> = covdim;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    PROTECT(<a class="code" href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a> = add_args(<a class="code" href="trajectory_8c.html#a94fe754831aa7e8eeb4053fa11b537cd">args</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,Pnames,Cnames));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    PROTECT(<a class="code" href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a> = <a class="code" href="trajectory_8c.html#ae1150d665d648766c28508b57a8cb644">fn</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    nprotect += 2;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a> = 1;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  xdim[0] = nvar; xdim[1] = nrep; xdim[2] = ntimes;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  PROTECT(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a> = makearray(3,xdim)); nprotect++;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  setrownames(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,<a class="code" href="trajectory_8c.html#a2e65cd991bb60dd57098ab40b91ac722">Snames</a>,3);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  sidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;stateindex&quot;</span>)));</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  pidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;paramindex&quot;</span>)));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  cidx = INTEGER(GET_SLOT(func,install(<span class="stringliteral">&quot;covarindex&quot;</span>)));</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (nzeros&gt;0) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    PROTECT(zindex = <a class="code" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,accumvars,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    zidx = INTEGER(zindex);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    zidx = 0;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span> (hasvnames) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    PROTECT(vindex = <a class="code" href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a>(xstart,Vnames,<span class="stringliteral">&quot;state variables&quot;</span>)); nprotect++;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    vidx = INTEGER(vindex);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    vidx = 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nrep; i++) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      SSA(<a class="code" href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a>,i,nvar,nevent,npar,nrep,ntimes,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      REAL(xstart),t0,REAL(times),REAL(<a class="code" href="trajectory_8c.html#a58d967e1449ba00d87d2f6d70b50d525">params</a>),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>),REAL(vmatrix),</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      nzeros,zidx,sidx,pidx,<a class="code" href="trajectory_8c.html#a4edeebb04b42d65deaf721d0abbc091e">ncovars</a>,cidx,hasvnames,vidx,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      covdim,&amp;covariate_table,REAL(hmax));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0a68b9b7d7ecabc154b06307bb01caa288">native</a> || <a class="code" href="trajectory_8c.html#a6c1c1c275092d79f830aa36620cfd33d">mode</a> == <a class="code" href="pomp__defines_8h.html#a9b7b93971f7c1bb47567c959809206b0afea0bbef864c95976371693c4688026d">regNative</a>) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="pomp__decls_8h.html#a5ddde1fa5bcf8c3949fd4865a7ab474c">unset_pomp_userdata</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="ttc" id="apomp_8h_html_a7cbbce02475d974d83e25dc46c4b6f1d"><div class="ttname"><a href="pomp_8h.html#a7cbbce02475d974d83e25dc46c4b6f1d">pomp_ssa_rate_fn</a></div><div class="ttdeci">double pomp_ssa_rate_fn(int event, double t, const double *x, const double *p, const int *stateindex, const int *parindex, const int *covindex, const double *covars)</div><div class="ttdef"><b>Definition:</b> <a href="pomp_8h_source.html#l00203">pomp.h:203</a></div></div>
<div class="ttc" id="apomp__defines_8h_html_a2285fe40c11882d02308957485772528"><div class="ttname"><a href="pomp__defines_8h.html#a2285fe40c11882d02308957485772528">MATCHROWNAMES</a></div><div class="ttdeci">#define MATCHROWNAMES(X, N, W)</div><div class="ttdef"><b>Definition:</b> <a href="pomp__defines_8h_source.html#l00013">pomp_defines.h:13</a></div></div>
<div class="ttc" id="assa_8c_html_a492c6ccf2bde2bebcd32e73e0933ee92"><div class="ttname"><a href="ssa_8c.html#a492c6ccf2bde2bebcd32e73e0933ee92">FIRST</a></div><div class="ttdeci">#define FIRST</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00200">ssa.c:200</a></div></div>
<div class="ttc" id="assa_8c_html_a6ee98078df1e27286ab249d0ceb99dc9"><div class="ttname"><a href="ssa_8c.html#a6ee98078df1e27286ab249d0ceb99dc9">NPAR</a></div><div class="ttdeci">#define NPAR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00196">ssa.c:196</a></div></div>
<div class="ttc" id="assa_8c_html_aacac4c9fd5f97b563c3e886e6c78af77"><div class="ttname"><a href="ssa_8c.html#aacac4c9fd5f97b563c3e886e6c78af77">RXR</a></div><div class="ttdeci">#define RXR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00201">ssa.c:201</a></div></div>
<div class="ttc" id="assa_8c_html_ad4005a40cf60593ea8924e927d57f9eb"><div class="ttname"><a href="ssa_8c.html#ad4005a40cf60593ea8924e927d57f9eb">NCOV</a></div><div class="ttdeci">#define NCOV</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00197">ssa.c:197</a></div></div>
<div class="ttc" id="assa_8c_html_ad5195ac8f863f5a9a7eaa0db094f7639"><div class="ttname"><a href="ssa_8c.html#ad5195ac8f863f5a9a7eaa0db094f7639">NVAR</a></div><div class="ttdeci">#define NVAR</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00195">ssa.c:195</a></div></div>
<div class="ttc" id="assa_8c_html_af97b4b249542bc8c012be3f4614bdcf0"><div class="ttname"><a href="ssa_8c.html#af97b4b249542bc8c012be3f4614bdcf0">RATEFN</a></div><div class="ttdeci">#define RATEFN</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00199">ssa.c:199</a></div></div>
<div class="ttc" id="assa_8c_html_aff1b09d6630c6c0942f78171e74c1b9d"><div class="ttname"><a href="ssa_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a></div><div class="ttdeci">#define ARGS</div><div class="ttdef"><b>Definition:</b> <a href="ssa_8c_source.html#l00198">ssa.c:198</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a868191e685624fbffd57ee4f32859ac6_cgraph.png" border="0" usemap="#apomp__decls_8h_a868191e685624fbffd57ee4f32859ac6_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a868191e685624fbffd57ee4f32859ac6_cgraph" id="apomp__decls_8h_a868191e685624fbffd57ee4f32859ac6_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,123,108"/>
<area shape="rect" href="lookup__table_8c.html#aa7a80c78f9ef26859eea09b5299e702b" title=" " alt="" coords="173,5,335,32"/>
<area shape="rect" href="lookup__table_8c.html#a1e57a24640cb0d9f6f8d55e02c3d553f" title=" " alt="" coords="171,56,337,83"/>
<area shape="rect" href="pomp__decls_8h.html#a94db08f2d9f751e7832aaadb5ae6920e" title=" " alt="" coords="183,107,325,133"/>
<area shape="rect" href="pomp__decls_8h.html#aa019045daea9be339fd1e70e3441d252" title=" " alt="" coords="179,157,329,184"/>
</map>
</div>

</div>
</div>
<a id="aba3bb9e9bce5419b23032d95b1bba531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba3bb9e9bce5419b23032d95b1bba531">&#9670;&nbsp;</a></span>synth_loglik()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP synth_loglik </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ysim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ydat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="synth__lik_8c_source.html#l00106">106</a> of file <a class="el" href="synth__lik_8c_source.html">synth_lik.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                         {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SEXP loglik, dim, y;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  PROTECT(y = duplicate(AS_NUMERIC(ydat)));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  PROTECT(dim = GET_DIM(ysim));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  PROTECT(ysim = AS_NUMERIC(ysim));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  robust_synth_loglik(REAL(ysim),INTEGER(dim),REAL(y),REAL(loglik));</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  UNPROTECT(4);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> loglik;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a982475f3663a786d7883672aa2ed072e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a982475f3663a786d7883672aa2ed072e">&#9670;&nbsp;</a></span>systematic_resampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP systematic_resampling </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resample_8c_source.html#l00009">9</a> of file <a class="el" href="resample_8c_source.html">resample.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">int</span> m, n;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  SEXP perm;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  m = *(INTEGER(AS_INTEGER(np)));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  n = LENGTH(weights);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  PROTECT(perm = NEW_INTEGER(m));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  PROTECT(weights = AS_NUMERIC(weights));</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a>(n,REAL(weights),m,INTEGER(perm),1);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  PutRNGstate();</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  UNPROTECT(2);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">return</span>(perm);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="ttc" id="aresample_8c_html_a37f1a2acca063e96f0efa73705ec87b2"><div class="ttname"><a href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a></div><div class="ttdeci">void nosort_resamp(int nw, double *w, int np, int *p, int offset)</div><div class="ttdef"><b>Definition:</b> <a href="resample_8c_source.html#l00025">resample.c:25</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a982475f3663a786d7883672aa2ed072e_cgraph.png" border="0" usemap="#apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_cgraph" alt=""/></div>
<map name="apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_cgraph" id="apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="resample_8c.html#a37f1a2acca063e96f0efa73705ec87b2" title=" " alt="" coords="228,5,347,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a982475f3663a786d7883672aa2ed072e_icgraph.png" border="0" usemap="#apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_icgraph" id="apomp__decls_8h_a982475f3663a786d7883672aa2ed072e_icgraph">
<area shape="rect" title=" " alt="" coords="156,5,331,32"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="5,5,108,32"/>
</map>
</div>

</div>
</div>
<a id="a036b9fb7cfc62e3984889f95024971a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a036b9fb7cfc62e3984889f95024971a0">&#9670;&nbsp;</a></span>table_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void table_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlookup__table__t.html">lookup_table_t</a> *&#160;</td>
          <td class="paramname"><em>tab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="lookup__table_8c_source.html#l00053">53</a> of file <a class="el" href="lookup__table_8c_source.html">lookup_table.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> flag = 0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> j, k;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> e;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> ((tab == 0) || (tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a> &lt; 1) || (tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a> &lt; 1)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a> = findInterval(tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>,tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>,x,TRUE,TRUE,tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>,&amp;flag);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// warn only if we are *outside* the interval</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> ((x &lt; tab-&gt;x[0]) || (x &gt; tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[(tab-&gt;<a class="code" href="structlookup__table__t.html#a928f893d2851476723521ae3c7d29749">length</a>)-1]))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="pomp__internal_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;in &#39;table_lookup&#39;: extrapolating at %le.&quot;</span>, x);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">switch</span> (tab-&gt;<a class="code" href="structlookup__table__t.html#a83e4e0655a5836172df9d671ed4d726c">order</a>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">default</span>: <span class="comment">// linear interpolation</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    e = (x - tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]) / (tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>] - tab-&gt;<a class="code" href="structlookup__table__t.html#aa071aabe5391f11c0d915907ad16dd28">x</a>[tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>-1]);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      k = j+(tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>)*(tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      y[j] = e*(tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k])+(1-e)*(tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k-tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>]);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">case</span> 0: <span class="comment">// piecewise constant</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>; j++) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      k = j+(tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>)*(tab-&gt;<a class="code" href="structlookup__table__t.html#a5bc85f841e0c15e15a7b8b7e12172ea1">index</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      y[j] = tab-&gt;<a class="code" href="structlookup__table__t.html#afc0a89e59da489c4fd7fd4aca70c298d">y</a>[k-tab-&gt;<a class="code" href="structlookup__table__t.html#a73816c282d64530aafb1dd154ee41f60">width</a>];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a036b9fb7cfc62e3984889f95024971a0_icgraph.png" border="0" usemap="#apomp__decls_8h_a036b9fb7cfc62e3984889f95024971a0_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a036b9fb7cfc62e3984889f95024971a0_icgraph" id="apomp__decls_8h_a036b9fb7cfc62e3984889f95024971a0_icgraph">
<area shape="rect" title=" " alt="" coords="391,107,497,133"/>
<area shape="rect" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="175,5,335,32"/>
<area shape="rect" href="pomp__decls_8h.html#ab5870e93076f917246e64740c1416a05" title=" " alt="" coords="191,56,319,83"/>
<area shape="rect" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="168,107,343,133"/>
<area shape="rect" href="pomp__decls_8h.html#ab2d2bf78c9a2e064a57e6c9bf3d52bc2" title=" " alt="" coords="184,157,327,184"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="204,208,307,235"/>
<area shape="rect" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,31,120,57"/>
</map>
</div>

</div>
</div>
<a id="a5ddde1fa5bcf8c3949fd4865a7ab474c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ddde1fa5bcf8c3949fd4865a7ab474c">&#9670;&nbsp;</a></span>unset_pomp_userdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unset_pomp_userdata </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="userdata_8c_source.html#l00032">32</a> of file <a class="el" href="userdata_8c_source.html">userdata.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="userdata_8c.html#a1157d519a72b891b41cef2d20a90bebb">USERDATA</a> = R_NilValue;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pomp__decls_8h_a5ddde1fa5bcf8c3949fd4865a7ab474c_icgraph.png" border="0" usemap="#apomp__decls_8h_a5ddde1fa5bcf8c3949fd4865a7ab474c_icgraph" alt=""/></div>
<map name="apomp__decls_8h_a5ddde1fa5bcf8c3949fd4865a7ab474c_icgraph" id="apomp__decls_8h_a5ddde1fa5bcf8c3949fd4865a7ab474c_icgraph">
<area shape="rect" title=" " alt="" coords="391,56,557,83"/>
<area shape="rect" href="pomp__decls_8h.html#a4c519c3f1f7ceca7aae16c0aa702cfeb" title=" " alt="" coords="175,5,335,32"/>
<area shape="rect" href="pomp__decls_8h.html#aca7782b5824af2ba096aa0d7f1c4834b" title=" " alt="" coords="168,56,343,83"/>
<area shape="rect" href="init_8c.html#ac82c44c250cd2f69f3259d56f09c1c26" title=" " alt="" coords="204,107,307,133"/>
<area shape="rect" href="pomp__decls_8h.html#a388d1f049a9d7284d0e7ba26591e6099" title=" " alt="" coords="5,5,120,32"/>
</map>
</div>

</div>
</div>
<a id="ac643fb3aad609b1078e9abb994ec6cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac643fb3aad609b1078e9abb994ec6cf2">&#9670;&nbsp;</a></span>wpfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP wpfilter </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Trigger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wpfilter_8c_source.html#l00010">10</a> of file <a class="el" href="wpfilter_8c_source.html">wpfilter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  SEXP dimX, dimP, Xnames, Pnames;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>, np;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">//  int npars;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="comment">//  int do_pr = 0;  // do parameter resampling?  at the moment, we do not</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordtype">int</span> *dim, k;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *dimnm[] = {<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;.id&quot;</span>};</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  PROTECT(dimX = GET_DIM(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>));</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  dim = INTEGER(dimX);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a> = dim[0]; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> = dim[1];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  PROTECT(Xnames = GET_ROWNAMES(GET_DIMNAMES(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>)));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  PROTECT(Params = as_matrix(Params));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  PROTECT(dimP = GET_DIM(Params));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  dim = INTEGER(dimP);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">//  npars = dim[0];</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (dim[1] &gt; 1 &amp;&amp; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a> != dim[1])</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="pomp__internal_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;ncol(&#39;params&#39;) does not match ncol(&#39;states&#39;)&quot;</span>); <span class="comment">// # nocov</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  PROTECT(Pnames = GET_ROWNAMES(GET_DIMNAMES(Params)));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  np = *INTEGER(AS_INTEGER(Np));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">//  do_pr = (dim[1] &gt; 1);       // resample parameters as well as states</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  PROTECT(Weights = duplicate(AS_NUMERIC(Weights)));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  PROTECT(W = duplicate(AS_NUMERIC(W)));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">int</span> nprotect = 7;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">double</span> trigger, target;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  trigger = *REAL(AS_NUMERIC(Trigger));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  target = *REAL(AS_NUMERIC(Target));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// add W to Weights. check weights for NAN or +Inf. find max of weights.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> maxlogw = R_NegInf, oldw = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span> *xW = REAL(Weights);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span> *xw = REAL(W);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    oldw += exp(*xW);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    *xW += *xw;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (ISNAN(*xW) || *xW == R_PosInf) { <span class="comment">// check the weights</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      SEXP rv;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      PROTECT(rv = NEW_INTEGER(1)); nprotect++;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      *INTEGER(rv) = k+1; <span class="comment">// return the index of the peccant particle</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      UNPROTECT(nprotect);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">return</span> rv;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (maxlogw &lt; *xW) maxlogw = *xW;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// set up return list</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  SEXP retval, retvalnames, newdim;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  PROTECT(retval = NEW_LIST(5));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  PROTECT(retvalnames = NEW_CHARACTER(5));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  PROTECT(newdim = NEW_INTEGER(2));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  nprotect += 3;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  dim = INTEGER(newdim);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  dim[0] = <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; dim[1] = <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  SET_DIM(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,newdim);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  setrownames(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,Xnames,2);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  fixdimnames(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>,dimnm,2);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  SET_STRING_ELT(retvalnames,0,mkChar(<span class="stringliteral">&quot;states&quot;</span>));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  SET_STRING_ELT(retvalnames,1,mkChar(<span class="stringliteral">&quot;params&quot;</span>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  SET_STRING_ELT(retvalnames,2,mkChar(<span class="stringliteral">&quot;weights&quot;</span>));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  SET_STRING_ELT(retvalnames,3,mkChar(<span class="stringliteral">&quot;ess&quot;</span>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  SET_STRING_ELT(retvalnames,4,mkChar(<span class="stringliteral">&quot;loglik&quot;</span>));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  SET_NAMES(retval,retvalnames);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  SEXP ess, loglik;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  PROTECT(ess = NEW_NUMERIC(1));    <span class="comment">// effective sample size</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  PROTECT(loglik = NEW_NUMERIC(1)); <span class="comment">// conditional log likelihood</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  nprotect += 2;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span> (maxlogw == R_NegInf) {    <span class="comment">// all particles have zero likelihood</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    *REAL(ess) = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    *REAL(loglik) = R_NegInf;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// compute sum and sum of squares</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> w = 0, ws = 0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    xw = REAL(W);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    xW = REAL(Weights);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      *xW -= maxlogw;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      *xw = exp(*xW);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (*xw != 0) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        w += *xw;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        ws += (*xw)*(*xw);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    *(REAL(ess)) = w*w/ws;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    *(REAL(loglik)) = maxlogw + log(w) - log(oldw);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  SET_ELEMENT(retval,3,ess);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  SET_ELEMENT(retval,4,loglik);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (maxlogw == R_NegInf || (*REAL(ess) &gt;= <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>*trigger &amp;&amp; np == <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>)) { <span class="comment">// do not resample</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    SET_ELEMENT(retval,0,<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    SET_ELEMENT(retval,2,Weights);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  } <span class="keywordflow">else</span> {                      <span class="comment">// no resampling</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// create storage for new states</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    SEXP newstates = R_NilValue;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">double</span> *ss = 0, *st = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordtype">int</span> xdim[] = {<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>, np};</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      PROTECT(newstates = makearray(2,xdim)); nprotect++;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      setrownames(newstates,Xnames,2);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      fixdimnames(newstates,dimnm,2);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      ss = REAL(<a class="code" href="gompertz_8c.html#a207fd5507206d307cd63f95374fcd00d">X</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      st = REAL(newstates);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    SET_ELEMENT(retval,0,newstates);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// create storage for new parameters</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//    SEXP newparams = R_NilValue;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//    double *ps = 0, *pt = 0;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// if (do_pr) {</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//   int xdim[] = {npars, np};</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">//   PROTECT(newparams = makearray(2,xdim)); nprotect++;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//   setrownames(newparams,Pnames,2);</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">//   fixdimnames(newparams,dimnm,2);</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">//   ps = REAL(Params);</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">//   pt = REAL(newparams);</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">//   SET_ELEMENT(retval,1,newparams);</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// } else {</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    SET_ELEMENT(retval,1,Params);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// create storage for new weights</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    SEXP newweights = R_NilValue;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">double</span> *ws = 0, *wt = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      PROTECT(newweights = NEW_NUMERIC(np)); nprotect++;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      ws = REAL(Weights);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      wt = REAL(newweights);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    SET_ELEMENT(retval,2,newweights);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// compute target resampling weights</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span> (k = 0, xw = REAL(W), xW = REAL(Weights); k &lt; <a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>; k++, xw++, xW++) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      *xw = *xW;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      *xW *= target;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      *xw = exp(*xw - *xW);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// do resampling</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordtype">int</span> sample[np];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      GetRNGstate();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="pomp__decls_8h.html#a37f1a2acca063e96f0efa73705ec87b2">nosort_resamp</a>(<a class="code" href="trajectory_8c.html#a72f66d373d52ab42fd8af134bd7f9cda">nreps</a>,REAL(W),np,sample,0);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      PutRNGstate();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; np; k++) { <span class="comment">// copy the particles</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">int</span> sp = sample[k], j;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">double</span> *xx;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//  double *xp;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span> (j = 0, xx = ss+<a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>*sp; j &lt; <a class="code" href="trajectory_8c.html#ae8f6d2fd6490d3153cb4133bf183a404">nvars</a>; j++, st++, xx++)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      *st = *xx;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// REVISIT THIS IF PARAMETER RESAMPLING IS IMPLEMENTED</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// if (do_pr) {</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//   for (j = 0, xp = ps+npars*sp; j &lt; npars; j++, pt++, xp++)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//     *pt = *xp;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    wt[k] = ws[sp];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  UNPROTECT(nprotect);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">return</span>(retval);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="pomp__decls_8h.html">pomp_decls.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
